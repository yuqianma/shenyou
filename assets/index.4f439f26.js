function aC(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var LR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function RR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var K={exports:{}},ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lu=Symbol.for("react.element"),OR=Symbol.for("react.portal"),FR=Symbol.for("react.fragment"),DR=Symbol.for("react.strict_mode"),kR=Symbol.for("react.profiler"),NR=Symbol.for("react.provider"),UR=Symbol.for("react.context"),GR=Symbol.for("react.forward_ref"),zR=Symbol.for("react.suspense"),VR=Symbol.for("react.memo"),HR=Symbol.for("react.lazy"),p2=Symbol.iterator;function jR(t){return t===null||typeof t!="object"?null:(t=p2&&t[p2]||t["@@iterator"],typeof t=="function"?t:null)}var lC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cC=Object.assign,AC={};function Xl(t,e,n){this.props=t,this.context=e,this.refs=AC,this.updater=n||lC}Xl.prototype.isReactComponent={};Xl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Xl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function uC(){}uC.prototype=Xl.prototype;function ty(t,e,n){this.props=t,this.context=e,this.refs=AC,this.updater=n||lC}var ny=ty.prototype=new uC;ny.constructor=ty;cC(ny,Xl.prototype);ny.isPureReactComponent=!0;var g2=Array.isArray,fC=Object.prototype.hasOwnProperty,ry={current:null},hC={key:!0,ref:!0,__self:!0,__source:!0};function dC(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)fC.call(e,r)&&!hC.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),h=0;h<a;h++)c[h]=arguments[h+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:lu,type:t,key:s,ref:o,props:i,_owner:ry.current}}function WR(t,e){return{$$typeof:lu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function iy(t){return typeof t=="object"&&t!==null&&t.$$typeof===lu}function QR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var m2=/\/+/g;function up(t,e){return typeof t=="object"&&t!==null&&t.key!=null?QR(""+t.key):e.toString(36)}function oh(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case lu:case OR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+up(o,0):r,g2(i)?(n="",t!=null&&(n=t.replace(m2,"$&/")+"/"),oh(i,e,n,"",function(h){return h})):i!=null&&(iy(i)&&(i=WR(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(m2,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",g2(t))for(var a=0;a<t.length;a++){s=t[a];var c=r+up(s,a);o+=oh(s,e,n,c,i)}else if(c=jR(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=r+up(s,a++),o+=oh(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Zu(t,e,n){if(t==null)return t;var r=[],i=0;return oh(t,r,"","",function(s){return e.call(n,s,i++)}),r}function $R(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ur={current:null},ah={transition:null},XR={ReactCurrentDispatcher:ur,ReactCurrentBatchConfig:ah,ReactCurrentOwner:ry};ct.Children={map:Zu,forEach:function(t,e,n){Zu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Zu(t,function(){e++}),e},toArray:function(t){return Zu(t,function(e){return e})||[]},only:function(t){if(!iy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ct.Component=Xl;ct.Fragment=FR;ct.Profiler=kR;ct.PureComponent=ty;ct.StrictMode=DR;ct.Suspense=zR;ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XR;ct.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=cC({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ry.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)fC.call(e,c)&&!hC.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var h=0;h<c;h++)a[h]=arguments[h+2];r.children=a}return{$$typeof:lu,type:t.type,key:i,ref:s,props:r,_owner:o}};ct.createContext=function(t){return t={$$typeof:UR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:NR,_context:t},t.Consumer=t};ct.createElement=dC;ct.createFactory=function(t){var e=dC.bind(null,t);return e.type=t,e};ct.createRef=function(){return{current:null}};ct.forwardRef=function(t){return{$$typeof:GR,render:t}};ct.isValidElement=iy;ct.lazy=function(t){return{$$typeof:HR,_payload:{_status:-1,_result:t},_init:$R}};ct.memo=function(t,e){return{$$typeof:VR,type:t,compare:e===void 0?null:e}};ct.startTransition=function(t){var e=ah.transition;ah.transition={};try{t()}finally{ah.transition=e}};ct.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ct.useCallback=function(t,e){return ur.current.useCallback(t,e)};ct.useContext=function(t){return ur.current.useContext(t)};ct.useDebugValue=function(){};ct.useDeferredValue=function(t){return ur.current.useDeferredValue(t)};ct.useEffect=function(t,e){return ur.current.useEffect(t,e)};ct.useId=function(){return ur.current.useId()};ct.useImperativeHandle=function(t,e,n){return ur.current.useImperativeHandle(t,e,n)};ct.useInsertionEffect=function(t,e){return ur.current.useInsertionEffect(t,e)};ct.useLayoutEffect=function(t,e){return ur.current.useLayoutEffect(t,e)};ct.useMemo=function(t,e){return ur.current.useMemo(t,e)};ct.useReducer=function(t,e,n){return ur.current.useReducer(t,e,n)};ct.useRef=function(t){return ur.current.useRef(t)};ct.useState=function(t){return ur.current.useState(t)};ct.useSyncExternalStore=function(t,e,n){return ur.current.useSyncExternalStore(t,e,n)};ct.useTransition=function(){return ur.current.useTransition()};ct.version="18.2.0";(function(t){t.exports=ct})(K);const Nd=RR(K.exports),y2=aC({__proto__:null,default:Nd},[K.exports]);var sm={},Ud={exports:{}},Hr={},pC={exports:{}},gC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(le,_e){var Ce=le.length;le.push(_e);e:for(;0<Ce;){var Fe=Ce-1>>>1,ke=le[Fe];if(0<i(ke,_e))le[Fe]=_e,le[Ce]=ke,Ce=Fe;else break e}}function n(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var _e=le[0],Ce=le.pop();if(Ce!==_e){le[0]=Ce;e:for(var Fe=0,ke=le.length,it=ke>>>1;Fe<it;){var Rt=2*(Fe+1)-1,Pn=le[Rt],An=Rt+1,Tt=le[An];if(0>i(Pn,Ce))An<ke&&0>i(Tt,Pn)?(le[Fe]=Tt,le[An]=Ce,Fe=An):(le[Fe]=Pn,le[Rt]=Ce,Fe=Rt);else if(An<ke&&0>i(Tt,Ce))le[Fe]=Tt,le[An]=Ce,Fe=An;else break e}}return _e}function i(le,_e){var Ce=le.sortIndex-_e.sortIndex;return Ce!==0?Ce:le.id-_e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],h=[],p=1,m=null,v=3,E=!1,b=!1,x=!1,I=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(le){for(var _e=n(h);_e!==null;){if(_e.callback===null)r(h);else if(_e.startTime<=le)r(h),_e.sortIndex=_e.expirationTime,e(c,_e);else break;_e=n(h)}}function O(le){if(x=!1,M(le),!b)if(n(c)!==null)b=!0,Pe(N);else{var _e=n(h);_e!==null&&Ue(O,_e.startTime-le)}}function N(le,_e){b=!1,x&&(x=!1,S(Z),Z=-1),E=!0;var Ce=v;try{for(M(_e),m=n(c);m!==null&&(!(m.expirationTime>_e)||le&&!D());){var Fe=m.callback;if(typeof Fe=="function"){m.callback=null,v=m.priorityLevel;var ke=Fe(m.expirationTime<=_e);_e=t.unstable_now(),typeof ke=="function"?m.callback=ke:m===n(c)&&r(c),M(_e)}else r(c);m=n(c)}if(m!==null)var it=!0;else{var Rt=n(h);Rt!==null&&Ue(O,Rt.startTime-_e),it=!1}return it}finally{m=null,v=Ce,E=!1}}var z=!1,X=null,Z=-1,Q=5,k=-1;function D(){return!(t.unstable_now()-k<Q)}function ne(){if(X!==null){var le=t.unstable_now();k=le;var _e=!0;try{_e=X(!0,le)}finally{_e?se():(z=!1,X=null)}}else z=!1}var se;if(typeof P=="function")se=function(){P(ne)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,xe=oe.port2;oe.port1.onmessage=ne,se=function(){xe.postMessage(null)}}else se=function(){I(ne,0)};function Pe(le){X=le,z||(z=!0,se())}function Ue(le,_e){Z=I(function(){le(t.unstable_now())},_e)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(le){le.callback=null},t.unstable_continueExecution=function(){b||E||(b=!0,Pe(N))},t.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<le?Math.floor(1e3/le):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(le){switch(v){case 1:case 2:case 3:var _e=3;break;default:_e=v}var Ce=v;v=_e;try{return le()}finally{v=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(le,_e){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var Ce=v;v=le;try{return _e()}finally{v=Ce}},t.unstable_scheduleCallback=function(le,_e,Ce){var Fe=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Fe+Ce:Fe):Ce=Fe,le){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=Ce+ke,le={id:p++,callback:_e,priorityLevel:le,startTime:Ce,expirationTime:ke,sortIndex:-1},Ce>Fe?(le.sortIndex=Ce,e(h,le),n(c)===null&&le===n(h)&&(x?(S(Z),Z=-1):x=!0,Ue(O,Ce-Fe))):(le.sortIndex=ke,e(c,le),b||E||(b=!0,Pe(N))),le},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(le){var _e=v;return function(){var Ce=v;v=_e;try{return le.apply(this,arguments)}finally{v=Ce}}}})(gC);(function(t){t.exports=gC})(pC);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mC=K.exports,zr=pC.exports;function fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yC=new Set,TA={};function ua(t,e){Il(t,e),Il(t+"Capture",e)}function Il(t,e){for(TA[t]=e,t=0;t<e.length;t++)yC.add(e[t])}var ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),om=Object.prototype.hasOwnProperty,YR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_2={},v2={};function JR(t){return om.call(v2,t)?!0:om.call(_2,t)?!1:YR.test(t)?v2[t]=!0:(_2[t]=!0,!1)}function KR(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ZR(t,e,n,r){if(e===null||typeof e>"u"||KR(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fr(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vn[t]=new fr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vn[e]=new fr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vn[t]=new fr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vn[t]=new fr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vn[t]=new fr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vn[t]=new fr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vn[t]=new fr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vn[t]=new fr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vn[t]=new fr(t,5,!1,t.toLowerCase(),null,!1,!1)});var sy=/[\-:]([a-z])/g;function oy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sy,oy);Vn[e]=new fr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sy,oy);Vn[e]=new fr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sy,oy);Vn[e]=new fr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vn[t]=new fr(t,1,!1,t.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vn[t]=new fr(t,1,!1,t.toLowerCase(),null,!0,!0)});function ay(t,e,n,r){var i=Vn.hasOwnProperty(e)?Vn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ZR(e,n,i,r)&&(n=null),r||i===null?JR(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ws=mC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qu=Symbol.for("react.element"),Wa=Symbol.for("react.portal"),Qa=Symbol.for("react.fragment"),ly=Symbol.for("react.strict_mode"),am=Symbol.for("react.profiler"),_C=Symbol.for("react.provider"),vC=Symbol.for("react.context"),cy=Symbol.for("react.forward_ref"),lm=Symbol.for("react.suspense"),cm=Symbol.for("react.suspense_list"),Ay=Symbol.for("react.memo"),zs=Symbol.for("react.lazy"),EC=Symbol.for("react.offscreen"),E2=Symbol.iterator;function _c(t){return t===null||typeof t!="object"?null:(t=E2&&t[E2]||t["@@iterator"],typeof t=="function"?t:null)}var rn=Object.assign,fp;function Wc(t){if(fp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fp=e&&e[1]||""}return`
`+fp+t}var hp=!1;function dp(t,e){if(!t||hp)return"";hp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{hp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Wc(t):""}function qR(t){switch(t.tag){case 5:return Wc(t.type);case 16:return Wc("Lazy");case 13:return Wc("Suspense");case 19:return Wc("SuspenseList");case 0:case 2:case 15:return t=dp(t.type,!1),t;case 11:return t=dp(t.type.render,!1),t;case 1:return t=dp(t.type,!0),t;default:return""}}function Am(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qa:return"Fragment";case Wa:return"Portal";case am:return"Profiler";case ly:return"StrictMode";case lm:return"Suspense";case cm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vC:return(t.displayName||"Context")+".Consumer";case _C:return(t._context.displayName||"Context")+".Provider";case cy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ay:return e=t.displayName||null,e!==null?e:Am(t.type)||"Memo";case zs:e=t._payload,t=t._init;try{return Am(t(e))}catch{}}return null}function eO(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Am(e);case 8:return e===ly?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function lo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function wC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function tO(t){var e=wC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ef(t){t._valueTracker||(t._valueTracker=tO(t))}function TC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=wC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Gh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function um(t,e){var n=e.checked;return rn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:t._wrapperState.initialChecked})}function w2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=lo(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bC(t,e){e=e.checked,e!=null&&ay(t,"checked",e,!1)}function fm(t,e){bC(t,e);var n=lo(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?hm(t,e.type,n):e.hasOwnProperty("defaultValue")&&hm(t,e.type,lo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function T2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function hm(t,e,n){(e!=="number"||Gh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Qc=Array.isArray;function yl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+lo(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function dm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fe(91));return rn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function b2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(fe(92));if(Qc(n)){if(1<n.length)throw Error(fe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:lo(n)}}function xC(t,e){var n=lo(e.value),r=lo(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function x2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function CC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?CC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var tf,SC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(tf=tf||document.createElement("div"),tf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bA(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var nA={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nO=["Webkit","ms","Moz","O"];Object.keys(nA).forEach(function(t){nO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nA[e]=nA[t]})});function PC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||nA.hasOwnProperty(t)&&nA[t]?(""+e).trim():e+"px"}function MC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=PC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var rO=rn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gm(t,e){if(e){if(rO[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fe(62))}}function mm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ym=null;function uy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var _m=null,_l=null,vl=null;function C2(t){if(t=uu(t)){if(typeof _m!="function")throw Error(fe(280));var e=t.stateNode;e&&(e=jd(e),_m(t.stateNode,t.type,e))}}function IC(t){_l?vl?vl.push(t):vl=[t]:_l=t}function BC(){if(_l){var t=_l,e=vl;if(vl=_l=null,C2(t),e)for(t=0;t<e.length;t++)C2(e[t])}}function LC(t,e){return t(e)}function RC(){}var pp=!1;function OC(t,e,n){if(pp)return t(e,n);pp=!0;try{return LC(t,e,n)}finally{pp=!1,(_l!==null||vl!==null)&&(RC(),BC())}}function xA(t,e){var n=t.stateNode;if(n===null)return null;var r=jd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(fe(231,e,typeof n));return n}var vm=!1;if(ds)try{var vc={};Object.defineProperty(vc,"passive",{get:function(){vm=!0}}),window.addEventListener("test",vc,vc),window.removeEventListener("test",vc,vc)}catch{vm=!1}function iO(t,e,n,r,i,s,o,a,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var rA=!1,zh=null,Vh=!1,Em=null,sO={onError:function(t){rA=!0,zh=t}};function oO(t,e,n,r,i,s,o,a,c){rA=!1,zh=null,iO.apply(sO,arguments)}function aO(t,e,n,r,i,s,o,a,c){if(oO.apply(this,arguments),rA){if(rA){var h=zh;rA=!1,zh=null}else throw Error(fe(198));Vh||(Vh=!0,Em=h)}}function fa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&4098)!==0&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function FC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function S2(t){if(fa(t)!==t)throw Error(fe(188))}function lO(t){var e=t.alternate;if(!e){if(e=fa(t),e===null)throw Error(fe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return S2(i),t;if(s===r)return S2(i),e;s=s.sibling}throw Error(fe(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(fe(189))}}if(n.alternate!==r)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?t:e}function DC(t){return t=lO(t),t!==null?kC(t):null}function kC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=kC(t);if(e!==null)return e;t=t.sibling}return null}var NC=zr.unstable_scheduleCallback,P2=zr.unstable_cancelCallback,cO=zr.unstable_shouldYield,AO=zr.unstable_requestPaint,cn=zr.unstable_now,uO=zr.unstable_getCurrentPriorityLevel,fy=zr.unstable_ImmediatePriority,UC=zr.unstable_UserBlockingPriority,Hh=zr.unstable_NormalPriority,fO=zr.unstable_LowPriority,GC=zr.unstable_IdlePriority,Gd=null,Ki=null;function hO(t){if(Ki&&typeof Ki.onCommitFiberRoot=="function")try{Ki.onCommitFiberRoot(Gd,t,void 0,(t.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:gO,dO=Math.log,pO=Math.LN2;function gO(t){return t>>>=0,t===0?32:31-(dO(t)/pO|0)|0}var nf=64,rf=4194304;function $c(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=$c(a):(s&=o,s!==0&&(r=$c(s)))}else o=n&~i,o!==0?r=$c(o):s!==0&&(r=$c(s));if(r===0)return 0;if(e!==0&&e!==r&&(e&i)===0&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if((r&4)!==0&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Pi(e),i=1<<n,r|=t[n],e&=~i;return r}function mO(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yO(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Pi(s),a=1<<o,c=i[o];c===-1?((a&n)===0||(a&r)!==0)&&(i[o]=mO(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function wm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function zC(){var t=nf;return nf<<=1,(nf&4194240)===0&&(nf=64),t}function gp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function cu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pi(e),t[e]=n}function _O(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Pi(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function hy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Pi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Pt=0;function VC(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var HC,dy,jC,WC,QC,Tm=!1,sf=[],qs=null,eo=null,to=null,CA=new Map,SA=new Map,Ws=[],vO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function M2(t,e){switch(t){case"focusin":case"focusout":qs=null;break;case"dragenter":case"dragleave":eo=null;break;case"mouseover":case"mouseout":to=null;break;case"pointerover":case"pointerout":CA.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":SA.delete(e.pointerId)}}function Ec(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=uu(e),e!==null&&dy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function EO(t,e,n,r,i){switch(e){case"focusin":return qs=Ec(qs,t,e,n,r,i),!0;case"dragenter":return eo=Ec(eo,t,e,n,r,i),!0;case"mouseover":return to=Ec(to,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return CA.set(s,Ec(CA.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,SA.set(s,Ec(SA.get(s)||null,t,e,n,r,i)),!0}return!1}function $C(t){var e=No(t.target);if(e!==null){var n=fa(e);if(n!==null){if(e=n.tag,e===13){if(e=FC(n),e!==null){t.blockedOn=e,QC(t.priority,function(){jC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=bm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ym=r,n.target.dispatchEvent(r),ym=null}else return e=uu(n),e!==null&&dy(e),t.blockedOn=n,!1;e.shift()}return!0}function I2(t,e,n){lh(t)&&n.delete(e)}function wO(){Tm=!1,qs!==null&&lh(qs)&&(qs=null),eo!==null&&lh(eo)&&(eo=null),to!==null&&lh(to)&&(to=null),CA.forEach(I2),SA.forEach(I2)}function wc(t,e){t.blockedOn===e&&(t.blockedOn=null,Tm||(Tm=!0,zr.unstable_scheduleCallback(zr.unstable_NormalPriority,wO)))}function PA(t){function e(i){return wc(i,t)}if(0<sf.length){wc(sf[0],t);for(var n=1;n<sf.length;n++){var r=sf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(qs!==null&&wc(qs,t),eo!==null&&wc(eo,t),to!==null&&wc(to,t),CA.forEach(e),SA.forEach(e),n=0;n<Ws.length;n++)r=Ws[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ws.length&&(n=Ws[0],n.blockedOn===null);)$C(n),n.blockedOn===null&&Ws.shift()}var El=ws.ReactCurrentBatchConfig,Wh=!0;function TO(t,e,n,r){var i=Pt,s=El.transition;El.transition=null;try{Pt=1,py(t,e,n,r)}finally{Pt=i,El.transition=s}}function bO(t,e,n,r){var i=Pt,s=El.transition;El.transition=null;try{Pt=4,py(t,e,n,r)}finally{Pt=i,El.transition=s}}function py(t,e,n,r){if(Wh){var i=bm(t,e,n,r);if(i===null)Cp(t,e,r,Qh,n),M2(t,r);else if(EO(i,t,e,n,r))r.stopPropagation();else if(M2(t,r),e&4&&-1<vO.indexOf(t)){for(;i!==null;){var s=uu(i);if(s!==null&&HC(s),s=bm(t,e,n,r),s===null&&Cp(t,e,r,Qh,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Cp(t,e,r,null,n)}}var Qh=null;function bm(t,e,n,r){if(Qh=null,t=uy(r),t=No(t),t!==null)if(e=fa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=FC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Qh=t,null}function XC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uO()){case fy:return 1;case UC:return 4;case Hh:case fO:return 16;case GC:return 536870912;default:return 16}default:return 16}}var Xs=null,gy=null,ch=null;function YC(){if(ch)return ch;var t,e=gy,n=e.length,r,i="value"in Xs?Xs.value:Xs.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ch=i.slice(t,1<r?1-r:void 0)}function Ah(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function of(){return!0}function B2(){return!1}function jr(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?of:B2,this.isPropagationStopped=B2,this}return rn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=of)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=of)},persist:function(){},isPersistent:of}),e}var Yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},my=jr(Yl),Au=rn({},Yl,{view:0,detail:0}),xO=jr(Au),mp,yp,Tc,zd=rn({},Au,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Tc&&(Tc&&t.type==="mousemove"?(mp=t.screenX-Tc.screenX,yp=t.screenY-Tc.screenY):yp=mp=0,Tc=t),mp)},movementY:function(t){return"movementY"in t?t.movementY:yp}}),L2=jr(zd),CO=rn({},zd,{dataTransfer:0}),SO=jr(CO),PO=rn({},Au,{relatedTarget:0}),_p=jr(PO),MO=rn({},Yl,{animationName:0,elapsedTime:0,pseudoElement:0}),IO=jr(MO),BO=rn({},Yl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),LO=jr(BO),RO=rn({},Yl,{data:0}),R2=jr(RO),OO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kO(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=DO[t])?!!e[t]:!1}function yy(){return kO}var NO=rn({},Au,{key:function(t){if(t.key){var e=OO[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ah(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?FO[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yy,charCode:function(t){return t.type==="keypress"?Ah(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ah(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),UO=jr(NO),GO=rn({},zd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),O2=jr(GO),zO=rn({},Au,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yy}),VO=jr(zO),HO=rn({},Yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),jO=jr(HO),WO=rn({},zd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),QO=jr(WO),$O=[9,13,27,32],_y=ds&&"CompositionEvent"in window,iA=null;ds&&"documentMode"in document&&(iA=document.documentMode);var XO=ds&&"TextEvent"in window&&!iA,JC=ds&&(!_y||iA&&8<iA&&11>=iA),F2=String.fromCharCode(32),D2=!1;function KC(t,e){switch(t){case"keyup":return $O.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $a=!1;function YO(t,e){switch(t){case"compositionend":return ZC(e);case"keypress":return e.which!==32?null:(D2=!0,F2);case"textInput":return t=e.data,t===F2&&D2?null:t;default:return null}}function JO(t,e){if($a)return t==="compositionend"||!_y&&KC(t,e)?(t=YC(),ch=gy=Xs=null,$a=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return JC&&e.locale!=="ko"?null:e.data;default:return null}}var KO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!KO[t.type]:e==="textarea"}function qC(t,e,n,r){IC(r),e=$h(e,"onChange"),0<e.length&&(n=new my("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var sA=null,MA=null;function ZO(t){AS(t,0)}function Vd(t){var e=Ja(t);if(TC(e))return t}function qO(t,e){if(t==="change")return e}var eS=!1;if(ds){var vp;if(ds){var Ep="oninput"in document;if(!Ep){var N2=document.createElement("div");N2.setAttribute("oninput","return;"),Ep=typeof N2.oninput=="function"}vp=Ep}else vp=!1;eS=vp&&(!document.documentMode||9<document.documentMode)}function U2(){sA&&(sA.detachEvent("onpropertychange",tS),MA=sA=null)}function tS(t){if(t.propertyName==="value"&&Vd(MA)){var e=[];qC(e,MA,t,uy(t)),OC(ZO,e)}}function eF(t,e,n){t==="focusin"?(U2(),sA=e,MA=n,sA.attachEvent("onpropertychange",tS)):t==="focusout"&&U2()}function tF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Vd(MA)}function nF(t,e){if(t==="click")return Vd(e)}function rF(t,e){if(t==="input"||t==="change")return Vd(e)}function iF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Li=typeof Object.is=="function"?Object.is:iF;function IA(t,e){if(Li(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!om.call(e,i)||!Li(t[i],e[i]))return!1}return!0}function G2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function z2(t,e){var n=G2(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=G2(n)}}function nS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?nS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function rS(){for(var t=window,e=Gh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Gh(t.document)}return e}function vy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function sF(t){var e=rS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&nS(n.ownerDocument.documentElement,n)){if(r!==null&&vy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=z2(n,s);var o=z2(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oF=ds&&"documentMode"in document&&11>=document.documentMode,Xa=null,xm=null,oA=null,Cm=!1;function V2(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Cm||Xa==null||Xa!==Gh(r)||(r=Xa,"selectionStart"in r&&vy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),oA&&IA(oA,r)||(oA=r,r=$h(xm,"onSelect"),0<r.length&&(e=new my("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xa)))}function af(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ya={animationend:af("Animation","AnimationEnd"),animationiteration:af("Animation","AnimationIteration"),animationstart:af("Animation","AnimationStart"),transitionend:af("Transition","TransitionEnd")},wp={},iS={};ds&&(iS=document.createElement("div").style,"AnimationEvent"in window||(delete Ya.animationend.animation,delete Ya.animationiteration.animation,delete Ya.animationstart.animation),"TransitionEvent"in window||delete Ya.transitionend.transition);function Hd(t){if(wp[t])return wp[t];if(!Ya[t])return t;var e=Ya[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in iS)return wp[t]=e[n];return t}var sS=Hd("animationend"),oS=Hd("animationiteration"),aS=Hd("animationstart"),lS=Hd("transitionend"),cS=new Map,H2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function po(t,e){cS.set(t,e),ua(e,[t])}for(var Tp=0;Tp<H2.length;Tp++){var bp=H2[Tp],aF=bp.toLowerCase(),lF=bp[0].toUpperCase()+bp.slice(1);po(aF,"on"+lF)}po(sS,"onAnimationEnd");po(oS,"onAnimationIteration");po(aS,"onAnimationStart");po("dblclick","onDoubleClick");po("focusin","onFocus");po("focusout","onBlur");po(lS,"onTransitionEnd");Il("onMouseEnter",["mouseout","mouseover"]);Il("onMouseLeave",["mouseout","mouseover"]);Il("onPointerEnter",["pointerout","pointerover"]);Il("onPointerLeave",["pointerout","pointerover"]);ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xc));function j2(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,aO(r,e,void 0,t),t.currentTarget=null}function AS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,h=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;j2(i,a,h),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,h=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;j2(i,a,h),s=c}}}if(Vh)throw t=Em,Vh=!1,Em=null,t}function Qt(t,e){var n=e[Bm];n===void 0&&(n=e[Bm]=new Set);var r=t+"__bubble";n.has(r)||(uS(e,t,2,!1),n.add(r))}function xp(t,e,n){var r=0;e&&(r|=4),uS(n,t,r,e)}var lf="_reactListening"+Math.random().toString(36).slice(2);function BA(t){if(!t[lf]){t[lf]=!0,yC.forEach(function(n){n!=="selectionchange"&&(cF.has(n)||xp(n,!1,t),xp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[lf]||(e[lf]=!0,xp("selectionchange",!1,e))}}function uS(t,e,n,r){switch(XC(e)){case 1:var i=TO;break;case 4:i=bO;break;default:i=py}n=i.bind(null,e,n,t),i=void 0,!vm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Cp(t,e,n,r,i){var s=r;if((e&1)===0&&(e&2)===0&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=No(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}OC(function(){var h=s,p=uy(n),m=[];e:{var v=cS.get(t);if(v!==void 0){var E=my,b=t;switch(t){case"keypress":if(Ah(n)===0)break e;case"keydown":case"keyup":E=UO;break;case"focusin":b="focus",E=_p;break;case"focusout":b="blur",E=_p;break;case"beforeblur":case"afterblur":E=_p;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=L2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=SO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=VO;break;case sS:case oS:case aS:E=IO;break;case lS:E=jO;break;case"scroll":E=xO;break;case"wheel":E=QO;break;case"copy":case"cut":case"paste":E=LO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=O2}var x=(e&4)!==0,I=!x&&t==="scroll",S=x?v!==null?v+"Capture":null:v;x=[];for(var P=h,M;P!==null;){M=P;var O=M.stateNode;if(M.tag===5&&O!==null&&(M=O,S!==null&&(O=xA(P,S),O!=null&&x.push(LA(P,O,M)))),I)break;P=P.return}0<x.length&&(v=new E(v,b,null,n,p),m.push({event:v,listeners:x}))}}if((e&7)===0){e:{if(v=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",v&&n!==ym&&(b=n.relatedTarget||n.fromElement)&&(No(b)||b[ps]))break e;if((E||v)&&(v=p.window===p?p:(v=p.ownerDocument)?v.defaultView||v.parentWindow:window,E?(b=n.relatedTarget||n.toElement,E=h,b=b?No(b):null,b!==null&&(I=fa(b),b!==I||b.tag!==5&&b.tag!==6)&&(b=null)):(E=null,b=h),E!==b)){if(x=L2,O="onMouseLeave",S="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(x=O2,O="onPointerLeave",S="onPointerEnter",P="pointer"),I=E==null?v:Ja(E),M=b==null?v:Ja(b),v=new x(O,P+"leave",E,n,p),v.target=I,v.relatedTarget=M,O=null,No(p)===h&&(x=new x(S,P+"enter",b,n,p),x.target=M,x.relatedTarget=I,O=x),I=O,E&&b)t:{for(x=E,S=b,P=0,M=x;M;M=Ca(M))P++;for(M=0,O=S;O;O=Ca(O))M++;for(;0<P-M;)x=Ca(x),P--;for(;0<M-P;)S=Ca(S),M--;for(;P--;){if(x===S||S!==null&&x===S.alternate)break t;x=Ca(x),S=Ca(S)}x=null}else x=null;E!==null&&W2(m,v,E,x,!1),b!==null&&I!==null&&W2(m,I,b,x,!0)}}e:{if(v=h?Ja(h):window,E=v.nodeName&&v.nodeName.toLowerCase(),E==="select"||E==="input"&&v.type==="file")var N=qO;else if(k2(v))if(eS)N=rF;else{N=tF;var z=eF}else(E=v.nodeName)&&E.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(N=nF);if(N&&(N=N(t,h))){qC(m,N,n,p);break e}z&&z(t,v,h),t==="focusout"&&(z=v._wrapperState)&&z.controlled&&v.type==="number"&&hm(v,"number",v.value)}switch(z=h?Ja(h):window,t){case"focusin":(k2(z)||z.contentEditable==="true")&&(Xa=z,xm=h,oA=null);break;case"focusout":oA=xm=Xa=null;break;case"mousedown":Cm=!0;break;case"contextmenu":case"mouseup":case"dragend":Cm=!1,V2(m,n,p);break;case"selectionchange":if(oF)break;case"keydown":case"keyup":V2(m,n,p)}var X;if(_y)e:{switch(t){case"compositionstart":var Z="onCompositionStart";break e;case"compositionend":Z="onCompositionEnd";break e;case"compositionupdate":Z="onCompositionUpdate";break e}Z=void 0}else $a?KC(t,n)&&(Z="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(Z="onCompositionStart");Z&&(JC&&n.locale!=="ko"&&($a||Z!=="onCompositionStart"?Z==="onCompositionEnd"&&$a&&(X=YC()):(Xs=p,gy="value"in Xs?Xs.value:Xs.textContent,$a=!0)),z=$h(h,Z),0<z.length&&(Z=new R2(Z,t,null,n,p),m.push({event:Z,listeners:z}),X?Z.data=X:(X=ZC(n),X!==null&&(Z.data=X)))),(X=XO?YO(t,n):JO(t,n))&&(h=$h(h,"onBeforeInput"),0<h.length&&(p=new R2("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:h}),p.data=X))}AS(m,e)})}function LA(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $h(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=xA(t,n),s!=null&&r.unshift(LA(t,s,i)),s=xA(t,e),s!=null&&r.push(LA(t,s,i))),t=t.return}return r}function Ca(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function W2(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,h=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&h!==null&&(a=h,i?(c=xA(n,s),c!=null&&o.unshift(LA(n,c,a))):i||(c=xA(n,s),c!=null&&o.push(LA(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var AF=/\r\n?/g,uF=/\u0000|\uFFFD/g;function Q2(t){return(typeof t=="string"?t:""+t).replace(AF,`
`).replace(uF,"")}function cf(t,e,n){if(e=Q2(e),Q2(t)!==e&&n)throw Error(fe(425))}function Xh(){}var Sm=null,Pm=null;function Mm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Im=typeof setTimeout=="function"?setTimeout:void 0,fF=typeof clearTimeout=="function"?clearTimeout:void 0,$2=typeof Promise=="function"?Promise:void 0,hF=typeof queueMicrotask=="function"?queueMicrotask:typeof $2<"u"?function(t){return $2.resolve(null).then(t).catch(dF)}:Im;function dF(t){setTimeout(function(){throw t})}function Sp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),PA(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);PA(e)}function no(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function X2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Jl=Math.random().toString(36).slice(2),$i="__reactFiber$"+Jl,RA="__reactProps$"+Jl,ps="__reactContainer$"+Jl,Bm="__reactEvents$"+Jl,pF="__reactListeners$"+Jl,gF="__reactHandles$"+Jl;function No(t){var e=t[$i];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ps]||n[$i]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=X2(t);t!==null;){if(n=t[$i])return n;t=X2(t)}return e}t=n,n=t.parentNode}return null}function uu(t){return t=t[$i]||t[ps],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ja(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(fe(33))}function jd(t){return t[RA]||null}var Lm=[],Ka=-1;function go(t){return{current:t}}function $t(t){0>Ka||(t.current=Lm[Ka],Lm[Ka]=null,Ka--)}function Nt(t,e){Ka++,Lm[Ka]=t.current,t.current=e}var co={},er=go(co),Er=go(!1),Zo=co;function Bl(t,e){var n=t.type.contextTypes;if(!n)return co;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function wr(t){return t=t.childContextTypes,t!=null}function Yh(){$t(Er),$t(er)}function Y2(t,e,n){if(er.current!==co)throw Error(fe(168));Nt(er,e),Nt(Er,n)}function fS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(fe(108,eO(t)||"Unknown",i));return rn({},n,r)}function Jh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||co,Zo=er.current,Nt(er,t),Nt(Er,Er.current),!0}function J2(t,e,n){var r=t.stateNode;if(!r)throw Error(fe(169));n?(t=fS(t,e,Zo),r.__reactInternalMemoizedMergedChildContext=t,$t(Er),$t(er),Nt(er,t)):$t(Er),Nt(Er,n)}var as=null,Wd=!1,Pp=!1;function hS(t){as===null?as=[t]:as.push(t)}function mF(t){Wd=!0,hS(t)}function mo(){if(!Pp&&as!==null){Pp=!0;var t=0,e=Pt;try{var n=as;for(Pt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}as=null,Wd=!1}catch(i){throw as!==null&&(as=as.slice(t+1)),NC(fy,mo),i}finally{Pt=e,Pp=!1}}return null}var Za=[],qa=0,Kh=null,Zh=0,ei=[],ti=0,qo=null,cs=1,As="";function Fo(t,e){Za[qa++]=Zh,Za[qa++]=Kh,Kh=t,Zh=e}function dS(t,e,n){ei[ti++]=cs,ei[ti++]=As,ei[ti++]=qo,qo=t;var r=cs;t=As;var i=32-Pi(r)-1;r&=~(1<<i),n+=1;var s=32-Pi(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,cs=1<<32-Pi(e)+i|n<<i|r,As=s+t}else cs=1<<s|n<<i|r,As=t}function Ey(t){t.return!==null&&(Fo(t,1),dS(t,1,0))}function wy(t){for(;t===Kh;)Kh=Za[--qa],Za[qa]=null,Zh=Za[--qa],Za[qa]=null;for(;t===qo;)qo=ei[--ti],ei[ti]=null,As=ei[--ti],ei[ti]=null,cs=ei[--ti],ei[ti]=null}var kr=null,Or=null,Jt=!1,Ti=null;function pS(t,e){var n=ri(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function K2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,kr=t,Or=no(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,kr=t,Or=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qo!==null?{id:cs,overflow:As}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ri(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,kr=t,Or=null,!0):!1;default:return!1}}function Rm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Om(t){if(Jt){var e=Or;if(e){var n=e;if(!K2(t,e)){if(Rm(t))throw Error(fe(418));e=no(n.nextSibling);var r=kr;e&&K2(t,e)?pS(r,n):(t.flags=t.flags&-4097|2,Jt=!1,kr=t)}}else{if(Rm(t))throw Error(fe(418));t.flags=t.flags&-4097|2,Jt=!1,kr=t}}}function Z2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kr=t}function Af(t){if(t!==kr)return!1;if(!Jt)return Z2(t),Jt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Mm(t.type,t.memoizedProps)),e&&(e=Or)){if(Rm(t))throw gS(),Error(fe(418));for(;e;)pS(t,e),e=no(e.nextSibling)}if(Z2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Or=no(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Or=null}}else Or=kr?no(t.stateNode.nextSibling):null;return!0}function gS(){for(var t=Or;t;)t=no(t.nextSibling)}function Ll(){Or=kr=null,Jt=!1}function Ty(t){Ti===null?Ti=[t]:Ti.push(t)}var yF=ws.ReactCurrentBatchConfig;function vi(t,e){if(t&&t.defaultProps){e=rn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var qh=go(null),ed=null,el=null,by=null;function xy(){by=el=ed=null}function Cy(t){var e=qh.current;$t(qh),t._currentValue=e}function Fm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function wl(t,e){ed=t,by=el=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&e)!==0&&(vr=!0),t.firstContext=null)}function ai(t){var e=t._currentValue;if(by!==t)if(t={context:t,memoizedValue:e,next:null},el===null){if(ed===null)throw Error(fe(308));el=t,ed.dependencies={lanes:0,firstContext:t}}else el=el.next=t;return e}var Uo=null;function Sy(t){Uo===null?Uo=[t]:Uo.push(t)}function mS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Sy(e)):(n.next=i.next,i.next=n),e.interleaved=n,gs(t,r)}function gs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vs=!1;function Py(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function us(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ro(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,(mt&2)!==0){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,gs(t,n)}return i=r.interleaved,i===null?(e.next=e,Sy(r)):(e.next=i.next,i.next=e),r.interleaved=e,gs(t,n)}function uh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hy(t,n)}}function q2(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function td(t,e,n,r){var i=t.updateQueue;Vs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var p=t.alternate;p!==null&&(p=p.updateQueue,a=p.lastBaseUpdate,a!==o&&(a===null?p.firstBaseUpdate=h:a.next=h,p.lastBaseUpdate=c))}if(s!==null){var m=i.baseState;o=0,p=h=c=null,a=s;do{var v=a.lane,E=a.eventTime;if((r&v)===v){p!==null&&(p=p.next={eventTime:E,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,x=a;switch(v=e,E=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){m=b.call(E,m,v);break e}m=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,v=typeof b=="function"?b.call(E,m,v):b,v==null)break e;m=rn({},m,v);break e;case 2:Vs=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,v=i.effects,v===null?i.effects=[a]:v.push(a))}else E={eventTime:E,lane:v,tag:a.tag,payload:a.payload,callback:a.callback,next:null},p===null?(h=p=E,c=m):p=p.next=E,o|=v;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;v=a,a=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(1);if(p===null&&(c=m),i.baseState=c,i.firstBaseUpdate=h,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ta|=o,t.lanes=o,t.memoizedState=m}}function eE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(fe(191,i));i.call(r)}}}var _S=new mC.Component().refs;function Dm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:rn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Qd={isMounted:function(t){return(t=t._reactInternals)?fa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=cr(),i=so(t),s=us(r,i);s.payload=e,n!=null&&(s.callback=n),e=ro(t,s,i),e!==null&&(Mi(e,t,i,r),uh(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=cr(),i=so(t),s=us(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ro(t,s,i),e!==null&&(Mi(e,t,i,r),uh(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=cr(),r=so(t),i=us(n,r);i.tag=2,e!=null&&(i.callback=e),e=ro(t,i,r),e!==null&&(Mi(e,t,r,n),uh(e,t,r))}};function tE(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!IA(n,r)||!IA(i,s):!0}function vS(t,e,n){var r=!1,i=co,s=e.contextType;return typeof s=="object"&&s!==null?s=ai(s):(i=wr(e)?Zo:er.current,r=e.contextTypes,s=(r=r!=null)?Bl(t,i):co),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function nE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Qd.enqueueReplaceState(e,e.state,null)}function km(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=_S,Py(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ai(s):(s=wr(e)?Zo:er.current,i.context=Bl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Dm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Qd.enqueueReplaceState(i,i.state,null),td(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function bc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var r=n.stateNode}if(!r)throw Error(fe(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===_S&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,t))}return t}function uf(t,e){throw t=Object.prototype.toString.call(e),Error(fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function rE(t){var e=t._init;return e(t._payload)}function ES(t){function e(S,P){if(t){var M=S.deletions;M===null?(S.deletions=[P],S.flags|=16):M.push(P)}}function n(S,P){if(!t)return null;for(;P!==null;)e(S,P),P=P.sibling;return null}function r(S,P){for(S=new Map;P!==null;)P.key!==null?S.set(P.key,P):S.set(P.index,P),P=P.sibling;return S}function i(S,P){return S=oo(S,P),S.index=0,S.sibling=null,S}function s(S,P,M){return S.index=M,t?(M=S.alternate,M!==null?(M=M.index,M<P?(S.flags|=2,P):M):(S.flags|=2,P)):(S.flags|=1048576,P)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function a(S,P,M,O){return P===null||P.tag!==6?(P=Fp(M,S.mode,O),P.return=S,P):(P=i(P,M),P.return=S,P)}function c(S,P,M,O){var N=M.type;return N===Qa?p(S,P,M.props.children,O,M.key):P!==null&&(P.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===zs&&rE(N)===P.type)?(O=i(P,M.props),O.ref=bc(S,P,M),O.return=S,O):(O=mh(M.type,M.key,M.props,null,S.mode,O),O.ref=bc(S,P,M),O.return=S,O)}function h(S,P,M,O){return P===null||P.tag!==4||P.stateNode.containerInfo!==M.containerInfo||P.stateNode.implementation!==M.implementation?(P=Dp(M,S.mode,O),P.return=S,P):(P=i(P,M.children||[]),P.return=S,P)}function p(S,P,M,O,N){return P===null||P.tag!==7?(P=Qo(M,S.mode,O,N),P.return=S,P):(P=i(P,M),P.return=S,P)}function m(S,P,M){if(typeof P=="string"&&P!==""||typeof P=="number")return P=Fp(""+P,S.mode,M),P.return=S,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case qu:return M=mh(P.type,P.key,P.props,null,S.mode,M),M.ref=bc(S,null,P),M.return=S,M;case Wa:return P=Dp(P,S.mode,M),P.return=S,P;case zs:var O=P._init;return m(S,O(P._payload),M)}if(Qc(P)||_c(P))return P=Qo(P,S.mode,M,null),P.return=S,P;uf(S,P)}return null}function v(S,P,M,O){var N=P!==null?P.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return N!==null?null:a(S,P,""+M,O);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case qu:return M.key===N?c(S,P,M,O):null;case Wa:return M.key===N?h(S,P,M,O):null;case zs:return N=M._init,v(S,P,N(M._payload),O)}if(Qc(M)||_c(M))return N!==null?null:p(S,P,M,O,null);uf(S,M)}return null}function E(S,P,M,O,N){if(typeof O=="string"&&O!==""||typeof O=="number")return S=S.get(M)||null,a(P,S,""+O,N);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case qu:return S=S.get(O.key===null?M:O.key)||null,c(P,S,O,N);case Wa:return S=S.get(O.key===null?M:O.key)||null,h(P,S,O,N);case zs:var z=O._init;return E(S,P,M,z(O._payload),N)}if(Qc(O)||_c(O))return S=S.get(M)||null,p(P,S,O,N,null);uf(P,O)}return null}function b(S,P,M,O){for(var N=null,z=null,X=P,Z=P=0,Q=null;X!==null&&Z<M.length;Z++){X.index>Z?(Q=X,X=null):Q=X.sibling;var k=v(S,X,M[Z],O);if(k===null){X===null&&(X=Q);break}t&&X&&k.alternate===null&&e(S,X),P=s(k,P,Z),z===null?N=k:z.sibling=k,z=k,X=Q}if(Z===M.length)return n(S,X),Jt&&Fo(S,Z),N;if(X===null){for(;Z<M.length;Z++)X=m(S,M[Z],O),X!==null&&(P=s(X,P,Z),z===null?N=X:z.sibling=X,z=X);return Jt&&Fo(S,Z),N}for(X=r(S,X);Z<M.length;Z++)Q=E(X,S,Z,M[Z],O),Q!==null&&(t&&Q.alternate!==null&&X.delete(Q.key===null?Z:Q.key),P=s(Q,P,Z),z===null?N=Q:z.sibling=Q,z=Q);return t&&X.forEach(function(D){return e(S,D)}),Jt&&Fo(S,Z),N}function x(S,P,M,O){var N=_c(M);if(typeof N!="function")throw Error(fe(150));if(M=N.call(M),M==null)throw Error(fe(151));for(var z=N=null,X=P,Z=P=0,Q=null,k=M.next();X!==null&&!k.done;Z++,k=M.next()){X.index>Z?(Q=X,X=null):Q=X.sibling;var D=v(S,X,k.value,O);if(D===null){X===null&&(X=Q);break}t&&X&&D.alternate===null&&e(S,X),P=s(D,P,Z),z===null?N=D:z.sibling=D,z=D,X=Q}if(k.done)return n(S,X),Jt&&Fo(S,Z),N;if(X===null){for(;!k.done;Z++,k=M.next())k=m(S,k.value,O),k!==null&&(P=s(k,P,Z),z===null?N=k:z.sibling=k,z=k);return Jt&&Fo(S,Z),N}for(X=r(S,X);!k.done;Z++,k=M.next())k=E(X,S,Z,k.value,O),k!==null&&(t&&k.alternate!==null&&X.delete(k.key===null?Z:k.key),P=s(k,P,Z),z===null?N=k:z.sibling=k,z=k);return t&&X.forEach(function(ne){return e(S,ne)}),Jt&&Fo(S,Z),N}function I(S,P,M,O){if(typeof M=="object"&&M!==null&&M.type===Qa&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case qu:e:{for(var N=M.key,z=P;z!==null;){if(z.key===N){if(N=M.type,N===Qa){if(z.tag===7){n(S,z.sibling),P=i(z,M.props.children),P.return=S,S=P;break e}}else if(z.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===zs&&rE(N)===z.type){n(S,z.sibling),P=i(z,M.props),P.ref=bc(S,z,M),P.return=S,S=P;break e}n(S,z);break}else e(S,z);z=z.sibling}M.type===Qa?(P=Qo(M.props.children,S.mode,O,M.key),P.return=S,S=P):(O=mh(M.type,M.key,M.props,null,S.mode,O),O.ref=bc(S,P,M),O.return=S,S=O)}return o(S);case Wa:e:{for(z=M.key;P!==null;){if(P.key===z)if(P.tag===4&&P.stateNode.containerInfo===M.containerInfo&&P.stateNode.implementation===M.implementation){n(S,P.sibling),P=i(P,M.children||[]),P.return=S,S=P;break e}else{n(S,P);break}else e(S,P);P=P.sibling}P=Dp(M,S.mode,O),P.return=S,S=P}return o(S);case zs:return z=M._init,I(S,P,z(M._payload),O)}if(Qc(M))return b(S,P,M,O);if(_c(M))return x(S,P,M,O);uf(S,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,P!==null&&P.tag===6?(n(S,P.sibling),P=i(P,M),P.return=S,S=P):(n(S,P),P=Fp(M,S.mode,O),P.return=S,S=P),o(S)):n(S,P)}return I}var Rl=ES(!0),wS=ES(!1),fu={},Zi=go(fu),OA=go(fu),FA=go(fu);function Go(t){if(t===fu)throw Error(fe(174));return t}function My(t,e){switch(Nt(FA,e),Nt(OA,t),Nt(Zi,fu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pm(e,t)}$t(Zi),Nt(Zi,e)}function Ol(){$t(Zi),$t(OA),$t(FA)}function TS(t){Go(FA.current);var e=Go(Zi.current),n=pm(e,t.type);e!==n&&(Nt(OA,t),Nt(Zi,n))}function Iy(t){OA.current===t&&($t(Zi),$t(OA))}var Zt=go(0);function nd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Mp=[];function By(){for(var t=0;t<Mp.length;t++)Mp[t]._workInProgressVersionPrimary=null;Mp.length=0}var fh=ws.ReactCurrentDispatcher,Ip=ws.ReactCurrentBatchConfig,ea=0,nn=null,wn=null,Ln=null,rd=!1,aA=!1,DA=0,_F=0;function Qn(){throw Error(fe(321))}function Ly(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Li(t[n],e[n]))return!1;return!0}function Ry(t,e,n,r,i,s){if(ea=s,nn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,fh.current=t===null||t.memoizedState===null?TF:bF,t=n(r,i),aA){s=0;do{if(aA=!1,DA=0,25<=s)throw Error(fe(301));s+=1,Ln=wn=null,e.updateQueue=null,fh.current=xF,t=n(r,i)}while(aA)}if(fh.current=id,e=wn!==null&&wn.next!==null,ea=0,Ln=wn=nn=null,rd=!1,e)throw Error(fe(300));return t}function Oy(){var t=DA!==0;return DA=0,t}function Hi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?nn.memoizedState=Ln=t:Ln=Ln.next=t,Ln}function li(){if(wn===null){var t=nn.alternate;t=t!==null?t.memoizedState:null}else t=wn.next;var e=Ln===null?nn.memoizedState:Ln.next;if(e!==null)Ln=e,wn=t;else{if(t===null)throw Error(fe(310));wn=t,t={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},Ln===null?nn.memoizedState=Ln=t:Ln=Ln.next=t}return Ln}function kA(t,e){return typeof e=="function"?e(t):e}function Bp(t){var e=li(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=wn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,h=s;do{var p=h.lane;if((ea&p)===p)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(a=c=m,o=r):c=c.next=m,nn.lanes|=p,ta|=p}h=h.next}while(h!==null&&h!==s);c===null?o=r:c.next=a,Li(r,e.memoizedState)||(vr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,nn.lanes|=s,ta|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Lp(t){var e=li(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Li(s,e.memoizedState)||(vr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function bS(){}function xS(t,e){var n=nn,r=li(),i=e(),s=!Li(r.memoizedState,i);if(s&&(r.memoizedState=i,vr=!0),r=r.queue,Fy(PS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ln!==null&&Ln.memoizedState.tag&1){if(n.flags|=2048,NA(9,SS.bind(null,n,r,i,e),void 0,null),Fn===null)throw Error(fe(349));(ea&30)!==0||CS(n,e,i)}return i}function CS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=nn.updateQueue,e===null?(e={lastEffect:null,stores:null},nn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function SS(t,e,n,r){e.value=n,e.getSnapshot=r,MS(e)&&IS(t)}function PS(t,e,n){return n(function(){MS(e)&&IS(t)})}function MS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Li(t,n)}catch{return!0}}function IS(t){var e=gs(t,1);e!==null&&Mi(e,t,1,-1)}function iE(t){var e=Hi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kA,lastRenderedState:t},e.queue=t,t=t.dispatch=wF.bind(null,nn,t),[e.memoizedState,t]}function NA(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=nn.updateQueue,e===null?(e={lastEffect:null,stores:null},nn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function BS(){return li().memoizedState}function hh(t,e,n,r){var i=Hi();nn.flags|=t,i.memoizedState=NA(1|e,n,void 0,r===void 0?null:r)}function $d(t,e,n,r){var i=li();r=r===void 0?null:r;var s=void 0;if(wn!==null){var o=wn.memoizedState;if(s=o.destroy,r!==null&&Ly(r,o.deps)){i.memoizedState=NA(e,n,s,r);return}}nn.flags|=t,i.memoizedState=NA(1|e,n,s,r)}function sE(t,e){return hh(8390656,8,t,e)}function Fy(t,e){return $d(2048,8,t,e)}function LS(t,e){return $d(4,2,t,e)}function RS(t,e){return $d(4,4,t,e)}function OS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function FS(t,e,n){return n=n!=null?n.concat([t]):null,$d(4,4,OS.bind(null,e,t),n)}function Dy(){}function DS(t,e){var n=li();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ly(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function kS(t,e){var n=li();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ly(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function NS(t,e,n){return(ea&21)===0?(t.baseState&&(t.baseState=!1,vr=!0),t.memoizedState=n):(Li(n,e)||(n=zC(),nn.lanes|=n,ta|=n,t.baseState=!0),e)}function vF(t,e){var n=Pt;Pt=n!==0&&4>n?n:4,t(!0);var r=Ip.transition;Ip.transition={};try{t(!1),e()}finally{Pt=n,Ip.transition=r}}function US(){return li().memoizedState}function EF(t,e,n){var r=so(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},GS(t))zS(e,n);else if(n=mS(t,e,n,r),n!==null){var i=cr();Mi(n,t,r,i),VS(n,e,r)}}function wF(t,e,n){var r=so(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(GS(t))zS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Li(a,o)){var c=e.interleaved;c===null?(i.next=i,Sy(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=mS(t,e,i,r),n!==null&&(i=cr(),Mi(n,t,r,i),VS(n,e,r))}}function GS(t){var e=t.alternate;return t===nn||e!==null&&e===nn}function zS(t,e){aA=rd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function VS(t,e,n){if((n&4194240)!==0){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hy(t,n)}}var id={readContext:ai,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useInsertionEffect:Qn,useLayoutEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useMutableSource:Qn,useSyncExternalStore:Qn,useId:Qn,unstable_isNewReconciler:!1},TF={readContext:ai,useCallback:function(t,e){return Hi().memoizedState=[t,e===void 0?null:e],t},useContext:ai,useEffect:sE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,hh(4194308,4,OS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return hh(4194308,4,t,e)},useInsertionEffect:function(t,e){return hh(4,2,t,e)},useMemo:function(t,e){var n=Hi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Hi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=EF.bind(null,nn,t),[r.memoizedState,t]},useRef:function(t){var e=Hi();return t={current:t},e.memoizedState=t},useState:iE,useDebugValue:Dy,useDeferredValue:function(t){return Hi().memoizedState=t},useTransition:function(){var t=iE(!1),e=t[0];return t=vF.bind(null,t[1]),Hi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=nn,i=Hi();if(Jt){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=e(),Fn===null)throw Error(fe(349));(ea&30)!==0||CS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,sE(PS.bind(null,r,s,t),[t]),r.flags|=2048,NA(9,SS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Hi(),e=Fn.identifierPrefix;if(Jt){var n=As,r=cs;n=(r&~(1<<32-Pi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=DA++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=_F++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},bF={readContext:ai,useCallback:DS,useContext:ai,useEffect:Fy,useImperativeHandle:FS,useInsertionEffect:LS,useLayoutEffect:RS,useMemo:kS,useReducer:Bp,useRef:BS,useState:function(){return Bp(kA)},useDebugValue:Dy,useDeferredValue:function(t){var e=li();return NS(e,wn.memoizedState,t)},useTransition:function(){var t=Bp(kA)[0],e=li().memoizedState;return[t,e]},useMutableSource:bS,useSyncExternalStore:xS,useId:US,unstable_isNewReconciler:!1},xF={readContext:ai,useCallback:DS,useContext:ai,useEffect:Fy,useImperativeHandle:FS,useInsertionEffect:LS,useLayoutEffect:RS,useMemo:kS,useReducer:Lp,useRef:BS,useState:function(){return Lp(kA)},useDebugValue:Dy,useDeferredValue:function(t){var e=li();return wn===null?e.memoizedState=t:NS(e,wn.memoizedState,t)},useTransition:function(){var t=Lp(kA)[0],e=li().memoizedState;return[t,e]},useMutableSource:bS,useSyncExternalStore:xS,useId:US,unstable_isNewReconciler:!1};function Fl(t,e){try{var n="",r=e;do n+=qR(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Rp(t,e,n){return{value:t,source:null,stack:n!=null?n:null,digest:e!=null?e:null}}function Nm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var CF=typeof WeakMap=="function"?WeakMap:Map;function HS(t,e,n){n=us(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){od||(od=!0,Xm=r),Nm(t,e)},n}function jS(t,e,n){n=us(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Nm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Nm(t,e),typeof r!="function"&&(io===null?io=new Set([this]):io.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function oE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new CF;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=GF.bind(null,t,e,n),e.then(t,t))}function aE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function lE(t,e,n,r,i){return(t.mode&1)===0?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=us(-1,1),e.tag=2,ro(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=i,t)}var SF=ws.ReactCurrentOwner,vr=!1;function ar(t,e,n,r){e.child=t===null?wS(e,null,n,r):Rl(e,t.child,n,r)}function cE(t,e,n,r,i){n=n.render;var s=e.ref;return wl(e,i),r=Ry(t,e,n,r,s,i),n=Oy(),t!==null&&!vr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ms(t,e,i)):(Jt&&n&&Ey(e),e.flags|=1,ar(t,e,r,i),e.child)}function AE(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!jy(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,WS(t,e,s,r,i)):(t=mh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,(t.lanes&i)===0){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:IA,n(o,r)&&t.ref===e.ref)return ms(t,e,i)}return e.flags|=1,t=oo(s,r),t.ref=e.ref,t.return=e,e.child=t}function WS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(IA(s,r)&&t.ref===e.ref)if(vr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)(t.flags&131072)!==0&&(vr=!0);else return e.lanes=t.lanes,ms(t,e,i)}return Um(t,e,n,r,i)}function QS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(nl,Rr),Rr|=n;else{if((n&1073741824)===0)return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Nt(nl,Rr),Rr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Nt(nl,Rr),Rr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Nt(nl,Rr),Rr|=r;return ar(t,e,i,n),e.child}function $S(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Um(t,e,n,r,i){var s=wr(n)?Zo:er.current;return s=Bl(e,s),wl(e,i),n=Ry(t,e,n,r,s,i),r=Oy(),t!==null&&!vr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ms(t,e,i)):(Jt&&r&&Ey(e),e.flags|=1,ar(t,e,n,i),e.child)}function uE(t,e,n,r,i){if(wr(n)){var s=!0;Jh(e)}else s=!1;if(wl(e,i),e.stateNode===null)dh(t,e),vS(e,n,r),km(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=ai(h):(h=wr(n)?Zo:er.current,h=Bl(e,h));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==h)&&nE(e,o,r,h),Vs=!1;var v=e.memoizedState;o.state=v,td(e,r,o,i),c=e.memoizedState,a!==r||v!==c||Er.current||Vs?(typeof p=="function"&&(Dm(e,n,p,r),c=e.memoizedState),(a=Vs||tE(e,n,a,r,v,c,h))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=h,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,yS(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:vi(e.type,a),o.props=h,m=e.pendingProps,v=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ai(c):(c=wr(n)?Zo:er.current,c=Bl(e,c));var E=n.getDerivedStateFromProps;(p=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||v!==c)&&nE(e,o,r,c),Vs=!1,v=e.memoizedState,o.state=v,td(e,r,o,i);var b=e.memoizedState;a!==m||v!==b||Er.current||Vs?(typeof E=="function"&&(Dm(e,n,E,r),b=e.memoizedState),(h=Vs||tE(e,n,h,r,v,b,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),o.props=r,o.state=b,o.context=c,r=h):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),r=!1)}return Gm(t,e,n,r,s,i)}function Gm(t,e,n,r,i,s){$S(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&J2(e,n,!1),ms(t,e,s);r=e.stateNode,SF.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Rl(e,t.child,null,s),e.child=Rl(e,null,a,s)):ar(t,e,a,s),e.memoizedState=r.state,i&&J2(e,n,!0),e.child}function XS(t){var e=t.stateNode;e.pendingContext?Y2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Y2(t,e.context,!1),My(t,e.containerInfo)}function fE(t,e,n,r,i){return Ll(),Ty(i),e.flags|=256,ar(t,e,n,r),e.child}var zm={dehydrated:null,treeContext:null,retryLane:0};function Vm(t){return{baseLanes:t,cachePool:null,transitions:null}}function YS(t,e,n){var r=e.pendingProps,i=Zt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Nt(Zt,i&1),t===null)return Om(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((e.mode&1)===0?e.lanes=1:t.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},(r&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Jd(o,r,0,null),t=Qo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Vm(n),e.memoizedState=zm,t):ky(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return PF(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return(o&1)===0&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=oo(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=oo(a,s):(s=Qo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Vm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=zm,r}return s=t.child,t=s.sibling,r=oo(s,{mode:"visible",children:r.children}),(e.mode&1)===0&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ky(t,e){return e=Jd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ff(t,e,n,r){return r!==null&&Ty(r),Rl(e,t.child,null,n),t=ky(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function PF(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Rp(Error(fe(422))),ff(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Jd({mode:"visible",children:r.children},i,0,null),s=Qo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,(e.mode&1)!==0&&Rl(e,t.child,null,o),e.child.memoizedState=Vm(o),e.memoizedState=zm,s);if((e.mode&1)===0)return ff(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(fe(419)),r=Rp(s,r,void 0),ff(t,e,o,r)}if(a=(o&t.childLanes)!==0,vr||a){if(r=Fn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=(i&(r.suspendedLanes|o))!==0?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,gs(t,i),Mi(r,t,i,-1))}return Hy(),r=Rp(Error(fe(421))),ff(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=zF.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Or=no(i.nextSibling),kr=e,Jt=!0,Ti=null,t!==null&&(ei[ti++]=cs,ei[ti++]=As,ei[ti++]=qo,cs=t.id,As=t.overflow,qo=e),e=ky(e,r.children),e.flags|=4096,e)}function hE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Fm(t.return,e,n)}function Op(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function JS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ar(t,e,r.children,n),r=Zt.current,(r&2)!==0)r=r&1|2,e.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&hE(t,n,e);else if(t.tag===19)hE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Nt(Zt,r),(e.mode&1)===0)e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&nd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Op(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&nd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Op(e,!0,n,null,s);break;case"together":Op(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dh(t,e){(e.mode&1)===0&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ms(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ta|=e.lanes,(n&e.childLanes)===0)return null;if(t!==null&&e.child!==t.child)throw Error(fe(153));if(e.child!==null){for(t=e.child,n=oo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=oo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function MF(t,e,n){switch(e.tag){case 3:XS(e),Ll();break;case 5:TS(e);break;case 1:wr(e.type)&&Jh(e);break;case 4:My(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Nt(qh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Nt(Zt,Zt.current&1),e.flags|=128,null):(n&e.child.childLanes)!==0?YS(t,e,n):(Nt(Zt,Zt.current&1),t=ms(t,e,n),t!==null?t.sibling:null);Nt(Zt,Zt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,(t.flags&128)!==0){if(r)return JS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Nt(Zt,Zt.current),r)break;return null;case 22:case 23:return e.lanes=0,QS(t,e,n)}return ms(t,e,n)}var KS,Hm,ZS,qS;KS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hm=function(){};ZS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Go(Zi.current);var s=null;switch(n){case"input":i=um(t,i),r=um(t,r),s=[];break;case"select":i=rn({},i,{value:void 0}),r=rn({},r,{value:void 0}),s=[];break;case"textarea":i=dm(t,i),r=dm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Xh)}gm(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var a=i[h];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(TA.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var c=r[h];if(a=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&c!==a&&(c!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(h,n)),n=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(TA.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Qt("scroll",t),s||a===c||(s=[])):(s=s||[]).push(h,c))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};qS=function(t,e,n,r){n!==r&&(e.flags|=4)};function xc(t,e){if(!Jt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function $n(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function IF(t,e,n){var r=e.pendingProps;switch(wy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(e),null;case 1:return wr(e.type)&&Yh(),$n(e),null;case 3:return r=e.stateNode,Ol(),$t(Er),$t(er),By(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Af(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,Ti!==null&&(Km(Ti),Ti=null))),Hm(t,e),$n(e),null;case 5:Iy(e);var i=Go(FA.current);if(n=e.type,t!==null&&e.stateNode!=null)ZS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(fe(166));return $n(e),null}if(t=Go(Zi.current),Af(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[$i]=e,r[RA]=s,t=(e.mode&1)!==0,n){case"dialog":Qt("cancel",r),Qt("close",r);break;case"iframe":case"object":case"embed":Qt("load",r);break;case"video":case"audio":for(i=0;i<Xc.length;i++)Qt(Xc[i],r);break;case"source":Qt("error",r);break;case"img":case"image":case"link":Qt("error",r),Qt("load",r);break;case"details":Qt("toggle",r);break;case"input":w2(r,s),Qt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Qt("invalid",r);break;case"textarea":b2(r,s),Qt("invalid",r)}gm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&cf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&cf(r.textContent,a,t),i=["children",""+a]):TA.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Qt("scroll",r)}switch(n){case"input":ef(r),T2(r,s,!0);break;case"textarea":ef(r),x2(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Xh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=CC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[$i]=e,t[RA]=r,KS(t,e,!1,!1),e.stateNode=t;e:{switch(o=mm(n,r),n){case"dialog":Qt("cancel",t),Qt("close",t),i=r;break;case"iframe":case"object":case"embed":Qt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Xc.length;i++)Qt(Xc[i],t);i=r;break;case"source":Qt("error",t),i=r;break;case"img":case"image":case"link":Qt("error",t),Qt("load",t),i=r;break;case"details":Qt("toggle",t),i=r;break;case"input":w2(t,r),i=um(t,r),Qt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=rn({},r,{value:void 0}),Qt("invalid",t);break;case"textarea":b2(t,r),i=dm(t,r),Qt("invalid",t);break;default:i=r}gm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?MC(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&SC(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&bA(t,c):typeof c=="number"&&bA(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(TA.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Qt("scroll",t):c!=null&&ay(t,s,c,o))}switch(n){case"input":ef(t),T2(t,r,!1);break;case"textarea":ef(t),x2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+lo(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?yl(t,!!r.multiple,s,!1):r.defaultValue!=null&&yl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Xh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $n(e),null;case 6:if(t&&e.stateNode!=null)qS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(fe(166));if(n=Go(FA.current),Go(Zi.current),Af(e)){if(r=e.stateNode,n=e.memoizedProps,r[$i]=e,(s=r.nodeValue!==n)&&(t=kr,t!==null))switch(t.tag){case 3:cf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$i]=e,e.stateNode=r}return $n(e),null;case 13:if($t(Zt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Jt&&Or!==null&&(e.mode&1)!==0&&(e.flags&128)===0)gS(),Ll(),e.flags|=98560,s=!1;else if(s=Af(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(fe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(fe(317));s[$i]=e}else Ll(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;$n(e),s=!1}else Ti!==null&&(Km(Ti),Ti=null),s=!0;if(!s)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,(e.mode&1)!==0&&(t===null||(Zt.current&1)!==0?Tn===0&&(Tn=3):Hy())),e.updateQueue!==null&&(e.flags|=4),$n(e),null);case 4:return Ol(),Hm(t,e),t===null&&BA(e.stateNode.containerInfo),$n(e),null;case 10:return Cy(e.type._context),$n(e),null;case 17:return wr(e.type)&&Yh(),$n(e),null;case 19:if($t(Zt),s=e.memoizedState,s===null)return $n(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)xc(s,!1);else{if(Tn!==0||t!==null&&(t.flags&128)!==0)for(t=e.child;t!==null;){if(o=nd(t),o!==null){for(e.flags|=128,xc(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Nt(Zt,Zt.current&1|2),e.child}t=t.sibling}s.tail!==null&&cn()>Dl&&(e.flags|=128,r=!0,xc(s,!1),e.lanes=4194304)}else{if(!r)if(t=nd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),xc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Jt)return $n(e),null}else 2*cn()-s.renderingStartTime>Dl&&n!==1073741824&&(e.flags|=128,r=!0,xc(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=cn(),e.sibling=null,n=Zt.current,Nt(Zt,r?n&1|2:n&1),e):($n(e),null);case 22:case 23:return Vy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&(e.mode&1)!==0?(Rr&1073741824)!==0&&($n(e),e.subtreeFlags&6&&(e.flags|=8192)):$n(e),null;case 24:return null;case 25:return null}throw Error(fe(156,e.tag))}function BF(t,e){switch(wy(e),e.tag){case 1:return wr(e.type)&&Yh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ol(),$t(Er),$t(er),By(),t=e.flags,(t&65536)!==0&&(t&128)===0?(e.flags=t&-65537|128,e):null;case 5:return Iy(e),null;case 13:if($t(Zt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(fe(340));Ll()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $t(Zt),null;case 4:return Ol(),null;case 10:return Cy(e.type._context),null;case 22:case 23:return Vy(),null;case 24:return null;default:return null}}var hf=!1,Zn=!1,LF=typeof WeakSet=="function"?WeakSet:Set,Be=null;function tl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ln(t,e,r)}else n.current=null}function jm(t,e,n){try{n()}catch(r){ln(t,e,r)}}var dE=!1;function RF(t,e){if(Sm=Wh,t=rS(),vy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,h=0,p=0,m=t,v=null;t:for(;;){for(var E;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(E=m.firstChild)!==null;)v=m,m=E;for(;;){if(m===t)break t;if(v===n&&++h===i&&(a=o),v===s&&++p===r&&(c=o),(E=m.nextSibling)!==null)break;m=v,v=m.parentNode}m=E}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pm={focusedElem:t,selectionRange:n},Wh=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var b=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,I=b.memoizedState,S=e.stateNode,P=S.getSnapshotBeforeUpdate(e.elementType===e.type?x:vi(e.type,x),I);S.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var M=e.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(O){ln(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return b=dE,dE=!1,b}function lA(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&jm(e,n,s)}i=i.next}while(i!==r)}}function Xd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Wm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function e3(t){var e=t.alternate;e!==null&&(t.alternate=null,e3(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$i],delete e[RA],delete e[Bm],delete e[pF],delete e[gF])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function t3(t){return t.tag===5||t.tag===3||t.tag===4}function pE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||t3(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Qm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Xh));else if(r!==4&&(t=t.child,t!==null))for(Qm(t,e,n),t=t.sibling;t!==null;)Qm(t,e,n),t=t.sibling}function $m(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($m(t,e,n),t=t.sibling;t!==null;)$m(t,e,n),t=t.sibling}var Un=null,Ei=!1;function Ls(t,e,n){for(n=n.child;n!==null;)n3(t,e,n),n=n.sibling}function n3(t,e,n){if(Ki&&typeof Ki.onCommitFiberUnmount=="function")try{Ki.onCommitFiberUnmount(Gd,n)}catch{}switch(n.tag){case 5:Zn||tl(n,e);case 6:var r=Un,i=Ei;Un=null,Ls(t,e,n),Un=r,Ei=i,Un!==null&&(Ei?(t=Un,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Un.removeChild(n.stateNode));break;case 18:Un!==null&&(Ei?(t=Un,n=n.stateNode,t.nodeType===8?Sp(t.parentNode,n):t.nodeType===1&&Sp(t,n),PA(t)):Sp(Un,n.stateNode));break;case 4:r=Un,i=Ei,Un=n.stateNode.containerInfo,Ei=!0,Ls(t,e,n),Un=r,Ei=i;break;case 0:case 11:case 14:case 15:if(!Zn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&((s&2)!==0||(s&4)!==0)&&jm(n,e,o),i=i.next}while(i!==r)}Ls(t,e,n);break;case 1:if(!Zn&&(tl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ln(n,e,a)}Ls(t,e,n);break;case 21:Ls(t,e,n);break;case 22:n.mode&1?(Zn=(r=Zn)||n.memoizedState!==null,Ls(t,e,n),Zn=r):Ls(t,e,n);break;default:Ls(t,e,n)}}function gE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new LF),e.forEach(function(r){var i=VF.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function yi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Un=a.stateNode,Ei=!1;break e;case 3:Un=a.stateNode.containerInfo,Ei=!0;break e;case 4:Un=a.stateNode.containerInfo,Ei=!0;break e}a=a.return}if(Un===null)throw Error(fe(160));n3(s,o,i),Un=null,Ei=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(h){ln(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)r3(e,t),e=e.sibling}function r3(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yi(e,t),Ni(t),r&4){try{lA(3,t,t.return),Xd(3,t)}catch(x){ln(t,t.return,x)}try{lA(5,t,t.return)}catch(x){ln(t,t.return,x)}}break;case 1:yi(e,t),Ni(t),r&512&&n!==null&&tl(n,n.return);break;case 5:if(yi(e,t),Ni(t),r&512&&n!==null&&tl(n,n.return),t.flags&32){var i=t.stateNode;try{bA(i,"")}catch(x){ln(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&bC(i,s),mm(a,o);var h=mm(a,s);for(o=0;o<c.length;o+=2){var p=c[o],m=c[o+1];p==="style"?MC(i,m):p==="dangerouslySetInnerHTML"?SC(i,m):p==="children"?bA(i,m):ay(i,p,m,h)}switch(a){case"input":fm(i,s);break;case"textarea":xC(i,s);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?yl(i,!!s.multiple,E,!1):v!==!!s.multiple&&(s.defaultValue!=null?yl(i,!!s.multiple,s.defaultValue,!0):yl(i,!!s.multiple,s.multiple?[]:"",!1))}i[RA]=s}catch(x){ln(t,t.return,x)}}break;case 6:if(yi(e,t),Ni(t),r&4){if(t.stateNode===null)throw Error(fe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){ln(t,t.return,x)}}break;case 3:if(yi(e,t),Ni(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{PA(e.containerInfo)}catch(x){ln(t,t.return,x)}break;case 4:yi(e,t),Ni(t);break;case 13:yi(e,t),Ni(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Gy=cn())),r&4&&gE(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Zn=(h=Zn)||p,yi(e,t),Zn=h):yi(e,t),Ni(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&(t.mode&1)!==0)for(Be=t,p=t.child;p!==null;){for(m=Be=p;Be!==null;){switch(v=Be,E=v.child,v.tag){case 0:case 11:case 14:case 15:lA(4,v,v.return);break;case 1:tl(v,v.return);var b=v.stateNode;if(typeof b.componentWillUnmount=="function"){r=v,n=v.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){ln(r,n,x)}}break;case 5:tl(v,v.return);break;case 22:if(v.memoizedState!==null){yE(m);continue}}E!==null?(E.return=v,Be=E):yE(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=PC("display",o))}catch(x){ln(t,t.return,x)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(x){ln(t,t.return,x)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:yi(e,t),Ni(t),r&4&&gE(t);break;case 21:break;default:yi(e,t),Ni(t)}}function Ni(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(t3(n)){var r=n;break e}n=n.return}throw Error(fe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(bA(i,""),r.flags&=-33);var s=pE(t);$m(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=pE(t);Qm(t,a,o);break;default:throw Error(fe(161))}}catch(c){ln(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function OF(t,e,n){Be=t,i3(t)}function i3(t,e,n){for(var r=(t.mode&1)!==0;Be!==null;){var i=Be,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||hf;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Zn;a=hf;var h=Zn;if(hf=o,(Zn=c)&&!h)for(Be=i;Be!==null;)o=Be,c=o.child,o.tag===22&&o.memoizedState!==null?_E(i):c!==null?(c.return=o,Be=c):_E(i);for(;s!==null;)Be=s,i3(s),s=s.sibling;Be=i,hf=a,Zn=h}mE(t)}else(i.subtreeFlags&8772)!==0&&s!==null?(s.return=i,Be=s):mE(t)}}function mE(t){for(;Be!==null;){var e=Be;if((e.flags&8772)!==0){var n=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:Zn||Xd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:vi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&eE(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}eE(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&PA(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}Zn||e.flags&512&&Wm(e)}catch(v){ln(e,e.return,v)}}if(e===t){Be=null;break}if(n=e.sibling,n!==null){n.return=e.return,Be=n;break}Be=e.return}}function yE(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Be=n;break}Be=e.return}}function _E(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Xd(4,e)}catch(c){ln(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){ln(e,i,c)}}var s=e.return;try{Wm(e)}catch(c){ln(e,s,c)}break;case 5:var o=e.return;try{Wm(e)}catch(c){ln(e,o,c)}}}catch(c){ln(e,e.return,c)}if(e===t){Be=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Be=a;break}Be=e.return}}var FF=Math.ceil,sd=ws.ReactCurrentDispatcher,Ny=ws.ReactCurrentOwner,si=ws.ReactCurrentBatchConfig,mt=0,Fn=null,pn=null,Gn=0,Rr=0,nl=go(0),Tn=0,UA=null,ta=0,Yd=0,Uy=0,cA=null,yr=null,Gy=0,Dl=1/0,os=null,od=!1,Xm=null,io=null,df=!1,Ys=null,ad=0,AA=0,Ym=null,ph=-1,gh=0;function cr(){return(mt&6)!==0?cn():ph!==-1?ph:ph=cn()}function so(t){return(t.mode&1)===0?1:(mt&2)!==0&&Gn!==0?Gn&-Gn:yF.transition!==null?(gh===0&&(gh=zC()),gh):(t=Pt,t!==0||(t=window.event,t=t===void 0?16:XC(t.type)),t)}function Mi(t,e,n,r){if(50<AA)throw AA=0,Ym=null,Error(fe(185));cu(t,n,r),((mt&2)===0||t!==Fn)&&(t===Fn&&((mt&2)===0&&(Yd|=n),Tn===4&&Qs(t,Gn)),Tr(t,r),n===1&&mt===0&&(e.mode&1)===0&&(Dl=cn()+500,Wd&&mo()))}function Tr(t,e){var n=t.callbackNode;yO(t,e);var r=jh(t,t===Fn?Gn:0);if(r===0)n!==null&&P2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&P2(n),e===1)t.tag===0?mF(vE.bind(null,t)):hS(vE.bind(null,t)),hF(function(){(mt&6)===0&&mo()}),n=null;else{switch(VC(r)){case 1:n=fy;break;case 4:n=UC;break;case 16:n=Hh;break;case 536870912:n=GC;break;default:n=Hh}n=f3(n,s3.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function s3(t,e){if(ph=-1,gh=0,(mt&6)!==0)throw Error(fe(327));var n=t.callbackNode;if(Tl()&&t.callbackNode!==n)return null;var r=jh(t,t===Fn?Gn:0);if(r===0)return null;if((r&30)!==0||(r&t.expiredLanes)!==0||e)e=ld(t,r);else{e=r;var i=mt;mt|=2;var s=a3();(Fn!==t||Gn!==e)&&(os=null,Dl=cn()+500,Wo(t,e));do try{NF();break}catch(a){o3(t,a)}while(1);xy(),sd.current=s,mt=i,pn!==null?e=0:(Fn=null,Gn=0,e=Tn)}if(e!==0){if(e===2&&(i=wm(t),i!==0&&(r=i,e=Jm(t,i))),e===1)throw n=UA,Wo(t,0),Qs(t,r),Tr(t,cn()),n;if(e===6)Qs(t,r);else{if(i=t.current.alternate,(r&30)===0&&!DF(i)&&(e=ld(t,r),e===2&&(s=wm(t),s!==0&&(r=s,e=Jm(t,s))),e===1))throw n=UA,Wo(t,0),Qs(t,r),Tr(t,cn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(fe(345));case 2:Do(t,yr,os);break;case 3:if(Qs(t,r),(r&130023424)===r&&(e=Gy+500-cn(),10<e)){if(jh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){cr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Im(Do.bind(null,t,yr,os),e);break}Do(t,yr,os);break;case 4:if(Qs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Pi(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=cn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*FF(r/1960))-r,10<r){t.timeoutHandle=Im(Do.bind(null,t,yr,os),r);break}Do(t,yr,os);break;case 5:Do(t,yr,os);break;default:throw Error(fe(329))}}}return Tr(t,cn()),t.callbackNode===n?s3.bind(null,t):null}function Jm(t,e){var n=cA;return t.current.memoizedState.isDehydrated&&(Wo(t,e).flags|=256),t=ld(t,e),t!==2&&(e=yr,yr=n,e!==null&&Km(e)),t}function Km(t){yr===null?yr=t:yr.push.apply(yr,t)}function DF(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Li(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qs(t,e){for(e&=~Uy,e&=~Yd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pi(e),r=1<<n;t[n]=-1,e&=~r}}function vE(t){if((mt&6)!==0)throw Error(fe(327));Tl();var e=jh(t,0);if((e&1)===0)return Tr(t,cn()),null;var n=ld(t,e);if(t.tag!==0&&n===2){var r=wm(t);r!==0&&(e=r,n=Jm(t,r))}if(n===1)throw n=UA,Wo(t,0),Qs(t,e),Tr(t,cn()),n;if(n===6)throw Error(fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Do(t,yr,os),Tr(t,cn()),null}function zy(t,e){var n=mt;mt|=1;try{return t(e)}finally{mt=n,mt===0&&(Dl=cn()+500,Wd&&mo())}}function na(t){Ys!==null&&Ys.tag===0&&(mt&6)===0&&Tl();var e=mt;mt|=1;var n=si.transition,r=Pt;try{if(si.transition=null,Pt=1,t)return t()}finally{Pt=r,si.transition=n,mt=e,(mt&6)===0&&mo()}}function Vy(){Rr=nl.current,$t(nl)}function Wo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,fF(n)),pn!==null)for(n=pn.return;n!==null;){var r=n;switch(wy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Yh();break;case 3:Ol(),$t(Er),$t(er),By();break;case 5:Iy(r);break;case 4:Ol();break;case 13:$t(Zt);break;case 19:$t(Zt);break;case 10:Cy(r.type._context);break;case 22:case 23:Vy()}n=n.return}if(Fn=t,pn=t=oo(t.current,null),Gn=Rr=e,Tn=0,UA=null,Uy=Yd=ta=0,yr=cA=null,Uo!==null){for(e=0;e<Uo.length;e++)if(n=Uo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Uo=null}return t}function o3(t,e){do{var n=pn;try{if(xy(),fh.current=id,rd){for(var r=nn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}rd=!1}if(ea=0,Ln=wn=nn=null,aA=!1,DA=0,Ny.current=null,n===null||n.return===null){Tn=1,UA=e,pn=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=Gn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,p=a,m=p.tag;if((p.mode&1)===0&&(m===0||m===11||m===15)){var v=p.alternate;v?(p.updateQueue=v.updateQueue,p.memoizedState=v.memoizedState,p.lanes=v.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=aE(o);if(E!==null){E.flags&=-257,lE(E,o,a,s,e),E.mode&1&&oE(s,h,e),e=E,c=h;var b=e.updateQueue;if(b===null){var x=new Set;x.add(c),e.updateQueue=x}else b.add(c);break e}else{if((e&1)===0){oE(s,h,e),Hy();break e}c=Error(fe(426))}}else if(Jt&&a.mode&1){var I=aE(o);if(I!==null){(I.flags&65536)===0&&(I.flags|=256),lE(I,o,a,s,e),Ty(Fl(c,a));break e}}s=c=Fl(c,a),Tn!==4&&(Tn=2),cA===null?cA=[s]:cA.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=HS(s,c,e);q2(s,S);break e;case 1:a=c;var P=s.type,M=s.stateNode;if((s.flags&128)===0&&(typeof P.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(io===null||!io.has(M)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=jS(s,a,e);q2(s,O);break e}}s=s.return}while(s!==null)}c3(n)}catch(N){e=N,pn===n&&n!==null&&(pn=n=n.return);continue}break}while(1)}function a3(){var t=sd.current;return sd.current=id,t===null?id:t}function Hy(){(Tn===0||Tn===3||Tn===2)&&(Tn=4),Fn===null||(ta&268435455)===0&&(Yd&268435455)===0||Qs(Fn,Gn)}function ld(t,e){var n=mt;mt|=2;var r=a3();(Fn!==t||Gn!==e)&&(os=null,Wo(t,e));do try{kF();break}catch(i){o3(t,i)}while(1);if(xy(),mt=n,sd.current=r,pn!==null)throw Error(fe(261));return Fn=null,Gn=0,Tn}function kF(){for(;pn!==null;)l3(pn)}function NF(){for(;pn!==null&&!cO();)l3(pn)}function l3(t){var e=u3(t.alternate,t,Rr);t.memoizedProps=t.pendingProps,e===null?c3(t):pn=e,Ny.current=null}function c3(t){var e=t;do{var n=e.alternate;if(t=e.return,(e.flags&32768)===0){if(n=IF(n,e,Rr),n!==null){pn=n;return}}else{if(n=BF(n,e),n!==null){n.flags&=32767,pn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tn=6,pn=null;return}}if(e=e.sibling,e!==null){pn=e;return}pn=e=t}while(e!==null);Tn===0&&(Tn=5)}function Do(t,e,n){var r=Pt,i=si.transition;try{si.transition=null,Pt=1,UF(t,e,n,r)}finally{si.transition=i,Pt=r}return null}function UF(t,e,n,r){do Tl();while(Ys!==null);if((mt&6)!==0)throw Error(fe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(fe(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(_O(t,s),t===Fn&&(pn=Fn=null,Gn=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||df||(df=!0,f3(Hh,function(){return Tl(),null})),s=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||s){s=si.transition,si.transition=null;var o=Pt;Pt=1;var a=mt;mt|=4,Ny.current=null,RF(t,n),r3(n,t),sF(Pm),Wh=!!Sm,Pm=Sm=null,t.current=n,OF(n),AO(),mt=a,Pt=o,si.transition=s}else t.current=n;if(df&&(df=!1,Ys=t,ad=i),s=t.pendingLanes,s===0&&(io=null),hO(n.stateNode),Tr(t,cn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(od)throw od=!1,t=Xm,Xm=null,t;return(ad&1)!==0&&t.tag!==0&&Tl(),s=t.pendingLanes,(s&1)!==0?t===Ym?AA++:(AA=0,Ym=t):AA=0,mo(),null}function Tl(){if(Ys!==null){var t=VC(ad),e=si.transition,n=Pt;try{if(si.transition=null,Pt=16>t?16:t,Ys===null)var r=!1;else{if(t=Ys,Ys=null,ad=0,(mt&6)!==0)throw Error(fe(331));var i=mt;for(mt|=4,Be=t.current;Be!==null;){var s=Be,o=s.child;if((Be.flags&16)!==0){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var h=a[c];for(Be=h;Be!==null;){var p=Be;switch(p.tag){case 0:case 11:case 15:lA(8,p,s)}var m=p.child;if(m!==null)m.return=p,Be=m;else for(;Be!==null;){p=Be;var v=p.sibling,E=p.return;if(e3(p),p===h){Be=null;break}if(v!==null){v.return=E,Be=v;break}Be=E}}}var b=s.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var I=x.sibling;x.sibling=null,x=I}while(x!==null)}}Be=s}}if((s.subtreeFlags&2064)!==0&&o!==null)o.return=s,Be=o;else e:for(;Be!==null;){if(s=Be,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:lA(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,Be=S;break e}Be=s.return}}var P=t.current;for(Be=P;Be!==null;){o=Be;var M=o.child;if((o.subtreeFlags&2064)!==0&&M!==null)M.return=o,Be=M;else e:for(o=P;Be!==null;){if(a=Be,(a.flags&2048)!==0)try{switch(a.tag){case 0:case 11:case 15:Xd(9,a)}}catch(N){ln(a,a.return,N)}if(a===o){Be=null;break e}var O=a.sibling;if(O!==null){O.return=a.return,Be=O;break e}Be=a.return}}if(mt=i,mo(),Ki&&typeof Ki.onPostCommitFiberRoot=="function")try{Ki.onPostCommitFiberRoot(Gd,t)}catch{}r=!0}return r}finally{Pt=n,si.transition=e}}return!1}function EE(t,e,n){e=Fl(n,e),e=HS(t,e,1),t=ro(t,e,1),e=cr(),t!==null&&(cu(t,1,e),Tr(t,e))}function ln(t,e,n){if(t.tag===3)EE(t,t,n);else for(;e!==null;){if(e.tag===3){EE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(io===null||!io.has(r))){t=Fl(n,t),t=jS(e,t,1),e=ro(e,t,1),t=cr(),e!==null&&(cu(e,1,t),Tr(e,t));break}}e=e.return}}function GF(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=cr(),t.pingedLanes|=t.suspendedLanes&n,Fn===t&&(Gn&n)===n&&(Tn===4||Tn===3&&(Gn&130023424)===Gn&&500>cn()-Gy?Wo(t,0):Uy|=n),Tr(t,e)}function A3(t,e){e===0&&((t.mode&1)===0?e=1:(e=rf,rf<<=1,(rf&130023424)===0&&(rf=4194304)));var n=cr();t=gs(t,e),t!==null&&(cu(t,e,n),Tr(t,n))}function zF(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),A3(t,n)}function VF(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(fe(314))}r!==null&&r.delete(e),A3(t,n)}var u3;u3=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Er.current)vr=!0;else{if((t.lanes&n)===0&&(e.flags&128)===0)return vr=!1,MF(t,e,n);vr=(t.flags&131072)!==0}else vr=!1,Jt&&(e.flags&1048576)!==0&&dS(e,Zh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;dh(t,e),t=e.pendingProps;var i=Bl(e,er.current);wl(e,n),i=Ry(null,e,r,t,i,n);var s=Oy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wr(r)?(s=!0,Jh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Py(e),i.updater=Qd,e.stateNode=i,i._reactInternals=e,km(e,r,t,n),e=Gm(null,e,r,!0,s,n)):(e.tag=0,Jt&&s&&Ey(e),ar(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(dh(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=jF(r),t=vi(r,t),i){case 0:e=Um(null,e,r,t,n);break e;case 1:e=uE(null,e,r,t,n);break e;case 11:e=cE(null,e,r,t,n);break e;case 14:e=AE(null,e,r,vi(r.type,t),n);break e}throw Error(fe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:vi(r,i),Um(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:vi(r,i),uE(t,e,r,i,n);case 3:e:{if(XS(e),t===null)throw Error(fe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,yS(t,e),td(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Fl(Error(fe(423)),e),e=fE(t,e,r,n,i);break e}else if(r!==i){i=Fl(Error(fe(424)),e),e=fE(t,e,r,n,i);break e}else for(Or=no(e.stateNode.containerInfo.firstChild),kr=e,Jt=!0,Ti=null,n=wS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ll(),r===i){e=ms(t,e,n);break e}ar(t,e,r,n)}e=e.child}return e;case 5:return TS(e),t===null&&Om(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Mm(r,i)?o=null:s!==null&&Mm(r,s)&&(e.flags|=32),$S(t,e),ar(t,e,o,n),e.child;case 6:return t===null&&Om(e),null;case 13:return YS(t,e,n);case 4:return My(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Rl(e,null,r,n):ar(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:vi(r,i),cE(t,e,r,i,n);case 7:return ar(t,e,e.pendingProps,n),e.child;case 8:return ar(t,e,e.pendingProps.children,n),e.child;case 12:return ar(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Nt(qh,r._currentValue),r._currentValue=o,s!==null)if(Li(s.value,o)){if(s.children===i.children&&!Er.current){e=ms(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=us(-1,n&-n),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?c.next=c:(c.next=p.next,p.next=c),h.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Fm(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(fe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Fm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ar(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,wl(e,n),i=ai(i),r=r(i),e.flags|=1,ar(t,e,r,n),e.child;case 14:return r=e.type,i=vi(r,e.pendingProps),i=vi(r.type,i),AE(t,e,r,i,n);case 15:return WS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:vi(r,i),dh(t,e),e.tag=1,wr(r)?(t=!0,Jh(e)):t=!1,wl(e,n),vS(e,r,i),km(e,r,i,n),Gm(null,e,r,!0,t,n);case 19:return JS(t,e,n);case 22:return QS(t,e,n)}throw Error(fe(156,e.tag))};function f3(t,e){return NC(t,e)}function HF(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ri(t,e,n,r){return new HF(t,e,n,r)}function jy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function jF(t){if(typeof t=="function")return jy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===cy)return 11;if(t===Ay)return 14}return 2}function oo(t,e){var n=t.alternate;return n===null?(n=ri(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function mh(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")jy(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qa:return Qo(n.children,i,s,e);case ly:o=8,i|=8;break;case am:return t=ri(12,n,e,i|2),t.elementType=am,t.lanes=s,t;case lm:return t=ri(13,n,e,i),t.elementType=lm,t.lanes=s,t;case cm:return t=ri(19,n,e,i),t.elementType=cm,t.lanes=s,t;case EC:return Jd(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _C:o=10;break e;case vC:o=9;break e;case cy:o=11;break e;case Ay:o=14;break e;case zs:o=16,r=null;break e}throw Error(fe(130,t==null?t:typeof t,""))}return e=ri(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Qo(t,e,n,r){return t=ri(7,t,r,e),t.lanes=n,t}function Jd(t,e,n,r){return t=ri(22,t,r,e),t.elementType=EC,t.lanes=n,t.stateNode={isHidden:!1},t}function Fp(t,e,n){return t=ri(6,t,null,e),t.lanes=n,t}function Dp(t,e,n){return e=ri(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function WF(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gp(0),this.expirationTimes=gp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Wy(t,e,n,r,i,s,o,a,c){return t=new WF(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ri(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Py(s),t}function QF(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function h3(t){if(!t)return co;t=t._reactInternals;e:{if(fa(t)!==t||t.tag!==1)throw Error(fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fe(171))}if(t.tag===1){var n=t.type;if(wr(n))return fS(t,n,e)}return e}function d3(t,e,n,r,i,s,o,a,c){return t=Wy(n,r,!0,t,i,s,o,a,c),t.context=h3(null),n=t.current,r=cr(),i=so(n),s=us(r,i),s.callback=e!=null?e:null,ro(n,s,i),t.current.lanes=i,cu(t,i,r),Tr(t,r),t}function Kd(t,e,n,r){var i=e.current,s=cr(),o=so(i);return n=h3(n),e.context===null?e.context=n:e.pendingContext=n,e=us(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ro(i,e,o),t!==null&&(Mi(t,i,o,s),uh(t,i,o)),o}function cd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qy(t,e){wE(t,e),(t=t.alternate)&&wE(t,e)}function $F(){return null}var p3=typeof reportError=="function"?reportError:function(t){console.error(t)};function $y(t){this._internalRoot=t}Zd.prototype.render=$y.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(fe(409));Kd(t,e,null,null)};Zd.prototype.unmount=$y.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;na(function(){Kd(null,t,null,null)}),e[ps]=null}};function Zd(t){this._internalRoot=t}Zd.prototype.unstable_scheduleHydration=function(t){if(t){var e=WC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ws.length&&e!==0&&e<Ws[n].priority;n++);Ws.splice(n,0,t),n===0&&$C(t)}};function Xy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function qd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function TE(){}function XF(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=cd(o);s.call(h)}}var o=d3(e,r,t,0,null,!1,!1,"",TE);return t._reactRootContainer=o,t[ps]=o.current,BA(t.nodeType===8?t.parentNode:t),na(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var h=cd(c);a.call(h)}}var c=Wy(t,0,!1,null,null,!1,!1,"",TE);return t._reactRootContainer=c,t[ps]=c.current,BA(t.nodeType===8?t.parentNode:t),na(function(){Kd(e,c,n,r)}),c}function e0(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=cd(o);a.call(c)}}Kd(e,o,t,i)}else o=XF(n,e,t,i,r);return cd(o)}HC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=$c(e.pendingLanes);n!==0&&(hy(e,n|1),Tr(e,cn()),(mt&6)===0&&(Dl=cn()+500,mo()))}break;case 13:na(function(){var r=gs(t,1);if(r!==null){var i=cr();Mi(r,t,1,i)}}),Qy(t,1)}};dy=function(t){if(t.tag===13){var e=gs(t,134217728);if(e!==null){var n=cr();Mi(e,t,134217728,n)}Qy(t,134217728)}};jC=function(t){if(t.tag===13){var e=so(t),n=gs(t,e);if(n!==null){var r=cr();Mi(n,t,e,r)}Qy(t,e)}};WC=function(){return Pt};QC=function(t,e){var n=Pt;try{return Pt=t,e()}finally{Pt=n}};_m=function(t,e,n){switch(e){case"input":if(fm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=jd(r);if(!i)throw Error(fe(90));TC(r),fm(r,i)}}}break;case"textarea":xC(t,n);break;case"select":e=n.value,e!=null&&yl(t,!!n.multiple,e,!1)}};LC=zy;RC=na;var YF={usingClientEntryPoint:!1,Events:[uu,Ja,jd,IC,BC,zy]},Cc={findFiberByHostInstance:No,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},JF={bundleType:Cc.bundleType,version:Cc.version,rendererPackageName:Cc.rendererPackageName,rendererConfig:Cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=DC(t),t===null?null:t.stateNode},findFiberByHostInstance:Cc.findFiberByHostInstance||$F,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pf.isDisabled&&pf.supportsFiber)try{Gd=pf.inject(JF),Ki=pf}catch{}}Hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YF;Hr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xy(e))throw Error(fe(200));return QF(t,e,null,n)};Hr.createRoot=function(t,e){if(!Xy(t))throw Error(fe(299));var n=!1,r="",i=p3;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Wy(t,1,!1,null,null,n,!1,r,i),t[ps]=e.current,BA(t.nodeType===8?t.parentNode:t),new $y(e)};Hr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(fe(188)):(t=Object.keys(t).join(","),Error(fe(268,t)));return t=DC(e),t=t===null?null:t.stateNode,t};Hr.flushSync=function(t){return na(t)};Hr.hydrate=function(t,e,n){if(!qd(e))throw Error(fe(200));return e0(null,t,e,!0,n)};Hr.hydrateRoot=function(t,e,n){if(!Xy(t))throw Error(fe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=p3;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=d3(e,null,t,1,n!=null?n:null,i,!1,s,o),t[ps]=e.current,BA(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Zd(e)};Hr.render=function(t,e,n){if(!qd(e))throw Error(fe(200));return e0(null,t,e,!1,n)};Hr.unmountComponentAtNode=function(t){if(!qd(t))throw Error(fe(40));return t._reactRootContainer?(na(function(){e0(null,null,t,!1,function(){t._reactRootContainer=null,t[ps]=null})}),!0):!1};Hr.unstable_batchedUpdates=zy;Hr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!qd(n))throw Error(fe(200));if(t==null||t._reactInternals===void 0)throw Error(fe(38));return e0(t,e,n,!1,r)};Hr.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=Hr})(Ud);var bE=Ud.exports;sm.createRoot=bE.createRoot,sm.hydrateRoot=bE.hydrateRoot;const KF="modulepreload",ZF=function(t,e){return new URL(t,e).href},xE={},qF=function(e,n,r){return!n||n.length===0?e():Promise.all(n.map(i=>{if(i=ZF(i,r),i in xE)return;xE[i]=!0;const s=i.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${o}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":KF,s||(a.as="script",a.crossOrigin=""),a.href=i,document.head.appendChild(a),s)return new Promise((c,h)=>{a.addEventListener("load",c),a.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};var t0={exports:{}},n0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eD=K.exports,tD=Symbol.for("react.element"),nD=Symbol.for("react.fragment"),rD=Object.prototype.hasOwnProperty,iD=eD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sD={key:!0,ref:!0,__self:!0,__source:!0};function g3(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)rD.call(e,r)&&!sD.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:tD,type:t,key:s,ref:o,props:i,_owner:iD.current}}n0.Fragment=nD;n0.jsx=g3;n0.jsxs=g3;(function(t){t.exports=n0})(t0);const oD=t0.exports.Fragment,Ve=t0.exports.jsx,ii=t0.exports.jsxs,aD=K.exports.createContext(null);function lD(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function CE(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function SE(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const cD=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function PE(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{const i=e[r.ref];let s=null;if("interactive"in r&&(s={...r},delete s.interactive),i){s=s||{...r},delete s.ref;for(const o of cD)o in i&&(s[o]=i[o])}return s||r});return{...t,layers:n}}function AD(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function $s(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!$s(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!$s(t[i],e[i]))return!1;return!0}return!1}const ME={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},kp={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},IE={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},uD=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],fD=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class kl{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[IE[i.type]];s&&s(i)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[ME[i.type]];if(s){if(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"){const o=this._hoveredFeatures||this._map.queryRenderedFeatures(i.point,{layers:this.props.interactiveLayerIds});i.features=o}s(i),delete i.features}},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[kp[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=kl.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n,r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:o}=e;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),r}_initialize(e){const{props:n}=this,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||hD()||null,container:e,style:PE(n.mapStyle)},i=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),n.gl){const h=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=h,n.gl)}const s=new this._MapClass(r);i.padding&&s.setPadding(i.padding),n.cursor&&(s.getCanvas().style.cursor=n.cursor),this._createShadowTransform(s);const o=s._render;s._render=h=>{this._inRender=!0,o.call(s,h),this._inRender=!1};const a=s._renderTaskQueue.run;s._renderTaskQueue.run=h=>{a.call(s._renderTaskQueue,h),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const c=s.fire;s.fire=this._fireEvent.bind(this,c),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>this._updateStyleComponents(this.props,{})),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const h in ME)s.on(h,this._onPointerEvent);for(const h in kp)s.on(h,this._onCameraEvent);for(const h in IE)s.on(h,this._onEvent);this._map=s}recycle(){kl.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=lD(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,c=r.isMoving();c&&(i.cameraElevationReference="sea");const h=SE(i,{...CE(r.transform),...e});if(c&&(i.cameraElevationReference="ground"),h&&n){const p=this._deferredEvents;p.move=!0,p.zoom||(p.zoom=s!==i.zoom),p.rotate||(p.rotate=a!==i.bearing),p.pitch||(p.pitch=o!==i.pitch)}return c||SE(r.transform,e),h}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of uD)s in e&&!$s(e[s],n[s])&&(i=!0,r[`set${s[0].toUpperCase()}${s.slice(1)}`](e[s]));return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==n.mapStyle){const r={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(PE(e.mapStyle),r),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.style.loaded()&&("light"in e&&!$s(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&!$s(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&!$s(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){const r=this._map;let i=!1;for(const s of fD){const o=e[s];$s(o,n[s])||(i=!0,o?r[s].enable(o):r[s].disable())}return i}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0;let a;if(s==="mousemove")try{a=this._map.queryRenderedFeatures(e.point,{layers:r.interactiveLayerIds})}catch{a=[]}else a=[];const c=a.length>0;!c&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,c&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in kp&&(typeof n=="object"&&(n.viewState=CE(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=n}}}kl.savedMaps=[];function hD(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||process.env.MapboxAccessToken}catch{}try{t=t||process.env.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const dD=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function pD(t,e){if(!t)return null;const n=t.map,r={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>t.transform.locationPoint(e.LngLat.convert(i)),unproject:i=>t.transform.pointLocation(e.Point.convert(i)),queryTerrainElevation:(i,s)=>{const o=n.transform;n.transform=t.transform;const a=n.queryTerrainElevation(i,s);return n.transform=o,a}};for(const i of gD(n))!(i in r)&&!dD.includes(i)&&(r[i]=n[i].bind(n));return r}function gD(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const mD=typeof document<"u"?K.exports.useLayoutEffect:K.exports.useEffect,yD=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function _D(t,e){for(const n of yD)n in e&&(t[n]=e[n]);e.RTLTextPlugin&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(e.RTLTextPlugin,n=>{n&&console.error(n)},!1)}const r0=K.exports.createContext(null),vD={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:t=>console.error(t.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},Yy=K.exports.forwardRef((t,e)=>{const n=K.exports.useContext(aD),[r,i]=K.exports.useState(null),s=K.exports.useRef(),{current:o}=K.exports.useRef({mapLib:null,map:null});K.exports.useEffect(()=>{const c=t.mapLib;let h=!0,p;return Promise.resolve(c||qF(()=>import("./mapbox-gl.1c244ae4.js").then(m=>m.m),[],import.meta.url)).then(m=>{if(!!h){if(m.Map||(m=m.default),!m||!m.Map)throw new Error("Invalid mapLib");if(m.supported(t))_D(m,t),t.reuseMaps&&(p=kl.reuse(t,s.current)),p||(p=new kl(m.Map,t,s.current)),o.map=pD(p,m),o.mapLib=m,i(p),n==null||n.onMapMount(o.map,t.id);else throw new Error("Map is not supported by this browser")}}).catch(m=>{t.onError({type:"error",target:null,originalEvent:null,error:m})}),()=>{h=!1,p&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?p.recycle():p.destroy())}},[]),mD(()=>{r&&r.setProps(t)}),K.exports.useImperativeHandle(e,()=>o.map,[r]);const a=K.exports.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]);return Ve("div",{id:t.id,ref:s,style:a,children:r&&Ve(r0.Provider,{value:o,children:t.children})})});Yy.displayName="Map";Yy.defaultProps=vD;const ED=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ha(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!ED.test(r)?n[r]=`${i}px`:n[r]=i}}const wD={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function m3(t){const{map:e,mapLib:n}=K.exports.useContext(r0),r=K.exports.useRef({props:t});r.current.props=t;const i=K.exports.useMemo(()=>{let s=!1;K.exports.Children.forEach(t.children,c=>{c&&(s=!0)});const o={...t,element:s?document.createElement("div"):null},a=new n.Marker(o).setLngLat([t.longitude,t.latitude]);return a.getElement().addEventListener("click",c=>{var h,p;(p=(h=r.current.props).onClick)===null||p===void 0||p.call(h,{type:"click",target:a,originalEvent:c})}),a.on("dragstart",c=>{var h,p;const m=c;m.lngLat=i.getLngLat(),(p=(h=r.current.props).onDragStart)===null||p===void 0||p.call(h,m)}),a.on("drag",c=>{var h,p;const m=c;m.lngLat=i.getLngLat(),(p=(h=r.current.props).onDrag)===null||p===void 0||p.call(h,m)}),a.on("dragend",c=>{var h,p;const m=c;m.lngLat=i.getLngLat(),(p=(h=r.current.props).onDragEnd)===null||p===void 0||p.call(h,m)}),a},[]);return K.exports.useEffect(()=>(i.addTo(e.getMap()),()=>{i.remove()}),[]),K.exports.useEffect(()=>{ha(i.getElement(),t.style)},[t.style]),(i.getLngLat().lng!==t.longitude||i.getLngLat().lat!==t.latitude)&&i.setLngLat([t.longitude,t.latitude]),t.offset&&!AD(i.getOffset(),t.offset)&&i.setOffset(t.offset),i.isDraggable()!==t.draggable&&i.setDraggable(t.draggable),i.getRotation()!==t.rotation&&i.setRotation(t.rotation),i.getRotationAlignment()!==t.rotationAlignment&&i.setRotationAlignment(t.rotationAlignment),i.getPitchAlignment()!==t.pitchAlignment&&i.setPitchAlignment(t.pitchAlignment),i.getPopup()!==t.popup&&i.setPopup(t.popup),Ud.exports.createPortal(t.children,i.getElement())}m3.defaultProps=wD;K.exports.memo(m3);function BE(t){return new Set(t?t.trim().split(/\s+/):[])}function TD(t){const{map:e,mapLib:n}=K.exports.useContext(r0),r=K.exports.useMemo(()=>document.createElement("div"),[]),i=K.exports.useRef({props:t});i.current.props=t;const s=K.exports.useMemo(()=>{const o={...t},a=new n.Popup(o).setLngLat([t.longitude,t.latitude]);return a.once("open",c=>{var h,p;(p=(h=i.current.props).onOpen)===null||p===void 0||p.call(h,c)}),a},[]);if(K.exports.useEffect(()=>{const o=a=>{var c,h;(h=(c=i.current.props).onClose)===null||h===void 0||h.call(c,a)};return s.on("close",o),s.setDOMContent(r).addTo(e.getMap()),()=>{s.off("close",o),s.isOpen()&&s.remove()}},[]),K.exports.useEffect(()=>{ha(s.getElement(),t.style)},[t.style]),s.isOpen()&&((s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!$s(s.options.offset,t.offset)&&s.setOffset(t.offset),(s.options.anchor!==t.anchor||s.options.maxWidth!==t.maxWidth)&&(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth)),s.options.className!==t.className)){const o=BE(s.options.className),a=BE(t.className);for(const c of o)a.has(c)||s.removeClassName(c);for(const c of a)o.has(c)||s.addClassName(c);s.options.className=t.className}return Ud.exports.createPortal(t.children,r)}K.exports.memo(TD);function hu(t,e,n,r){const i=K.exports.useContext(r0),s=K.exports.useMemo(()=>t(i),[]);return K.exports.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,c=typeof n=="function"?n:typeof e=="function"?e:null,{map:h}=i;return h.hasControl(s)||(h.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{c&&c(i),h.hasControl(s)&&h.removeControl(s)}},[]),s}function bD(t){const e=hu(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return K.exports.useEffect(()=>{ha(e._container,t.style)},[t.style]),null}K.exports.memo(bD);function xD(t){const e=hu(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return K.exports.useEffect(()=>{ha(e._controlContainer,t.style)},[t.style]),null}K.exports.memo(xD);const y3=K.exports.forwardRef((t,e)=>{const n=K.exports.useRef({props:t}),r=hu(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var c,h;(h=(c=n.current.props).onGeolocate)===null||h===void 0||h.call(c,a)}),s.on("error",a=>{var c,h;(h=(c=n.current.props).onError)===null||h===void 0||h.call(c,a)}),s.on("outofmaxbounds",a=>{var c,h;(h=(c=n.current.props).onOutOfMaxBounds)===null||h===void 0||h.call(c,a)}),s.on("trackuserlocationstart",a=>{var c,h;(h=(c=n.current.props).onTrackUserLocationStart)===null||h===void 0||h.call(c,a)}),s.on("trackuserlocationend",a=>{var c,h;(h=(c=n.current.props).onTrackUserLocationEnd)===null||h===void 0||h.call(c,a)}),s},{position:t.position});return n.current.props=t,K.exports.useImperativeHandle(e,()=>({trigger:()=>r.trigger()}),[]),K.exports.useEffect(()=>{ha(r._container,t.style)},[t.style]),null});y3.displayName="GeolocateControl";K.exports.memo(y3);function CD(t){const e=hu(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return K.exports.useEffect(()=>{ha(e._container,t.style)},[t.style]),null}K.exports.memo(CD);const SD={unit:"metric",maxWidth:100};function _3(t){const e=hu(({mapLib:n})=>new n.ScaleControl(t),{position:t.position});return(e.options.unit!==t.unit||e.options.maxWidth!==t.maxWidth)&&(e.options.maxWidth=t.maxWidth,e.setUnit(t.unit)),K.exports.useEffect(()=>{ha(e._container,t.style)},[t.style]),null}_3.defaultProps=SD;K.exports.memo(_3);function Ct(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Nl=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),LE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);LE&&parseFloat(LE[1]);const PD="3.2.9";function es(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Np={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},MD=Np.global||Np.self||Np.window||{},$o=typeof process!="object"||String(process)!=="[object process]"||process.browser,Jy=typeof importScripts=="function",ID=typeof window<"u"&&typeof window.orientation<"u",RE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);RE&&parseFloat(RE[1]);function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class BD{constructor(e,n){T(this,"name",void 0),T(this,"workerThread",void 0),T(this,"isRunning",!0),T(this,"result",void 0),T(this,"_resolve",()=>{}),T(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){es(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){es(this.isRunning),this.isRunning=!1,this._reject(e)}}class Up{}const Gp=new Map;function LD(t){es(t.source&&!t.url||!t.source&&t.url);let e=Gp.get(t.source||t.url);return e||(t.url&&(e=RD(t.url),Gp.set(t.url,e)),t.source&&(e=v3(t.source),Gp.set(t.source,e))),es(e),e}function RD(t){if(!t.startsWith("http"))return t;const e=OD(t);return v3(e)}function v3(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function OD(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function E3(t,e=!0,n){const r=n||new Set;if(t){if(OE(t))r.add(t);else if(OE(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)E3(t[i],e,r)}}return n===void 0?Array.from(r):[]}function OE(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const zp=()=>{};class Zm{static isSupported(){return typeof Worker<"u"&&$o||typeof Up<"u"&&!$o}constructor(e){T(this,"name",void 0),T(this,"source",void 0),T(this,"url",void 0),T(this,"terminated",!1),T(this,"worker",void 0),T(this,"onMessage",void 0),T(this,"onError",void 0),T(this,"_loadableURL","");const{name:n,source:r,url:i}=e;es(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=zp,this.onError=s=>console.log(s),this.worker=$o?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=zp,this.onError=zp,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,n){n=n||E3(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=LD({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Up(r,{eval:!1})}else if(this.source)e=new Up(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class FD{static isSupported(){return Zm.isSupported()}constructor(e){T(this,"name","unnamed"),T(this,"source",void 0),T(this,"url",void 0),T(this,"maxConcurrency",1),T(this,"maxMobileConcurrency",1),T(this,"onDebug",()=>{}),T(this,"reuseWorkers",!0),T(this,"props",{}),T(this,"jobQueue",[]),T(this,"idleQueue",[]),T(this,"count",0),T(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new BD(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Zm({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ID?this.maxMobileConcurrency:this.maxConcurrency}}const DD={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ls{static isSupported(){return Zm.isSupported()}static getWorkerFarm(e={}){return ls._workerFarm=ls._workerFarm||new ls({}),ls._workerFarm.setProps(e),ls._workerFarm}constructor(e){T(this,"props",void 0),T(this,"workerPools",new Map),this.props={...DD},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new FD({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}T(ls,"_workerFarm",void 0);const kD="latest";function ND(t,e={}){const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=kD);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return es(i),i}function UD(t,e=PD){es(t,"no worker provided");const n=t.version;return!(!e||!n)}const GD={},zD=Object.freeze(Object.defineProperty({__proto__:null,default:GD},Symbol.toStringTag,{value:"Module"})),VD="3.2.9",Vp={};async function Xo(t,e=null,n={}){return e&&(t=HD(t,e,n)),Vp[t]=Vp[t]||jD(t),await Vp[t]}function HD(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:$o?n.CDN?(es(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(VD,"/dist/libs/").concat(t)):Jy?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}async function jD(t){if(t.endsWith("wasm"))return await(await fetch(t)).arrayBuffer();if(!$o)try{return zD&&void 0}catch{return null}if(Jy)return importScripts(t);const n=await(await fetch(t)).text();return WD(n,t)}function WD(t,e){if(!$o)return;if(Jy)return eval.call(MD,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}function QD(t,e){return!ls.isSupported()||!$o&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function $D(t,e,n,r,i){const s=t.id,o=ND(t,n),c=ls.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const h=await c.startJob("process-on-worker",XD.bind(null,i));return h.postMessage("process",{input:e,options:n,context:r}),await(await h.result).result}async function XD(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const c=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:c})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function YD(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?FE(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?FE(t,0,e):""}function FE(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}function JD(t){try{return JSON.parse(t)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(YD(t),'"'))}}function w3(t){return t&&typeof t=="object"&&t.isBuffer}function KD(t){return w3(t)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t}function T3(t){if(w3(t))return KD(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function ZD(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function qD(...t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}function Hp(...t){const e=t,n=e&&e.length>1&&e[0].constructor||null;if(!n)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');const r=e.reduce((o,a)=>o+a.length,0),i=new n(r);let s=0;for(const o of e)i.set(o,s),s+=o.length;return i}function Ky(t,e,n){const r=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function du(t,e){return Ct(t>=0),Ct(e>0),t+(e-1)&~(e-1)}function e4(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const i=t.byteOffset,s=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,i,s)}return e.set(r,n),n+du(r.byteLength,4)}async function t4(t){const e=[];for await(const n of t)e.push(n);return qD(...e)}function DE(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class kE{constructor(e,n){T(this,"name",void 0),T(this,"type",void 0),T(this,"sampleSize",1),T(this,"time",void 0),T(this,"count",void 0),T(this,"samples",void 0),T(this,"lastTiming",void 0),T(this,"lastSampleTime",void 0),T(this,"lastSampleCount",void 0),T(this,"_count",0),T(this,"_time",0),T(this,"_samples",0),T(this,"_startTime",0),T(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=DE(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(DE()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class pu{constructor(e){T(this,"id",void 0),T(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof kE?this.stats[n]=e:this.stats[n]=new kE(n,r)),this.stats[n]}}const n4="Queued Requests",r4="Active Requests",i4="Cancelled Requests",s4="Queued Requests Ever",o4="Active Requests Ever",a4={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class b3{constructor(e={}){T(this,"props",void 0),T(this,"stats",void 0),T(this,"activeRequestCount",0),T(this,"requestQueue",[]),T(this,"requestMap",new Map),T(this,"deferredUpdate",null),this.props={...a4,...e},this.stats=new pu({id:this.props.id}),this.stats.get(n4),this.stats.get(r4),this.stats.get(i4),this.stats.get(s4),this.stats.get(o4)}scheduleRequest(e,n=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let l4="";const NE={};function c4(t){for(const e in NE)if(t.startsWith(e)){const n=NE[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(l4).concat(t)),t}function A4(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}function x3(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}const u4=t=>typeof t=="boolean",uA=t=>typeof t=="function",gu=t=>t!==null&&typeof t=="object",UE=t=>gu(t)&&t.constructor==={}.constructor,f4=t=>t&&typeof t[Symbol.iterator]=="function",h4=t=>t&&typeof t[Symbol.asyncIterator]=="function",Kl=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Zl=t=>typeof Blob<"u"&&t instanceof Blob,d4=t=>t&&typeof t=="object"&&t.isBuffer,p4=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||gu(t)&&uA(t.tee)&&uA(t.cancel)&&uA(t.getReader),g4=t=>gu(t)&&uA(t.read)&&uA(t.pipe)&&u4(t.readable),C3=t=>p4(t)||g4(t),m4=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,y4=/^([-\w.]+\/[-\w.+]+)/;function _4(t){const e=y4.exec(t);return e?e[1]:t}function GE(t){const e=m4.exec(t);return e?e[1]:""}const v4=/\?.*/;function i0(t){if(Kl(t)){const e=jp(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:_4(n)||GE(e)}}return Zl(t)?{url:jp(t.name||""),type:t.type||""}:typeof t=="string"?{url:jp(t),type:GE(t)}:{url:"",type:""}}function E4(t){return Kl(t)?t.headers["content-length"]||-1:Zl(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function jp(t){return t.replace(v4,"")}async function S3(t){if(Kl(t))return t;const e={},n=E4(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=i0(t);i&&(e["content-type"]=i);const s=await b4(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function w4(t){if(!t.ok){const e=await T4(t);throw new Error(e)}}async function T4(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function b4(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=x4(n);return"data:base64,".concat(r)}return null}function x4(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function qm(t,e){if(typeof t=="string"){t=c4(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await S3(t)}function P3(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&Boolean(process.versions.electron))return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Ts(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||P3()}const yh={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},gf=yh.window||yh.self||yh.global,Sc=yh.process||{},M3=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Ts();const Wp=globalThis;function I3(t){if(!t&&!Ts())return"Node";if(P3(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":Wp.chrome?"Chrome":Wp.safari?"Safari":Wp.mozInnerScreenX?"Firefox":"Unknown"}function C4(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class S4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";T(this,"storage",void 0),T(this,"id",void 0),T(this,"config",{}),this.storage=C4(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}return this}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function P4(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function M4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Qp(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Ad;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ad||(Ad={}));function zE(t){return typeof t=="string"?Ad[t.toUpperCase()]||Ad.WHITE:t}function I4(t,e,n){return!Ts&&typeof t=="string"&&(e&&(e=zE(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=zE(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function B4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function ud(t,e){if(!t)throw new Error(e||"Assertion failed")}function Sa(){let t;if(Ts&&"performance"in gf){var e,n;t=gf==null||(e=gf.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Sc){var r;const i=Sc==null||(r=Sc.hrtime)===null||r===void 0?void 0:r.call(Sc);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Pa={debug:Ts&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},L4={enabled:!0,level:0};function Zr(){}const VE={},HE={once:!0};class mu{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};T(this,"id",void 0),T(this,"VERSION",M3),T(this,"_startTs",Sa()),T(this,"_deltaTs",Sa()),T(this,"_storage",void 0),T(this,"userData",{}),T(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this._storage=new S4("__probe-".concat(this.id,"__"),L4),this.userData={},this.timeStamp("".concat(this.id," started")),B4(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Sa()-this._startTs).toPrecision(10))}getDelta(){return Number((Sa()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:e}),this}setLevel(e){return this._storage.updateConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.updateConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){ud(e,n)}warn(e){return this._getLogFunction(0,e,Pa.warn,arguments,HE)}error(e){return this._getLogFunction(0,e,Pa.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Pa.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Pa.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Pa.debug||Pa.info,arguments,HE)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Zr,r&&[r],{tag:D4(n)}):Zr}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?Ts?F4({image:i,message:s,scale:o}):O4({image:i,message:s,scale:o}):Zr}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Zr)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=jE({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Zr)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=B3(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=jE({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,ud(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Sa();const o=s.tag||s.message;if(s.once)if(!VE[o])VE[o]=Sa();else return Zr;return n=R4(this.id,s.message,s),r.bind(console,n,...s.args)}return Zr}}T(mu,"VERSION",M3);function B3(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return ud(Number.isFinite(e)&&e>=0),e}function jE(t){const{logLevel:e,message:n}=t;t.logLevel=B3(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return ud(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function R4(t,e,n){if(typeof e=="string"){const r=n.time?M4(P4(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=I4(e,n.color,n.background)}return e}function O4(t){let{image:e,message:n="",scale:r=1}=t;return(void 0)({image:e,message:n,scale:r}),Zr}function F4(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=Qp(s,n,r);console.log(...o)},s.src=e,Zr}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Qp(e,n,r)),Zr;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Qp(s,n,r)),s.src=e.toDataURL(),Zr}return Zr}function D4(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const WE=new mu({id:"loaders.gl"});class k4{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class N4{constructor(){T(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const L3={fetch:null,mimeType:void 0,nothrow:!1,log:new N4,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Nl,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},U4={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function R3(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const O3=()=>{const t=R3();return t.globalOptions=t.globalOptions||{...L3},t.globalOptions};function G4(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],z4(t,n),H4(e,t,r)}function F3(t,e){const n=O3(),r=t||n;return typeof r.fetch=="function"?r.fetch:gu(r.fetch)?i=>qm(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:qm}function z4(t,e){QE(t,null,L3,U4,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};QE(r,n.id,i,s,e)}}function QE(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const c=!e&&gu(t[a]),h=a==="baseUri"&&!e,p=a==="workerUrl"&&e;if(!(a in n)&&!h&&!p){if(a in r)WE.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!c){const m=V4(a,i);WE.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(m))()}}}}function V4(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function H4(t,e,n){const i={...t.options||{}};return j4(i,n),i.log===null&&(i.log=new k4),$E(i,O3()),$E(i,e),i}function $E(t,e){for(const n in e)if(n in e){const r=e[n];UE(r)&&UE(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function j4(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function Zy(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function qy(t){var e,n;Ct(t,"null loader"),Ct(Zy(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const D3=()=>{const t=R3();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function W4(t){const e=D3();t=Array.isArray(t)?t:[t];for(const n of t){const r=qy(n);e.find(i=>r===i)||e.unshift(r)}}function Q4(){return D3()}const $4=new mu({id:"loaders.gl"}),X4=/\.([^.]+)$/;async function Y4(t,e=[],n,r){if(!k3(t))return null;let i=XE(t,e,{...n,nothrow:!0},r);if(i)return i;if(Zl(t)&&(t=await t.slice(0,10).arrayBuffer(),i=XE(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(N3(t));return i}function XE(t,e=[],n,r){if(!k3(t))return null;if(e&&!Array.isArray(e))return qy(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...Q4()),K4(i);const s=J4(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(N3(t));return s}function J4(t,e,n,r){const{url:i,type:s}=i0(t),o=i||(r==null?void 0:r.url);let a=null,c="";if(n!=null&&n.mimeType&&(a=$p(e,n==null?void 0:n.mimeType),c="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||Z4(e,o),c=c||(a?"matched url ".concat(o):""),a=a||$p(e,s),c=c||(a?"matched MIME type ".concat(s):""),a=a||ek(e,t),c=c||(a?"matched initial data ".concat(U3(t)):""),a=a||$p(e,n==null?void 0:n.fallbackMimeType),c=c||(a?"matched fallback MIME type ".concat(s):""),c){var h;$4.log(1,"selectLoader selected ".concat((h=a)===null||h===void 0?void 0:h.name,": ").concat(c,"."))}return a}function k3(t){return!(t instanceof Response&&t.status===204)}function N3(t){const{url:e,type:n}=i0(t);let r="No valid loader found (";r+=e?"".concat(A4(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?U3(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function K4(t){for(const e of t)qy(e)}function Z4(t,e){const n=e&&X4.exec(e),r=n&&n[1];return r?q4(t,r):null}function q4(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function $p(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function ek(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(tk(e,n))return n}else if(ArrayBuffer.isView(e)){if(YE(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&YE(e,0,n))return n;return null}function tk(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function YE(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>nk(t,e,n,i))}function nk(t,e,n,r){if(r instanceof ArrayBuffer)return ZD(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=e1(t,e,r.length);return r===i;default:return!1}}function U3(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?e1(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?e1(t,0,e):""}function e1(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const rk=256*1024;function*ik(t,e){const n=(e==null?void 0:e.chunkSize)||rk;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const sk=256*1024;function*ok(t,e={}){const{chunkSize:n=sk}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const ak=1024*1024;async function*lk(t,e){const n=(e==null?void 0:e.chunkSize)||ak;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function JE(t,e){return Nl?ck(t,e):Ak(t)}async function*ck(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield T3(o)}}catch{n.releaseLock()}}async function*Ak(t,e){for await(const n of t)yield T3(n)}function uk(t,e){if(typeof t=="string")return ik(t,e);if(t instanceof ArrayBuffer)return ok(t,e);if(Zl(t))return lk(t,e);if(C3(t))return JE(t,e);if(Kl(t))return JE(t.body,e);throw new Error("makeIterator")}const G3="Cannot convert supplied data type";function fk(t,e,n){if(e.text&&typeof t=="string")return t;if(d4(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(G3)}async function hk(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return fk(t,e);if(Zl(t)&&(t=await S3(t)),Kl(t)){const i=t;return await w4(i),e.binary?await i.arrayBuffer():await i.text()}if(C3(t)&&(t=uk(t,n)),f4(t)||h4(t))return t4(t);throw new Error(G3)}function dk(t,e,n=null){if(n)return n;const r={fetch:F3(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function pk(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function e_(t,e,n,r){es(!r||typeof r=="object"),e&&!Array.isArray(e)&&!Zy(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=i0(t),o=pk(e,r),a=await Y4(t,o,n);return a?(n=G4(n,a,o,i),r=dk({url:i,parse:e_,loaders:o},n,r),await gk(a,t,n,r)):null}async function gk(t,e,n,r){if(UD(t),Kl(e)){const i=e,{ok:s,redirected:o,status:a,statusText:c,type:h,url:p}=i,m=Object.fromEntries(i.headers.entries());r.response={headers:m,ok:s,redirected:o,status:a,statusText:c,type:h,url:p}}if(e=await hk(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(QD(t,n))return await $D(t,e,n,r,e_);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw es(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function ys(t,e,n,r){!Array.isArray(e)&&!Zy(e)&&(n=e,e=void 0);const i=F3(n);let s=t;return typeof t=="string"&&(s=await i(t)),Zl(t)&&(s=await i(t)),await e_(s,e,n)}const mk="3.2.9",{_parseImageNode:yk}=globalThis,t1=typeof Image<"u",n1=typeof ImageBitmap<"u",_k=Boolean(yk),r1=Nl?!0:_k;function vk(t){switch(t){case"auto":return n1||t1||r1;case"imagebitmap":return n1;case"image":return t1;case"data":return r1;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function Ek(){if(n1)return"imagebitmap";if(t1)return"image";if(r1)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function wk(t){const e=bk(t);if(!e)throw new Error("Not an image");return e}function Tk(t){switch(wk(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function bk(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const xk=/^data:image\/svg\+xml/,Ck=/\.svg((\?|#).*)?$/;function t_(t){return t&&(xk.test(t)||Ck.test(t))}function Sk(t,e){if(t_(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return z3(t,e)}function z3(t,e){if(t_(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function V3(t,e,n){const r=Sk(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Pk(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Pk(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const Mk={};let KE=!0;async function Ik(t,e,n){let r;t_(n)?r=await V3(t,e,n):r=z3(t,n);const i=e&&e.imagebitmap;return await Bk(r,i)}async function Bk(t,e=null){if((Lk(e)||!KE)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),KE=!1}return await createImageBitmap(t)}function Lk(t){for(const e in t||Mk)return!1;return!0}const Xi=!1,fA=!0;function n_(t){const e=yu(t);return Rk(e)||Dk(e)||Ok(e)||Fk(e)}function Rk(t){const e=yu(t);return e.byteLength>=24&&e.getUint32(0,Xi)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Xi),height:e.getUint32(20,Xi)}:null}function Ok(t){const e=yu(t);return e.byteLength>=10&&e.getUint32(0,Xi)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,fA),height:e.getUint16(8,fA)}:null}function Fk(t){const e=yu(t);return e.byteLength>=14&&e.getUint16(0,Xi)===16973&&e.getUint32(2,fA)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,fA),height:e.getUint32(22,fA)}:null}function Dk(t){const e=yu(t);if(!(e.byteLength>=3&&e.getUint16(0,Xi)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=kk();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Xi);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Xi),width:e.getUint16(s+7,Xi)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,Xi)}return null}function kk(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function yu(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function Nk(t,e){const{mimeType:n}=n_(t)||{},r=globalThis._parseImageNode;return Ct(r),await r(t,n)}async function Uk(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=Gk(i);let a;switch(o){case"imagebitmap":a=await Ik(t,e,s);break;case"image":a=await V3(t,e,s);break;case"data":a=await Nk(t);break;default:Ct(!1)}return i==="data"&&(a=Tk(a)),a}function Gk(t){switch(t){case"auto":case"data":return Ek();default:return vk(t),t}}const zk=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],Vk=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],Hk={image:{type:"auto",decode:!0}},r_={id:"image",module:"images",name:"Images",version:mk,mimeTypes:Vk,extensions:zk,parse:Uk,tests:[t=>Boolean(n_(new DataView(t)))],options:Hk},jk=["image/png","image/jpeg","image/gif"],Xp={};function Wk(t){return Xp[t]===void 0&&(Xp[t]=Qk(t)),Xp[t]}function Qk(t){switch(t){case"image/webp":return $k();case"image/svg":return Nl;default:if(!Nl){const{_parseImageNode:e}=globalThis;return Boolean(e)&&jk.includes(t)}return!0}}function $k(){if(!Nl)return!1;try{return document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")===0}catch{return!1}}const ze=new mu({id:"deck"});let i1={};function Xk(t){i1=t}function Jn(t,e,n,r){ze.level>0&&i1[t]&&i1[t].call(null,e,n,r)}function Yk(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const Jk={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:Yk,parseTextSync:JSON.parse},hA="8.8.11",_h=globalThis.deck&&globalThis.deck.VERSION;if(_h&&_h!==hA)throw new Error("deck.gl - multiple versions detected: ".concat(_h," vs ").concat(hA));_h||(ze.log(1,"deck.gl ".concat(hA))(),globalThis.deck={...globalThis.deck,VERSION:hA,version:hA,log:ze,_registerLoggers:Xk},W4([Jk,[r_,{imagebitmap:{premultiplyAlpha:"none"}}]]));const Kk=globalThis.deck,Le=new mu({id:"luma.gl"});function lr(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Zk="Invalid WebGLRenderingContext",qk="Requires WebGL2";function s0(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&Number.isFinite(t._version))}function nt(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function eN(t){return nt(t)?t:null}function o0(t){return lr(s0(t),Zk),t}function qn(t){return lr(nt(t),qk),t}const Yc={};function tN(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function nN(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function rN(t,e){Yc[t]=!0,e!==void 0&&tN(e)}function iN(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Yc[r]=!0);while(r!==0);for(r in Yc)if(Yc[r])return delete Yc[r],parseInt(r,10);return 0}}const _u=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};_u.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};_u.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const da=function(e){const n=this;this.gl=e,iN(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const c=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return c.buffer;case 34338:return c.enabled;case 34339:return c.size;case 34340:return c.stride;case 34341:return c.type;case 34922:return c.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,c,h,p){const m=n.currentVertexArrayObject;m.maxAttrib=Math.max(m.maxAttrib,s);const v=m.attribs[s];return v.buffer=n.currentArrayBuffer,v.size=o,v.type=a,v.normalized=c,v.stride=h,v.offset=p,v.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{nN("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};da.prototype.VERTEX_ARRAY_BINDING_OES=34229;da.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new _u(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};da.prototype.createVertexArrayOES=function(){const e=new _u(this);return this.vertexArrayObjects.push(e),e};da.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};da.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof _u&&e.hasBeenBound&&e.ext===this)};da.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){rN(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let c=0;c<=a;c++){const h=s.attribs[c],p=i?i.attribs[c]:null;if((!i||h.enabled!==p.enabled)&&(h.enabled?r.enableVertexAttribArray.call(n,c):r.disableVertexAttribArray.call(n,c)),h.enabled){let m=!1;(!i||h.buffer!==p.buffer)&&(o!==h.buffer&&(r.bindBuffer.call(n,34962,h.buffer),o=h.buffer),m=!0),(m||h.cached!==p.cached)&&r.vertexAttribPointer.call(n,c,h.size,h.type,h.normalized,h.stride,h.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function sN(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new da(this)),this.__OESVertexArrayObject))}}const ZE="OES_element_index",qE="WEBGL_draw_buffers",oN="EXT_disjoint_timer_query",aN="EXT_disjoint_timer_query_webgl2",lN="EXT_texture_filter_anisotropic",ew="WEBGL_debug_renderer_info",cN=35723,AN=4352,uN=36795,fN=34047,hN=37445,dN=37446,Dt=t=>nt(t)?void 0:0,pN={[3074]:t=>nt(t)?void 0:36064,[cN]:t=>nt(t)?void 0:AN,[35977]:Dt,[32937]:Dt,[uN]:(t,e)=>{const n=nt(t)?t.getExtension(aN):t.getExtension(oN);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[hN]:(t,e)=>{const n=t.getExtension(ew);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[dN]:(t,e)=>{const n=t.getExtension(ew);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[fN]:(t,e)=>{const n=t.luma.extensions[lN];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:Dt,[35071]:Dt,[37447]:Dt,[36063]:(t,e)=>{if(!nt(t)){const n=t.getExtension(qE);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:Dt,[35374]:Dt,[35377]:Dt,[34852]:t=>{if(!nt(t)){const e=t.getExtension(qE);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(ZE)?2147483647:65535,[33001]:t=>t.getExtension(ZE)?16777216:65535,[33e3]:t=>16777216,[37157]:Dt,[35373]:Dt,[35657]:Dt,[36183]:Dt,[37137]:Dt,[34045]:Dt,[35978]:Dt,[35979]:Dt,[35968]:Dt,[35376]:Dt,[35375]:Dt,[35659]:Dt,[37154]:Dt,[35371]:Dt,[35658]:Dt,[35076]:Dt,[35077]:Dt,[35380]:Dt};function gN(t,e,n){const r=pN[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const mN="OES_vertex_array_object",H3="ANGLE_instanced_arrays",yN="WEBGL_draw_buffers",_N="EXT_disjoint_timer_query",vN="EXT_texture_filter_anisotropic",EN="VertexArray requires WebGL2 or OES_vertex_array_object extension";function wN(t,e){return{webgl2:nt(t),ext:t.getExtension(e)}}const j3={[mN]:{meta:{suffix:"OES"},createVertexArray:()=>{lr(!1,EN)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[H3]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){lr(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[yN]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{lr(!1)}},[_N]:{meta:{suffix:"EXT"},createQuery:()=>{lr(!1)},deleteQuery:()=>{lr(!1)},beginQuery:()=>{lr(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Yp={readBuffer:(t,e,n)=>{nt(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=wN(t,H3);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!nt(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!nt(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[vN];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:gN,hint(t,e,n,r){return e(n,r)}};function TN(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(sN(t),bN(t),CN(t,j3),xN(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=TN;function bN(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function xN(t,e){let{target:n,target2:r}=e;Object.keys(Yp).forEach(i=>{if(typeof Yp[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=Yp[i].bind(null,t,s);n[i]=o,r[i]=o}})}function CN(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&SN(t,{extension:n,target:t.luma,target2:t})}function SN(t,e){let{extension:n,target:r,target2:i}=e;const s=j3[n];lr(s);const{meta:o={}}=s,{suffix:a=""}=o,c=t.getExtension(n);for(const h of Object.keys(s)){const p="".concat(h).concat(a);let m=null;h==="meta"||typeof t[h]=="function"||(c&&typeof c[p]=="function"?m=function(){return c[p](...arguments)}:typeof s[h]=="function"&&(m=s[h].bind(r))),m&&(r[h]=m,i[h]=m)}}const i_={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},Rs=(t,e,n)=>e?t.enable(n):t.disable(n),tw=(t,e,n)=>t.hint(n,e),Pr=(t,e,n)=>t.pixelStorei(n,e),PN=(t,e)=>{const n=nt(t)?36009:36160;return t.bindFramebuffer(n,e)},MN=(t,e)=>t.bindFramebuffer(36008,e);function Pc(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const IN={[3042]:Rs,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:Rs,[2885]:(t,e)=>t.cullFace(e),[2929]:Rs,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:Rs,[35723]:tw,[36006]:PN,[2886]:(t,e)=>t.frontFace(e),[33170]:tw,[2849]:(t,e)=>t.lineWidth(e),[32823]:Rs,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:Rs,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:Rs,[3088]:(t,e)=>t.scissor(...e),[2960]:Rs,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:Pr,[3317]:Pr,[37440]:Pr,[37441]:Pr,[37443]:Pr,[3330]:Pr,[3332]:Pr,[3331]:Pr,[36010]:MN,[3314]:Pr,[32878]:Pr,[3316]:Pr,[3315]:Pr,[32877]:Pr,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Pc(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Pc(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Pc(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Pc(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Pc(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function an(t,e,n){return e[t]!==void 0?e[t]:n[t]}const BN={blendEquation:(t,e,n)=>t.blendEquationSeparate(an(32777,e,n),an(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(an(32969,e,n),an(32968,e,n),an(32971,e,n),an(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(an(32824,e,n),an(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(an(32938,e,n),an(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,an(2962,e,n),an(2967,e,n),an(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,an(34816,e,n),an(36003,e,n),an(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,an(2964,e,n),an(2965,e,n),an(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,an(34817,e,n),an(34818,e,n),an(34819,e,n))},nw={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},Ui=(t,e)=>t.isEnabled(e),rw={[3042]:Ui,[2884]:Ui,[2929]:Ui,[3024]:Ui,[32823]:Ui,[32926]:Ui,[32928]:Ui,[3089]:Ui,[2960]:Ui,[35977]:Ui};function W3(t){for(const e in t)return!1;return!0}function LN(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function iw(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function RN(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:c,oldValue:h}=n(t.state._updateCache,...o);return c&&r(...o),h},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function ON(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class FN{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?kN(e):Object.assign({},i_),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){lr(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];_s(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){lr(s!==void 0);const o=e[s],a=this.cache[s];LN(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function Q3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(lr(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new FN(t,{copyState:r}),ON(t);for(const s in nw){const o=nw[s];RN(t,s,o)}iw(t,"getParameter"),iw(t,"isEnabled")}return t.state.enable=n,t}function DN(t){t.state||Q3(t,{copyState:!1}),t.state.push()}function sw(t){lr(t.state),t.state.pop()}function _s(t,e){if(lr(s0(t),"setParameters requires a WebGL context"),W3(e))return;const n={};for(const i in e){const s=Number(i),o=IN[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=BN[i];s(t,e,r)}}function kN(t,e){if(e=e||i_,typeof e=="number"){const i=e,s=rw[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=rw[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function NN(t){_s(t,i_)}function oi(t,e,n){if(W3(e))return n(t);const{nocatch:r=!0}=e;DN(t),_s(t,e);let i;if(r)i=n(t),sw(t);else try{i=n(t)}finally{sw(t)}return i}function Ul(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function Jp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=Ul(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return GN(e,r,i,s,n)}function UN(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function GN(t,e,n,r,i){const s=ow(t[0],e,n);let o=aw(t[1],e,r,i),a=ow(t[0]+1,e,n);const c=a===n-1?a:a-1;a=aw(t[1]+1,e,r,i);let h;return i?(a=a===0?a:a+1,h=o,o=a):h=a===r-1?a:a-1,{x:s,y:o,width:Math.max(c-s+1,1),height:Math.max(h-o+1,1)}}function ow(t,e,n){return Math.min(Math.round(t*e),n-1)}function aw(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const s_=Ts(),zN=s_&&typeof document<"u",$3={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function X3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lr(s_,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},$3,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=WN({canvas:s,width:e,height:n,onError:r});return i=jN(o,t),i?(i=o_(i,t),QN(i),i):null}function o_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||$N(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},$3,e);const{manageState:n,debug:r}=e;return n&&Q3(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Le.log(1,...s)()}}),s_&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Le.level=Math.max(Le.level,1)):Le.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function VN(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function HN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=UN(e.useDevicePixels);XN(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function jN(t,e){const{onError:n}=e;let r=null;const i=c=>r=c.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function WN(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(zN&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function QN(t){const e=nt(t)?"WebGL2":"WebGL1",n=VN(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";Le.info(1,"".concat(e).concat(i," context ").concat(r))()}function $N(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function XN(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(Le.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),c=Math.floor(i*o);t.canvas.width=a,t.canvas.height=c,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==c)&&(Le.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const dA="8.5.16",YN="set luma.log.level=1 (or higher) to trace rendering";class Y3{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new pu({id:e})),this.stats.get(e)}}const zo=new Y3;if(globalThis.luma&&globalThis.luma.VERSION!==dA)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(dA));globalThis.luma||(Ts()&&Le.log(1,"luma.gl ".concat(dA," - ").concat(YN))(),globalThis.luma=globalThis.luma||{VERSION:dA,version:dA,log:Le,stats:zo,globals:{modules:{},nodeIO:{}}});function JN(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function KN(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function ve(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Kp(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return ve(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function ao(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const Zp={};function Ri(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Zp[t]=Zp[t]||1;const e=Zp[t]++;return"".concat(t,"-").concat(e)}function lw(t){return ve(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function Gl(t){let e=!0;for(const n in t){e=!1;break}return e}function J3(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw Le.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const Ma="Resource subclass must define virtual methods";class bs{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o0(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Ri(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._initStats(),this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Kp(this.gl,e),ve(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=nt(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,c="webgl2"in i?i.webgl2:i.webgl1;return s?c:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=nt(this.gl),o={},a=n||Object.keys(i);for(const c of a){const h=i[c];if(h&&(!("webgl2"in h)||s)&&(!("extension"in h)||this.gl.getExtension(h.extension))){const m=r?ao(this.gl,c):c;o[m]=this.getParameter(c,e),r&&h.type==="GLenum"&&(o[m]=ao(this.gl,o[m]))}}return o}setParameter(e,n){e=Kp(this.gl,e),ve(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=nt(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=Kp(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return J3(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Ma)}_deleteHandle(){throw new Error(Ma)}_bindHandle(e){throw new Error(Ma)}_getOptsFromHandle(){throw new Error(Ma)}_getParameter(e,n){throw new Error(Ma)}_setParameter(e,n){throw new Error(Ma)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_initStats(){this.gl.stats=this.gl.stats||new Y3}_addStats(){const e=this[Symbol.toStringTag],n=zo.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];zo.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._doTrackAllocatedMemory(e,n),this._doTrackAllocatedMemory(e,n,this.gl.stats.get("Memory Usage"))}_doTrackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:zo.get("Memory Usage");r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e),this.byteLength=e}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._doTrackDeallocatedMemory(e),this._doTrackDeallocatedMemory(e,this.gl.stats.get("Memory Usage"))}_doTrackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zo.get("Memory Usage");n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(e," Memory")).subtractCount(this.byteLength),this.byteLength=0}}const ZN="Failed to deduce GL constant from typed array";function s1(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(ZN)}}function GA(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function qN(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const c=a*o,h=(r-a-1)*o;s.set(e.subarray(c,c+o)),e.copyWithin(c,h,h+o),e.set(s,h)}}function e8(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let c=0;c<i;c++)for(let h=0;h<4;h++)o[(a*i+c)*4+h]=e[(a*2*n+c*2)*4+h];return{data:o,width:i,height:s}}function o1(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const h=r[a]?"".concat(t,".").concat(r[a]):"N/A";Le.removed("".concat(t,".").concat(a),h)()}for(const a in i)if(a in e){const c=i[a];Le.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))()}let o=null;for(const a in s)if(a in e){const c=s[a];Le.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))(),o=o||Object.assign({},e),o[c]=e[a],delete o[a]}return o||e}const t8={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},n8={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class _r{static getBytesPerElement(e){return GA(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return ve(e.size),GA(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new _r(t8,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return _r.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return _r.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=o1("Accessor",e,n8),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const cw=10,K3={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},r8={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:K3},i8={removedProps:K3};class St extends bs{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/_r.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/_r.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=o1("Buffer",e,r8),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=o1("Buffer",e,i8),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new _r(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;ve(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(qn(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return qn(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};qn(this.gl);const s=GA(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let c,h;e?(h=e.length,c=h-a):(c=Math.min(o,i||o),h=a+c);const p=Math.min(o,c);return i=i||p,ve(i<=p),e=e||new s(h),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(ve(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(cw,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;ve(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,cw),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=s1(e);return ve(s),this.setAccessor(new _r(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;ve(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=GA(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new _r(this.accessor,{type:s1(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Le.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Le.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Le.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Le.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new _r(this.accessor,e),this}}const a_={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},Z3={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},q3={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function s8(t,e){const n=a_[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=nt(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function o8(t,e){const n=a_[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const a8=[9729,9728],Aw=globalThis.WebGLBuffer||function(){};class ra extends bs{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&s8(e,r),s=s&&(!i||o8(e,r))),s}constructor(e,n){const{id:r=Ri("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(P=>this.initialize(Object.assign({},e,{pixels:P,data:P}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:c={},pixelStore:h={},textureUnit:p=void 0}=e;n||(n=i);let{width:m,height:v,dataFormat:E,type:b,compressed:x=!1,mipmaps:I=!0}=e;const{depth:S=0}=e;return{width:m,height:v,compressed:x,dataFormat:E,type:b}=this._deduceParameters({format:s,type:b,dataFormat:E,compressed:x,data:n,width:m,height:v}),this.width=m,this.height=v,this.depth=S,this.format=s,this.type=b,this.dataFormat=E,this.border=o,this.textureUnit=p,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),I&&this._isNPOT()&&(Le.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),I=!1,this._updateForNPOT(c)),this.mipmaps=I,this.setImageData({data:n,width:m,height:v,depth:S,format:s,type:b,dataFormat:E,border:o,mipmaps:I,parameters:h,compressed:x}),I&&this.generateMipmap(),this.setParameters(c),a&&(this.data=n),r&&(this._video={video:n,parameters:c,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Le.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),oi(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:c={}}=e;let{data:h=null,type:p=this.type,width:m=this.width,height:v=this.height,dataFormat:E=this.dataFormat,compressed:b=!1}=e;h||(h=r),{type:p,dataFormat:E,compressed:b,width:m,height:v}=this._deduceParameters({format:s,type:p,dataFormat:E,compressed:b,data:h,width:m,height:v});const{gl:x}=this;x.bindTexture(this.target,this.handle);let I=null;({data:h,dataType:I}=this._getDataType({data:h,compressed:b}));let S,P=0;if(oi(this.gl,c,()=>{switch(I){case"null":x.texImage2D(n,i,s,m,v,o,E,p,h);break;case"typed-array":x.texImage2D(n,i,s,m,v,o,E,p,h,a);break;case"buffer":S=qn(x),S.bindBuffer(35052,h.handle||h),S.texImage2D(n,i,s,m,v,o,E,p,a),S.bindBuffer(35052,null);break;case"browser-object":nt(x)?x.texImage2D(n,i,s,m,v,o,E,p,h):x.texImage2D(n,i,s,E,p,h);break;case"compressed":for(const[M,O]of h.entries())x.compressedTexImage2D(n,M,O.format,O.width,O.height,o,O.data),P+=O.levelSize;break;default:ve(!1,"Unknown image data type")}}),I==="compressed")this._trackAllocatedMemory(P,"Texture");else if(h&&h.byteLength)this._trackAllocatedMemory(h.byteLength,"Texture");else{const M=Z3[this.dataFormat]||4,O=q3[this.type]||1;this._trackAllocatedMemory(this.width*this.height*M*O,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:c=this.height,level:h=0,format:p=this.format,type:m=this.type,dataFormat:v=this.dataFormat,compressed:E=!1,offset:b=0,border:x=this.border,parameters:I={}}=e;if({type:m,dataFormat:v,compressed:E,width:a,height:c}=this._deduceParameters({format:p,type:m,dataFormat:v,compressed:E,data:i,width:a,height:c}),ve(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const S=i;i=S.data,a=S.shape[0],c=S.shape[1]}i instanceof St&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),oi(this.gl,I,()=>{if(E)this.gl.compressedTexSubImage2D(n,h,s,o,a,c,p,i);else if(i===null)this.gl.texSubImage2D(n,h,s,o,a,c,v,m,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,h,s,o,a,c,v,m,i,b);else if(i instanceof Aw){const S=qn(this.gl);S.bindBuffer(35052,i),S.texSubImage2D(n,h,s,o,a,c,v,m,b),S.bindBuffer(35052,null)}else nt(this.gl)?qn(this.gl).texSubImage2D(n,h,s,o,a,c,v,m,i):this.gl.texSubImage2D(n,h,s,o,v,m,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Le.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof St?{data:n.handle,dataType:"buffer"}:n instanceof Aw?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:c}=e;const h=a_[n];return o=o||h&&h.dataFormat,a=a||h&&h.types[0],c=c||h&&h.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:c,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},ve(i,"Could not deduced texture size"),ve(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),ve(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:ve(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return nt(this.gl)||!this.width||!this.height?!1:!lw(this.width)||!lw(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:a8.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let l8="";function c8(t,e){return ve(typeof t=="string"),t=l8+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class Hn extends ra{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return ra.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o0(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:c8(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const a1=[34069,34070,34071,34072,34073,34074];class eP extends ra{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};o0(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:c=5121}=e;const{gl:h}=this,p=i||s,m=await Promise.all(a1.map(v=>{const E=p[v];return Promise.all(Array.isArray(E)?E:[E])}));this.bind(),a1.forEach((v,E)=>{m[E].length>1&&this.opts.mipmaps!==!1&&Le.warn("".concat(this.id," has mipmap and multiple LODs."))(),m[E].forEach((b,x)=>{n&&r?h.texImage2D(v,x,a,n,r,o,a,c,b):h.texImage2D(v,x,a,a,c,b)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:c=6408,type:h=5121}=e,{gl:p}=this,m=s||o;return this.bind(),m instanceof Promise?m.then(v=>this.setImageDataForFace(Object.assign({},e,{face:n,data:v,pixels:v}))):this.width||this.height?p.texImage2D(n,0,c,r,i,a,c,h,m):p.texImage2D(n,0,c,c,h,m),this}}eP.FACES=a1;class A8 extends ra{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return nt(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qn(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:c,type:h=5121,offset:p=0,data:m,parameters:v={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),oi(this.gl,v,()=>{ArrayBuffer.isView(m)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,c,h,m),m instanceof St&&(this.gl.bindBuffer(35052,m.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,c,h,p))}),m&&m.byteLength)this._trackAllocatedMemory(m.byteLength,"Texture");else{const E=Z3[this.dataFormat]||4,b=q3[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*E*b,"Texture")}return this.loaded=!0,this}}const Mo="EXT_color_buffer_float",uw={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:Mo,bpp:2},[33327]:{gl2:Mo,bpp:4},[34842]:{gl2:Mo,bpp:8},[33326]:{gl2:Mo,bpp:4},[33328]:{gl2:Mo,bpp:8},[34836]:{gl2:Mo,bpp:16},[35898]:{gl2:Mo,bpp:4}};function u8(t,e,n){const r=n[e];if(!r)return!1;const i=nt(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class rl extends bs{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||u8(e,n,uw)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return ve(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&nt(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*uw[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const f8=256,h8=1024,d8=16384,fw=6144,hw=6145,dw=6146,pw=34041,tP="clear: bad arguments";function l_(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=d8,n!==!0&&(s.clearColor=n)),r&&(o|=f8,r!==!0&&(s.clearDepth=r)),i&&(o|=h8,r!==!0&&(s.clearStencil=r)),ve(o!==0,tP),oi(t,s,()=>{t.clear(o)})}function p8(t){let{framebuffer:e=null,buffer:n=fw,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qn(t),oi(t,{framebuffer:e},()=>{switch(n){case fw:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case hw:t.clearBufferfv(hw,0,[i]);break;case dw:t.clearBufferiv(dw,0,[i]);break;case pw:const[s,o]=i;t.clearBufferfi(pw,0,s,o);break;default:ve(!1,tP)}})}function g8(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return ve(!1),0}}function a0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:c,sourceType:h}=e;const{framebuffer:p,deleteFramebuffer:m}=nP(t);ve(p);const{gl:v,handle:E,attachments:b}=p;a=a||p.width,c=c||p.height,s===36064&&E===null&&(s=1028),ve(b[s]),h=h||b[s].type,o=y8(o,h,i,a,c),h=h||s1(o);const x=v.bindFramebuffer(36160,E);return v.readPixels(n,r,a,c,i,h,o),v.bindFramebuffer(36160,x||null),m&&p.delete(),o}function gw(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=a0(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=e8({data:r,width:i,height:s}));qN({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),c=a.createImageData(i,s);return c.data.set(r),a.putImageData(c,0,0),o.toDataURL()}function m8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=n;let{targetX:a,targetY:c,targetZ:h,width:p,height:m}=n;const{framebuffer:v,deleteFramebuffer:E}=nP(t);ve(v);const{gl:b,handle:x}=v,I=typeof a<"u"||typeof c<"u"||typeof h<"u";a=a||0,c=c||0,h=h||0;const S=b.bindFramebuffer(36160,x);ve(e);let P=null;if(e instanceof ra&&(P=e,p=Number.isFinite(p)?p:P.width,m=Number.isFinite(m)?m:P.height,P.bind(0),e=P.target),!I)b.copyTexImage2D(e,s,o,r,i,p,m,0);else switch(e){case 3553:case 34067:b.copyTexSubImage2D(e,s,a,c,r,i,p,m);break;case 35866:case 32879:qn(b).copyTexSubImage3D(e,s,a,c,h,r,i,p,m);break}return P&&P.unbind(),b.bindFramebuffer(36160,S||null),E&&v.delete(),P}function nP(t){return t instanceof mn?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:S8(t),deleteFramebuffer:!0}}function y8(t,e,n,r,i){if(t)return t;e=e||5121;const s=GA(e,{clamped:!1}),o=g8(n);return new s(r*i*o)}const Bt={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function _8(t){const e=new Hn(t,{format:6408,type:5126,dataFormat:6408}),n=new mn(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const rP={[Bt.WEBGL2]:[!1,!0],[Bt.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Bt.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Bt.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Bt.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Bt.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Bt.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Bt.FLOAT_BLEND]:["EXT_float_blend"],[Bt.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Bt.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Bt.TEXTURE_FLOAT]:["OES_texture_float",!0],[Bt.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Bt.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Bt.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Bt.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Bt.COLOR_ATTACHMENT_RGBA32F]:[_8,"EXT_color_buffer_float"],[Bt.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Bt.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Bt.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Bt.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Bt.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Bt.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},v8=2;function l0(t,e){return c_(t,e)}function c_(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>iP(t,n))}function E8(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in rP)t.luma.caps[e]===void 0&&(t.luma.caps[e]=iP(t,e));return t.luma.caps}function iP(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=w8(t,e)),t.luma.caps[e]||Le.log(v8,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function w8(t,e){const n=rP[e];ve(n,e);let r;const i=nt(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&Boolean(t.getExtension(s))}else typeof i=="string"?r=Boolean(t.getExtension(i)):typeof i=="boolean"?r=i:ve(!1);return r}const mw="Multiple render targets not supported";class mn extends bs{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new mn(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=qn(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=qn(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:c=!0,readBuffer:h=void 0,drawBuffers:p=void 0}=e;if(ve(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const m in i){const v=i[m];(Array.isArray(v)?v[0]:v).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:h,drawBuffers:p}),i&&c&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,c=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,c||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return ve(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&Le.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){ve(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),c=i[a];let h=c;if(!h)this._unattach(a);else if(h instanceof rl)this._attachRenderbuffer({attachment:a,renderbuffer:h});else if(Array.isArray(c)){const[p,m=0,v=0]=c;h=p,this._attachTexture({attachment:a,texture:p,layer:m,level:v})}else this._attachTexture({attachment:a,texture:h,layer:0,level:0});r&&h&&h.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(b8(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&l_(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,c)=>{p8(this.gl,{drawBuffer:c,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return Le.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Le.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Le.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Le.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Le.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Le.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=qn(this.gl),c=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,c),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=ao(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?ao(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?ao(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(gw(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Le.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=gw(this,{targetMaxHeight:100});return Le.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new Hn(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new rl(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new rl(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&ve(!1),o}_unattach(e){const n=this.attachments[e];!n||(n instanceof rl?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:qn(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const c=T8(i);o.framebufferTexture2D(36160,n,c,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:ve(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=eN(this.gl);n?n.readBuffer(e):ve(e===36064||e===1029,mw),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=qn(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):ve(e.length===1&&(e[0]===36064||e[0]===1029),mw)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=E8(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function T8(t){return t<34069?t+34069:t}function b8(t){return(mn.STATUS||{})[t]||"Framebuffer error ".concat(t)}const x8=[36049,36048,33296,33298,33299,33300,33301,33302,33303];mn.ATTACHMENT_PARAMETERS=x8;function C8(t,e){ve(t instanceof Hn||t instanceof eP||t instanceof A8);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:c,border:h,mipmaps:p}=t,m=Object.assign({width:i,height:s,format:o,type:a,dataFormat:c,border:h,mipmaps:p},e);return new n(r,m)}function S8(t,e){const{gl:n,width:r,height:i,id:s}=t;return new mn(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function vh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const P8=35632,M8=35633;function I8(t){switch(t){case P8:return"fragment";case M8:return"vertex";default:return"unknown type"}}function B8(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||vh(e)||"(unnamed)",c="".concat(I8(n)," shader ").concat(a);for(let p=0;p<i.length;p++){const m=i[p];if(m.length<=1)continue;const v=m.split(":"),E=v[0],b=parseInt(v[2],10);if(isNaN(b))throw new Error("GLSL compilation error in ".concat(c,": ").concat(t));E!=="WARNING"?s[b]=m:o[b]=m}const h=L8(e);return{shaderName:c,errors:yw(s,h),warnings:yw(o,h)}}function yw(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],c=parseInt(o[1],10)||0,h=s.substring(o.join(":").length+1).trim();n+=sP("^^^ ".concat(a,": ").concat(h,`

`),c)}}return n}function L8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),c=a.length;return sP(a,i-c)+n+s})}function sP(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function oP(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const R8="Shader: GLSL source code must be a JavaScript string";class zA extends bs{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return ve(!1),"unknown"}}constructor(e,n){o0(e),ve(typeof n.source=="string",R8);const r=vh(n.source,null)||n.id||Ri("unnamed ".concat(zA.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=vh(n,null);r&&(this.id=Ri(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(zA.getTypeName(this.shaderType),":").concat(this.id)}getName(){return vh(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=B8(r,this.source,this.shaderType,this.id);throw Le.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),Le.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class qp extends zA{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class eg extends zA{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const O8={[5126]:Wt.bind(null,"uniform1fv",Mr,1,Xn),[35664]:Wt.bind(null,"uniform2fv",Mr,2,Xn),[35665]:Wt.bind(null,"uniform3fv",Mr,3,Xn),[35666]:Wt.bind(null,"uniform4fv",Mr,4,Xn),[5124]:Wt.bind(null,"uniform1iv",Os,1,Xn),[35667]:Wt.bind(null,"uniform2iv",Os,2,Xn),[35668]:Wt.bind(null,"uniform3iv",Os,3,Xn),[35669]:Wt.bind(null,"uniform4iv",Os,4,Xn),[35670]:Wt.bind(null,"uniform1iv",Os,1,Xn),[35671]:Wt.bind(null,"uniform2iv",Os,2,Xn),[35672]:Wt.bind(null,"uniform3iv",Os,3,Xn),[35673]:Wt.bind(null,"uniform4iv",Os,4,Xn),[35674]:Wt.bind(null,"uniformMatrix2fv",Mr,4,rs),[35675]:Wt.bind(null,"uniformMatrix3fv",Mr,9,rs),[35676]:Wt.bind(null,"uniformMatrix4fv",Mr,16,rs),[35678]:Nn,[35680]:Nn,[5125]:Wt.bind(null,"uniform1uiv",mf,1,Xn),[36294]:Wt.bind(null,"uniform2uiv",mf,2,Xn),[36295]:Wt.bind(null,"uniform3uiv",mf,3,Xn),[36296]:Wt.bind(null,"uniform4uiv",mf,4,Xn),[35685]:Wt.bind(null,"uniformMatrix2x3fv",Mr,6,rs),[35686]:Wt.bind(null,"uniformMatrix2x4fv",Mr,8,rs),[35687]:Wt.bind(null,"uniformMatrix3x2fv",Mr,6,rs),[35688]:Wt.bind(null,"uniformMatrix3x4fv",Mr,12,rs),[35689]:Wt.bind(null,"uniformMatrix4x2fv",Mr,8,rs),[35690]:Wt.bind(null,"uniformMatrix4x3fv",Mr,12,rs),[35678]:Nn,[35680]:Nn,[35679]:Nn,[35682]:Nn,[36289]:Nn,[36292]:Nn,[36293]:Nn,[36298]:Nn,[36299]:Nn,[36300]:Nn,[36303]:Nn,[36306]:Nn,[36307]:Nn,[36308]:Nn,[36311]:Nn},F8={},D8={},k8={},_w=[0];function A_(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(_w[0]=t,t=_w);const i=t.length;if(i%e&&Le.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function Mr(t,e){return A_(t,e,Float32Array,F8)}function Os(t,e){return A_(t,e,Int32Array,D8)}function mf(t,e){return A_(t,e,Uint32Array,k8)}function vw(t,e,n){const r=O8[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function N8(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:Boolean(n[2])}}function U8(t,e,n){for(const r in t){const i=t[r];if((!n||Boolean(n[r]))&&!G8(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function G8(t){return Array.isArray(t)||ArrayBuffer.isView(t)?V8(t):isFinite(t)||t===!0||t===!1||t instanceof ra||t instanceof rl?!0:t instanceof mn?Boolean(t.texture):!1}function z8(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function V8(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Nn(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Wt(t,e,n,r){let i=null,s=null;return(o,a,c)=>{const h=e(c,n),p=h.length;let m=!1;if(i===null)i=new Float32Array(p),s=p,m=!0;else{ve(s===p,"Uniform length cannot change.");for(let v=0;v<p;++v)if(h[v]!==i[v]){m=!0;break}}return m&&(r(o,t,a,h),i.set(h)),m}}function Xn(t,e,n,r){t[e](n,r)}function rs(t,e,n,r){t[e](n,!1,r)}const H8=5120,j8=5121,W8=5122,Q8=5123,Ew=0,yf=1,$8=2,X8=3,_f=4,Y8=5,J8=6,En=5126,K8=35664,Z8=35665,q8=35666,Mc=5124,e6=35667,t6=35668,n6=35669,Ic=5125,r6=36294,i6=36295,s6=36296,o6=35670,a6=35671,l6=35672,c6=35673,A6=35674,u6=35675,f6=35676,h6=35685,d6=35686,p6=35687,g6=35688,m6=35689,y6=35690,l1={[En]:[En,1,"float"],[K8]:[En,2,"vec2"],[Z8]:[En,3,"vec3"],[q8]:[En,4,"vec4"],[Mc]:[Mc,1,"int"],[e6]:[Mc,2,"ivec2"],[t6]:[Mc,3,"ivec3"],[n6]:[Mc,4,"ivec4"],[Ic]:[Ic,1,"uint"],[r6]:[Ic,2,"uvec2"],[i6]:[Ic,3,"uvec3"],[s6]:[Ic,4,"uvec4"],[o6]:[En,1,"bool"],[a6]:[En,2,"bvec2"],[l6]:[En,3,"bvec3"],[c6]:[En,4,"bvec4"],[A6]:[En,8,"mat2"],[h6]:[En,8,"mat2x3"],[d6]:[En,8,"mat2x4"],[u6]:[En,12,"mat3"],[p6]:[En,12,"mat3x2"],[g6]:[En,12,"mat3x4"],[f6]:[En,16,"mat4"],[m6]:[En,16,"mat4x2"],[y6]:[En,16,"mat4x3"]};function _6(t){switch(t){case Ew:return Ew;case yf:return yf;case X8:return yf;case $8:return yf;case _f:return _f;case Y8:return _f;case J8:return _f;default:return ve(!1),0}}function ww(t){const e=l1[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function aP(t,e){switch(t){case H8:case j8:case W8:case Q8:t=En;break}for(const n in l1){const[r,i,s]=l1[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class v6{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),c=n.getAttribLocation(e.handle,s);c>=0&&this._addAttribute(c,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!nt(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=ww(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const c={location:e,name:n,accessor:new _r(a)};this.attributeInfos.push(c),this.attributeInfosByLocation[e]=c,this.attributeInfosByName[c.name]=c}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=ww(r),a=new _r({type:s,size:i*o}),c={location:e,name:n,accessor:a};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}const Tw=4,E6=35981,w6=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class lP extends bs{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",w6),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=E6}=e;return this.hash=n||"",this.vs=typeof r=="string"?new qp(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new eg(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,ve(this.vs instanceof qp),ve(this.fs instanceof eg),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(qn(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new v6(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:c=!1,indexType:h=5123,instanceCount:p=0,isInstanced:m=p>0,vertexArray:v=null,transformFeedback:E,framebuffer:b,parameters:x={},uniforms:I,samplers:S}=e;if((I||S)&&(Le.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(I||{})),Le.priority>=n){const P=b?b.id:"default",M="mode=".concat(ao(this.gl,r)," verts=").concat(i," ")+"instances=".concat(p," indexType=").concat(ao(this.gl,h)," ")+"isInstanced=".concat(m," isIndexed=").concat(c," ")+"Framebuffer=".concat(P);Le.log(n,M)()}return ve(v),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||m&&p===0?!1:(v.bindForDraw(i,p,()=>{if(b!==void 0&&(x=Object.assign({},x,{framebuffer:b})),E){const P=_6(r);E.begin(P)}this._bindTextures(),oi(this.gl,x,()=>{c&&m?this.gl2.drawElementsInstanced(r,i,h,s,p):c&&nt(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,h,s):c?this.gl.drawElements(r,i,h,s):m?this.gl2.drawArraysInstanced(r,s,i,p):this.gl.drawArrays(r,s,i)}),E&&E.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le.priority>=2&&U8(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof mn&&(s=s.texture),s instanceof ra)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:c}=i;a.bind(c),s=c,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&z8(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new qp({handle:i});break;case 35632:r.fs=new eg({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Ri(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Le.time(Tw,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Le.timeEnd(Tw,"linkProgram for ".concat(this._getName()))(),e.debug||Le.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=N8(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=vw(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=vw(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const T6=34918,b6=34919,x6=35007,C6=36795,S6=35976,P6=35887,M6=36202;class fd extends bs{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=nt(e),i=c_(e,Bt.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:ve(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(x6)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?M6:P6)}beginTransformFeedbackQuery(){return this.begin(S6)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,b6);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(C6)}getResult(){return this.gl2.getQueryParameter(this.handle,T6)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return fd.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class cP extends bs{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return nt(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qn(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Gl(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,Le.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof St?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let vf=null;function I6(t){return(!vf||vf.byteLength<t)&&(vf=new ArrayBuffer(t)),vf}function B6(t,e){const n=I6(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function L6(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let c=r;a<s;a++)e[c++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const R6="elements must be GL.ELEMENT_ARRAY_BUFFER";class Lr extends bs{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?nt(e)||I3()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Lr(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Lr.MAX_ATTRIBUTES=Lr.MAX_ATTRIBUTES||e.getParameter(34921),Lr.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Lr._setConstantFloatArray(e,n,r);break;case Int32Array:Lr._setConstantIntArray(e,n,r);break;case Uint32Array:Lr._setConstantUintArray(e,n,r);break;default:ve(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Lr.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ve(!e||e.target===34963,R6),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:c,integer:h,divisor:p}=r,{gl:m,gl2:v}=this;return e=Number(e),this.bind(()=>{m.bindBuffer(34962,n.handle),h?(ve(nt(m)),v.vertexAttribIPointer(e,i,s,o,a)):m.vertexAttribPointer(e,i,s,c,o,a),m.enableVertexAttribArray(e),v.vertexAttribDivisor(e,p||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Lr.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new St(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=B6(n.constructor,s);L6({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:ve(!1)}}static _setConstantIntArray(e,n,r){switch(ve(nt(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:ve(!1)}}static _setConstantUintArray(e,n,r){switch(ve(nt(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:ve(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return ve(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const O6="VertexArray: attributes must be Buffers or constants (i.e. typed array)",F6=/^(.+)__LOCATION_([0-9]+)$/,D6=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class k6{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Lr(e),J3(this,"VertexArray","v6.0",D6),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new St(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof St&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof St&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,Le.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const c=this._getAttributeInfo(a||o);if(!c)return s;const h=this.accessors[o]||{},p=_r.resolve(c.accessor,h,r,i),{size:m,type:v}=p;return ve(Number.isFinite(m)&&Number.isFinite(v)),{location:o,accessor:p}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=F6.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof St)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof St){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof St){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(O6)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Lr.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Lr.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof St){const a=r;if(o){const c=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,c)}else{const c=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,c)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Le.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function N6(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=VA(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function VA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return N6(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function bw(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;ve(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,c={},h=Object.keys(a).sort();let p=0;for(const E of h)!E.match(s)&&!E.match(o)&&tg({table:c,header:e,uniforms:r,uniformName:E,undefinedOnly:i})&&p++;for(const E of h)E.match(o)&&tg({table:c,header:e,uniforms:r,uniformName:E,undefinedOnly:i})&&p++;for(const E of h)c[E]||tg({table:c,header:e,uniforms:r,uniformName:E,undefinedOnly:i})&&p++;let m=0;const v={};if(!i)for(const E in r){const b=r[E];c[E]||(m++,v[E]={Type:"NOT USED: ".concat(b),[e]:VA(b)})}return{table:c,count:p,unusedTable:v,unusedCount:m}}function tg(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=U6(o);return!s||!a?(e[i]={[n]:a?VA(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function U6(t){return t!=null}function G6(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=xw(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const c=e.accessors[o.location];c&&(a="".concat(s,": ").concat(z6(o.name,c))),r[a]=xw(e,i[s],c,n)}}return r}function xw(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,c=0,h,p,m;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),h=s.indexOf("nt")!==-1),e instanceof St){const v=e,{data:E,changed:b}=v.getDebugData();p=b?"*":"",m=E,c=v.byteLength,a=c/E.BYTES_PER_ELEMENT/o;let x;if(n){const I=n.divisor>0;x="".concat(I?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(c," bytes ").concat(ao(i,s),")")}else h=!0,x="".concat(c," bytes");return{[r]:"".concat(p).concat(VA(m,{size:o,isInteger:h})),"Format ":x}}return m=e,o=e.length,s=String(e.constructor.name).replace("Array",""),h=s.indexOf("nt")!==-1,{[r]:"".concat(VA(m,{size:o,isInteger:h})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function z6(t,e){const{type:n,size:r}=e,i=aP(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function V6(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=Cw(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=Cw(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function Cw(t){const{type:e,size:n}=t.accessor,r=aP(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const Sw=Ts()&&typeof document<"u";let H6=0;class j6{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=I=>X3(I),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:c=null,glOptions:h={},debug:p=!1,createFramebuffer:m=!1,autoResizeViewport:v=!0,autoResizeDrawingBuffer:E=!0,stats:b=zo.get("animation-loop-".concat(H6++))}=e;let{useDevicePixels:x=!0}=e;"useDevicePixelRatio"in e&&(Le.deprecated("useDevicePixelRatio","useDevicePixels")(),x=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:c,glOptions:h,debug:p,createFramebuffer:m},this.gl=c,this.needsRedraw=null,this.timeline=null,this.stats=b,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:v,autoResizeDrawingBuffer:E,useDevicePixels:x}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return ve(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=fd.isSupported(this.gl,["timers"])?new fd(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return Le.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Sw?new Promise((e,n)=>{if(Sw&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):KN(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):JN(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?o_(this.props.gl,e):this.onCreateContext(e),!s0(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");NN(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&HN(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new mn(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const vu="vs",u_="fs";function Nr(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const ng={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function W6(t){const e={};for(const n in t){const r=t[n],i=Q6(r);e[n]=i}return e}function Q6(t){let e=Pw(t);return e==="object"?t?"type"in t?Object.assign({},t,ng[t.type]):"value"in t?(e=Pw(t.value),Object.assign({type:e},t,ng[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},ng[e])}function Pw(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const $6="vs",X6="fs";class Mw{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:c=[],defines:h={},inject:p={},vertexShader:m,fragmentShader:v}=e;Nr(typeof n=="string"),this.name=n,this.vs=r||m,this.fs=i||v,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=h,this.injections=Y6(p),o&&(this.uniforms=W6(o))}getModuleSource(e){let n;switch(e){case $6:n=this.vs||"";break;case X6:n=this.fs||"";break;default:Nr(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Nr(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function Y6(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function J6(t){return K6(uP(t))}function K6(t){const e={},n={};return AP({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function AP(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&AP({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function uP(t,e){return t.map(n=>(n instanceof Mw||(Nr(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Nr(n.name,"shader module has no name"),n=new Mw(n),n.dependencies=uP(n.dependencies)),n))}function Z6(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const q6=7936,e5=7937,t5=7938,n5=35724,f_={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},ko={};Object.keys(f_).forEach(t=>{ko[t]=t});function r5(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function i5(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||q6),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||e5);return{gpuVendor:s5(n,r),vendor:n,renderer:r,version:t.getParameter(t5),shadingLanguageVersion:t.getParameter(n5)}}function s5(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const rg={};function Iw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=f_[e];if(Nr(r,e),!Z6(n))return!0;if(e in rg)return rg[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const c=t.getShaderParameter(a,35713);return t.deleteShader(a),rg[e]=c,c}function o5(t,e){const n=f_[e];Nr(n,e);const r=r5(t)&&n[1]||n[0],i=typeof r=="string"?Boolean(t.getExtension(r)):r;return Nr(i===!1||i===!0),i}function Ef(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>o5(t,n))}function a5(t){switch(i5(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function l5(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Ef(t,ko.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Ef(t,ko.GLSL_DERIVATIVES)&&Iw(t,ko.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Ef(t,ko.GLSL_FRAG_DATA)&&Iw(t,ko.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Ef(t,ko.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const c5=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,A5=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,u5={[vu]:c5,[u_]:A5},Eh="__LUMA_INJECT_DECLARATIONS__",Bw=/void\s+main\s*\([^)]*\)\s*\{\n?/,Lw=/}\n?[^{}]*$/,ig=[];function Rw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===vu;for(const s in n){const o=n[s];o.sort((c,h)=>c.order-h.order),ig.length=o.length;for(let c=0,h=o.length;c<h;++c)ig[c]=o[c].injection;const a="".concat(ig.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(Eh,a));break;case"vs:#main-start":i&&(t=t.replace(Bw,c=>c+a));break;case"vs:#main-end":i&&(t=t.replace(Lw,c=>a+c));break;case"fs:#decl":i||(t=t.replace(Eh,a));break;case"fs:#main-start":i||(t=t.replace(Bw,c=>c+a));break;case"fs:#main-end":i||(t=t.replace(Lw,c=>a+c));break;default:t=t.replace(s,c=>c+a)}}return t=t.replace(Eh,""),r&&(t=t.replace(/\}\s*$/,s=>s+u5[e])),t}function c1(t){const e={};return Nr(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function zl(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const fP=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],f5=[...fP,[zl("attribute"),"in $1"],[zl("varying"),"out $1"]],h5=[...fP,[zl("varying"),"in $1"]],hP=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],d5=[...hP,[zl("in"),"attribute $1"],[zl("out"),"varying $1"]],p5=[...hP,[zl("in"),"varying $1"]],A1="gl_FragColor",u1=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,g5=/void\s+main\s*\([^)]*\)\s*\{\n?/;function m5(t,e,n){switch(e){case 300:return n?hd(t,f5):y5(t);case 100:return n?hd(t,d5):_5(t);default:throw new Error("unknown GLSL version ".concat(e))}}function hd(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function y5(t){t=hd(t,h5);const e=t.match(u1);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(A1,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(g5,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(A1,"\\b"),"g"),n)}return t}function _5(t){t=hd(t,p5);const e=t.match(u1);if(e){const n=e[1];t=t.replace(u1,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),A1)}return t}const v5=`

`.concat(Eh,`

`),dP={[vu]:"vertex",[u_]:"fragment"},E5=`precision highp float;

`;function w5(t,e){const{vs:n,fs:r}=e,i=J6(e.modules||[]);return{gl:t,vs:Ow(t,Object.assign({},e,{source:n,type:vu,modules:i})),fs:Ow(t,Object.assign({},e,{source:r,type:u_,modules:i})),getUniforms:T5(i)}}function Ow(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:c={},transpileToGLSL100:h=!1,prologue:p=!0,log:m}=e;Nr(typeof r=="string","shader source must be a string");const v=i===vu,E=r.split(`
`);let b=100,x="",I=r;E[0].indexOf("#version ")===0?(b=300,x=E[0],I=E.slice(1).join(`
`)):x="#version ".concat(b);const S={};s.forEach(X=>{Object.assign(S,X.getDefines())}),Object.assign(S,o);let P=p?"".concat(x,`
`).concat(x5({id:n,source:r,type:i}),`
`).concat(b5({type:i}),`
`).concat(a5(t),`
`).concat(l5(t),`
`).concat(C5(S),`
`).concat(v?"":E5,`
`):"".concat(x,`
`);const M=P5(a),O={},N={},z={};for(const X in c){const Z=typeof c[X]=="string"?{injection:c[X],order:0}:c[X],Q=X.match(/^(v|f)s:(#)?([\w-]+)$/);if(Q){const k=Q[2],D=Q[3];k?D==="decl"?N[X]=[Z]:z[X]=[Z]:O[X]=[Z]}else z[X]=[Z]}for(const X of s){m&&X.checkDeprecations(I,m),P+=X.getModuleSource(i,b);const Q=X.injections[i];for(const k in Q){const D=k.match(/^(v|f)s:#([\w-]+)$/);if(D){const se=D[2]==="decl"?N:z;se[k]=se[k]||[],se[k].push(Q[k])}else O[k]=O[k]||[],O[k].push(Q[k])}}return P+=v5,P=Rw(P,i,N),P+=S5(M[i],O),P+=I,P=Rw(P,i,z),P=m5(P,h?100:b,v),P}function T5(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function b5(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(dP[e].toUpperCase(),`
`)}function x5(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(dP[r],`

`):""}function C5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function S5(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function P5(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const M5="void main() {gl_FragColor = vec4(0);}",pP=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,I5=`#version 300 es
`.concat(pP);function gP(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function mP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?I5:e>300?"#version ".concat(e,`
`).concat(pP):M5;const s=R5(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function B5(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Nr(!1),null}}function L5(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Nr(!1),null}}function R5(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Nr(!1),null}}const O5=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,F5={name:"fp32",vs:O5,fs:null};function bi(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const D5=1/Math.PI*180,k5=1/180*Math.PI,bn={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function N5(t,{precision:e=bn.precision}={}){return t=V5(t),"".concat(parseFloat(t.toPrecision(e)))}function Ao(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function U5(t){return z5(t)}function G5(t){return Jc(t)}function z5(t,e){return h_(t,n=>n*k5,e)}function Jc(t,e){return h_(t,n=>n*D5,e)}function On(t,e,n){return h_(t,r=>Math.max(e,Math.min(n,r)))}function Ii(t,e,n){return Ao(t)?t.map((r,i)=>Ii(r,e[i],n)):n*e+(1-n)*t}function Ur(t,e,n){const r=bn.EPSILON;n&&(bn.EPSILON=n);try{if(t===e)return!0;if(Ao(t)&&Ao(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Ur(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=bn.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{bn.EPSILON=r}}function V5(t){return Math.round(t/bn.EPSILON)*bn.EPSILON}function H5(t){return t.clone?t.clone():new Array(t.length)}function h_(t,e,n){if(Ao(t)){const r=t;n=n||H5(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function j5(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class d_ extends j5(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Ao(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(bn)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+N5(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Ur(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(bn.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function W5(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function wt(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function pA(t,e,n=""){if(bn.debug&&!W5(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class p_ extends d_{get x(){return this[0]}set x(e){this[0]=wt(e)}get y(){return this[1]}set y(e){this[1]=wt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return wt(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return wt(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return bi(e>=0&&e<this.ELEMENTS,"index is out of range"),wt(this[e])}setComponent(e,n){return bi(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var gA=1e-6,Oi=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Q5(){var t=new Oi(2);return Oi!=Float32Array&&(t[0]=0,t[1]=0),t}function dd(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function yP(t,e){return t[0]=-e[0],t[1]=-e[1],t}function _P(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function $5(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function X5(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function vP(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function EP(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=Q5();return function(e,n,r,i,s,o){var a,c;for(n||(n=2),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function wP(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function TP(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function Y5(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function J5(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function bP(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}class g_ extends p_{constructor(e=0,n=0){super(2),Ao(e)&&arguments.length===1?this.copy(e):(bn.debug&&(wt(e),wt(n)),this[0]=e,this[1]=n)}set(e,n){return this[0]=e,this[1]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return bn.debug&&(wt(e.x),wt(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return EP(this,this,e),this.check()}transformAsVector(e){return wP(this,this,e),this.check()}transformByMatrix3(e){return vP(this,this,e),this.check()}transformByMatrix2x3(e){return X5(this,this,e),this.check()}transformByMatrix2(e){return $5(this,this,e),this.check()}}function xP(){var t=new Oi(3);return Oi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function CP(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Fw(t,e,n){var r=new Oi(3);return r[0]=t,r[1]=e,r[2]=n,r}function K5(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Z5(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function q5(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function eU(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function m_(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function wh(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],c=n[2];return t[0]=i*c-s*a,t[1]=s*o-r*c,t[2]=r*a-i*o,t}function tU(t,e,n,r){var i=e[0],s=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t}function y_(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function SP(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function PP(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],c=e[1],h=e[2],p=i*h-s*c,m=s*a-r*h,v=r*c-i*a,E=i*v-s*m,b=s*p-r*v,x=r*m-i*p,I=o*2;return p*=I,m*=I,v*=I,E*=2,b*=2,x*=2,t[0]=a+p+E,t[1]=c+m+b,t[2]=h+v+x,t}function nU(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function rU(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function iU(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function sU(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],c=Math.sqrt(n*n+r*r+i*i),h=Math.sqrt(s*s+o*o+a*a),p=c*h,m=p&&m_(t,e)/p;return Math.acos(Math.min(Math.max(m,-1),1))}var MP=K5,IP=CP,sg=Z5;(function(){var t=xP();return function(e,n,r,i,s,o){var a,c;for(n||(n=3),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const og=[0,0,0];let wf;class ee extends p_{static get ZERO(){return wf||(wf=new ee(0,0,0),Object.freeze(wf)),wf}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Ao(e)?this.copy(e):(bn.debug&&(wt(e),wt(n),wt(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return bn.debug&&(wt(e.x),wt(e.y),wt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=wt(e)}angle(e){return sU(this,e)}cross(e){return wh(this,this,e),this.check()}rotateX({radians:e,origin:n=og}){return nU(this,this,n,e),this.check()}rotateY({radians:e,origin:n=og}){return rU(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=og}){return iU(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return y_(this,this,e),this.check()}transformAsVector(e){return TP(this,this,e),this.check()}transformByMatrix3(e){return SP(this,this,e),this.check()}transformByMatrix2(e){return Y5(this,this,e),this.check()}transformByQuaternion(e){return PP(this,this,e),this.check()}}let Tf;class __ extends p_{static get ZERO(){return Tf||(Tf=new __(0,0,0,0),Object.freeze(Tf)),Tf}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),Ao(e)&&arguments.length===1?this.copy(e):(bn.debug&&(wt(e),wt(n),wt(r),wt(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return bn.debug&&(wt(e.x),wt(e.y),wt(e.z),wt(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=wt(e)}get w(){return this[3]}set w(e){this[3]=wt(e)}transform(e){return y_(this,this,e),this.check()}transformByMatrix3(e){return bP(this,this,e),this.check()}transformByMatrix2(e){return J5(this,this,e),this.check()}transformByQuaternion(e){return PP(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class BP extends d_{toString(){let e="[";if(bn.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=wt(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function oU(){var t=new Oi(9);return Oi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function aU(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function lU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],p=e[8],m=p*o-a*h,v=-p*s+a*c,E=h*s-o*c,b=n*m+r*v+i*E;return b?(b=1/b,t[0]=m*b,t[1]=(-p*r+i*h)*b,t[2]=(a*r-i*o)*b,t[3]=v*b,t[4]=(p*n-i*c)*b,t[5]=(-a*n+i*s)*b,t[6]=E*b,t[7]=(-h*n+r*c)*b,t[8]=(o*n-r*s)*b,t):null}function cU(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],c=t[7],h=t[8];return e*(h*s-o*c)+n*(-h*i+o*a)+r*(c*i-s*a)}function Dw(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],h=e[6],p=e[7],m=e[8],v=n[0],E=n[1],b=n[2],x=n[3],I=n[4],S=n[5],P=n[6],M=n[7],O=n[8];return t[0]=v*r+E*o+b*h,t[1]=v*i+E*a+b*p,t[2]=v*s+E*c+b*m,t[3]=x*r+I*o+S*h,t[4]=x*i+I*a+S*p,t[5]=x*s+I*c+S*m,t[6]=P*r+M*o+O*h,t[7]=P*i+M*a+O*p,t[8]=P*s+M*c+O*m,t}function AU(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],h=e[6],p=e[7],m=e[8],v=n[0],E=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=c,t[6]=v*r+E*o+h,t[7]=v*i+E*a+p,t[8]=v*s+E*c+m,t}function uU(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],h=e[6],p=e[7],m=e[8],v=Math.sin(n),E=Math.cos(n);return t[0]=E*r+v*o,t[1]=E*i+v*a,t[2]=E*s+v*c,t[3]=E*o-v*r,t[4]=E*a-v*i,t[5]=E*c-v*s,t[6]=h,t[7]=p,t[8]=m,t}function kw(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function fU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,c=i+i,h=n*o,p=r*o,m=r*a,v=i*o,E=i*a,b=i*c,x=s*o,I=s*a,S=s*c;return t[0]=1-m-b,t[3]=p-S,t[6]=v+I,t[1]=p+S,t[4]=1-h-b,t[7]=E-x,t[2]=v-I,t[5]=E+x,t[8]=1-h-m,t}var f1;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(f1||(f1={}));const hU=Object.freeze([1,0,0,0,1,0,0,0,1]);class xn extends BP{static get IDENTITY(){return pU()}static get ZERO(){return dU()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return f1}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(hU)}fromObject(e){return this.check()}fromQuaternion(e){return fU(this,e),this.check()}set(e,n,r,i,s,o,a,c,h){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=h,this.check()}setRowMajor(e,n,r,i,s,o,a,c,h){return this[0]=e,this[1]=i,this[2]=a,this[3]=n,this[4]=s,this[5]=c,this[6]=r,this[7]=o,this[8]=h,this.check()}determinant(){return cU(this)}transpose(){return aU(this,this),this.check()}invert(){return lU(this,this),this.check()}multiplyLeft(e){return Dw(this,e,this),this.check()}multiplyRight(e){return Dw(this,this,e),this.check()}rotate(e){return uU(this,this,e),this.check()}scale(e){return Array.isArray(e)?kw(this,this,e):kw(this,this,[e,e]),this.check()}translate(e){return AU(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=vP(n||[-0,-0],e,this);break;case 3:r=SP(n||[-0,-0,-0],e,this);break;case 4:r=bP(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return pA(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let bf,xf;function dU(){return bf||(bf=new xn([0,0,0,0,0,0,0,0,0]),Object.freeze(bf)),bf}function pU(){return xf||(xf=new xn,Object.freeze(xf)),xf}function gU(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mU(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function h1(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],p=e[8],m=e[9],v=e[10],E=e[11],b=e[12],x=e[13],I=e[14],S=e[15],P=n*a-r*o,M=n*c-i*o,O=n*h-s*o,N=r*c-i*a,z=r*h-s*a,X=i*h-s*c,Z=p*x-m*b,Q=p*I-v*b,k=p*S-E*b,D=m*I-v*x,ne=m*S-E*x,se=v*S-E*I,oe=P*se-M*ne+O*D+N*k-z*Q+X*Z;return oe?(oe=1/oe,t[0]=(a*se-c*ne+h*D)*oe,t[1]=(i*ne-r*se-s*D)*oe,t[2]=(x*X-I*z+S*N)*oe,t[3]=(v*z-m*X-E*N)*oe,t[4]=(c*k-o*se-h*Q)*oe,t[5]=(n*se-i*k+s*Q)*oe,t[6]=(I*O-b*X-S*M)*oe,t[7]=(p*X-v*O+E*M)*oe,t[8]=(o*ne-a*k+h*Z)*oe,t[9]=(r*k-n*ne-s*Z)*oe,t[10]=(b*z-x*O+S*P)*oe,t[11]=(m*O-p*z-E*P)*oe,t[12]=(a*Q-o*D-c*Z)*oe,t[13]=(n*D-r*Q+i*Z)*oe,t[14]=(x*M-b*N-I*P)*oe,t[15]=(p*N-m*M+v*P)*oe,t):null}function yU(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],c=t[7],h=t[8],p=t[9],m=t[10],v=t[11],E=t[12],b=t[13],x=t[14],I=t[15],S=e*o-n*s,P=e*a-r*s,M=e*c-i*s,O=n*a-r*o,N=n*c-i*o,z=r*c-i*a,X=h*b-p*E,Z=h*x-m*E,Q=h*I-v*E,k=p*x-m*b,D=p*I-v*b,ne=m*I-v*x;return S*ne-P*D+M*k+O*Q-N*Z+z*X}function Yo(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],h=e[6],p=e[7],m=e[8],v=e[9],E=e[10],b=e[11],x=e[12],I=e[13],S=e[14],P=e[15],M=n[0],O=n[1],N=n[2],z=n[3];return t[0]=M*r+O*a+N*m+z*x,t[1]=M*i+O*c+N*v+z*I,t[2]=M*s+O*h+N*E+z*S,t[3]=M*o+O*p+N*b+z*P,M=n[4],O=n[5],N=n[6],z=n[7],t[4]=M*r+O*a+N*m+z*x,t[5]=M*i+O*c+N*v+z*I,t[6]=M*s+O*h+N*E+z*S,t[7]=M*o+O*p+N*b+z*P,M=n[8],O=n[9],N=n[10],z=n[11],t[8]=M*r+O*a+N*m+z*x,t[9]=M*i+O*c+N*v+z*I,t[10]=M*s+O*h+N*E+z*S,t[11]=M*o+O*p+N*b+z*P,M=n[12],O=n[13],N=n[14],z=n[15],t[12]=M*r+O*a+N*m+z*x,t[13]=M*i+O*c+N*v+z*I,t[14]=M*s+O*h+N*E+z*S,t[15]=M*o+O*p+N*b+z*P,t}function pd(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,c,h,p,m,v,E,b,x,I,S;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],c=e[2],h=e[3],p=e[4],m=e[5],v=e[6],E=e[7],b=e[8],x=e[9],I=e[10],S=e[11],t[0]=o,t[1]=a,t[2]=c,t[3]=h,t[4]=p,t[5]=m,t[6]=v,t[7]=E,t[8]=b,t[9]=x,t[10]=I,t[11]=S,t[12]=o*r+p*i+b*s+e[12],t[13]=a*r+m*i+x*s+e[13],t[14]=c*r+v*i+I*s+e[14],t[15]=h*r+E*i+S*s+e[15]),t}function v_(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function _U(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),c,h,p,m,v,E,b,x,I,S,P,M,O,N,z,X,Z,Q,k,D,ne,se,oe,xe;return a<gA?null:(a=1/a,i*=a,s*=a,o*=a,c=Math.sin(n),h=Math.cos(n),p=1-h,m=e[0],v=e[1],E=e[2],b=e[3],x=e[4],I=e[5],S=e[6],P=e[7],M=e[8],O=e[9],N=e[10],z=e[11],X=i*i*p+h,Z=s*i*p+o*c,Q=o*i*p-s*c,k=i*s*p-o*c,D=s*s*p+h,ne=o*s*p+i*c,se=i*o*p+s*c,oe=s*o*p-i*c,xe=o*o*p+h,t[0]=m*X+x*Z+M*Q,t[1]=v*X+I*Z+O*Q,t[2]=E*X+S*Z+N*Q,t[3]=b*X+P*Z+z*Q,t[4]=m*k+x*D+M*ne,t[5]=v*k+I*D+O*ne,t[6]=E*k+S*D+N*ne,t[7]=b*k+P*D+z*ne,t[8]=m*se+x*oe+M*xe,t[9]=v*se+I*oe+O*xe,t[10]=E*se+S*oe+N*xe,t[11]=b*se+P*oe+z*xe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function LP(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],c=e[7],h=e[8],p=e[9],m=e[10],v=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+h*r,t[5]=o*i+p*r,t[6]=a*i+m*r,t[7]=c*i+v*r,t[8]=h*i-s*r,t[9]=p*i-o*r,t[10]=m*i-a*r,t[11]=v*i-c*r,t}function vU(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],h=e[8],p=e[9],m=e[10],v=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-h*r,t[1]=o*i-p*r,t[2]=a*i-m*r,t[3]=c*i-v*r,t[8]=s*r+h*i,t[9]=o*r+p*i,t[10]=a*r+m*i,t[11]=c*r+v*i,t}function RP(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],h=e[4],p=e[5],m=e[6],v=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+h*r,t[1]=o*i+p*r,t[2]=a*i+m*r,t[3]=c*i+v*r,t[4]=h*i-s*r,t[5]=p*i-o*r,t[6]=m*i-a*r,t[7]=v*i-c*r,t}function EU(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],c=e[8],h=e[9],p=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,o,a),t[2]=Math.hypot(c,h,p),t}function wU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,c=i+i,h=n*o,p=r*o,m=r*a,v=i*o,E=i*a,b=i*c,x=s*o,I=s*a,S=s*c;return t[0]=1-m-b,t[1]=p+S,t[2]=v-I,t[3]=0,t[4]=p-S,t[5]=1-h-b,t[6]=E+x,t[7]=0,t[8]=v+I,t[9]=E-x,t[10]=1-h-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function TU(t,e,n,r,i,s,o){var a=1/(n-e),c=1/(i-r),h=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*c,t[10]=(o+s)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*h,t[15]=0,t}function bU(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var xU=bU;function CU(t,e,n,r,i,s,o){var a=1/(e-n),c=1/(r-i),h=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*c,t[14]=(o+s)*h,t[15]=1,t}var SU=CU;function PU(t,e,n,r){var i,s,o,a,c,h,p,m,v,E,b=e[0],x=e[1],I=e[2],S=r[0],P=r[1],M=r[2],O=n[0],N=n[1],z=n[2];return Math.abs(b-O)<gA&&Math.abs(x-N)<gA&&Math.abs(I-z)<gA?gU(t):(p=b-O,m=x-N,v=I-z,E=1/Math.hypot(p,m,v),p*=E,m*=E,v*=E,i=P*v-M*m,s=M*p-S*v,o=S*m-P*p,E=Math.hypot(i,s,o),E?(E=1/E,i*=E,s*=E,o*=E):(i=0,s=0,o=0),a=m*o-v*s,c=v*i-p*o,h=p*s-m*i,E=Math.hypot(a,c,h),E?(E=1/E,a*=E,c*=E,h*=E):(a=0,c=0,h=0),t[0]=i,t[1]=a,t[2]=p,t[3]=0,t[4]=s,t[5]=c,t[6]=m,t[7]=0,t[8]=o,t[9]=h,t[10]=v,t[11]=0,t[12]=-(i*b+s*x+o*I),t[13]=-(a*b+c*x+h*I),t[14]=-(p*b+m*x+v*I),t[15]=1,t)}function MU(){var t=new Oi(4);return Oi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function IU(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function E_(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function BU(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function LU(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function RU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t}function OU(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function FU(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a),t}function ql(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}function DU(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],c=n[2],h=n[3],p=h*r+a*s-c*i,m=h*i+c*r-o*s,v=h*s+o*i-a*r,E=-o*r-a*i-c*s;return t[0]=p*h+E*-o+m*-c-v*-a,t[1]=m*h+E*-a+v*-o-p*-c,t[2]=v*h+E*-c+p*-a-m*-o,t[3]=e[3],t}(function(){var t=MU();return function(e,n,r,i,s,o){var a,c;for(n||(n=4),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var d1;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(d1||(d1={}));const kU=45*Math.PI/180,NU=1,ag=.1,lg=500,UU=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ye extends BP{static get IDENTITY(){return zU()}static get ZERO(){return GU()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return d1}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,c,h,p,m,v,E,b,x,I){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=h,this[9]=p,this[10]=m,this[11]=v,this[12]=E,this[13]=b,this[14]=x,this[15]=I,this.check()}setRowMajor(e,n,r,i,s,o,a,c,h,p,m,v,E,b,x,I){return this[0]=e,this[1]=s,this[2]=h,this[3]=E,this[4]=n,this[5]=o,this[6]=p,this[7]=b,this[8]=r,this[9]=a,this[10]=m,this[11]=x,this[12]=i,this[13]=c,this[14]=v,this[15]=I,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(UU)}fromObject(e){return this.check()}fromQuaternion(e){return wU(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=ag,far:a=lg}=e;return a===1/0?VU(this,n,r,i,s,o):TU(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return PU(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=ag,far:a=lg}=e;return SU(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=kU,aspect:r=NU,focalDistance:i=1,near:s=ag,far:o=lg}=e;Nw(n);const a=n/2,c=i*Math.tan(a),h=c*r;return this.ortho({left:-h,right:h,bottom:-c,top:c,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return Nw(n),xU(this,n,r,i,s),this.check()}determinant(){return yU(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return mU(this,this),this.check()}invert(){return h1(this,this),this.check()}multiplyLeft(e){return Yo(this,e,this),this.check()}multiplyRight(e){return Yo(this,this,e),this.check()}rotateX(e){return LP(this,this,e),this.check()}rotateY(e){return vU(this,this,e),this.check()}rotateZ(e){return RP(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return _U(this,this,e,n),this.check()}scale(e){return v_(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return pd(this,this,e),this.check()}transform(e,n){return e.length===4?(n=ql(n||[-0,-0,-0,-0],e,this),pA(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=EP(n||[-0,-0],e,this);break;case 3:i=y_(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return pA(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=wP(n||[-0,-0],e,this);break;case 3:r=TP(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return pA(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Cf,Sf;function GU(){return Cf||(Cf=new Ye([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Cf)),Cf}function zU(){return Sf||(Sf=new Ye,Object.freeze(Sf)),Sf}function Nw(t){if(t>Math.PI*2)throw Error("expected radians")}function VU(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),c=(n+e)/(n-e),h=(i+r)/(i-r),p=-1,m=-1,v=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=h,t[10]=p,t[11]=m,t[12]=0,t[13]=0,t[14]=v,t[15]=0,t}function Uw(){var t=new Oi(4);return Oi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function HU(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function OP(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Gw(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=n[0],c=n[1],h=n[2],p=n[3];return t[0]=r*p+o*a+i*h-s*c,t[1]=i*p+o*c+s*a-r*h,t[2]=s*p+o*h+r*c-i*a,t[3]=o*p-r*a-i*c-s*h,t}function jU(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*a,t[1]=i*c+s*a,t[2]=s*c-i*a,t[3]=o*c-r*a,t}function WU(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c-s*a,t[1]=i*c+o*a,t[2]=s*c+r*a,t[3]=o*c-i*a,t}function QU(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*a,t[1]=i*c-r*a,t[2]=s*c+o*a,t[3]=o*c-s*a,t}function $U(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Th(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3],c=n[0],h=n[1],p=n[2],m=n[3],v,E,b,x,I;return E=i*c+s*h+o*p+a*m,E<0&&(E=-E,c=-c,h=-h,p=-p,m=-m),1-E>gA?(v=Math.acos(E),b=Math.sin(v),x=Math.sin((1-r)*v)/b,I=Math.sin(r*v)/b):(x=1-r,I=r),t[0]=x*i+I*c,t[1]=x*s+I*h,t[2]=x*o+I*p,t[3]=x*a+I*m,t}function XU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=s*a,t}function YU(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function FP(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[o*3+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+o]-e[o*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[o]=(e[o*3+i]+e[i*3+o])*r}return t}var JU=IU,KU=E_,ZU=OU,qU=FU,eG=BU,tG=LU,DP=RU,nG=function(){var t=xP(),e=Fw(1,0,0),n=Fw(0,1,0);return function(r,i,s){var o=m_(i,s);return o<-.999999?(wh(t,e,i),IP(t)<1e-6&&wh(t,n,i),eU(t,t),OP(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(wh(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,DP(r,r))}}();(function(){var t=Uw(),e=Uw();return function(n,r,i,s,o,a){return Th(t,r,o,a),Th(e,i,s,a),Th(n,t,e,2*a*(1-a)),n}})();(function(){var t=oU();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],DP(e,FP(e,t))}})();const rG=[0,0,0,1];class HA extends d_{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return FP(this,e),this.check()}fromAxisRotation(e,n){return OP(this,e,n),this.check()}identity(){return HU(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=wt(e)}get y(){return this[1]}set y(e){this[1]=wt(e)}get z(){return this[2]}set z(e){this[2]=wt(e)}get w(){return this[3]}set w(e){this[3]=wt(e)}len(){return eG(this)}lengthSquared(){return tG(this)}dot(e){return ZU(this,e)}rotationTo(e,n){return nG(this,e,n),this.check()}add(e){return JU(this,this,e),this.check()}calculateW(){return $U(this,this),this.check()}conjugate(){return YU(this,this),this.check()}invert(){return XU(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(qU(this,e,n,r),this.check())}multiplyRight(e){return Gw(this,this,e),this.check()}multiplyLeft(e){return Gw(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return jU(this,this,e),this.check()}rotateY(e){return WU(this,this,e),this.check()}rotateZ(e){return QU(this,this,e),this.check()}scale(e){return KU(this,this,e),this.check()}slerp(e,n,r){let i,s,o;switch(arguments.length){case 1:({start:i=rG,target:s,ratio:o}=e);break;case 2:i=this,s=e,o=n;break;default:i=e,s=n,o=r}return Th(this,i,s,o),this.check()}transformVector4(e,n=new __){return DU(n,e,this),pA(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const jA={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},zw=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,iG={lightSources:{}};function cg(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function sG(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=cg(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,o)=>{i["lighting_uPointLight[".concat(o,"].color")]=cg(s),i["lighting_uPointLight[".concat(o,"].position")]=s.position,i["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,o)=>{i["lighting_uDirectionalLight[".concat(o,"].color")]=cg(s),i["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function kP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:iG;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},sG({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return kP({lightSources:e})}return{}}const w_={name:"lights",vs:zw,fs:zw,getUniforms:kP,defines:{MAX_LIGHTS:3}},oG=new Uint8Array([0,255,255,255]),aG={pickingSelectedColor:null,pickingHighlightColor:oG,pickingActive:!1,pickingAttribute:!1};function lG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:aG;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}const cG=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,AG=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,uG={name:"picking",vs:cG,fs:AG,getUniforms:lG},NP=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,fG={};function hG(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function UP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fG;if(!("material"in t))return{};const{material:e}=t;return e?hG(e):{lighting_uEnabled:!1}}const T_={name:"gouraud-lighting",dependencies:[w_],vs:NP,defines:{LIGHTING_VERTEX:1},getUniforms:UP},GP={name:"phong-lighting",dependencies:[w_],fs:NP,defines:{LIGHTING_FRAGMENT:1},getUniforms:UP},dG=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,pG=`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,b_={name:"pbr",vs:dG,fs:pG,defines:{LIGHTING_FRAGMENT:1},dependencies:[w_]},gG=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,mG={name:"transform",vs:gG,fs:null};class Eu{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Eu(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:c=!1}=e,h=this._getModuleList(e.modules),p=this._getHash(n),m=this._getHash(r),v=h.map(M=>this._getHash(M.name)).sort(),E=o.map(M=>this._getHash(M)),b=Object.keys(i).sort(),x=Object.keys(s).sort(),I=[],S=[];for(const M of b)I.push(this._getHash(M)),I.push(this._getHash(i[M]));for(const M of x)S.push(this._getHash(M)),S.push(this._getHash(s[M]));const P="".concat(p,"/").concat(m,"D").concat(I.join("/"),"M").concat(v.join("/"),"I").concat(S.join("/"),"V").concat(E.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(c?"T":"");if(!this._programCache[P]){const M=w5(this.gl,{vs:n,fs:r,modules:h,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:c});this._programCache[P]=new lP(this.gl,{hash:P,vs:M.vs,fs:M.fs,varyings:o,bufferMode:a}),this._getUniforms[P]=M.getUniforms||(O=>{}),this._useCounts[P]=0}return this._useCounts[P]++,this._programCache[P]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],c=a.name;n[i++]=a,r[c]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],c=a.name;r[c]||(n[i++]=a,r[c]=!0)}return n.length=i,n}}const yG={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function _G(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=vG(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const c=o.value,h={...o};delete h.value,r[a]=[new St(t,c),h],EG(s,h)}}if(i){const s=i.value||i;ve(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new St(t,{data:s,target:34963}),o]}return r}function vG(t,e){const{attributeMap:n=yG}=e||{};return n&&n[t]||t}function EG(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}ve(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Ia=2,wG=1e4,TG="Model needs drawMode and vertexCount",Vw=()=>{},bG={};class tr{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Ri("model")}=n;ve(s0(e)),this.id=r,this.gl=e,this.id=n.id||Ri("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Eu.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:h,transpileToGLSL100:p}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:h,transpileToGLSL100:p},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},ve(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),TG)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:h,transpileToGLSL100:p}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:h,transpileToGLSL100:p},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return ve(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return ve(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=_G(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Gl(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return l_(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:c=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let h;Le.priority>=Ia&&(h=this._logDrawCallStart(Ia));const p=this.vertexArray.getDrawParams(),{isIndexed:m=p.isIndexed,indexType:v=p.indexType,indexOffset:E=p.indexOffset,vertexArrayInstanced:b=p.isInstanced}=this.props;b&&!this.isInstanced&&Le.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:x,instanceCount:I}=this,{onBeforeRender:S=Vw,onAfterRender:P=Vw}=this.props;S(),this.program.setUniforms(this.uniforms);const M=this.program.draw(Object.assign(bG,e,{logPriority:h,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:c,transformFeedback:o,isIndexed:m,indexType:v,isInstanced:x,instanceCount:I,offset:m?E:0}));return P(),Le.priority>=Ia&&this._logDrawCallEnd(h,c,r),M}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Le.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:c,bufferMode:h,transpileToGLSL100:p}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:c,bufferMode:h,transpileToGLSL100:p}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}ve(n instanceof lP,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new k6(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof St&&n.delete()}}_setAnimationProps(e){this.animated&&ve(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Gl(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new cP(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:wG;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Le.group(Ia,">>> DRAWING MODEL ".concat(this.id),{collapsed:Le.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=G6({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:c}=bw({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:h,count:p}=bw({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});p>0&&Le.log("MISSING UNIFORMS",Object.keys(h))(),c>0&&Le.log("UNUSED UNIFORMS",Object.keys(a))();const m=V6(this.vertexArray.configuration);Le.table(e,s)(),Le.table(e,o)(),Le.table(e+1,m)(),i&&i.log({logLevel:Ia,message:"Rendered to ".concat(i.id)}),Le.groupEnd(Ia)()}}class xG{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof St?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&ve(nt(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:c,accessor:h}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:c,accessor:h})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new cP(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],ve(r[s]instanceof St)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new St(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const CG="transform_uSampler_",gd="transform_uSize_",Hw="transform_position";function SG(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const c={};let h=e,p={};if(o>0||r){const m=h.split(`
`),v=m.slice();if(m.forEach((E,b,x)=>{if(o>0){const I=LG(E,n);if(I){const{updatedLine:S,inject:P}=I;v[b]=S,p=c1([p,P]),Object.assign(c,I.samplerTextureMap),o--}}r&&!a&&(a=BG(E,r))}),r){ve(i);const E="".concat(gd).concat(r),b="uniform vec2 ".concat(E,`;
`),x="     vec2 ".concat(Hw," = transform_getPos(").concat(E,`);
     gl_Position = vec4(`).concat(Hw,`, 0, 1.);
`);p=c1([p,{"vs:#decl":b,"vs:#main-start":x}])}h=v.join(`
`)}return{vs:h,targetTextureType:a,inject:p,samplerTextureMap:c}}function PG(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(gd).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(gd).concat(a)]=[s,o];return i}function MG(t){return gP(t,["attribute","in"])}function IG(t){const e="".concat(CG).concat(t),n="".concat(gd).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function BG(t,e){const n=gP(t,["varying","out"]);return n&&n.name===e?n.type:null}function LG(t,e){const n={},r=MG(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:c,uniformDeclerations:h}=IG(s),p=B5(i),m="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(c,").").concat(p,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":h,"vs:#main-start":m},samplerTextureMap:n}}return null}const RG={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},OG="transform_output";class FG{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),c=Object.assign({},e.parameters);let h=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const m in this.samplerTextureMap){const v=this.samplerTextureMap[m];a[m]=r[v]}this._setSourceTextureParameters();const p=PG({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,p)}return this.hasTargetTexture&&(h=!1,c.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:h,parameters:c}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=a0(n);if(!e)return r;const i=r.constructor,s=L5(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let c=0;c<r.length;c+=4)for(let h=0;h<s;h++)o[a++]=r[c+h];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Hn)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new St(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:c}=e;c?(c.update({attachments:{[36064]:s},resizeAttachments:!1}),c.resize({width:o,height:a})):e.framebuffer=new mn(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{[36064]:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(RG)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=C8(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:c}=SG({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),h=c1([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=c;const p=e._fs||mP({version:oP(i),input:this.targetTextureVarying,inputType:o,output:OG}),m=this.hasSourceTextures||this.targetTextureVarying?[mG].concat(e.modules||[]):e.modules;return{vs:i,fs:p,modules:m,uniforms:s,inject:h}}}class x_{static isSupported(e){return nt(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();ve(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new tr(n,Object.assign({},e,{fs:e.fs||mP({version:oP(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){DG(n)&&(this.bufferTransform=new xG(e,n)),kG(n)&&(this.textureTransform=new FG(e,n)),ve(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function DG(t){return!!(!Gl(t.feedbackBuffers)||!Gl(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function kG(t){return!!(!Gl(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const jw={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Ar{static get DRAW_MODE(){return jw}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ri("geometry"),drawMode:r=jw.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,ve(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(ve(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:c}=s;!c&&o&&a>=1&&(r=Math.min(r,o.length/a))}return ve(Number.isFinite(r)),r}}const NG=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),UG=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),GG=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),zG=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),VG={POSITION:{size:3,value:new Float32Array(UG)},NORMAL:{size:3,value:new Float32Array(GG)},TEXCOORD_0:{size:2,value:new Float32Array(zG)}};class HG extends Ar{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ri("cube-geometry")}=e;super({...e,id:n,indices:{size:1,value:new Uint16Array(NG)},attributes:{...VG,...e.attributes}})}}let jG=1,WG=1;class zP{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=jG++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=WG++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const VP="#define SMOOTH_EDGE_RADIUS 0.5",QG=`
`.concat(VP,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),$G=`
`.concat(VP,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),XG={name:"geometry",vs:QG,fs:$G},$e={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty($e,"IDENTITY",{get:()=>(ze.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const xi={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Vr={common:0,meters:1,pixels:2},Ww={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},wu={DRAW:"draw",MASK:"mask"},YG=Object.keys($e).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat($e[t],";")).join(""),JG=Object.keys(xi).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(xi[t],";")).join(""),KG=Object.keys(Vr).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Vr[t],";")).join(""),ZG="".concat(YG,`
`).concat(JG,`
`).concat(KG,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0; // meters
const float GLOBE_RADIUS = 256.0;

// returns an adjustment factor for uCommonUnitsPerMeter
float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {

    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear
    // Adjust by 1 / cos(latitude)
    // If geometry.position (vertex in common space) is populated, use it
    // Otherwise use geometry.worldPosition (anchor in world space)
    
    if (geometry.position.w == 0.0) {
      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);
      return 1.0 / cos(radians(y));
    }

    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)
    // Taylor series of 1 / cos(latitude)
    // Max error < 0.003
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}
//
// Scaling offsets - scales meters to "world distance"
// Note the scalar version of project_size is for scaling the z component only
//
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}

// Get rotation matrix that aligns the z axis with the given up vector
// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  // Tangent on XY plane
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}

//
// Projecting normal - transform deltas from current coordinate system to
// normals in the worldspace
//
vec3 project_normal(vec3 vector) {
  // Apply model matrix
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

//
// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]
//
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

//
// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)
//
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;

  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size(position_world.z),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        // Too far from the projection center for offset mode to be accurate
        // Only use high parts
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.
    position_world.xyz -= project_uCoordinateOrigin;
  }

  // Translation is already added to the high parts
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}

//
// Projects from common space coordinates to clip space.
// Uses project_uViewProjectionMatrix
//
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}

// Returns a clip space offset that corresponds to a given number of screen pixels
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  // UNIT_PIXELS
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function qG(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Tu(t){let e={},n;return r=>{for(const i in r)if(!qG(r[i],e[i])){n=t(r),e=r;break}return n}}const Qw=[0,0,0,0],ez=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],HP=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],tz=[0,0,0],jP=[0,0,0],nz=Tu(sz);function WP(t,e,n=jP){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===$e.LNGLAT_OFFSETS||e===$e.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case xi.WEB_MERCATOR:(e===$e.LNGLAT||e===$e.CARTESIAN)&&(i=[0,0,0],s=!1);break;case xi.WEB_MERCATOR_AUTO_OFFSET:e===$e.LNGLAT?r=i:e===$e.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case xi.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case xi.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function rz(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=Qw,c=Qw,h=t.cameraPosition;const{geospatialOrigin:p,shaderCoordinateOrigin:m,offsetMode:v}=WP(t,e,n);return v&&(c=t.projectPosition(p||m),h=[h[0]-c[0],h[1]-c[1],h[2]-c[2]],c[3]=1,a=ql([],c,o),s=r||s,o=Yo([],i,s),o=Yo([],o,ez)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:c,cameraPosCommon:h,shaderCoordinateOrigin:m,geospatialOrigin:p}}function iz({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=$e.DEFAULT,coordinateOrigin:i=jP,autoWrapLongitude:s=!1}){r===$e.DEFAULT&&(r=t.isGeospatial?$e.LNGLAT:$e.CARTESIAN);const o=nz({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||HP,o}function sz({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:c,geospatialOrigin:h}=rz(t,n,r),p=t.getDistanceScales(),m=[t.width*e,t.height*e],v=ql([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,E={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:m,project_uDevicePixelRatio:e,project_uFocalDistance:v,project_uCommonUnitsPerMeter:p.unitsPerMeter,project_uCommonUnitsPerWorldUnit:p.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:tz,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:HP,project_uCameraPosition:a};if(h){const b=t.getDistanceScales(h);switch(n){case $e.METER_OFFSETS:E.project_uCommonUnitsPerWorldUnit=b.unitsPerMeter,E.project_uCommonUnitsPerWorldUnit2=b.unitsPerMeter2;break;case $e.LNGLAT:case $e.LNGLAT_OFFSETS:t._pseudoMeters||(E.project_uCommonUnitsPerMeter=b.unitsPerMeter),E.project_uCommonUnitsPerWorldUnit=b.unitsPerDegree,E.project_uCommonUnitsPerWorldUnit2=b.unitsPerDegree2;break;case $e.CARTESIAN:E.project_uCommonUnitsPerWorldUnit=[1,1,b.unitsPerMeter[2]],E.project_uCommonUnitsPerWorldUnit2=[0,0,b.unitsPerMeter2[2]];break}}return E}const oz={};function az(t=oz){return"viewport"in t?iz(t):{}}const C_={name:"project",dependencies:[F5,XG],vs:ZG,getUniforms:az},lz=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,ci={name:"project32",dependencies:[C_],vs:lz};function cz(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function bl(t,e){const n=ql([],e,t);return E_(n,n,1/n[3]),n}function $w(t,e){const n=t%e;return n<0?e+n:n}function p1(t,e,n){return t<e?e:t>n?n:t}function Az(t){return Math.log(t)*Math.LOG2E}const S_=Math.log2||Az;function vs(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Ci=Math.PI,QP=Ci/4,Bi=Ci/180,g1=180/Ci,WA=512,m1=4003e4,Pf=85.051129,uz=1.5;function fz(t){return S_(t)}function uo(t){const[e,n]=t;vs(Number.isFinite(e)),vs(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Bi,i=n*Bi,s=WA*(r+Ci)/(2*Ci),o=WA*(Ci+Math.log(Math.tan(QP+i*.5)))/(2*Ci);return[s,o]}function fo(t){const[e,n]=t,r=e/WA*(2*Ci)-Ci,i=2*(Math.atan(Math.exp(n/WA*(2*Ci)-Ci))-QP);return[r*g1,i*g1]}function hz(t){const{latitude:e}=t;vs(Number.isFinite(e));const n=Math.cos(e*Bi);return fz(m1*n)-9}function y1(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;vs(Number.isFinite(e)&&Number.isFinite(n));const i=WA,s=Math.cos(e*Bi),o=i/360,a=o/s,c=i/m1/s,h={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[o,a,c],degreesPerUnit:[1/o,1/a,1/c]};if(r){const p=Bi*Math.tan(e*Bi)/s,m=o*p/2,v=i/m1*p,E=v/a*c;h.unitsPerDegree2=[0,m,v],h.unitsPerMeter2=[E,0,E]}return h}function $P(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:c,unitsPerMeter2:h}=y1({longitude:n,latitude:r,highPrecision:!0}),p=uo(t);p[0]+=s*(c[0]+h[0]*o),p[1]+=o*(c[1]+h[1]*o);const m=fo(p),v=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[m[0],m[1],v]:m}function dz(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=cz();pd(a,a,[0,0,-i]),LP(a,a,-n*Bi),RP(a,a,r*Bi);const c=s/e;return v_(a,a,[c,c,c]),o&&pd(a,a,q5([],o)),a}function pz(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:c=1,farZMultiplier:h=1}=t;let{fovy:p=md(uz)}=t;r!==void 0&&(p=md(r));const m=p*Bi,v=i*Bi,E=XP(p);let b=E;o&&(b+=o[2]*a/Math.cos(v)/n);const x=m*(.5+(s?s[1]:0)/n),I=Math.sin(x)*b/Math.sin(p1(Math.PI/2-v-x,.01,Math.PI-.01)),S=Math.sin(v)*I+b,P=b*10,M=Math.min(S*h,P);return{fov:m,aspect:e/n,focalDistance:E,near:c,far:M}}function md(t){return 2*Math.atan(.5/t)*g1}function XP(t){return .5/Math.tan(.5*t*Bi)}function YP(t,e){const[n,r,i=0]=t;return vs(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),bl(e,[n,r,i,1])}function c0(t,e,n=0){const[r,i,s]=t;if(vs(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return bl(e,[r,i,s,1]);const o=bl(e,[r,i,0,1]),a=bl(e,[r,i,1,1]),c=o[2],h=a[2],p=c===h?0:((n||0)-c)/(h-c);return _P([],o,a,p)}function JP(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,c],[h,p]]=r,m=gz(t.padding),v=uo([a,p1(p,-Pf,Pf)]),E=uo([h,p1(c,-Pf,Pf)]),b=[Math.max(Math.abs(E[0]-v[0]),i),Math.max(Math.abs(E[1]-v[1]),i)],x=[e-m.left-m.right-Math.abs(o[0])*2,n-m.top-m.bottom-Math.abs(o[1])*2];vs(x[0]>0&&x[1]>0);const I=x[0]/b[0],S=x[1]/b[1],P=(m.right-m.left)/2/I,M=(m.top-m.bottom)/2/S,O=[(E[0]+v[0])/2+P,(E[1]+v[1])/2+M],N=fo(O),z=Math.min(s,S_(Math.abs(Math.min(I,S))));return vs(Number.isFinite(z)),{longitude:N[0],latitude:N[1],zoom:z}}function gz(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(vs(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const Xw=Math.PI/180;function mz(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let c,h;const p=t.fovy?.5*t.fovy*Xw:Math.atan(.5/t.altitude),m=(90-t.pitch)*Xw;return p>m-.01?(c=Yw(t,0,e),h=Yw(t,n,e)):(c=i([0,0],s),h=i([n,0],s)),[o,a,h,c]}function Yw(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=bl(r,[e,0,1,1]),s=bl(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),c=_P([],i,s,a),h=fo(c);return h.push(n),h}const Jw=512;function yz(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=$w(i+180,360)-180),(a<-180||a>180)&&(a=$w(a+180,360)-180);const c=S_(n/Jw);if(o<=c)o=c,s=0;else{const h=n/2/Math.pow(2,o),p=fo([0,h])[1];if(s<p)s=p;else{const m=fo([0,Jw-h])[1];s>m&&(s=m)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const _z=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,vz=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,Ez=Tu(Cz),wz=Tu(Sz),Tz=[0,0,0,1],bz=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function xz(t,e){const[n,r,i]=t,s=c0([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function Cz({viewport:t,center:e}){return new Ye(t.viewProjectionMatrix).invert().transform(e)}function Sz({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>xz(o,r));for(const o of e){const a=o.clone().translate(new ee(t.center).negate()),c=s.map(p=>a.transform(p)),h=new Ye().ortho({left:Math.min(...c.map(p=>p[0])),right:Math.max(...c.map(p=>p[0])),bottom:Math.min(...c.map(p=>p[1])),top:Math.max(...c.map(p=>p[1])),near:Math.min(...c.map(p=>-p[2])),far:Math.max(...c.map(p=>-p[2]))});n.push(h.multiplyRight(o))}return n}function Pz(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||Tz,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=Ez({viewport:t.viewport,center:e.project_uCenter}),s=[],o=wz({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const c=o[a],h=c.clone().translate(new ee(t.viewport.center).negate());e.project_uCoordinateSystem===$e.LNGLAT&&e.project_uProjectionMode===xi.WEB_MERCATOR?(o[a]=h,s[a]=i):(o[a]=c.clone().multiplyRight(bz),s[a]=h.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const Ag={name:"shadow",dependencies:[C_],vs:_z,fs:vz,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?Pz(t,e):{}},Ai={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...uG},Mz=[C_],Iz=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Bz(t){const e=Eu.getDefaultProgramManager(t);for(const n of Mz)e.addDefaultModule(n);for(const n of Iz)e.addShaderHook(n);return e}const Lz=[255,255,255],Rz=1;let Oz=0;class KP{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","ambient");const{color:n=Lz}=e,{intensity:r=Rz}=e;this.id=e.id||"ambient-".concat(Oz++),this.color=n,this.intensity=r}}const Fz=[255,255,255],Dz=1,kz=[0,0,-1];let Nz=0;class Kw{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","directional"),T(this,"direction",void 0),T(this,"shadow",void 0);const{color:n=Fz}=e,{intensity:r=Dz}=e,{direction:i=kz}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(Nz++),this.color=n,this.intensity=r,this.type="directional",this.direction=new ee(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class Uz{constructor(e,n={id:"pass"}){T(this,"id",void 0),T(this,"gl",void 0),T(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class A0 extends Uz{constructor(...e){super(...e),T(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return _s(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:c=!0}=e;e.pass=e.pass||"unknown";const h=this.gl;c&&zz(h),a&&(this._lastRenderIndex=-1);const p=[];for(const m of i){const v=s&&s[m.id];o(m);const E=this._getDrawLayerParams(m,e),b=m.subViewports||[m];for(const x of b){const I=this._drawLayersInViewport(h,{target:n,moduleParameters:r,viewport:x,view:v,pass:e.pass,layers:e.layers},E);p.push(I)}}return p}_getDrawLayerParams(e,{layers:n,pass:r,layerFilter:i,cullRect:s,effects:o,moduleParameters:a}){const c=[],h=ZP(this._lastRenderIndex+1),p={layer:n[0],viewport:e,isPicking:r.startsWith("picking"),renderPass:r,cullRect:s},m={};for(let v=0;v<n.length;v++){const E=n[v],b=this._shouldDrawLayer(E,p,i,m),x={shouldDrawLayer:b};b&&(x.layerRenderIndex=h(E,b),x.moduleParameters=this._getModuleParameters(E,o,r,a),x.layerParameters=this.getLayerParameters(E,v,e)),c[v]=x}return c}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},c){const h=Gz(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const m=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;oi(e,{scissorTest:!0,scissor:h},()=>l_(e,m))}const p={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};_s(e,{viewport:h});for(let m=0;m<n.length;m++){const v=n[m],{shouldDrawLayer:E,layerRenderIndex:b,moduleParameters:x,layerParameters:I}=c[m];if(E&&v.props.pickable&&p.pickableCount++,v.isComposite)p.compositeCount++;else if(E){p.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,b),x.viewport=o;try{v._drawLayer({moduleParameters:x,uniforms:{layerIndex:b},parameters:I})}catch(S){v.raiseError(S,"drawing ".concat(v," to ").concat(i))}}}return p}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:Ul(this.gl)});if(n)for(const c of n){var a;Object.assign(o,(a=c.getModuleParameters)===null||a===void 0?void 0:a.call(c,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function ZP(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,c=i.parent&&i.parent.id;let h;if(c&&!(c in e)&&r(i.parent,!1),c in n){const p=n[c]=n[c]||ZP(e[c],e);h=p(i,s),n[a]=p}else Number.isFinite(o)?(h=o+(e[c]||0),n[a]=null):h=t;return s&&h>=t&&(t=h+1),e[a]=h,h};return r}function Gz(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||Ul(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function zz(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;_s(t,{viewport:[0,0,e,n]}),t.clear(16640)}class Vz extends A0{constructor(e,n){super(e,n),T(this,"shadowMap",void 0),T(this,"depthBuffer",void 0),T(this,"fbo",void 0),this.shadowMap=new Hn(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new rl(e,{format:33189,width:1,height:1}),this.fbo=new mn(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;oi(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=Ul(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Hz={color:[255,255,255],intensity:1},Zw=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],jz=[0,0,0,200/255];class P_{constructor(e={}){T(this,"id","lighting-effect"),T(this,"props",null),T(this,"shadowColor",jz),T(this,"shadow",void 0),T(this,"ambientLight",null),T(this,"directionalLights",[]),T(this,"pointLights",[]),T(this,"shadowPasses",[]),T(this,"shadowMaps",[]),T(this,"dummyShadowMap",null),T(this,"programManager",void 0),T(this,"shadowMatrices",void 0);for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow)}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(!!this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Eu.getDefaultProgramManager(e),Ag&&this.programManager.addDefaultModule(Ag)),this.dummyShadowMap||(this.dummyShadowMap=new Hn(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Ag),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Ye().lookAt({eye:new ee(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new Vz(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new KP(Hz),this.directionalLights.push(new Kw(Zw[0]),new Kw(Zw[1])))}}class Wz{constructor(e={}){T(this,"_pool",[]),T(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:c}){const h=i||e&&e.constructor||Float32Array,p=n*r+s;if(ArrayBuffer.isView(e)){if(p<=e.length)return e;if(p*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new h(e.buffer,0,p)}let m=1/0;c&&(m=c*r+s);const v=this._allocate(h,p,a,m);return e&&o?v.set(e):a||v.fill(0,0,4),this._release(e),v}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,c=o.findIndex(h=>h.byteLength>=a);if(c>=0){const h=new e(o.splice(c,1)[0],0,s);return r&&h.fill(0),h}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const Vl=new Wz;function Kc(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Qz(t,e){const n=t%e;return n<0?e+n:n}function $z(t){return[t[12],t[13],t[14]]}function Xz(t){return{left:Ba(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Ba(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Ba(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Ba(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Ba(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Ba(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const qw=new ee;function Ba(t,e,n,r){qw.set(t,e,n);const i=qw.len();return{distance:r/i,normal:new ee(-t/i,-e/i,-n/i)}}function Yz(t){return t-Math.fround(t)}let Bc;function ug(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Bc=Vl.allocate(Bc,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let c=0;c<n;c++){const h=t[o++];Bc[a+c]=h,Bc[a+c+n]=Yz(h)}a+=n*2}return Bc.subarray(0,s*n*2)}const Jz=Math.PI/180,Kz=Kc(),eT=[0,0,0],Zz={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function qz({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const c=t/e,h=n?new Ye().orthographic({fovy:r,aspect:c,focalDistance:i,near:o,far:a}):new Ye().perspective({fovy:r,aspect:c,near:o,far:a});if(s){const{left:p=0,right:m=0,top:v=0,bottom:E=0}=s,b=On((p+t-m)/2,0,t)-t/2,x=On((v+e-E)/2,0,e)-e/2;h[8]-=b*2/t,h[9]+=x*2/e}return h}class yo{constructor(e={}){T(this,"id",void 0),T(this,"x",void 0),T(this,"y",void 0),T(this,"width",void 0),T(this,"height",void 0),T(this,"isGeospatial",void 0),T(this,"zoom",void 0),T(this,"focalDistance",void 0),T(this,"position",void 0),T(this,"modelMatrix",void 0),T(this,"distanceScales",void 0),T(this,"scale",void 0),T(this,"center",void 0),T(this,"cameraPosition",void 0),T(this,"projectionMatrix",void 0),T(this,"viewMatrix",void 0),T(this,"viewMatrixUncentered",void 0),T(this,"viewMatrixInverse",void 0),T(this,"viewProjectionMatrix",void 0),T(this,"pixelProjectionMatrix",void 0),T(this,"pixelUnprojectionMatrix",void 0),T(this,"resolution",void 0),T(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.distanceScales=e.distanceScales||Zz,this.focalDistance=e.focalDistance||1,this.position=e.position||eT,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?xi.WEB_MERCATOR:xi.WEB_MERCATOR_AUTO_OFFSET:xi.IDENTITY}equals(e){return e instanceof yo?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ur(e.projectionMatrix,this.projectionMatrix)&&Ur(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=YP(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,c=r&&r*this.distanceScales.unitsPerMeter[2],h=c0([i,a,o],this.pixelUnprojectionMatrix,c),[p,m,v]=this.unprojectPosition(h);return Number.isFinite(o)?[p,m,v]:Number.isFinite(r)?[p,m,r]:[p,m]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=uo(e);return n[1]=On(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?fo(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?y1({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Xz(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=hz({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||y1({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=eT;if(s&&(a=o?new Ye(o).transformAsVector(s,[]):s),this.isGeospatial){const c=this.projectPosition([n,r,0]);this.center=new ee(a).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=Kz,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:c=1e3,padding:h=null,focalDistance:p=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Ye().multiplyRight(n).translate(new ee(this.center).negate()),this.projectionMatrix=r||qz({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*Jz,focalDistance:p,padding:h,near:a,far:c});const m=Kc();Yo(m,m,this.projectionMatrix),Yo(m,m,this.viewMatrix),this.viewProjectionMatrix=m,this.viewMatrixInverse=h1([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=$z(this.viewMatrixInverse);const v=Kc(),E=Kc();v_(v,v,[this.width/2,-this.height/2,1]),pd(v,v,[1,-1,0]),Yo(E,v,this.viewProjectionMatrix),this.pixelProjectionMatrix=E,this.pixelUnprojectionMatrix=h1(Kc(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ze.warn("Pixel project matrix not invertible")()}}T(yo,"displayName","Viewport");const e9=512,t9=4003e4,n9=Math.PI/180;function tT(t){const e=Math.cos(t*n9);return e9/t9/e}class ts extends yo{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:c=1.01,orthographic:h=!1,projectionMatrix:p,repeat:m=!1,worldOffset:v=0,legacyMeterSizes:E=!1}=e;let{width:b,height:x,altitude:I=1.5}=e;const S=Math.pow(2,i);b=b||1,x=x||1;let P,M=null;p?(I=p[5]/2,P=md(I)):(e.fovy?(P=e.fovy,I=XP(P)):P=md(I),M=pz({width:b,height:x,pitch:s,fovy:P,nearZMultiplier:a,farZMultiplier:c}));let O=dz({height:x,pitch:s,bearing:o,scale:S,altitude:I});v&&(O=new Ye().translate([512*v,0,0]).multiplyLeft(O)),super({...e,width:b,height:x,viewMatrix:O,longitude:r,latitude:n,zoom:i,...M,fovy:P,focalDistance:I}),T(this,"longitude",void 0),T(this,"latitude",void 0),T(this,"pitch",void 0),T(this,"bearing",void 0),T(this,"altitude",void 0),T(this,"fovy",void 0),T(this,"orthographic",void 0),T(this,"_subViewports",void 0),T(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=I,this.fovy=P,this.orthographic=h,this._subViewports=m?[]:null,this._pseudoMeters=E,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new ts({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*tT(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/tT(r);return[n,r,i]}addMetersToLngLat(e,n){return $P(e,n)}panByPosition(e,n){const r=c0(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=dd([],i,yP([],r)),o=dd([],this.center,s),[a,c]=this.unprojectFlat(o);return{longitude:a,latitude:c}}getBounds(e={}){const n=mz(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=JP({width:r,height:i,bounds:e,...n});return new ts({width:r,height:i,longitude:s,latitude:o,zoom:a})}}T(ts,"displayName","WebMercatorViewport");function fg(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof ts){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function r9(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===$e.DEFAULT&&(i=e.isGeospatial?$e.LNGLAT:$e.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function qP(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,c=0]=t;switch(n&&([o,a,c]=ql([],[o,a,c,1],n)),r){case $e.LNGLAT:return fg([o,a,c],e,s);case $e.LNGLAT_OFFSETS:return fg([o+i[0],a+i[1],c+(i[2]||0)],e,s);case $e.METER_OFFSETS:return fg($P(i,[o,a,c]),e,s);case $e.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],c+i[2]]:e.projectPosition([o,a,c])}}function eM(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=r9(e),{geospatialOrigin:c,shaderCoordinateOrigin:h,offsetMode:p}=WP(n,r,i),m=qP(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:p});if(p){const v=n.projectPosition(c||h);MP(m,m,v)}return m}const i9=[255,255,255],s9=1,o9=[0,0,1],a9=[0,0,1];let l9=0;class c9{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","point"),T(this,"position",void 0),T(this,"attenuation",void 0),T(this,"projectedLight",void 0);const{color:n=i9}=e,{intensity:r=s9}=e,{position:i=a9}=e;this.id=e.id||"point-".concat(l9++),this.color=n,this.intensity=r,this.type="point",this.position=i,this.attenuation=A9(e),this.projectedLight={...this}}getProjectedLight({layer:e}){const{projectedLight:n}=this,r=e.context.viewport,{coordinateSystem:i,coordinateOrigin:s}=e.props,o=eM(this.position,{viewport:r,coordinateSystem:i,coordinateOrigin:s,fromCoordinateSystem:r.isGeospatial?$e.LNGLAT:$e.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=o,n}}function A9(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:o9}const Ha={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},yd=Symbol.for("component"),xl=Symbol.for("asyncPropDefaults"),ia=Symbol.for("asyncPropOriginal"),Js=Symbol.for("asyncPropResolved");function u0(t,e=()=>!0){return Array.isArray(t)?tM(t,e,[]):e(t)?[t]:[]}function tM(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?tM(i,e,n):e(i)&&n.push(i)}return n}function u9({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class f9{constructor(e,n,r){T(this,"id",void 0),T(this,"context",void 0),T(this,"isLoaded",void 0),T(this,"persistent",void 0),T(this,"_loadCount",0),T(this,"_subscribers",new Set),T(this,"_data",void 0),T(this,"_loader",void 0),T(this,"_error",void 0),T(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=ys(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class h9{constructor({gl:e,protocol:n}){T(this,"protocol",void 0),T(this,"_context",void 0),T(this,"_resources",void 0),T(this,"_consumers",void 0),T(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new f9(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},c=a.resourceId&&this._resources[a.resourceId];c&&(c.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const d9="layerManager.setLayers",p9="layerManager.activateViewport";class g9{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){T(this,"layers",void 0),T(this,"context",void 0),T(this,"resourceManager",void 0),T(this,"_lastRenderedLayers",[]),T(this,"_needsRedraw",!1),T(this,"_needsUpdate",!1),T(this,"_nextLayers",null),T(this,"_debug",!1),T(this,"activateViewport",o=>{Jn(p9,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new h9({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&Bz(e),stats:r||new pu({id:"deck.gl"}),viewport:i||new yo({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new zP,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Jn(d9,this,n,e),this._lastRenderedLayers=e;const r=u0(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?ze.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&ze.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Ha.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Ha.MATCHED,n!==e&&(e.lifecycle=Ha.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Ha.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Ha.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function pa(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const r=t[n],i=e[n];if(!(r===i||Array.isArray(r)&&Array.isArray(i)&&pa(r,i)))return!1}return!0}class m9{constructor(e){T(this,"width",void 0),T(this,"height",void 0),T(this,"views",void 0),T(this,"viewState",void 0),T(this,"controllers",void 0),T(this,"timeline",void 0),T(this,"_viewports",void 0),T(this,"_viewportMap",void 0),T(this,"_isUpdating",void 0),T(this,"_needsRedraw",void 0),T(this,"_needsUpdate",void 0),T(this,"_eventManager",void 0),T(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=u0(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!pa(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):ze.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return i||(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let c=n[s.id];const h=Boolean(s.controller);h&&!c&&(r=!0),(r||!h)&&c&&(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,o,a,c),this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const y9=/([0-9]+\.?[0-9]*)(%|px)/;function Fs(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=y9.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Ds(t,e){return t.relative?Math.round(t.position*e):t.position}function Rn(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class sa{constructor(e){T(this,"id",void 0),T(this,"viewportInstance",void 0),T(this,"_x",void 0),T(this,"_y",void 0),T(this,"_width",void 0),T(this,"_height",void 0),T(this,"_padding",void 0),T(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:c}=e||{};Rn(!c||c instanceof yo),this.viewportInstance=c,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Fs(r),this._y=Fs(i),this._width=Fs(s),this._height=Fs(o),this._padding=a&&{left:Fs(a.left||0),right:Fs(a.right||0),top:Fs(a.top||0),bottom:Fs(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&pa(this.props,e.props)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Ds(this._x,e),y:Ds(this._y,n),width:Ds(this._width,e),height:Ds(this._height,n)};return this._padding&&(r.padding={left:Ds(this._padding.left,e),top:Ds(this._padding.top,n),right:Ds(this._padding.right,e),bottom:Ds(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class bu{constructor(e){T(this,"_inProgress",void 0),T(this,"_handle",void 0),T(this,"_timeline",void 0),T(this,"time",void 0),T(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const nT=()=>{},_1={BREAK:1,SNAP_TO_END:2,IGNORE:3},_9=t=>t,v9=_1.BREAK;class E9{constructor(e){T(this,"getControllerState",void 0),T(this,"props",void 0),T(this,"propsInTransition",void 0),T(this,"transition",void 0),T(this,"onViewStateChange",void 0),T(this,"onStateChange",void 0),T(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:c}}=n,h=c(r/a),p=i.interpolateProps(s,o,h);this.propsInTransition=this.getControllerState({...this.props,...p}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new bu(e.timeline),this.onViewStateChange=e.onViewStateChange||nT,this.onStateChange=e.onStateChange||nT}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===_1.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&Boolean(r)}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===_1.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const c={duration:o,easing:n.transitionEasing||_9,interpolator:s,interruption:n.transitionInterruption||v9,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class w9{constructor(e){T(this,"_propsToCompare",void 0),T(this,"_propsToExtract",void 0),T(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Ur(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(n=>{const r=e[n];Rn(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const T9=["longitude","latitude","zoom","bearing","pitch"],b9=["longitude","latitude","zoom"];class M_ extends w9{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:T9,required:b9},super(r.transitionProps),T(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),c=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(c),aroundPosition:c,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Ii(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Ii(e.around,n.around,r)))}return i}}const ks={transitionDuration:0},x9=300,Mf=t=>1-(1-t)*(1-t),La={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Io={};class nM{constructor(e){T(this,"props",void 0),T(this,"state",{}),T(this,"transitionManager",void 0),T(this,"eventManager",void 0),T(this,"onViewStateChange",void 0),T(this,"onStateChange",void 0),T(this,"makeViewport",void 0),T(this,"_controllerState",void 0),T(this,"_events",{}),T(this,"_interactionState",{isDragging:!1}),T(this,"_customEvents",[]),T(this,"_eventStartBlocked",null),T(this,"_panMove",!1),T(this,"invertPan",!1),T(this,"dragMode","rotate"),T(this,"inertia",0),T(this,"scrollZoom",!0),T(this,"dragPan",!0),T(this,"dragRotate",!0),T(this,"doubleClickZoom",!0),T(this,"touchZoom",!0),T(this,"touchRotate",!1),T(this,"keyboard",!0),this.transitionManager=new E9({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return Boolean(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?x9:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:c=!1,keyboard:h=!0}=e,p=Boolean(this.onViewStateChange);this.toggleEvents(La.WHEEL,p&&r),this.toggleEvents(La.PAN,p&&(i||s)),this.toggleEvents(La.PINCH,p&&(a||c)),this.toggleEvents(La.TRIPLE_PAN,p&&c),this.toggleEvents(La.DOUBLE_TAP,p&&o),this.toggleEvents(La.KEYBOARD,p&&h),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=c,this.keyboard=h}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,ks,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,ks,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Mf},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,ks,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Mf},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,ks,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,ks,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Mf},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Io._startPinchRotation=e.rotation,Io._lastPinchEvent=e,this.updateViewport(r,ks,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Io._startPinchRotation-r})}return this.updateViewport(n,ks,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Io._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Io;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),c=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:c}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Mf},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Io._startPinchRotation=null,Io._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let c;const h={};switch(e.srcEvent.code){case"Minus":c=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),h.isZooming=!0;break;case"Equal":c=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),h.isZooming=!0;break;case"ArrowLeft":n?(c=a.rotateLeft(s),h.isRotating=!0):(c=a.moveLeft(i),h.isPanning=!0);break;case"ArrowRight":n?(c=a.rotateRight(s),h.isRotating=!0):(c=a.moveRight(i),h.isPanning=!0);break;case"ArrowUp":n?(c=a.rotateUp(o),h.isRotating=!0):(c=a.moveUp(i),h.isPanning=!0);break;case"ArrowDown":n?(c=a.rotateDown(o),h.isRotating=!0):(c=a.moveDown(i),h.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),h),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?ks:e?{...n,transitionInterpolator:new M_({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class rM{constructor(e,n){T(this,"_viewportProps",void 0),T(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const rT=5,C9=1.2;class S9 extends rM{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:c=0,altitude:h=1.5,position:p=[0,0,0],maxZoom:m=20,minZoom:v=0,maxPitch:E=60,minPitch:b=0,startPanLngLat:x,startZoomLngLat:I,startRotatePos:S,startBearing:P,startPitch:M,startZoom:O,normalize:N=!0}=e;Rn(Number.isFinite(s)),Rn(Number.isFinite(i)),Rn(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:c,altitude:h,maxZoom:m,minZoom:v,maxPitch:E,minPitch:b,normalize:N,position:p},{startPanLngLat:x,startZoomLngLat:I,startRotatePos:S,startBearing:P,startPitch:M,startZoom:O}),T(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let c=i+Math.log2(r);c=On(c,a,o);const h=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...h.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=On(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=On(a,o,s);const{normalize:c=!0}=e;return c&&Object.assign(e,yz(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],c=n[1],{width:h,height:p}=this.getViewportProps(),m=s/h;let v=0;o>0?Math.abs(p-c)>rT&&(v=o/(c-p)*C9):o<0&&c>rT&&(v=1-a/c),v=On(v,-1,1);const{minPitch:E,maxPitch:b}=this.getViewportProps(),x=i+180*m;let I=r;return v>0?I=r+v*(b-r):v<0&&(I=r-v*(E-r)),{pitch:I,bearing:x}}}class P9 extends nM{constructor(...e){super(...e),T(this,"ControllerState",S9),T(this,"transition",{transitionDuration:300,transitionInterpolator:new M_({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),T(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class iM extends sa{get ViewportType(){return ts}get ControllerType(){return P9}}T(iM,"displayName","MapView");class M9 extends A0{constructor(e,n){super(e,n),T(this,"maskMap",void 0),T(this,"fbo",void 0);const{mapSize:r=2048}=n;this.maskMap=new Hn(e,{width:r,height:r,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.fbo=new mn(e,{id:"maskmap",width:r,height:r,attachments:{[36064]:this.maskMap}})}render(e){const n=this.gl,r=[!1,!1,!1,!1];return r[e.channel]=!0,oi(n,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:r,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return e.props.operation===wu.MASK}delete(){this.fbo.delete(),this.maskMap.delete()}}const I9=new Ye().lookAt({eye:[0,0,1]});function B9({width:t,height:e,near:n,far:r,padding:i}){let s=-t/2,o=t/2,a=-e/2,c=e/2;if(i){const{left:h=0,right:p=0,top:m=0,bottom:v=0}=i,E=On((h+t-p)/2,0,t)-t/2,b=On((m+e-v)/2,0,e)-e/2;s-=E,o-=E,a+=b,c+=b}return new Ye().ortho({left:s,right:o,bottom:a,top:c,near:n,far:r})}class L9 extends yo{constructor(e){const{width:n,height:r,near:i=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:c=null,flipY:h=!0}=e,p=Array.isArray(o)?o[0]:o,m=Array.isArray(o)?o[1]:o,v=Math.min(p,m),E=Math.pow(2,v);let b;if(p!==m){const x=Math.pow(2,p),I=Math.pow(2,m);b={unitsPerMeter:[x/E,I/E,1],metersPerUnit:[E/x,E/I,1]}}super({...e,longitude:void 0,position:a,viewMatrix:I9.clone().scale([E,E*(h?-1:1),E]),projectionMatrix:B9({width:n||1,height:r||1,padding:c,near:i,far:s}),zoom:v,distanceScales:b})}projectFlat([e,n]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],n*r[1]]}unprojectFlat([e,n]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],n*r[1]]}panByPosition(e,n){const r=c0(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=dd([],i,yP([],r)),o=dd([],this.center,s);return{target:this.unprojectFlat(o)}}}class R9 extends rM{constructor(e){const{width:n,height:r,rotationX:i=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:c=-90,maxRotationX:h=90,minZoom:p=-1/0,maxZoom:m=1/0,startPanPosition:v,startRotatePos:E,startRotationX:b,startRotationOrbit:x,startZoomPosition:I,startZoom:S}=e;super({width:n,height:r,rotationX:i,rotationOrbit:s,target:o,zoom:a,minRotationX:c,maxRotationX:h,minZoom:p,maxZoom:m},{startPanPosition:v,startRotatePos:E,startRotationX:b,startRotationOrbit:x,startZoomPosition:I,startZoom:S}),T(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:n}){const r=this.getState().startPanPosition||n;if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:c}=this.getViewportProps();if(!i||s===void 0||o===void 0)return this;let h;if(e){let p=(e[0]-i[0])/a;const m=(e[1]-i[1])/c;(s<-90||s>90)&&(p*=-1),h={rotationX:s+m*180,rotationOrbit:o+p*180}}else h={rotationX:s+r,rotationOrbit:o+n};return this._getUpdatedState(h)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:i}=r;return Math.abs(i-n.rotationOrbit)>180&&(r.rotationOrbit=i<0?i+360:i-360),r}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomPosition:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:r,startZoom:i}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);const s=n+Math.log2(e);return On(s,i,r)}_panFromCenter(e){const{width:n,height:r,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(i)?[On(i[0],r,n),On(i[1],r,n)]:On(i,r,n),e.rotationX=On(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=Qz(a+180,360)-180),e}}class O9 extends R9{constructor(e){super(e),T(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(n)){let[o,a]=n;switch(this.zoomAxis){case"X":o=On(o+s,i,r);break;case"Y":a=On(a+s,i,r);break;default:let c=Math.min(o+s,a+s);c<i&&(s+=i-c),c=Math.max(o+s,a+s),c>r&&(s+=r-c),o+=s,a+=s}return[o,a]}return On(n+s,i,r)}}class F9 extends nM{constructor(...e){super(...e),T(this,"ControllerState",O9),T(this,"transition",{transitionDuration:300,transitionInterpolator:new M_(["target","zoom"])}),T(this,"dragMode","pan")}_onPanRotate(){return!1}}class sM extends sa{get ViewportType(){return L9}get ControllerType(){return F9}}T(sM,"displayName","OrthographicView");function D9({layers:t,viewport:e}){let n=null;for(const s of t){const o=s.getBounds();o&&(n?(n[0]=Math.min(n[0],o[0][0]),n[1]=Math.min(n[1],o[0][1]),n[2]=Math.max(n[2],o[1][0]),n[3]=Math.max(n[3],o[1][1])):n=[o[0][0],o[0][1],o[1][0],o[1][1]])}const r=e.getBounds();if(!n)return r;const i=N9(r);return n[2]-n[0]<i[2]-i[0]||n[3]-n[1]<i[3]-i[1]||(n[0]=Math.max(n[0],i[0]),n[1]=Math.max(n[1],i[1]),n[2]=Math.min(n[2],i[2]),n[3]=Math.min(n[3],i[3])),n}function k9({bounds:t,viewport:e,width:n,height:r}){if(t[2]<=t[0]||t[3]<=t[1])return null;const i=1;if(n-=i*2,r-=i*2,e instanceof ts){const{longitude:a,latitude:c,zoom:h}=JP({width:n,height:r,bounds:[[t[0],t[1]],[t[2],t[3]]],maxZoom:20});return new ts({longitude:a,latitude:c,zoom:h,x:i,y:i,width:n,height:r})}const s=[(t[0]+t[2])/2,(t[1]+t[3])/2,0],o=Math.min(20,n/(t[2]-t[0]),r/(t[3]-t[1]));return new sM({x:i,y:i}).makeViewport({width:n,height:r,viewState:{target:s,zoom:Math.log2(o)}})}function N9(t){const e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}class U9{constructor(){T(this,"id","mask-effect"),T(this,"props",null),T(this,"useInPicking",!0),T(this,"dummyMaskMap",void 0),T(this,"channels",[]),T(this,"masks",null),T(this,"maskPass",void 0),T(this,"maskMap",void 0),T(this,"lastViewport",void 0)}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new Hn(e,{width:1,height:1}));const a=n.filter(m=>m.props.visible&&m.props.operation===wu.MASK);if(a.length===0){this.masks=null,this.channels.length=0;return}this.masks={},this.maskPass||(this.maskPass=new M9(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const c=this._sortMaskChannels(a),h=i[0],p=!this.lastViewport||!this.lastViewport.equals(h);for(const m in c)this._renderChannel(c[m],{layerFilter:r,onViewportActive:s,views:o,viewport:h,viewportChanged:p})}_renderChannel(e,{layerFilter:n,onViewportActive:r,views:i,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const c=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((h,p)=>h!==a.layerBounds[p]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(c||o)&&(this.lastViewport=s,e.bounds=D9({layers:e.layers,viewport:s}),c||!Ur(e.bounds,a.bounds))){const{maskPass:h,maskMap:p}=this,m=k9({bounds:e.bounds,viewport:s,width:p.width,height:p.height});e.maskBounds=m?m.getBounds():[0,0,1,1],h.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:n,viewports:m?[m]:[],onViewportActive:r,views:i,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const n={};let r=0;for(const i of e){const{id:s}=i.root;let o=n[s];if(!o){if(++r>4){ze.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>(a==null?void 0:a.id)===s),layers:[],layerBounds:[],coordinateOrigin:i.root.props.coordinateOrigin,coordinateSystem:i.root.props.coordinateSystem},n[s]=o}o.layers.push(i),o.layerBounds.push(i.getBounds())}for(let i=0;i<4;i++){const s=this.channels[i];(!s||!(s.id in n))&&(this.channels[i]=null)}for(const i in n){const s=n[i];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return n}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const G9=new P_;class z9{constructor(){T(this,"effects",void 0),T(this,"_internalEffects",void 0),T(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!pa(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new U9),e.some(n=>n instanceof P_)||this._internalEffects.push(G9)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class V9 extends A0{shouldDrawLayer(e){return e.props.operation===wu.DRAW}}const iT={blendFunc:[1,0,32771,0],blendEquation:32774};class oM extends A0{constructor(...e){super(...e),T(this,"pickZ",void 0),T(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:c,width:h,height:p},cullRect:m,effects:v,pass:E="picking",pickZ:b}){const x=this.gl;this.pickZ=b;const I=b?null:{byLayer:new Map,byAlpha:[]};this._colors=I;const S=oi(x,{scissorTest:!0,scissor:[a,c,h,p],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...iT,blend:!b},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:m,effects:v==null?void 0:v.filter(M=>M.useInPicking),pass:E}));return this._colors=null,{decodePickingColor:I&&j9.bind(null,I),stats:S}}shouldDrawLayer(e){return e.props.pickable&&e.props.operation===wu.DRAW}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters};return this._colors?(Object.assign(i,iT),i.blend=!0,i.blendColor=H9(this._colors,e,r)):i.blend=!1,i}}function H9(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(ze.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function j9(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const W9="deckRenderer.renderLayers";class Q9{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new V9(e),this.pickLayersPass=new oM(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||mn.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const r=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,i=n.render({...e,target:r});this._postRender(e.effects,e),this.renderCount++,Jn(W9,this,i,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){let r=null;for(const i of e)i.preRender(this.gl,n),i.postRender&&(r=i);r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new mn(this.gl),new mn(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const $9={pickedColor:null,pickedObjectIndex:-1};function X9({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:c,height:h}=s;let p=i*i,m=-1,v=0;for(let E=0;E<h;E++){const b=E+a-r,x=b*b;if(x>p)v+=4*c;else for(let I=0;I<c;I++){if(t[v+3]-1>=0){const P=I+o-n,M=P*P+x;M<=p&&(p=M,m=v)}v+=4}}if(m>=0){const E=t.slice(m,m+4),b=e(E);if(b){const x=Math.floor(m/4/c),I=m/4-x*c;return{...b,pickedColor:E,pickedX:o+I,pickedY:a+x}}ze.error("Picked non-existent layer. Is picking buffer corrupt?")()}return $9}function Y9({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):ze.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function aM({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=K9((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const c=[r-o.x,i-o.y];s!==void 0&&(c[2]=s),a=o.unproject(c)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function J9(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,c=o?[o]:[];if(r==="hover"){const m=n.index,v=n.layerId,E=o?o.props.id:null;if(E!==v||a!==m){if(E!==v){const b=i.find(x=>x.props.id===v);b&&c.unshift(b)}n.layerId=E,n.index=a,n.info=null}}const h=aM(t),p=new Map;return p.set(null,h),c.forEach(m=>{let v={...h};m===o&&(v.color=s,v.index=a,v.picked=!0),v=lM({layer:m,info:v,mode:r});const E=v.layer;m===o&&r==="hover"&&(n.info=v),p.set(E.id,v),r==="hover"&&E.updateAutoHighlight(v)}),p}function lM({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function K9(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class Z9{constructor(e){T(this,"gl",void 0),T(this,"pickingFBO",void 0),T(this,"depthFBO",void 0),T(this,"pickLayersPass",void 0),T(this,"layerFilter",void 0),T(this,"lastPickedInfo",void 0),T(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new oM(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,c=o?r.find(v=>v.id===o):null,h=a&&i.find(v=>v.id===a)||i[0],p=h&&h.unproject([e-h.x,n-h.y]);return{...s,...{x:e,y:n,viewport:h,coordinate:p,layer:c}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new mn(r),mn.isSupported(r,{colorBufferFloat:!0}))){const i=new mn(r);i.attach({[36064]:new Hn(r,{format:nt(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>r.isPickable()&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:c="query",unproject3D:h,onViewportActive:p,effects:m}){const v=this._getPickable(e),E=Ul(this.gl);if(!v)return{result:[],emptyInfo:aM({viewports:r,x:i,y:s,pixelRatio:E})};this._resizeBuffer();const b=Jp(this.gl,[i,s],!0),x=[b.x+Math.floor(b.width/2),b.y+Math.floor(b.height/2)],I=Math.round(o*E),{width:S,height:P}=this.pickingFBO,M=this._getPickingRect({deviceX:x[0],deviceY:x[1],deviceRadius:I,deviceWidth:S,deviceHeight:P}),O={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let N;const z=[],X=new Set;for(let Z=0;Z<a;Z++){let Q;if(M){const D=this._drawAndSample({layers:v,views:n,viewports:r,onViewportActive:p,deviceRect:M,cullRect:O,effects:m,pass:"picking:".concat(c)});Q=X9({...D,deviceX:x[0],deviceY:x[1],deviceRadius:I,deviceRect:M})}else Q={pickedColor:null,pickedObjectIndex:-1};let k;Q.pickedLayer&&h&&this.depthFBO&&(k=this._drawAndSample({layers:[Q.pickedLayer],views:n,viewports:r,onViewportActive:p,deviceRect:{x:Q.pickedX,y:Q.pickedY,width:1,height:1},cullRect:O,effects:m,pass:"picking:".concat(c,":z")},!0).pickedColors[0]),Q.pickedLayer&&Z+1<a&&(X.add(Q.pickedLayer),Q.pickedLayer.disablePickingIndex(Q.pickedObjectIndex)),N=J9({pickInfo:Q,lastPickedInfo:this.lastPickedInfo,mode:c,layers:v,viewports:r,x:i,y:s,z:k,pixelRatio:E});for(const D of N.values())D.layer&&z.push(D);if(!Q.pickedColor)break}for(const Z of X)Z.restorePickingColors();return{result:z,emptyInfo:N.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:c="query",maxObjects:h=null,onViewportActive:p,effects:m}){const v=this._getPickable(e);if(!v)return[];this._resizeBuffer();const E=Ul(this.gl),b=Jp(this.gl,[i,s],!0),x=b.x,I=b.y+b.height,S=Jp(this.gl,[i+o,s+a],!0),P=S.x+S.width,M=S.y,O={x,y:M,width:P-x,height:I-M},N=this._drawAndSample({layers:v,views:n,viewports:r,onViewportActive:p,deviceRect:O,cullRect:{x:i,y:s,width:o,height:a},effects:m,pass:"picking:".concat(c)}),z=Y9(N),X=new Map,Z=Number.isFinite(h);for(let Q=0;Q<z.length&&!(Z&&h&&X.size>=h);Q++){const k=z[Q];let D={color:k.pickedColor,layer:null,index:k.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:E};D=lM({layer:k.pickedLayer,info:D,mode:c}),X.has(D.object)||X.set(D.object,D)}return Array.from(X.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:c},h=!1){const p=h?this.depthFBO:this.pickingFBO,{decodePickingColor:m}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:p,deviceRect:s,cullRect:o,effects:a,pass:c,pickZ:h}),{x:v,y:E,width:b,height:x}=s,I=new(h?Float32Array:Uint8Array)(b*x*4);return a0(p,{sourceX:v,sourceY:E,sourceWidth:b,sourceHeight:x,target:I}),{pickedColors:I,decodePickingColor:m}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),c=Math.min(i,e+r+1)-o,h=Math.min(s,n+r+1)-a;return c<=0||h<=0?null:{x:o,y:a,width:c,height:h}}}const q9={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class eV{constructor(e){T(this,"el",null),T(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,q9),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(!!i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var ec={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",c=Math.round,h=Math.abs,p=Date.now;function m(R,F,H){return setTimeout(M(R,H),F)}function v(R,F,H){return Array.isArray(R)?(E(R,H[F],H),!0):!1}function E(R,F,H){var q;if(!!R)if(R.forEach)R.forEach(F,H);else if(R.length!==i)for(q=0;q<R.length;)F.call(H,R[q],q,R),q++;else for(q in R)R.hasOwnProperty(q)&&F.call(H,R[q],q,R)}function b(R,F,H){var q="DEPRECATED METHOD: "+F+`
`+H+` AT 
`;return function(){var ce=new Error("get-stack-trace"),Se=ce&&ce.stack?ce.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",rt=e.console&&(e.console.warn||e.console.log);return rt&&rt.call(e.console,q,Se),R.apply(this,arguments)}}var x;typeof Object.assign!="function"?x=function(F){if(F===i||F===null)throw new TypeError("Cannot convert undefined or null to object");for(var H=Object(F),q=1;q<arguments.length;q++){var ce=arguments[q];if(ce!==i&&ce!==null)for(var Se in ce)ce.hasOwnProperty(Se)&&(H[Se]=ce[Se])}return H}:x=Object.assign;var I=b(function(F,H,q){for(var ce=Object.keys(H),Se=0;Se<ce.length;)(!q||q&&F[ce[Se]]===i)&&(F[ce[Se]]=H[ce[Se]]),Se++;return F},"extend","Use `assign`."),S=b(function(F,H){return I(F,H,!0)},"merge","Use `assign`.");function P(R,F,H){var q=F.prototype,ce;ce=R.prototype=Object.create(q),ce.constructor=R,ce._super=q,H&&x(ce,H)}function M(R,F){return function(){return R.apply(F,arguments)}}function O(R,F){return typeof R==a?R.apply(F&&F[0]||i,F):R}function N(R,F){return R===i?F:R}function z(R,F,H){E(k(F),function(q){R.addEventListener(q,H,!1)})}function X(R,F,H){E(k(F),function(q){R.removeEventListener(q,H,!1)})}function Z(R,F){for(;R;){if(R==F)return!0;R=R.parentNode}return!1}function Q(R,F){return R.indexOf(F)>-1}function k(R){return R.trim().split(/\s+/g)}function D(R,F,H){if(R.indexOf&&!H)return R.indexOf(F);for(var q=0;q<R.length;){if(H&&R[q][H]==F||!H&&R[q]===F)return q;q++}return-1}function ne(R){return Array.prototype.slice.call(R,0)}function se(R,F,H){for(var q=[],ce=[],Se=0;Se<R.length;){var rt=F?R[Se][F]:R[Se];D(ce,rt)<0&&q.push(R[Se]),ce[Se]=rt,Se++}return H&&(F?q=q.sort(function(Je,_n){return Je[F]>_n[F]}):q=q.sort()),q}function oe(R,F){for(var H,q,ce=F[0].toUpperCase()+F.slice(1),Se=0;Se<s.length;){if(H=s[Se],q=H?H+ce:F,q in R)return q;Se++}return i}var xe=1;function Pe(){return xe++}function Ue(R){var F=R.ownerDocument||R;return F.defaultView||F.parentWindow||e}var le=/mobile|tablet|ip(ad|hone|od)|android/i,_e="ontouchstart"in e,Ce=oe(e,"PointerEvent")!==i,Fe=_e&&le.test(navigator.userAgent),ke="touch",it="pen",Rt="mouse",Pn="kinect",An=25,Tt=1,Ut=2,ot=4,Gt=8,zt=1,Mn=2,In=4,jn=8,kn=16,yn=Mn|In,sn=jn|kn,rr=yn|sn,$r=["x","y"],ir=["clientX","clientY"];function _t(R,F){var H=this;this.manager=R,this.callback=F,this.element=R.element,this.target=R.options.inputTarget,this.domHandler=function(q){O(R.options.enable,[R])&&H.handler(q)},this.init()}_t.prototype={handler:function(){},init:function(){this.evEl&&z(this.element,this.evEl,this.domHandler),this.evTarget&&z(this.target,this.evTarget,this.domHandler),this.evWin&&z(Ue(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&X(this.element,this.evEl,this.domHandler),this.evTarget&&X(this.target,this.evTarget,this.domHandler),this.evWin&&X(Ue(this.element),this.evWin,this.domHandler)}};function Xr(R){var F,H=R.options.inputClass;return H?F=H:Ce?F=ge:Fe?F=To:_e?F=J:F=ga,new F(R,fi)}function fi(R,F,H){var q=H.pointers.length,ce=H.changedPointers.length,Se=F&Tt&&q-ce===0,rt=F&(ot|Gt)&&q-ce===0;H.isFirst=!!Se,H.isFinal=!!rt,Se&&(R.session={}),H.eventType=F,pe(R,H),R.emit("hammer.input",H),R.recognize(H),R.session.prevInput=H}function pe(R,F){var H=R.session,q=F.pointers,ce=q.length;H.firstInput||(H.firstInput=et(F)),ce>1&&!H.firstMultiple?H.firstMultiple=et(F):ce===1&&(H.firstMultiple=!1);var Se=H.firstInput,rt=H.firstMultiple,un=rt?rt.center:Se.center,Je=F.center=We(q);F.timeStamp=p(),F.deltaTime=F.timeStamp-Se.timeStamp,F.angle=at(un,Je),F.distance=Vt(un,Je),Oe(H,F),F.offsetDirection=Me(F.deltaX,F.deltaY);var _n=lt(F.deltaTime,F.deltaX,F.deltaY);F.overallVelocityX=_n.x,F.overallVelocityY=_n.y,F.overallVelocity=h(_n.x)>h(_n.y)?_n.x:_n.y,F.scale=rt?Cs(rt.pointers,q):1,F.rotation=rt?sr(rt.pointers,q):0,F.maxPointers=H.prevInput?F.pointers.length>H.prevInput.maxPointers?F.pointers.length:H.prevInput.maxPointers:F.pointers.length,Xe(H,F);var Sr=R.element;Z(F.srcEvent.target,Sr)&&(Sr=F.srcEvent.target),F.target=Sr}function Oe(R,F){var H=F.center,q=R.offsetDelta||{},ce=R.prevDelta||{},Se=R.prevInput||{};(F.eventType===Tt||Se.eventType===ot)&&(ce=R.prevDelta={x:Se.deltaX||0,y:Se.deltaY||0},q=R.offsetDelta={x:H.x,y:H.y}),F.deltaX=ce.x+(H.x-q.x),F.deltaY=ce.y+(H.y-q.y)}function Xe(R,F){var H=R.lastInterval||F,q=F.timeStamp-H.timeStamp,ce,Se,rt,un;if(F.eventType!=Gt&&(q>An||H.velocity===i)){var Je=F.deltaX-H.deltaX,_n=F.deltaY-H.deltaY,Sr=lt(q,Je,_n);Se=Sr.x,rt=Sr.y,ce=h(Sr.x)>h(Sr.y)?Sr.x:Sr.y,un=Me(Je,_n),R.lastInterval=F}else ce=H.velocity,Se=H.velocityX,rt=H.velocityY,un=H.direction;F.velocity=ce,F.velocityX=Se,F.velocityY=rt,F.direction=un}function et(R){for(var F=[],H=0;H<R.pointers.length;)F[H]={clientX:c(R.pointers[H].clientX),clientY:c(R.pointers[H].clientY)},H++;return{timeStamp:p(),pointers:F,center:We(F),deltaX:R.deltaX,deltaY:R.deltaY}}function We(R){var F=R.length;if(F===1)return{x:c(R[0].clientX),y:c(R[0].clientY)};for(var H=0,q=0,ce=0;ce<F;)H+=R[ce].clientX,q+=R[ce].clientY,ce++;return{x:c(H/F),y:c(q/F)}}function lt(R,F,H){return{x:F/R||0,y:H/R||0}}function Me(R,F){return R===F?zt:h(R)>=h(F)?R<0?Mn:In:F<0?jn:kn}function Vt(R,F,H){H||(H=$r);var q=F[H[0]]-R[H[0]],ce=F[H[1]]-R[H[1]];return Math.sqrt(q*q+ce*ce)}function at(R,F,H){H||(H=$r);var q=F[H[0]]-R[H[0]],ce=F[H[1]]-R[H[1]];return Math.atan2(ce,q)*180/Math.PI}function sr(R,F){return at(F[1],F[0],ir)+at(R[1],R[0],ir)}function Cs(R,F){return Vt(F[0],F[1],ir)/Vt(R[0],R[1],ir)}var $0={mousedown:Tt,mousemove:Ut,mouseup:ot},Fu="mousedown",X0="mousemove mouseup";function ga(){this.evEl=Fu,this.evWin=X0,this.pressed=!1,_t.apply(this,arguments)}P(ga,_t,{handler:function(F){var H=$0[F.type];H&Tt&&F.button===0&&(this.pressed=!0),H&Ut&&F.which!==1&&(H=ot),this.pressed&&(H&ot&&(this.pressed=!1),this.callback(this.manager,H,{pointers:[F],changedPointers:[F],pointerType:Rt,srcEvent:F}))}});var Y0={pointerdown:Tt,pointermove:Ut,pointerup:ot,pointercancel:Gt,pointerout:Gt},oc={2:ke,3:it,4:Rt,5:Pn},Du="pointerdown",ku="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Du="MSPointerDown",ku="MSPointerMove MSPointerUp MSPointerCancel");function ge(){this.evEl=Du,this.evWin=ku,_t.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}P(ge,_t,{handler:function(F){var H=this.store,q=!1,ce=F.type.toLowerCase().replace("ms",""),Se=Y0[ce],rt=oc[F.pointerType]||F.pointerType,un=rt==ke,Je=D(H,F.pointerId,"pointerId");Se&Tt&&(F.button===0||un)?Je<0&&(H.push(F),Je=H.length-1):Se&(ot|Gt)&&(q=!0),!(Je<0)&&(H[Je]=F,this.callback(this.manager,Se,{pointers:H,changedPointers:[F],pointerType:rt,srcEvent:F}),q&&H.splice(Je,1))}});var J0={touchstart:Tt,touchmove:Ut,touchend:ot,touchcancel:Gt},Nu="touchstart",K0="touchstart touchmove touchend touchcancel";function Uu(){this.evTarget=Nu,this.evWin=K0,this.started=!1,_t.apply(this,arguments)}P(Uu,_t,{handler:function(F){var H=J0[F.type];if(H===Tt&&(this.started=!0),!!this.started){var q=ac.call(this,F,H);H&(ot|Gt)&&q[0].length-q[1].length===0&&(this.started=!1),this.callback(this.manager,H,{pointers:q[0],changedPointers:q[1],pointerType:ke,srcEvent:F})}}});function ac(R,F){var H=ne(R.touches),q=ne(R.changedTouches);return F&(ot|Gt)&&(H=se(H.concat(q),"identifier",!0)),[H,q]}var Gu={touchstart:Tt,touchmove:Ut,touchend:ot,touchcancel:Gt},zu="touchstart touchmove touchend touchcancel";function To(){this.evTarget=zu,this.targetIds={},_t.apply(this,arguments)}P(To,_t,{handler:function(F){var H=Gu[F.type],q=ma.call(this,F,H);!q||this.callback(this.manager,H,{pointers:q[0],changedPointers:q[1],pointerType:ke,srcEvent:F})}});function ma(R,F){var H=ne(R.touches),q=this.targetIds;if(F&(Tt|Ut)&&H.length===1)return q[H[0].identifier]=!0,[H,H];var ce,Se,rt=ne(R.changedTouches),un=[],Je=this.target;if(Se=H.filter(function(_n){return Z(_n.target,Je)}),F===Tt)for(ce=0;ce<Se.length;)q[Se[ce].identifier]=!0,ce++;for(ce=0;ce<rt.length;)q[rt[ce].identifier]&&un.push(rt[ce]),F&(ot|Gt)&&delete q[rt[ce].identifier],ce++;if(!!un.length)return[se(Se.concat(un),"identifier",!0),un]}var lc=2500,Fi=25;function J(){_t.apply(this,arguments);var R=M(this.handler,this);this.touch=new To(this.manager,R),this.mouse=new ga(this.manager,R),this.primaryTouch=null,this.lastTouches=[]}P(J,_t,{handler:function(F,H,q){var ce=q.pointerType==ke,Se=q.pointerType==Rt;if(!(Se&&q.sourceCapabilities&&q.sourceCapabilities.firesTouchEvents)){if(ce)ae.call(this,H,q);else if(Se&&Ge.call(this,q))return;this.callback(F,H,q)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ae(R,F){R&Tt?(this.primaryTouch=F.changedPointers[0].identifier,me.call(this,F)):R&(ot|Gt)&&me.call(this,F)}function me(R){var F=R.changedPointers[0];if(F.identifier===this.primaryTouch){var H={x:F.clientX,y:F.clientY};this.lastTouches.push(H);var q=this.lastTouches,ce=function(){var Se=q.indexOf(H);Se>-1&&q.splice(Se,1)};setTimeout(ce,lc)}}function Ge(R){for(var F=R.srcEvent.clientX,H=R.srcEvent.clientY,q=0;q<this.lastTouches.length;q++){var ce=this.lastTouches[q],Se=Math.abs(F-ce.x),rt=Math.abs(H-ce.y);if(Se<=Fi&&rt<=Fi)return!0}return!1}var u=oe(o.style,"touchAction"),G=u!==i,At="compute",ht="auto",Ze="manipulation",tt="none",Ht="pan-x",ut="pan-y",st=ya();function on(R,F){this.manager=R,this.set(F)}on.prototype={set:function(R){R==At&&(R=this.compute()),G&&this.manager.element.style&&st[R]&&(this.manager.element.style[u]=R),this.actions=R.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var R=[];return E(this.manager.recognizers,function(F){O(F.options.enable,[F])&&(R=R.concat(F.getTouchAction()))}),Di(R.join(" "))},preventDefaults:function(R){var F=R.srcEvent,H=R.offsetDirection;if(this.manager.session.prevented){F.preventDefault();return}var q=this.actions,ce=Q(q,tt)&&!st[tt],Se=Q(q,ut)&&!st[ut],rt=Q(q,Ht)&&!st[Ht];if(ce){var un=R.pointers.length===1,Je=R.distance<2,_n=R.deltaTime<250;if(un&&Je&&_n)return}if(!(rt&&Se)&&(ce||Se&&H&yn||rt&&H&sn))return this.preventSrc(F)},preventSrc:function(R){this.manager.session.prevented=!0,R.preventDefault()}};function Di(R){if(Q(R,tt))return tt;var F=Q(R,Ht),H=Q(R,ut);return F&&H?tt:F||H?F?Ht:ut:Q(R,Ze)?Ze:ht}function ya(){if(!G)return!1;var R={},F=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(H){R[H]=F?e.CSS.supports("touch-action",H):!0}),R}var Ss=1,jt=2,hi=4,Bn=8,di=Bn,xr=16,De=32;function j(R){this.options=x({},this.defaults,R||{}),this.id=Pe(),this.manager=null,this.options.enable=N(this.options.enable,!0),this.state=Ss,this.simultaneous={},this.requireFail=[]}j.prototype={defaults:{},set:function(R){return x(this.options,R),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(R){if(v(R,"recognizeWith",this))return this;var F=this.simultaneous;return R=_a(R,this),F[R.id]||(F[R.id]=R,R.recognizeWith(this)),this},dropRecognizeWith:function(R){return v(R,"dropRecognizeWith",this)?this:(R=_a(R,this),delete this.simultaneous[R.id],this)},requireFailure:function(R){if(v(R,"requireFailure",this))return this;var F=this.requireFail;return R=_a(R,this),D(F,R)===-1&&(F.push(R),R.requireFailure(this)),this},dropRequireFailure:function(R){if(v(R,"dropRequireFailure",this))return this;R=_a(R,this);var F=D(this.requireFail,R);return F>-1&&this.requireFail.splice(F,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(R){return!!this.simultaneous[R.id]},emit:function(R){var F=this,H=this.state;function q(ce){F.manager.emit(ce,R)}H<Bn&&q(F.options.event+dt(H)),q(F.options.event),R.additionalEvent&&q(R.additionalEvent),H>=Bn&&q(F.options.event+dt(H))},tryEmit:function(R){if(this.canEmit())return this.emit(R);this.state=De},canEmit:function(){for(var R=0;R<this.requireFail.length;){if(!(this.requireFail[R].state&(De|Ss)))return!1;R++}return!0},recognize:function(R){var F=x({},R);if(!O(this.options.enable,[this,F])){this.reset(),this.state=De;return}this.state&(di|xr|De)&&(this.state=Ss),this.state=this.process(F),this.state&(jt|hi|Bn|xr)&&this.tryEmit(F)},process:function(R){},getTouchAction:function(){},reset:function(){}};function dt(R){return R&xr?"cancel":R&Bn?"end":R&hi?"move":R&jt?"start":""}function cc(R){return R==kn?"down":R==jn?"up":R==Mn?"left":R==In?"right":""}function _a(R,F){var H=F.manager;return H?H.get(R):R}function Cr(){j.apply(this,arguments)}P(Cr,j,{defaults:{pointers:1},attrTest:function(R){var F=this.options.pointers;return F===0||R.pointers.length===F},process:function(R){var F=this.state,H=R.eventType,q=F&(jt|hi),ce=this.attrTest(R);return q&&(H&Gt||!ce)?F|xr:q||ce?H&ot?F|Bn:F&jt?F|hi:jt:De}});function va(){Cr.apply(this,arguments),this.pX=null,this.pY=null}P(va,Cr,{defaults:{event:"pan",threshold:10,pointers:1,direction:rr},getTouchAction:function(){var R=this.options.direction,F=[];return R&yn&&F.push(ut),R&sn&&F.push(Ht),F},directionTest:function(R){var F=this.options,H=!0,q=R.distance,ce=R.direction,Se=R.deltaX,rt=R.deltaY;return ce&F.direction||(F.direction&yn?(ce=Se===0?zt:Se<0?Mn:In,H=Se!=this.pX,q=Math.abs(R.deltaX)):(ce=rt===0?zt:rt<0?jn:kn,H=rt!=this.pY,q=Math.abs(R.deltaY))),R.direction=ce,H&&q>F.threshold&&ce&F.direction},attrTest:function(R){return Cr.prototype.attrTest.call(this,R)&&(this.state&jt||!(this.state&jt)&&this.directionTest(R))},emit:function(R){this.pX=R.deltaX,this.pY=R.deltaY;var F=cc(R.direction);F&&(R.additionalEvent=this.options.event+F),this._super.emit.call(this,R)}});function Ac(){Cr.apply(this,arguments)}P(Ac,Cr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(R){return this._super.attrTest.call(this,R)&&(Math.abs(R.scale-1)>this.options.threshold||this.state&jt)},emit:function(R){if(R.scale!==1){var F=R.scale<1?"in":"out";R.additionalEvent=this.options.event+F}this._super.emit.call(this,R)}});function U(){j.apply(this,arguments),this._timer=null,this._input=null}P(U,j,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ht]},process:function(R){var F=this.options,H=R.pointers.length===F.pointers,q=R.distance<F.threshold,ce=R.deltaTime>F.time;if(this._input=R,!q||!H||R.eventType&(ot|Gt)&&!ce)this.reset();else if(R.eventType&Tt)this.reset(),this._timer=m(function(){this.state=di,this.tryEmit()},F.time,this);else if(R.eventType&ot)return di;return De},reset:function(){clearTimeout(this._timer)},emit:function(R){this.state===di&&(R&&R.eventType&ot?this.manager.emit(this.options.event+"up",R):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function uc(){Cr.apply(this,arguments)}P(uc,Cr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(R){return this._super.attrTest.call(this,R)&&(Math.abs(R.rotation)>this.options.threshold||this.state&jt)}});function fc(){Cr.apply(this,arguments)}P(fc,Cr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:yn|sn,pointers:1},getTouchAction:function(){return va.prototype.getTouchAction.call(this)},attrTest:function(R){var F=this.options.direction,H;return F&(yn|sn)?H=R.overallVelocity:F&yn?H=R.overallVelocityX:F&sn&&(H=R.overallVelocityY),this._super.attrTest.call(this,R)&&F&R.offsetDirection&&R.distance>this.options.threshold&&R.maxPointers==this.options.pointers&&h(H)>this.options.velocity&&R.eventType&ot},emit:function(R){var F=cc(R.offsetDirection);F&&this.manager.emit(this.options.event+F,R),this.manager.emit(this.options.event,R)}});function Ea(){j.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}P(Ea,j,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ze]},process:function(R){var F=this.options,H=R.pointers.length===F.pointers,q=R.distance<F.threshold,ce=R.deltaTime<F.time;if(this.reset(),R.eventType&Tt&&this.count===0)return this.failTimeout();if(q&&ce&&H){if(R.eventType!=ot)return this.failTimeout();var Se=this.pTime?R.timeStamp-this.pTime<F.interval:!0,rt=!this.pCenter||Vt(this.pCenter,R.center)<F.posThreshold;this.pTime=R.timeStamp,this.pCenter=R.center,!rt||!Se?this.count=1:this.count+=1,this._input=R;var un=this.count%F.taps;if(un===0)return this.hasRequireFailures()?(this._timer=m(function(){this.state=di,this.tryEmit()},F.interval,this),jt):di}return De},failTimeout:function(){return this._timer=m(function(){this.state=De},this.options.interval,this),De},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==di&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function pi(R,F){return F=F||{},F.recognizers=N(F.recognizers,pi.defaults.preset),new wa(R,F)}pi.VERSION="2.0.7",pi.defaults={domEvents:!1,touchAction:At,enable:!0,inputTarget:null,inputClass:null,preset:[[uc,{enable:!1}],[Ac,{enable:!1},["rotate"]],[fc,{direction:yn}],[va,{direction:yn},["swipe"]],[Ea],[Ea,{event:"doubletap",taps:2},["tap"]],[U]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Z0=1,Vu=2;function wa(R,F){this.options=x({},pi.defaults,F||{}),this.options.inputTarget=this.options.inputTarget||R,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=R,this.input=Xr(this),this.touchAction=new on(this,this.options.touchAction),Hu(this,!0),E(this.options.recognizers,function(H){var q=this.add(new H[0](H[1]));H[2]&&q.recognizeWith(H[2]),H[3]&&q.requireFailure(H[3])},this)}wa.prototype={set:function(R){return x(this.options,R),R.touchAction&&this.touchAction.update(),R.inputTarget&&(this.input.destroy(),this.input.target=R.inputTarget,this.input.init()),this},stop:function(R){this.session.stopped=R?Vu:Z0},recognize:function(R){var F=this.session;if(!F.stopped){this.touchAction.preventDefaults(R);var H,q=this.recognizers,ce=F.curRecognizer;(!ce||ce&&ce.state&di)&&(ce=F.curRecognizer=null);for(var Se=0;Se<q.length;)H=q[Se],F.stopped!==Vu&&(!ce||H==ce||H.canRecognizeWith(ce))?H.recognize(R):H.reset(),!ce&&H.state&(jt|hi|Bn)&&(ce=F.curRecognizer=H),Se++}},get:function(R){if(R instanceof j)return R;for(var F=this.recognizers,H=0;H<F.length;H++)if(F[H].options.event==R)return F[H];return null},add:function(R){if(v(R,"add",this))return this;var F=this.get(R.options.event);return F&&this.remove(F),this.recognizers.push(R),R.manager=this,this.touchAction.update(),R},remove:function(R){if(v(R,"remove",this))return this;if(R=this.get(R),R){var F=this.recognizers,H=D(F,R);H!==-1&&(F.splice(H,1),this.touchAction.update())}return this},on:function(R,F){if(R!==i&&F!==i){var H=this.handlers;return E(k(R),function(q){H[q]=H[q]||[],H[q].push(F)}),this}},off:function(R,F){if(R!==i){var H=this.handlers;return E(k(R),function(q){F?H[q]&&H[q].splice(D(H[q],F),1):delete H[q]}),this}},emit:function(R,F){this.options.domEvents&&hc(R,F);var H=this.handlers[R]&&this.handlers[R].slice();if(!(!H||!H.length)){F.type=R,F.preventDefault=function(){F.srcEvent.preventDefault()};for(var q=0;q<H.length;)H[q](F),q++}},destroy:function(){this.element&&Hu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Hu(R,F){var H=R.element;if(!!H.style){var q;E(R.options.cssProps,function(ce,Se){q=oe(H.style,Se),F?(R.oldCssProps[q]=H.style[q],H.style[q]=ce):H.style[q]=R.oldCssProps[q]||""}),F||(R.oldCssProps={})}}function hc(R,F){var H=n.createEvent("Event");H.initEvent(R,!0,!0),H.gesture=F,F.target.dispatchEvent(H)}x(pi,{INPUT_START:Tt,INPUT_MOVE:Ut,INPUT_END:ot,INPUT_CANCEL:Gt,STATE_POSSIBLE:Ss,STATE_BEGAN:jt,STATE_CHANGED:hi,STATE_ENDED:Bn,STATE_RECOGNIZED:di,STATE_CANCELLED:xr,STATE_FAILED:De,DIRECTION_NONE:zt,DIRECTION_LEFT:Mn,DIRECTION_RIGHT:In,DIRECTION_UP:jn,DIRECTION_DOWN:kn,DIRECTION_HORIZONTAL:yn,DIRECTION_VERTICAL:sn,DIRECTION_ALL:rr,Manager:wa,Input:_t,TouchAction:on,TouchInput:To,MouseInput:ga,PointerEventInput:ge,TouchMouseInput:J,SingleTouchInput:Uu,Recognizer:j,AttrRecognizer:Cr,Tap:Ea,Pan:va,Swipe:fc,Pinch:Ac,Rotate:uc,Press:U,on:z,off:X,each:E,merge:S,extend:I,assign:x,inherit:P,bindFn:M,prefixed:oe});var Yr=typeof e<"u"?e:typeof self<"u"?self:{};Yr.Hammer=pi,typeof i=="function"&&i.amd?i(function(){return pi}):t.exports?t.exports=pi:e[r]=pi})(window,document,"Hammer")})(ec);const tV=ec.exports,Gi=aC({__proto__:null,default:tV},[ec.exports]),cM=1,AM=2,v1=4,nV={mousedown:cM,mousemove:AM,mouseup:v1};function rV(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function iV(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(rV(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function sV(t){t.prototype.handler=function(n){let r=nV[n.type];r&cM&&n.button>=0&&(this.pressed=!0),r&AM&&n.which===0&&(r=v1),this.pressed&&(r&v1&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}iV(ec.exports.PointerEventInput);sV(ec.exports.MouseInput);const oV=ec.exports.Manager;class f0{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const aV=Gi?[[Gi.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Gi.Rotate,{enable:!1}],[Gi.Pinch,{enable:!1}],[Gi.Swipe,{enable:!1}],[Gi.Pan,{threshold:0,enable:!1}],[Gi.Press,{enable:!1}],[Gi.Tap,{event:"doubletap",taps:2,enable:!1}],[Gi.Tap,{event:"anytap",enable:!1}],[Gi.Tap,{enable:!1}]]:null,sT={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},lV={doubletap:["tap"]},cV={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},I_={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},AV={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},oT={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},uV=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",il=typeof window<"u"?window:global;let E1=!1;try{const t={get passive(){return E1=!0,!0}};il.addEventListener("test",null,t),il.removeEventListener("test",null)}catch{E1=!1}const fV=uV.indexOf("firefox")!==-1,{WHEEL_EVENTS:hV}=I_,aT="wheel",lT=4.000244140625,dV=40,pV=.25;class gV extends f0{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;il.WheelEvent&&(fV&&i.deltaMode===il.WheelEvent.DOM_DELTA_PIXEL&&(s/=il.devicePixelRatio),i.deltaMode===il.WheelEvent.DOM_DELTA_LINE&&(s*=dV)),s!==0&&s%lT===0&&(s=Math.floor(s/lT)),i.shiftKey&&s&&(s=s*pV),this.callback({type:aT,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(hV),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,E1?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===aT&&(this.options.enable=n)}}const{MOUSE_EVENTS:mV}=I_,cT="pointermove",AT="pointerover",uT="pointerout",fT="pointerenter",hT="pointerleave";class yV extends f0{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(mV),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===cT&&(this.enableMoveEvent=n),e===AT&&(this.enableOverEvent=n),e===uT&&(this.enableOutEvent=n),e===fT&&(this.enableEnterEvent=n),e===hT&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(AT,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(uT,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(fT,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(hT,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(cT,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:_V}=I_,dT="keydown",pT="keyup";class vV extends f0{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:dT,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:pT,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(_V),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===dT&&(this.enableDownEvent=n),e===pT&&(this.enableUpEvent=n)}}const gT="contextmenu";class EV extends f0{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{!this.options.enable||this.callback({type:gT,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===gT&&(this.options.enable=n)}}const w1=1,_d=2,T1=4,wV={pointerdown:w1,pointermove:_d,pointerup:T1,mousedown:w1,mousemove:_d,mouseup:T1},TV=1,bV=2,xV=3,CV=0,SV=1,PV=2,MV=1,IV=2,BV=4;function LV(t){const e=wV[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return e===T1||e===_d&&!Number.isFinite(n)?(s=i===TV,o=i===bV,a=i===xV):e===_d?(s=Boolean(n&MV),o=Boolean(n&BV),a=Boolean(n&IV)):e===w1&&(s=r===CV,o=r===SV,a=r===PV),{leftButton:s,middleButton:o,rightButton:a}}function RV(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const hg={srcElement:"root",priority:0};class OV{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let c=hg;typeof r=="string"||r&&r.addEventListener?c={...hg,srcElement:r}:r&&(c={...hg,...r});let h=a.get(c.srcElement);h||(h=[],a.set(c.srcElement,h));const p={type:e,handler:n,srcElement:c.srcElement,priority:c.priority};i&&(p.once=!0),s&&(p.passive=!0),o.push(p),this._active=this._active||!p.passive;let m=h.length-1;for(;m>=0&&!(h[m].priority>=p.priority);)m--;h.splice(m+1,0,p)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let c=0;c<r.length;c++){const{type:h,handler:p,once:m}=r[c];if(p({...e,type:h,stopPropagation:s,stopImmediatePropagation:o}),m&&a.push(r[c]),i)break}for(let c=0;c<a.length;c++){const{type:h,handler:p}=a[c];this.remove(h,p)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...LV(e),...RV(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const FV={events:null,recognizers:null,recognizerOptions:{},Manager:oV,touchAction:"none",tabIndex:0};class DV{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=cV[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...FV,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||aV}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(sT).forEach(i=>{const s=this.manager.get(i);s&&sT[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new gV(e,this._onOtherEvent,{enable:!1}),this.moveInput=new yV(e,this._onOtherEvent,{enable:!1}),this.keyInput=new vV(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new EV(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=lV[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const p in e)this._addEventHandler(p,e[p],r,i,s);return}const{manager:o,events:a}=this,c=oT[e]||e;let h=a.get(c);h||(h=new OV(this),a.set(c,h),h.recognizerName=AV[c]||c,o&&o.on(c,h.handleEvent)),h.add(e,n,r,i,s),h.isEmpty()||this._toggleRecognizer(h.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=oT[e]||e,s=r.get(i);if(!!s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const c of r.values())if(c.recognizerName===o&&!c.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function Bo(){}const kV=({isDragging:t})=>t?"grabbing":"grab",uM={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Bo,onResize:Bo,onViewStateChange:Bo,onInteractionStateChange:Bo,onBeforeRender:Bo,onAfterRender:Bo,onLoad:Bo,onError:t=>ze.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:kV,getTooltip:null,debug:!1,drawPickingColors:!1};class h0{constructor(e){T(this,"props",void 0),T(this,"width",0),T(this,"height",0),T(this,"userData",{}),T(this,"canvas",null),T(this,"viewManager",null),T(this,"layerManager",null),T(this,"effectManager",null),T(this,"deckRenderer",null),T(this,"deckPicker",null),T(this,"eventManager",null),T(this,"tooltip",null),T(this,"metrics",void 0),T(this,"animationLoop",void 0),T(this,"stats",void 0),T(this,"viewState",void 0),T(this,"cursorState",void 0),T(this,"_needsRedraw",void 0),T(this,"_pickRequest",void 0),T(this,"_lastPointerDownInfo",null),T(this,"_metricsCounter",void 0),T(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),T(this,"_onEvent",n=>{const r=Ww[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,c=a&&(a[r.handler]||a.props[r.handler]),h=this.props[r.handler];let p=!1;c&&(p=c.call(a,o,n)),!p&&h&&h(o,n)}),T(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...uM,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&ze.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),I3()==="IE"&&ze.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new pu({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Vl.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(i=this.deckRenderer)===null||i===void 0||i.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(a=this.tooltip)===null||a===void 0||a.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var c;(c=this.canvas.parentElement)===null||c===void 0||c.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ze.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ze.removed("onLayerClick","onClick")(),e.initialViewState&&!pa(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Rn(this.viewManager),this.viewManager.views}getViewports(e){return Rn(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_pick(e,n,r){Rn(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Rn(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth||e.width,r=e.clientHeight||e.height;if(n!==this.width||r!==this.height){var i;this.width=n,this.height=r,(i=this.viewManager)===null||i===void 0||i.setProps({width:n,height:r}),this.props.onResize({width:n,height:r})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:c,onAfterRender:h,useDevicePixels:p}=e;return new j6({width:n,height:r,useDevicePixels:p,autoResizeViewport:!1,gl:i,onCreateContext:m=>X3({...s,...m,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:m=>this._setGLContext(m.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:c,onAfterRender:h,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new iM({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,o_(e,{enable:!0,copyState:!0})),this.tooltip=new eV(this.canvas),_s(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new zP;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new DV(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in Ww)this.eventManager.on(i,this._onEvent);this.viewManager=new m9({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new g9(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new z9,this.deckRenderer=new Q9(e),this.deckPicker=new Z9(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;_s(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),ze.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=zo.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}T(h0,"defaultProps",uM);T(h0,"VERSION",Kk.VERSION);class dg{constructor(e,n){T(this,"opts",void 0),T(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function NV(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function bh(t){return t.stride||t.size*t.bytesPerElement}function fM(t,e){e.offset&&ze.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=bh(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function UV(t,e){const n=fM(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class GV{constructor(e,n,r){T(this,"gl",void 0),T(this,"id",void 0),T(this,"size",void 0),T(this,"settings",void 0),T(this,"value",void 0),T(this,"doublePrecision",void 0),T(this,"_buffer",void 0),T(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&l0(e,Bt.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let c=NV(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(c=Float32Array),this.value=null,this.settings={...n,defaultType:c,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new St(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*bh(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Vl.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=UV(this.getAccessor(),n||{});return r[e]=new dg(this,s.high),r["".concat(e,"64Low")]=i?new dg(this,s.low):new Float32Array(this.size),r}if(n){const r=fM(this.getAccessor(),n);return{[e]:new dg(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let c=0;c<s;)for(let h=0;h<i;h++){const p=n[c++];p<o[h]&&(o[h]=p),p>a[h]&&(a[h]=p)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof St?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=bh(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=bh(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=ug(s,i));const c=s.byteLength+a+i.stride*2;o.byteLength<c&&o.reallocate(c),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?ug(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=Vl.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?ug(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&ze.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e)return n[r]=i[0],n;switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const mT=[],yT=[];function _o(t,e=0,n=1/0){let r=mT;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(yT.length=t.length,r=yT):r=mT,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function hM(t){return t&&t[Symbol.asyncIterator]}function dM(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,c=r?r/a:n,h=i?i/a:0,p=Math.floor((t.length-h)/c);return(m,{index:v,target:E})=>{if(!s){const S=v*c+h;for(let P=0;P<n;P++)E[P]=t[S+P];return E}const b=s[v],x=s[v+1]||p;let I;if(o){I=new Array(x-b);for(let S=b;S<x;S++){const P=S*c+h;E=new Array(n);for(let M=0;M<n;M++)E[M]=t[P+M];I[S-b]=E}}else if(c===n)I=t.subarray(b*n+h,x*n+h);else{I=new t.constructor((x-b)*n);let S=0;for(let P=b;P<x;P++){const M=P*c+h;for(let O=0;O<n;O++)I[S++]=t[M+O]}}return I}}const zV=[],xh=[[0,1/0]];function VV(t,e){if(t===xh||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function pg(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,c=o-r;if(a>c){n.set(e.subarray(0,c),r);return}if(n.set(e,r),!s)return;let h=a;for(;h<c;){const p=s(h,e);for(let m=0;m<i;m++)n[r+h]=p[m]||0,h++}}function HV({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return pg({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const c=r&&((p,m)=>r(p+a,m)),h=Math.min(i.length,s.length);for(let p=1;p<h;p++){const m=i[p]*n,v=s[p]*n;pg({source:t.subarray(o,m),target:e,start:a,end:v,size:n,getData:c}),o=m,a=v}return a<e.length&&pg({source:[],target:e,start:a,size:n,getData:c}),e}const jV={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function pM(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...jV[n],...e,...t,type:n}}function gM(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function mM(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function yM(t){t.push(t.shift())}function B_(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function _M({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,c=n.byteOffset,h=n.startIndices,p=i&&h,m=B_(n,e),v=n.isConstant;if(!p&&r>=m)return;const E=v?n.value:n.getBuffer().getData({srcByteOffset:c});if(n.settings.normalized&&!v){const S=s;s=(P,M)=>n.normalizeConstant(S(P,M))}const b=v?(S,P)=>s(E,P):(S,P)=>s(E.subarray(S,S+a),P),x=t.getData({length:r}),I=new Float32Array(m);HV({source:x,target:I,sourceStartIndices:i,targetStartIndices:h,size:a,getData:b}),t.byteLength<I.byteLength+c&&t.reallocate(I.byteLength+c),t.subData({data:I,offset:c})}class L_ extends GV{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:xh}),T(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return pM(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=VV(this.state.updateRanges,[r,i])}else this.state.updateRanges=xh}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=zV}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==xh),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let c=!0;if(o){for(const[h,p]of s)o.call(i,this,{data:n,startRow:h,endRow:p,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[h,p]of s){const m=Number.isFinite(h)?this.getVertexOffset(h):0,v=Number.isFinite(p)?this.getVertexOffset(p):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:m,endOffset:v})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Rn(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=Boolean(o.size)&&o.size!==this.size;return r.binaryAccessor=dM(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?n[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:c,value:h,size:p,startIndices:m}=e,{accessor:v,transform:E}=a,b=c.binaryAccessor||(typeof v=="function"?v:s[v]);Rn(typeof b=="function",'accessor "'.concat(v,'" is not a function'));let x=e.getVertexOffset(r);const{iterable:I,objectInfo:S}=_o(n,r,i);for(const P of I){S.index++;let M=b(P,S);if(E&&(M=E.call(this,M)),m){const O=(S.index<m.length-1?m[S.index+1]:o)-m[S.index];if(M&&Array.isArray(M[0])){let N=x;for(const z of M)e._normalizeValue(z,h,N),N+=p}else M&&M.length>p?h.set(M,x):(e._normalizeValue(M,S.target,0),u9({target:h,source:S.target,start:x,count:O}));x+=O*p}else e._normalizeValue(M,h,x),x+=p}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class WV{constructor({gl:e,attribute:n,timeline:r}){T(this,"gl",void 0),T(this,"type","interpolation"),T(this,"attributeInTransition",void 0),T(this,"settings",void 0),T(this,"attribute",void 0),T(this,"transition",void 0),T(this,"currentStartIndices",void 0),T(this,"currentLength",void 0),T(this,"transform",void 0),T(this,"buffers",void 0),this.gl=e,this.transition=new bu(r),this.attribute=n,this.attributeInTransition=new L_(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=$V(e,n);const i={byteLength:0,usage:35050};this.buffers=[new St(e,i),new St(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;yM(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)_M({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=B_(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:gM(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const QV=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function $V(t,e){const n=mM(e.size);return new x_(t,{vs:QV,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class XV{constructor({gl:e,attribute:n,timeline:r}){T(this,"gl",void 0),T(this,"type","spring"),T(this,"attributeInTransition",void 0),T(this,"settings",void 0),T(this,"attribute",void 0),T(this,"transition",void 0),T(this,"currentStartIndices",void 0),T(this,"currentLength",void 0),T(this,"texture",void 0),T(this,"framebuffer",void 0),T(this,"transform",void 0),T(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new bu(r),this.attribute=n,this.attributeInTransition=new L_(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=JV(e),this.framebuffer=KV(e,this.texture),this.transform=YV(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new St(e,i),new St(e,i),new St(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)_M({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=B_(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:gM(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),yM(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),a0(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function YV(t,e,n){const r=mM(e.size);return new x_(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function JV(t){return new Hn(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function KV(t,e){return new mn(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const ZV={interpolation:WV,spring:XV};class qV{constructor(e,{id:n,timeline:r}){T(this,"id",void 0),T(this,"isSupported",void 0),T(this,"gl",void 0),T(this,"timeline",void 0),T(this,"transitions",void 0),T(this,"needsRedraw",void 0),T(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=x_.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);!o||this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){ze.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=ZV[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(ze.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const _T="attributeManager.invalidate",eH="attributeManager.updateStart",tH="attributeManager.updateEnd",nH="attribute.updateStart",rH="attribute.allocate",iH="attribute.updateEnd";class sH{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){T(this,"id",void 0),T(this,"gl",void 0),T(this,"attributes",void 0),T(this,"updateTriggers",void 0),T(this,"needsRedraw",void 0),T(this,"userData",void 0),T(this,"stats",void 0),T(this,"attributeTransitionManager",void 0),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new qV(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Jn(_T,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Jn(_T,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let c=!1;Jn(eH,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const h in this.attributes){const p=this.attributes[h],m=p.settings.accessor;p.startIndices=r,p.numInstances=n,s[h]&&ze.removed("props.".concat(h),"data.attributes.".concat(h))(),p.setExternalBuffer(o[h])||p.setBinaryValue(typeof m=="string"?o[m]:void 0,e.startIndices)||typeof m=="string"&&!o[m]&&p.setConstantValue(s[m])||p.needsUpdate()&&(c=!0,this._updateAttribute({attribute:p,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||p.needsRedraw()}c&&Jn(tH,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new L_(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Jn(nH,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Jn(rH,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Jn(iH,n,r))}}class oH extends bu{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Ii(n,r,o)}}const vT=1e-5;function ET(t,e,n,r,i){const s=e-t,a=(n-e)*i,c=-s*r;return a+c+s+e}function aH(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=ET(t[o],e[o],n[o],r,i);return s}return ET(t,e,n,r,i)}function wT(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class lH extends bu{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=aH(s,o,n,r,i);const c=wT(a,n),h=wT(a,o);c<vT&&h<vT&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const cH={interpolation:oH,spring:lH};class AH{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const c=s.get(e),{value:h=c.settings.fromValue}=c;n=h,this.remove(e)}if(i=pM(i),!i)return;const o=cH[i.type];if(!o){ze.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function uH(t){const e=R_(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function fH(t,e){const n=vM({newProps:t,oldProps:e,propTypes:R_(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=dH(t,e);let i=!1;return r||(i=pH(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:gH(t,e),transitionsChanged:hH(t,e)}}function hH(t,e){if(!t.transitions)return!1;const n={},r=R_(t);let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&b1(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function vM({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=b1(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=b1(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function b1(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function dH(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function pH(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&TT(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&TT(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function gH(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function TT(t,e,n){let r=t.updateTriggers[n];r=r==null?{}:r;let i=e.updateTriggers[n];return i=i==null?{}:i,vM({oldProps:i,newProps:r,triggerName:n})}function R_(t){const e=t[yd],n=e&&e.constructor;return n?n._propTypes:{}}const mH="count(): argument not an object",yH="count(): argument not a container";function _H(t){if(!EH(t))throw new Error(mH);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(vH(t))return Object.keys(t).length;throw new Error(yH)}function vH(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function EH(t){return t!==null&&typeof t=="object"}function wH(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const TH={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},x1={};function bH(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof Hn)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let r=null;e.compressed&&(r={[10241]:e.data.length>1?9985:9729});const i=new Hn(n,{...e,parameters:{...TH,...r,...t.props.textureParameters}});return x1[i.id]=!0,i}function xH(t){!t||!(t instanceof Hn)||x1[t.id]&&(t.delete(),delete x1[t.id])}const CH={boolean:{validate(t,e){return!0},equal(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||QA(t)&&(t.length===3||t.length===4)},equal(t,e,n){return gg(t,e)}},accessor:{validate(t,e){const n=vd(t);return n==="function"||n===vd(e.value)},equal(t,e,n){return typeof e=="function"?!0:gg(t,e)}},array:{validate(t,e){return e.optional&&!t||QA(t)},equal(t,e,n){return n.compare?gg(t,e):t===e}},object:{equal(t,e,n){return n.compare?pa(t,e):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>bH(n,t),release:t=>{xH(t)}}};function gg(t,e){if(t===e)return!0;if(!QA(t)||!QA(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function SH(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=PH(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function PH(t,e){switch(vd(e)){case"object":return Lc(t,e);case"array":return Lc(t,{type:"array",value:e,compare:!1});case"boolean":return Lc(t,{type:"boolean",value:e});case"number":return Lc(t,{type:"number",value:e});case"function":return Lc(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Lc(t,e){return"type"in e?{name:t,...CH[e.type],...e}:"value"in e?{name:t,type:vd(e.value),...e}:{name:t,type:"object",value:e}}function QA(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function vd(t){return QA(t)?"array":t===null?"null":typeof t}function MH(t,e){const n=EM(t.constructor),r=Object.create(n);r[yd]=t,r[ia]={},r[Js]={};for(let i=0;i<e.length;++i){const s=e[i];for(const o in s)r[o]=s[o]}return Object.freeze(r),r}function EM(t){const e=Ed(t,"_mergedDefaultProps");return e||(IH(t),t._mergedDefaultProps)}function IH(t){if(!t.prototype)return;const n=Object.getPrototypeOf(t),r=EM(n),i=Ed(t,"defaultProps")||{},s=SH(i),o=BH(s.defaultProps,r,t),a={...n._propTypes,...s.propTypes};RH(o,a);const c={...n._deprecatedProps,...s.deprecatedProps};LH(o,c),t._mergedDefaultProps=o,t._propTypes=a,t._deprecatedProps=c}function BH(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=FH(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}function LH(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])wM(this,s)||(this[s]=r);ze.deprecated(i,e[n].join("/"))()}})}function RH(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=OH(o))}t[xl]=n,t[ia]={},Object.defineProperties(t,r)}function OH(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||hM(e)?this[ia][t]=e:this[Js][t]=e},get(){if(this[Js]){if(t in this[Js])return this[Js][t]||this[xl][t];if(t in this[ia]){const e=this[yd]&&this[yd].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[xl][t]}}return this[xl][t]}}}function wM(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ed(t,e){return wM(t,e)&&t[e]}function FH(t){const e=Ed(t,"layerName")||Ed(t,"componentName");return e||ze.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}let DH=0;class O_{constructor(...e){T(this,"id",void 0),T(this,"props",void 0),T(this,"count",void 0),this.props=MH(this,e),this.id=this.props.id,this.count=DH++}clone(e){const{props:n}=this,r={};for(const i in n[xl])i in n[Js]?r[i]=n[Js][i]:i in n[ia]&&(r[i]=n[ia][i]);return new this.constructor({...n,...r,...e})}}T(O_,"componentName","Component");T(O_,"defaultProps",{});const kH=Object.freeze({});class NH{constructor(e){T(this,"component",void 0),T(this,"onAsyncPropUpdated",void 0),T(this,"asyncProps",void 0),T(this,"oldProps",void 0),T(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||kH}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return Boolean(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){const n=e[Js]||{},r=e[ia]||e,i=e[xl]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(!!this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(hM(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){const{dataTransform:c}=this.component.props;c?s=c(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class UH extends NH{constructor({attributeManager:e,layer:n}){super(n),T(this,"attributeManager",void 0),T(this,"needsRedraw",void 0),T(this,"needsUpdate",void 0),T(this,"subLayers",void 0),T(this,"usesPickingColorCache",void 0),T(this,"changeFlags",void 0),T(this,"viewport",void 0),T(this,"uniformTransitions",void 0),T(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,n){const r=this.component.props.fetch;return r?r(n,{propName:e,layer:this.layer}):super._fetch(e,n)}_onResolve(e,n){const r=this.component.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:this.layer})}_onError(e,n){this.layer.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const GH="layer.changeFlag",zH="layer.initialize",VH="layer.update",HH="layer.finalize",jH="layer.matched",bT=2**24-1,WH=Object.freeze([]),QH=Tu(({oldViewport:t,viewport:e})=>t.equals(e));let zi=new Uint8ClampedArray(0);const $H={data:{type:"data",value:WH,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let c=o.contains(t);return!c&&!i&&(o.add({resourceId:t,data:ys(t,r),persistent:!1}),c=!0),c?o.subscribe({resourceId:t,onChange:h=>{var p;return(p=n.internalState)===null||p===void 0?void 0:p.reloadAsyncProp(e,h)},consumerId:n.id,requestId:e}):ys(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:wu.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:$e.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class nr extends O_{constructor(...e){super(...e),T(this,"internalState",null),T(this,"lifecycle",Ha.NO_STATE),T(this,"context",void 0),T(this,"state",void 0),T(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Rn(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=qP(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=YP(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return Rn(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Rn(this.internalState);const r=this.internalState.viewport||this.context.viewport;return eM(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===$e.DEFAULT||e===$e.LNGLAT||e===$e.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Rn(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:_H(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const n=this.getAttributeManager();if(!n)return null;const{positions:r,instancePositions:i}=n.attributes;return(e=r||i)===null||e===void 0?void 0:e.getBounds()}getShaders(e){for(const n of this.props.extensions)e=wH(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const c of r)n.invalidateAll(c);else n.invalidateAll();const{props:i,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable;if(o!==a&&n){const{pickingColors:c,instancePickingColors:h}=n.attributes,p=c||h;p&&(a&&p.constant&&(p.constant=!1,n.invalidate(p.id)),!p.value&&!a&&(p.constant=!0,p.value=[0,0,0]))}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!QH({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();!n||(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(zi.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>bT&&ze.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),zi=Vl.allocate(zi,n,{size:3,copy:!0,maxCount:Math.max(n,bT)});const i=Math.floor(zi.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),zi[o*3+0]=s[0],zi[o*3+1]=s[1],zi[o*3+2]=s[2]}e.value=zi.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;!r||(this.internalState.usesPickingColorCache&&r.value.buffer!==zi.buffer&&(r.value=zi.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Rn(!this.internalState),Rn(Number.isFinite(this.props.coordinateSystem)),Jn(zH,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new UH({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ze.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new AH(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Jn(jH,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.internalState.layer=this,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Jn(VH,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),c=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const p of this.props.extensions)p.updateState.call(this,a,p);const h=this.getModels()[0]!==c[0];this._postUpdate(a,h)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Jn(HH,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,c=a&&a(n)||[0,0];_s(s.gl,{polygonOffset:c}),oi(s.gl,r,()=>{const h={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const p of this.props.extensions)p.draw.call(this,h,p);this.draw(h)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Jn(GH,this,i,e)}const r=Boolean(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=fH(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){uH(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new sH(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:c}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==c){const h={};o||(h.pickingSelectedColor=null),Array.isArray(c)&&(h.pickingHighlightColor=c),Number.isInteger(a)&&(h.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(h)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;return n=n||i,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}T(nr,"defaultProps",$H);T(nr,"layerName","Layer");const XH="compositeLayer.renderLayers";class xs extends nr{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:h,highlightColor:p,coordinateSystem:m,coordinateOrigin:v,wrapLongitude:E,positionFormat:b,modelMatrix:x,extensions:I,fetch:S,operation:P,_subLayerProps:M}=this.props,O={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:h,highlightColor:p,coordinateSystem:m,coordinateOrigin:v,wrapLongitude:E,positionFormat:b,modelMatrix:x,extensions:I,fetch:S,operation:P},N=M&&e.id&&M[e.id],z=N&&N.updateTriggers,X=e.id||"sublayer";if(N){const Z=this.constructor._propTypes,Q=e.type?e.type._propTypes:{};for(const k in N){const D=Q[k]||Z[k];D&&D.type==="accessor"&&(N[k]=this.getSubLayerAccessor(N[k]))}}Object.assign(O,e,N),O.id="".concat(this.props.id,"-").concat(X),O.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...z};for(const Z of I){const Q=Z.getSubLayerProps.call(this,Z);Q&&Object.assign(O,Q,{updateTriggers:Object.assign(O.updateTriggers,Q.updateTriggers)})}return O}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=u0(s,Boolean),this.internalState.subLayers=r}Jn(XH,this,i,r);for(const s of r)s.parent=this}}T(xs,"layerName","CompositeLayer");const If=Math.PI/180,xT=180/Math.PI,Ch=6370972,sl=256;function YH(){const t=sl/Ch,e=Math.PI/180*sl;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class JH extends yo{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:s=.1,farZMultiplier:o=2,resolution:a=10}=e;let{height:c,altitude:h=1.5}=e;c=c||1,h=Math.max(.75,h);const p=new Ye().lookAt({eye:[0,-h,0],up:[0,0,1]}),m=Math.pow(2,i);p.rotateX(n*If),p.rotateZ(-r*If),p.scale(m/c);const v=Math.atan(.5/h),E=sl*2*m/c;super({...e,height:c,viewMatrix:p,longitude:r,latitude:n,zoom:i,distanceScales:YH(),fovyRadians:v*2,focalDistance:h,near:s,far:Math.min(2,1/E+1)*h*o}),T(this,"longitude",void 0),T(this,"latitude",void 0),T(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=a}get projectionMode(){return xi.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),o=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],s[0],i[0],o[0]),Math.min(r[1],s[1],i[1],o[1]),Math.max(r[0],s[0],i[0],o[0]),Math.max(r[1],s[1],i[1],o[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,{pixelUnprojectionMatrix:c}=this;let h;if(Number.isFinite(o))h=mg(c,[i,a,o,1]);else{const E=mg(c,[i,a,-1,1]),b=mg(c,[i,a,1,1]),x=((r||0)/Ch+1)*sl,I=sg(MP([],E,b)),S=sg(E),P=sg(b),M=(4*S*P-(I-S-P)**2)/16,O=4*M/I,N=Math.sqrt(S-O),z=Math.sqrt(Math.max(0,x*x-O)),X=(N-z)/Math.sqrt(I);h=tU([],E,b,X)}const[p,m,v]=this.unprojectPosition(h);return Number.isFinite(o)?[p,m,v]:Number.isFinite(r)?[p,m,r]:[p,m]}projectPosition(e){const[n,r,i=0]=e,s=n*If,o=r*If,a=Math.cos(o),c=(i/Ch+1)*sl;return[Math.sin(s)*a*c,-Math.cos(s)*a*c,Math.sin(o)*c]}unprojectPosition(e){const[n,r,i]=e,s=IP(e),o=Math.asin(i/s),c=Math.atan2(n,-r)*xT,h=o*xT,p=(s/sl-1)*Ch;return[c,h,p]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function mg(t,e){const n=ql([],e,t);return E_(n,n,1/n[3]),n}class TM{constructor(e){T(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&pa(this.opts,e.opts)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],o=this.props[i];r[i]=o,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof o=="function"&&(r[i]=this.getSubLayerAccessor(o)))}return r}initializeState(e,n){}updateState(e,n){}draw(e,n){}finalizeState(e,n){}}T(TM,"defaultProps",{});class bM{constructor(e){T(this,"opts",void 0),T(this,"typedArrayManager",void 0),T(this,"indexStarts",[0]),T(this,"vertexStarts",[0]),T(this,"vertexCount",0),T(this,"instanceCount",0),T(this,"attributes",void 0),T(this,"_attributeDefs",void 0),T(this,"data",void 0),T(this,"getGeometry",void 0),T(this,"geometryBuffer",void 0),T(this,"buffers",void 0),T(this,"positionSize",void 0),T(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=Vl,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:c=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=c,s&&(Rn(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),c||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(a))for(const h of a)this._rebuildGeometry(h);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?dM(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const c=s[a];c.copy=n,r[a]=o.allocate(r[a],e,c)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=_o(i,n,r);for(const c of o){a.index++;const h=s?s(c,a):null;e(h,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:c=1/0}=e||{},h={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((m,v)=>{const E=m&&this.normalizeGeometry(m);h[v]=E,r[v+1]=r[v]+(E?this.getGeometrySize(E):0)},a,c),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof St){const m=o.accessor.stride||this.positionSize*4;i=i||o.byteLength/m}else if(o.buffer){const m=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/m}else if(o.value){const m=o.value,v=o.stride/m.BYTES_PER_ELEMENT||this.positionSize;i=i||m.length/v}this._allocate(i,Boolean(e)),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const p={};this._forEachGeometry((m,v)=>{const E=h[v]||m;p.vertexStart=r[v],p.indexStart=n[v];const b=v<r.length-1?r[v+1]:i;p.geometrySize=b-r[v],p.geometryIndex=v,this.updateGeometryAttributes(E,p)},a,c),this.vertexCount=n[n.length-1]}}const KH=typeof window<"u"?K.exports.useLayoutEffect:K.exports.useEffect;function wd(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const ZH={position:"absolute",zIndex:-1};function xM(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>xM(n,e));if(d0(t)){if(qH(t))return e.style=ZH,K.exports.cloneElement(t,e);if(ej(t))return K.exports.cloneElement(t,e)}return t}function d0(t){return t&&typeof t=="object"&&"type"in t||!1}function qH(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function ej(t){const e=t.type;return e&&e.deckGLViewProps}function C1(t){if(typeof t=="function")return K.exports.createElement(sa,{},t);if(Array.isArray(t))return t.map(C1);if(d0(t)){if(t.type===K.exports.Fragment)return C1(t.props.children);if(wd(t.type,sa))return t}return t}function tj({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return K.exports.Children.forEach(C1(t),o=>{if(d0(o)){const a=o.type;if(wd(a,nr)){const c=nj(a,o.props);i.push(c)}else r.push(o);if(wd(a,sa)&&a!==sa&&o.props.id){const c=new a(o.props);s[c.id]=c}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function nj(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function rj({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,c=o;d0(o)&&wd(o.type,sa)&&(a=o.props.id||s,c=o.props.children);const h=r.getViewport(a),p=r.getViewState(a);if(h){const{x:m,y:v,width:E,height:b}=h;c=xM(c,{x:m,y:v,width:E,height:b,viewport:h,viewState:p}),i[a]||(i[a]={viewport:h,children:[]}),i[a].children.push(c)}}return Object.keys(i).map(o=>{const{viewport:a,children:c}=i[o],{x:h,y:p,width:m,height:v}=a,E={position:"absolute",left:h,top:p,width:m,height:v},b="view-".concat(o),x=K.exports.createElement("div",{key:b,id:b,style:E},...c);if(n){const I={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:S=>{S.viewId=o,e._onViewStateChange(S)}};return K.exports.createElement(n,{key:b,value:I},x)}return x})}const ij={mixBlendMode:null};function sj({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in ij?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function oj(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function CM(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function aj(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():CM(t)}});return r}const SM=K.exports.forwardRef((t,e)=>{const[n,r]=K.exports.useState(0),s=K.exports.useRef({control:null,version:n,forceUpdate:()=>r(N=>N+1)}).current,o=K.exports.useRef(null),a=K.exports.useRef(null),c=K.exports.useMemo(()=>tj(t),[t.layers,t.views,t.children]);let h=!0;const p=N=>{var z;return h&&t.viewState?(s.viewStateUpdateRequested=N,null):(s.viewStateUpdateRequested=null,(z=t.onViewStateChange)===null||z===void 0?void 0:z.call(t,N))},m=N=>{if(h)s.interactionStateUpdateRequested=N;else{var z;s.interactionStateUpdateRequested=null,(z=t.onInteractionStateChange)===null||z===void 0||z.call(t,N)}},v=K.exports.useMemo(()=>{const N={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:c.layers,views:c.views,onViewStateChange:p,onInteractionStateChange:m};return delete N._customRender,s.deck&&s.deck.setProps(N),N},[t]);K.exports.useEffect(()=>{const N=t.Deck||h0;return s.deck=aj(s,N,{...v,parent:o.current,canvas:a.current}),()=>{var z;return(z=s.deck)===null||z===void 0?void 0:z.finalize()}},[]),KH(()=>{CM(s);const{viewStateUpdateRequested:N,interactionStateUpdateRequested:z}=s;N&&p(N),z&&m(z)}),K.exports.useImperativeHandle(e,()=>oj(s),[]);const E=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:b,width:x,height:I,id:S,style:P}=t,{containerStyle:M,canvasStyle:O}=K.exports.useMemo(()=>sj({width:x,height:I,style:P}),[x,I,P]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===E||s.version!==n){s.lastRenderedViewports=E,s.version=n;const N=rj({children:c.children,deck:s.deck,ContextProvider:b}),z=K.exports.createElement("canvas",{key:"canvas",id:S||"deckgl-overlay",ref:a,style:O});s.control=K.exports.createElement("div",{id:"".concat(S||"deckgl","-wrapper"),ref:o,style:M},[z,N])}return h=!1,s.control});SM.defaultProps=h0.defaultProps;const lj=`#define SHADER_NAME arc-layer-vertex-shader

attribute vec3 positions;
attribute vec4 instanceSourceColors;
attribute vec4 instanceTargetColors;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceTargetPositions64Low;
attribute vec3 instancePickingColors;
attribute float instanceWidths;
attribute float instanceHeights;
attribute float instanceTilts;

uniform bool greatCircle;
uniform bool useShortestPath;
uniform float numSegments;
uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;
varying float isValid;

float paraboloid(float distance, float sourceZ, float targetZ, float ratio) {
  // d: distance on the xy plane
  // r: ratio of the current point
  // p: ratio of the peak of the arc
  // h: height multiplier
  // z = f(r) = sqrt(r * (p * 2 - r)) * d * h
  // f(0) = 0
  // f(1) = dz

  float deltaZ = targetZ - sourceZ;
  float dh = distance * instanceHeights;
  if (dh == 0.0) {
    return sourceZ + deltaZ * ratio;
  }
  float unitZ = deltaZ / dh;
  float p2 = unitZ * unitZ + 1.0;

  // sqrt does not deal with negative values, manually flip source and target if delta.z < 0
  float dir = step(deltaZ, 0.0);
  float z0 = mix(sourceZ, targetZ, dir);
  float r = mix(ratio, 1.0 - ratio, dir);
  return sqrt(r * (p2 - r)) * dh + z0;
}

// offset vector by strokeWidth pixels
// offset_direction is -1 (left) or 1 (right)
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));
}

vec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {
  float distance = length(source.xy - target.xy);
  float z = paraboloid(distance, source.z, target.z, segmentRatio);

  float tiltAngle = radians(instanceTilts);
  vec2 tiltDirection = normalize(target.xy - source.xy);
  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);

  return vec3(
    mix(source.xy, target.xy, segmentRatio) + tilt,
    z * cos(tiltAngle)
  );
}

/* Great circle interpolation
 * http://www.movable-type.co.uk/scripts/latlong.html
 */
float getAngularDist (vec2 source, vec2 target) {
  vec2 sourceRadians = radians(source);
  vec2 targetRadians = radians(target);
  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);
  vec2 shd_sq = sin_half_delta * sin_half_delta;

  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;
  return 2.0 * asin(sqrt(a));
}

vec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {
  vec2 lngLat;

  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    lngLat = (1.0 - t) * source.xy + t * target.xy;
  } else {
    float a = sin((1.0 - t) * angularDist);
    float b = sin(t * angularDist);
    vec3 p = source3D.yxz * a + target3D.yxz * b;
    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));
  }

  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);

  return vec3(lngLat, z);
}

/* END GREAT CIRCLE */

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  float segmentIndex = positions.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));
  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));

  // if it's the first point, use next - current as direction
  // otherwise use current - prev
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  isValid = 1.0;

  uv = vec2(segmentRatio, positions.y);
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;

  vec4 curr;
  vec4 next;
  vec3 source;
  vec3 target;

  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));
    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));
    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);

    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);
    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);
    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);

    if (abs(currPos.x - prevPos.x) > 180.0) {
      indexDir = -1.0;
      isValid = 0.0;
    } else if (abs(currPos.x - nextPos.x) > 180.0) {
      indexDir = 1.0;
      isValid = 0.0;
    }
    nextPos = indexDir < 0.0 ? prevPos : nextPos;
    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;

    if (isValid == 0.0) {
      // split at the 180th meridian
      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;
      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);
      currPos = mix(currPos, nextPos, t);
      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);
    }

    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);
    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);
  
    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);
    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));
  
  } else {
    vec3 source_world = instanceSourcePositions;
    vec3 target_world = instanceTargetPositions;
    if (useShortestPath) {
      source_world.x = mod(source_world.x + 180., 360.0) - 180.;
      target_world.x = mod(target_world.x + 180., 360.0) - 180.;

      float deltaLng = target_world.x - source_world.x;
      if (deltaLng > 180.) target_world.x -= 360.;
      if (deltaLng < -180.) source_world.x -= 360.;
    }
    source = project_position(source_world, instanceSourcePositions64Low);
    target = project_position(target_world, instanceTargetPositions64Low);

    // common x at longitude=-180
    float antiMeridianX = 0.0;

    if (useShortestPath) {
      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;
      }
      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);

      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {
        isValid = 0.0;
        indexDir = sign(segmentRatio - thresholdRatio);
        segmentRatio = thresholdRatio;
      }
    }

    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
    vec3 currPos = interpolateFlat(source, target, segmentRatio);
    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);

    if (useShortestPath) {
      if (nextPos.x < antiMeridianX) {
        currPos.x += TILE_SIZE;
        nextPos.x += TILE_SIZE;
      }
    }

    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));
    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));
    geometry.position = vec4(currPos, 1.0);
  }

  // Multiply out width and clamp to limits
  // mercator pixels are interpreted as screen pixels
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );

  // extrude
  vec3 offset = vec3(
    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);
  vColor = vec4(color.rgb, color.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,cj=`#define SHADER_NAME arc-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;
varying float isValid;

void main(void) {
  if (isValid == 0.0) {
    discard;
  }

  gl_FragColor = vColor;
  geometry.uv = uv;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Td=[0,0,0,255],Aj={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:Td},getTargetColor:{type:"accessor",value:Td},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class F_ extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:lj,fs:cj,modules:[ci,Ai]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:Td},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:Td},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:s,greatCircle:o,wrapLongitude:a}=this.props;this.state.model.setUniforms(e).setUniforms({greatCircle:o,widthUnits:Vr[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s,useShortestPath:a}).draw()}_getModel(e){let n=[];for(let s=0;s<50;s++)n=n.concat([s,1,0,s,-1,0]);const i=new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:5,attributes:{positions:new Float32Array(n)}}),isInstanced:!0});return i.setUniforms({numSegments:50}),i}}T(F_,"layerName","ArcLayer");T(F_,"defaultProps",Aj);const uj=new Uint16Array([0,2,1,0,3,2]),fj=new Float32Array([0,1,0,0,1,0,1,1]);function hj(t,e){if(!e)return dj(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,s=Math.ceil(r/e)+1,o=(i-1)*(s-1)*6,a=new Uint32Array(o),c=new Float32Array(i*s*2),h=new Float64Array(i*s*3);let p=0,m=0;for(let v=0;v<i;v++){const E=v/(i-1);for(let b=0;b<s;b++){const x=b/(s-1),I=pj(t,E,x);h[p*3+0]=I[0],h[p*3+1]=I[1],h[p*3+2]=I[2]||0,c[p*2+0]=E,c[p*2+1]=1-x,v>0&&b>0&&(a[m++]=p-s,a[m++]=p-s-1,a[m++]=p-1,a[m++]=p-s,a[m++]=p-1,a[m++]=p),p++}}return{vertexCount:o,positions:h,indices:a,texCoords:c}}function dj(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:uj,texCoords:fj}}function pj(t,e,n){return Ii(Ii(t[0],t[1],n),Ii(t[3],t[2],n),e)}const gj=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,mj=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,yj=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  return mix(transparentColor, vec4(color, 1.0), alpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(mj,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),_j={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:$e.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};class PM extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:gj,fs:yj,modules:[ci,Ai]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var s;const{gl:o}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(o),i.invalidateAll()}if(e.bounds!==n.bounds){const o=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const c in a)o&&o[c]!==a[c]&&i.invalidate(c);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:s}=n;r.index=0;const o=vj(r.color),a=[Math.floor(o[0]*i),Math.floor(o[1]*s)];return r.bitmap={size:{width:i,height:s},uv:o,pixel:a},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return CT(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),hj(n,this.context.viewport.resolution)}_getModel(e){return e?new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:s,bounds:o,disablePicking:a}=this.state,{image:c,desaturate:h,transparentColor:p,tintColor:m}=this.props;r.pickingActive&&a||c&&i&&i.setUniforms(n).setUniforms({bitmapTexture:c,desaturate:h,transparentColor:p.map(v=>v/255),tintColor:m.slice(0,3).map(v=>v/255),coordinateConversion:s,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=$e;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:s}=this.props;if(!CT(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const o=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&o===n)return{coordinateConversion:-1,bounds:s};if(i===n&&o===e){const a=uo([s[0],s[1]]),c=uo([s[2],s[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],c[0],c[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}T(PM,"layerName","BitmapLayer");T(PM,"defaultProps",_j);function vj(t){const[e,n,r]=t,i=(r&240)/256,s=(r&15)/16;return[(e+s)/256,(n+i)/256]}function CT(t){return Number.isFinite(t[0])}const Ej=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  // convert size in meters to pixels, then scaled and clamp
 
  // project meters to pixels and clamp to limits 
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );

  // scale icon height to match instanceSize
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;

  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,wj=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);

  // if colorMode == 0, use pixel color from the texture
  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  // Take the global opacity and the alpha from vColor into account for the alpha component
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Tj=1024,bj=4,ST=()=>{},PT={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071};function xj(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Cj(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}function $A(t){return t&&(t.id||t.url)}function Sj(t,e,n,r){const i=t.width,s=t.height,o=new Hn(t.gl,{width:e,height:n,parameters:r});return m8(t,o,{targetY:0,width:i,height:s}),t.delete(),o}function MT(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=$A(i);t[o]={...i,x:s,y:n}}}function Pj({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let c=0;c<t.length;c++){const h=t[c],p=$A(h);if(!n[p]){const{height:m,width:v}=h;r+v+e>o&&(MT(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:h,xOffset:r}),r=r+v+e,s=Math.max(s,m)}}return a.length>0&&MT(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:xj(s+i+e)}}function Mj(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=_o(t);for(const o of i){s.index++;const a=e(o,s),c=$A(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[c]&&(!n[c]||a.url!==n[c].url)&&(r[c]={...a,source:o,sourceIndex:s.index})}return r}class Ij{constructor(e,{onUpdate:n=ST,onError:r=ST}){T(this,"gl",void 0),T(this,"onUpdate",void 0),T(this,"onError",void 0),T(this,"_loadOptions",null),T(this,"_texture",null),T(this,"_externalTexture",null),T(this,"_mapping",{}),T(this,"_textureParameters",null),T(this,"_pendingCount",0),T(this,"_autoPacking",!1),T(this,"_xOffset",0),T(this,"_yOffset",0),T(this,"_rowHeight",0),T(this,"_buffer",bj),T(this,"_canvasWidth",Tj),T(this,"_canvasHeight",0),T(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?$A(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var o;(o=this._texture)===null||o===void 0||o.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(Mj(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:c}=Pj({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=c,this._texture||(this._texture=new Hn(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||PT})),this._texture.height!==this._canvasHeight&&(this._texture=Sj(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||PT)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d");for(const r of e)this._pendingCount++,ys(r.url,r_,this._loadOptions).then(i=>{const s=$A(r),{x:o,y:a,width:c,height:h}=this._mapping[s],p=Cj(n,i,c,h);this._texture.setSubImageData({data:p,x:o,y:a,width:c,height:h}),this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const MM=[0,0,0,255],Bj={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:MM},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class p0 extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:Ej,fs:wj,modules:[ci,Ai]})}initializeState(){this.state={iconManager:new Ij(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:MM},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:c,getIcon:h,textureParameters:p}=n,{iconManager:m}=this.state,v=o||this.internalState.isAsyncPropLoading("iconAtlas");if(m.setProps({loadOptions:n.loadOptions,autoPacking:!v,iconAtlas:o,iconMapping:v?a:null,textureParameters:p}),v?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&m.packIcons(c,h),i.extensionsChanged){var E;const{gl:b}=this.context;(E=this.state.model)===null||E===void 0||E.delete(),this.state.model=this._getModel(b),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:c}=this.state,h=c.getTexture();h&&this.state.model.setUniforms(e).setUniforms({iconsTexture:h,iconsTextureDim:[h.width,h.height],sizeUnits:Vr[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):ze.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}T(p0,"defaultProps",Bj);T(p0,"layerName","IconLayer");const Lj=`#define SHADER_NAME line-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions64Low;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute float instanceWidths;

uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float useShortestPath;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;

// offset vector by strokeWidth pixels
// offset_direction is -1 (left) or 1 (right)
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

vec3 splitLine(vec3 a, vec3 b, float x) {
  float t = (x - a.x) / (b.x - a.x);
  return vec3(x, mix(a.yz, b.yz, t));
}

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  vec3 source_world = instanceSourcePositions;
  vec3 target_world = instanceTargetPositions;
  vec3 source_world_64low = instanceSourcePositions64Low;
  vec3 target_world_64low = instanceTargetPositions64Low;

  if (useShortestPath > 0.5 || useShortestPath < -0.5) {
    source_world.x = mod(source_world.x + 180., 360.0) - 180.;
    target_world.x = mod(target_world.x + 180., 360.0) - 180.;
    float deltaLng = target_world.x - source_world.x;

    if (deltaLng * useShortestPath > 180.) {
      source_world.x += 360. * useShortestPath;
      source_world = splitLine(source_world, target_world, 180. * useShortestPath);
      source_world_64low = vec3(0.0);
    } else if (deltaLng * useShortestPath < -180.) {
      target_world.x += 360. * useShortestPath;
      target_world = splitLine(source_world, target_world, 180. * useShortestPath);
      target_world_64low = vec3(0.0);
    } else if (useShortestPath < 0.) {
      // Line is not split, abort
      gl_Position = vec4(0.);
      return;
    }
  }

  // Position
  vec4 source_commonspace;
  vec4 target_commonspace;
  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);
  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);
  
  // linear interpolation of source & target to pick right coord
  float segmentIndex = positions.x;
  vec4 p = mix(source, target, segmentIndex);
  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);
  uv = positions.xy;
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;

  // Multiply out width and clamp to limits
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );

  // extrude
  vec3 offset = vec3(
    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Color
  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Rj=`#define SHADER_NAME line-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Oj=[0,0,0,255],Fj={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:Oj},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class IM extends nr{getShaders(){return super.getShaders({vs:Lj,fs:Rj,modules:[ci,Ai]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:s,wrapLongitude:o}=this.props;this.state.model.setUniforms(e).setUniforms({widthUnits:Vr[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s,useShortestPath:o?1:0}).draw(),o&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(e){const n=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:5,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}T(IM,"layerName","LineLayer");T(IM,"defaultProps",Fj);const Dj=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);

  // position on the containing square in [-1, 1] space
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  // Find the center of the point and add the current vertex
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply lighting
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);

  // Apply opacity to instance color, or return instance picking color
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,kj=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,BM=[0,0,0,255],LM=[0,0,1],Nj={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:LM},getColor:{type:"accessor",value:BM},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function Uj(t){const{header:e,attributes:n}=t;!e||!n||(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}class D_ extends nr{getShaders(){return super.getShaders({vs:Dj,fs:kj,modules:[ci,T_,Ai]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:LM},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:BM}})}updateState(e){const{changeFlags:n,props:r}=e;if(super.updateState(e),n.extensionsChanged){var i;const{gl:s}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}n.dataChanged&&Uj(r.data)}draw({uniforms:e}){const{pointSize:n,sizeUnits:r}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:Vr[r],radiusPixels:n}).draw()}_getModel(e){const n=[];for(let r=0;r<3;r++){const i=r/3*Math.PI*2;n.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:4,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}T(D_,"layerName","PointCloudLayer");T(D_,"defaultProps",Nj);const Gj=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  
  // Multiply out line width and clamp to limits
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;

  // Expand geometry to accomodate edge smoothing
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;

  // position on the containing square in [-1, 1] space
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
  }

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply opacity to instance color, or return instance picking color
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,zj=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (filled) {
    gl_FragColor = vFillColor;
  } else {
    discard;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,IT=[0,0,0,255],Vj={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:IT},getLineColor:{type:"accessor",value:IT},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class g0 extends nr{getShaders(){return super.getShaders({vs:Gj,fs:zj,modules:[ci,Ai]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:c,antialiasing:h,lineWidthUnits:p,lineWidthScale:m,lineWidthMinPixels:v,lineWidthMaxPixels:E}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:o?1:0,filled:a,billboard:c,antialiasing:h,radiusUnits:Vr[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Vr[p],lineWidthScale:m,lineWidthMinPixels:v,lineWidthMaxPixels:E}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}T(g0,"defaultProps",Vj);T(g0,"layerName","ScatterplotLayer");const k_={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function N_(t,e,n={}){return Hj(t,n)!==e?(jj(t,n),!0):!1}function Hj(t,e={}){return Math.sign(bd(t,e))}function bd(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let o=n,a=r-i;o<r;o+=i)s+=(t[o]-t[a])*(t[o+1]+t[a+1]),a=o;return s/2}function jj(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const c=n+a*i,h=n+(s-1-a)*i;for(let p=0;p<i;++p){const m=t[c+p];t[c+p]=t[h+p],t[h+p]=m}}}function Wj(t,e,n=2,r){const i=e&&e.length,s=i?e[0]*n:t.length;let o=RM(t,0,s,n,!0,r&&r[0]);const a=[];if(!o||o.next===o.prev)return a;let c,h,p,m,v,E,b;if(i&&(o=Jj(t,e,o,n,r)),t.length>80*n){m=h=t[0],v=p=t[1];for(let x=n;x<s;x+=n)E=t[x],b=t[x+1],E<m&&(m=E),b<v&&(v=b),E>h&&(h=E),b>p&&(p=b);c=Math.max(h-m,p-v),c=c!==0?1/c:0}return XA(o,a,n,m,v,c),a}function RM(t,e,n,r,i,s){let o,a;if(s===void 0&&(s=bd(t,{start:e,end:n,size:r})),i===s<0)for(o=e;o<n;o+=r)a=BT(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=BT(o,t[o],t[o+1],a);return a&&m0(a,a.next)&&(JA(a),a=a.next),a}function ho(t,e){if(!t)return t;e||(e=t);let n=t,r;do if(r=!1,!n.steiner&&(m0(n,n.next)||en(n.prev,n,n.next)===0)){if(JA(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function XA(t,e,n,r,i,s,o){if(!t)return;!o&&s&&t7(t,r,i,s);let a=t,c,h;for(;t.prev!==t.next;){if(c=t.prev,h=t.next,s?$j(t,r,i,s):Qj(t)){e.push(c.i/n),e.push(t.i/n),e.push(h.i/n),JA(t),t=h.next,a=h.next;continue}if(t=h,t===a){o?o===1?(t=Xj(ho(t),e,n),XA(t,e,n,r,i,s,2)):o===2&&Yj(t,e,n,r,i,s):XA(ho(t),e,n,r,i,s,1);break}}}function Qj(t){const e=t.prev,n=t,r=t.next;if(en(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(ol(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&en(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function $j(t,e,n,r){const i=t.prev,s=t,o=t.next;if(en(i,s,o)>=0)return!1;const a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,c=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,h=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,p=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,m=S1(a,c,e,n,r),v=S1(h,p,e,n,r);let E=t.prevZ,b=t.nextZ;for(;E&&E.z>=m&&b&&b.z<=v;){if(E!==t.prev&&E!==t.next&&ol(i.x,i.y,s.x,s.y,o.x,o.y,E.x,E.y)&&en(E.prev,E,E.next)>=0||(E=E.prevZ,b!==t.prev&&b!==t.next&&ol(i.x,i.y,s.x,s.y,o.x,o.y,b.x,b.y)&&en(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;E&&E.z>=m;){if(E!==t.prev&&E!==t.next&&ol(i.x,i.y,s.x,s.y,o.x,o.y,E.x,E.y)&&en(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;b&&b.z<=v;){if(b!==t.prev&&b!==t.next&&ol(i.x,i.y,s.x,s.y,o.x,o.y,b.x,b.y)&&en(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Xj(t,e,n){let r=t;do{const i=r.prev,s=r.next.next;!m0(i,s)&&OM(i,r,r.next,s)&&YA(i,s)&&YA(s,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(s.i/n),JA(r),JA(r.next),r=t=s),r=r.next}while(r!==t);return ho(r)}function Yj(t,e,n,r,i,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&i7(o,a)){let c=FM(o,a);o=ho(o,o.next),c=ho(c,c.next),XA(o,e,n,r,i,s),XA(c,e,n,r,i,s);return}a=a.next}o=o.next}while(o!==t)}function Jj(t,e,n,r,i){const s=[];let o,a,c,h,p;for(o=0,a=e.length;o<a;o++)c=e[o]*r,h=o<a-1?e[o+1]*r:t.length,p=RM(t,c,h,r,!1,i&&i[o+1]),p===p.next&&(p.steiner=!0),s.push(r7(p));for(s.sort(Kj),o=0;o<s.length;o++)Zj(s[o],n),n=ho(n,n.next);return n}function Kj(t,e){return t.x-e.x}function Zj(t,e){if(e=qj(t,e),e){const n=FM(e,t);ho(e,e.next),ho(n,n.next)}}function qj(t,e){let n=e;const r=t.x,i=t.y;let s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const v=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(v<=r&&v>s){if(s=v,v===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o;const a=o,c=o.x,h=o.y;let p=1/0,m;n=o;do r>=n.x&&n.x>=c&&r!==n.x&&ol(i<h?r:s,i,c,h,i<h?s:r,i,n.x,n.y)&&(m=Math.abs(i-n.y)/(r-n.x),YA(n,t)&&(m<p||m===p&&(n.x>o.x||n.x===o.x&&e7(o,n)))&&(o=n,p=m)),n=n.next;while(n!==a);return o}function e7(t,e){return en(t.prev,t,e.prev)<0&&en(e.next,t,t.next)<0}function t7(t,e,n,r){let i=t;do i.z===null&&(i.z=S1(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,n7(i)}function n7(t){let e,n,r=1,i,s,o,a,c,h;do{for(s=t,t=null,h=null,i=0;s;){for(i++,a=s,o=0,n=0;n<r&&(o++,a=a.nextZ,!!a);n++);for(c=r;o>0||c>0&&a;)o!==0&&(c===0||!a||s.z<=a.z)?(e=s,s=s.nextZ,o--):(e=a,a=a.nextZ,c--),h?h.nextZ=e:t=e,e.prevZ=h,h=e;s=a}h.nextZ=null,r*=2}while(i>1);return t}function S1(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function r7(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function ol(t,e,n,r,i,s,o,a){return(i-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(i-o)*(r-a)>=0}function i7(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!s7(t,e)&&(YA(t,e)&&YA(e,t)&&o7(t,e)&&(en(t.prev,t,e.prev)||en(t,e.prev,e))||m0(t,e)&&en(t.prev,t,t.next)>0&&en(e.prev,e,e.next)>0)}function en(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function m0(t,e){return t.x===e.x&&t.y===e.y}function OM(t,e,n,r){const i=Lf(en(t,e,n)),s=Lf(en(t,e,r)),o=Lf(en(n,r,t)),a=Lf(en(n,r,e));return!!(i!==s&&o!==a||i===0&&Bf(t,n,e)||s===0&&Bf(t,r,e)||o===0&&Bf(n,t,r)||a===0&&Bf(n,e,r))}function Bf(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Lf(t){return t>0?1:t<0?-1:0}function s7(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&OM(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function YA(t,e){return en(t.prev,t,t.next)<0?en(t,e,t.next)>=0&&en(t,t.prev,e)>=0:en(t,e,t.prev)<0||en(t,t.next,e)<0}function o7(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function FM(t,e){const n=new P1(t.i,t.x,t.y),r=new P1(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function BT(t,e,n,r){const i=new P1(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function JA(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function P1(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Si(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function M1(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function KA(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function I1(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function Sh(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function DM(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},c=(a-o)/n;let h=[];const p=[h],m=KA(t,0,n,o);let v,E;const b=NM(m,i,s,[]),x=[];Si(h,m);for(let I=1;I<c;I++){for(v=KA(t,I,n,o,v),E=Sh(v,b);E;){I1(m,v,E,b,x);const S=Sh(x,b);S&&(I1(m,x,S,b,x),E=S),Si(h,x),M1(m,x),l7(b,i,E),r&&h.length>n&&(h=[],p.push(h),Si(h,m)),E=Sh(v,b)}Si(h,v),M1(m,v)}return r?p:p[0]}const LT=0,a7=1;function Rf(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function kM(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],c=[{pos:t,types:o?new Array(t.length/r).fill(a7):null,holes:e||[]}],h=[[],[]];let p=[];for(;c.length;){const{pos:m,types:v,holes:E}=c.shift();c7(m,r,E[0]||m.length,h),p=NM(h[0],i,s,p);const b=Sh(h[1],p);if(b){let x=RT(m,v,r,0,E[0]||m.length,p,b);const I={pos:x[0].pos,types:x[0].types,holes:[]},S={pos:x[1].pos,types:x[1].types,holes:[]};c.push(I,S);for(let P=0;P<E.length;P++)x=RT(m,v,r,E[P],E[P+1]||m.length,p,b),x[0]&&(I.holes.push(I.pos.length),I.pos=Rf(I.pos,x[0].pos),o&&(I.types=Rf(I.types,x[0].types))),x[1]&&(S.holes.push(S.pos.length),S.pos=Rf(S.pos,x[1].pos),o&&(S.types=Rf(S.types,x[1].types)))}else{const x={positions:m};o&&(x.edgeTypes=v),E.length&&(x.holeIndices=E),a.push(x)}}return a}function RT(t,e,n,r,i,s,o){const a=(i-r)/n,c=[],h=[],p=[],m=[],v=[];let E,b,x;const I=KA(t,a-1,n,r);let S=Math.sign(o&8?I[1]-s[3]:I[0]-s[2]),P=e&&e[a-1],M=0,O=0;for(let N=0;N<a;N++)E=KA(t,N,n,r,E),b=Math.sign(o&8?E[1]-s[3]:E[0]-s[2]),x=e&&e[r/n+N],b&&S&&S!==b&&(I1(I,E,o,s,v),Si(c,v)&&p.push(P),Si(h,v)&&m.push(P)),b<=0?(Si(c,E)&&p.push(x),M-=b):p.length&&(p[p.length-1]=LT),b>=0?(Si(h,E)&&m.push(x),O+=b):m.length&&(m[m.length-1]=LT),M1(I,E),S=b,P=x;return[M?{pos:c,types:e&&p}:null,O?{pos:h,types:e&&m}:null]}function NM(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function l7(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function c7(t,e,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let c=0;c<n;c+=e){const h=t[c],p=t[c+1];i=h<i?h:i,s=h>s?h:s,o=p<o?p:o,a=p>a?p:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}const A7=85.051129;function u7(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);UM(o,n,0,i-r);const a=DM(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const c of a)GM(c,n);return a}function f7(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let c=0,h=0;for(let m=0;m<=e.length;m++){const v=e[m]||t.length,E=h,b=h7(t,r,c,v);for(let x=b;x<v;x++)o[h++]=t[x];for(let x=c;x<b;x++)o[h++]=t[x];UM(o,r,E,h),d7(o,r,E,h,n==null?void 0:n.maxLatitude),c=v,a[m]=h}a.pop();const p=kM(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const m of p)GM(m.positions,r);return p}function h7(t,e,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=e){const a=Math.abs(t[o]);a>i&&(i=a,s=o-1)}return s}function d7(t,e,n,r,i=A7){const s=t[n],o=t[r-e];if(Math.abs(s-o)>180){const a=KA(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,Si(t,a),a[1]=Math.sign(a[1])*i,Si(t,a),a[0]=s,Si(t,a)}}function UM(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function GM(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}class p7 extends Ar{constructor(e){const{id:n=Ri("column-geometry")}=e,{indices:r,attributes:i}=g7(e);super({...e,id:n,indices:r,attributes:i})}}function g7(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(ze.assert(i.length>=r),i=i.flatMap(E=>[E[0],E[1]]),N_(i,k_.COUNTER_CLOCKWISE));const s=n>0,o=r+1,a=s?o*3+1:r,c=Math.PI*2/r,h=new Uint16Array(s?r*3*2:0),p=new Float32Array(a*3),m=new Float32Array(a*3);let v=0;if(s){for(let E=0;E<o;E++){const b=E*c,x=E%r,I=Math.sin(b),S=Math.cos(b);for(let P=0;P<2;P++)p[v+0]=i?i[x*2]:S*e,p[v+1]=i?i[x*2+1]:I*e,p[v+2]=(1/2-P)*n,m[v+0]=i?i[x*2]:S,m[v+1]=i?i[x*2+1]:I,v+=3}p[v+0]=p[v-3],p[v+1]=p[v-2],p[v+2]=p[v-1],v+=3}for(let E=s?0:1;E<o;E++){const b=Math.floor(E/2)*Math.sign(.5-E%2),x=b*c,I=(b+r)%r,S=Math.sin(x),P=Math.cos(x);p[v+0]=i?i[I*2]:P*e,p[v+1]=i?i[I*2+1]:S*e,p[v+2]=n/2,m[v+2]=1,v+=3}if(s){let E=0;for(let b=0;b<r;b++)h[E++]=b*2+0,h[E++]=b*2+2,h[E++]=b*2+0,h[E++]=b*2+1,h[E++]=b*2+1,h[E++]=b*2+3}return{indices:h,attributes:{POSITION:{size:3,value:p},NORMAL:{size:3,value:m}}}}const m7=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;

// Custom uniforms
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;

// Result
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  // rotate primitive position and normal
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));

  // calculate elevation, if 3d not enabled set to 0
  // cylindar gemoetry height are between -1.0 to 1.0, transform it to between 0, 1
  float elevation = 0.0;
  // calculate stroke offset
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }

  // if alpha == 0.0 or z < 0.0, do not render element
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;

  // project center of column
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Light calculations
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,y7=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,xd=[0,0,0,255],_7={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:xd},getLineColor:{type:"accessor",value:xd},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class y0 extends nr{getShaders(){const{gl:e}=this.context,n=!nt(e),r={},i=this.props.flatShading&&l0(e,Bt.GLSL_DERIVATIVES);return i&&(r.FLAT_SHADING=1),super.getShaders({vs:m7,fs:y7,defines:r,transpileToGLSL100:n,modules:[ci,i?GP:T_,Ai]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:xd},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:xd},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=i.extensionsChanged||n.flatShading!==r.flatShading;if(s){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}(s||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new p7({radius:1,height:r?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o];s+=Math.sqrt(a[0]*a[0]+a[1]*a[1])/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModel(e){return new tr(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const s=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3,wireframeVertexCount:s.indices.value.length}),this.state.model.setProps({geometry:s})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:c,filled:h,stroked:p,wireframe:m,offset:v,coverage:E,radius:b,angle:x}=this.props,{model:I,fillVertexCount:S,wireframeVertexCount:P,edgeDistance:M}=this.state;I.setUniforms(e).setUniforms({radius:b,angle:x/180*Math.PI,offset:v,extruded:c,stroked:p,coverage:E,elevationScale:a,edgeDistance:M,radiusUnits:Vr[o],widthUnits:Vr[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s}),c&&m&&(I.setProps({isIndexed:!0}),I.setVertexCount(P).setDrawMode(1).setUniforms({isStroke:!0}).draw()),h&&(I.setProps({isIndexed:!1}),I.setVertexCount(S).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!c&&p&&(I.setProps({isIndexed:!1}),I.setVertexCount(S*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}T(y0,"layerName","ColumnLayer");T(y0,"defaultProps",_7);const v7={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}};class zM extends y0{getGeometry(e){return new HG}draw({uniforms:e}){const{elevationScale:n,extruded:r,offset:i,coverage:s,cellSize:o,angle:a,radiusUnits:c}=this.props;this.state.model.setUniforms(e).setUniforms({radius:o/2,radiusUnits:Vr[c],angle:a,offset:i,extruded:r,coverage:s,elevationScale:n,edgeDistance:1,isWireframe:!1}).draw()}}T(zM,"layerName","GridCellLayer");T(zM,"defaultProps",v7);function E7(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?DM(i,{size:e,gridResolution:n}):r?u7(i,{size:e}):i}const w7=1,T7=2,yg=4;class b7 extends bM{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?E7(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(OT(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&OT(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=yg,r[s+o-2]=yg):(r[s]+=w7,r[s+o-2]+=T7),r[s+o-1]=yg}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,c=0;c<s;a++,c++)this.getPointOnPath(e,c,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function OT(t){return Array.isArray(t[0])}const x7=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}

// calculate line join positions
vec3 lineJoin(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  // side of the segment - -1: left, 0: center, 1: right
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);

  // tangent of the corner
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  // direction of the corner
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  // direction of the segment
  vec2 dir = isEnd ? dirA : dirB;
  // direction of the extrusion
  vec2 perp = isEnd ? perpA : perpB;
  // length of the segment
  float L = isEnd ? lenA : lenB;

  // A = angle of the corner
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));

  // -1: right, 1: left
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);

  // relative position to the corner:
  // -1: inside (smaller side of the angle)
  // 0: center
  // 1: outside (bigger side of the angle)
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  // trim if inside corner extends further than the line segment
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);

  // special treatment for start cap and end cap
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;

  // extend out a triangle to envelope the round cap
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }

  // Generate variables for fragment shader
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return currPoint + offset;
}

// In clipspace extrusion, if a line extends behind the camera, clip it to avoid visual artifacts
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    // Extrude in clipspace
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 pos = lineJoin(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);
  } else {
    // Extrude in commonspace
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec4 pos = vec4(
      lineJoin(prevPosition, currPosition, nextPosition, width.xy),
      1.0);
    geometry.position = pos;
    gl_Position = project_common_position_to_clipspace(pos);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,C7=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
/*
 * vPathPosition represents the relative coordinates of the current fragment on the path segment.
 * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.
 * vPathPosition.y - position along the length of the path, between [0, L / width].
 */
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    // if joint is rounded, test distance from the corner
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    // trim miter
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,VM=[0,0,0,255],S7={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:VM},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},_g={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class oa extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:x7,fs:C7,modules:[ci,Ai]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:_g,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:_g,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:_g,defaultValue:VM},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new b7({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,c=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:c.getPath,buffers:c,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else this._disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:c,widthMaxPixels:h}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Vr[o],widthScale:a,miterLimit:s,widthMinPixels:c,widthMaxPixels:h}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}T(oa,"defaultProps",S7);T(oa,"layerName","PathLayer");var U_={exports:{}};U_.exports=_0;U_.exports.default=_0;function _0(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=HM(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,c,h,p,m,v,E;if(r&&(s=L7(t,e,s,n)),t.length>80*n){a=h=t[0],c=p=t[1];for(var b=n;b<i;b+=n)m=t[b],v=t[b+1],m<a&&(a=m),v<c&&(c=v),m>h&&(h=m),v>p&&(p=v);E=Math.max(h-a,p-c),E=E!==0?32767/E:0}return ZA(s,o,n,a,c,E,0),o}function HM(t,e,n,r,i){var s,o;if(i===R1(t,e,n,r)>0)for(s=e;s<n;s+=r)o=FT(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=FT(s,t[s],t[s+1],o);return o&&v0(o,o.next)&&(eu(o),o=o.next),o}function aa(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(v0(n,n.next)||tn(n.prev,n,n.next)===0)){if(eu(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function ZA(t,e,n,r,i,s,o){if(!!t){!o&&s&&k7(t,r,i,s);for(var a=t,c,h;t.prev!==t.next;){if(c=t.prev,h=t.next,s?M7(t,r,i,s):P7(t)){e.push(c.i/n|0),e.push(t.i/n|0),e.push(h.i/n|0),eu(t),t=h.next,a=h.next;continue}if(t=h,t===a){o?o===1?(t=I7(aa(t),e,n),ZA(t,e,n,r,i,s,2)):o===2&&B7(t,e,n,r,i,s):ZA(aa(t),e,n,r,i,s,1);break}}}}function P7(t){var e=t.prev,n=t,r=t.next;if(tn(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,c=n.y,h=r.y,p=i<s?i<o?i:o:s<o?s:o,m=a<c?a<h?a:h:c<h?c:h,v=i>s?i>o?i:o:s>o?s:o,E=a>c?a>h?a:h:c>h?c:h,b=r.next;b!==e;){if(b.x>=p&&b.x<=v&&b.y>=m&&b.y<=E&&al(i,a,s,c,o,h,b.x,b.y)&&tn(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function M7(t,e,n,r){var i=t.prev,s=t,o=t.next;if(tn(i,s,o)>=0)return!1;for(var a=i.x,c=s.x,h=o.x,p=i.y,m=s.y,v=o.y,E=a<c?a<h?a:h:c<h?c:h,b=p<m?p<v?p:v:m<v?m:v,x=a>c?a>h?a:h:c>h?c:h,I=p>m?p>v?p:v:m>v?m:v,S=B1(E,b,e,n,r),P=B1(x,I,e,n,r),M=t.prevZ,O=t.nextZ;M&&M.z>=S&&O&&O.z<=P;){if(M.x>=E&&M.x<=x&&M.y>=b&&M.y<=I&&M!==i&&M!==o&&al(a,p,c,m,h,v,M.x,M.y)&&tn(M.prev,M,M.next)>=0||(M=M.prevZ,O.x>=E&&O.x<=x&&O.y>=b&&O.y<=I&&O!==i&&O!==o&&al(a,p,c,m,h,v,O.x,O.y)&&tn(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;M&&M.z>=S;){if(M.x>=E&&M.x<=x&&M.y>=b&&M.y<=I&&M!==i&&M!==o&&al(a,p,c,m,h,v,M.x,M.y)&&tn(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;O&&O.z<=P;){if(O.x>=E&&O.x<=x&&O.y>=b&&O.y<=I&&O!==i&&O!==o&&al(a,p,c,m,h,v,O.x,O.y)&&tn(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function I7(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!v0(i,s)&&jM(i,r,r.next,s)&&qA(i,s)&&qA(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),eu(r),eu(r.next),r=t=s),r=r.next}while(r!==t);return aa(r)}function B7(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&G7(o,a)){var c=WM(o,a);o=aa(o,o.next),c=aa(c,c.next),ZA(o,e,n,r,i,s,0),ZA(c,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function L7(t,e,n,r){var i=[],s,o,a,c,h;for(s=0,o=e.length;s<o;s++)a=e[s]*r,c=s<o-1?e[s+1]*r:t.length,h=HM(t,a,c,r,!1),h===h.next&&(h.steiner=!0),i.push(U7(h));for(i.sort(R7),s=0;s<i.length;s++)n=O7(i[s],n);return n}function R7(t,e){return t.x-e.x}function O7(t,e){var n=F7(t,e);if(!n)return e;var r=WM(n,t);return aa(r,r.next),aa(n,n.next)}function F7(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var c=o,h=o.x,p=o.y,m=1/0,v;n=o;do r>=n.x&&n.x>=h&&r!==n.x&&al(i<p?r:s,i,h,p,i<p?s:r,i,n.x,n.y)&&(v=Math.abs(i-n.y)/(r-n.x),qA(n,t)&&(v<m||v===m&&(n.x>o.x||n.x===o.x&&D7(o,n)))&&(o=n,m=v)),n=n.next;while(n!==c);return o}function D7(t,e){return tn(t.prev,t,e.prev)<0&&tn(e.next,t,t.next)<0}function k7(t,e,n,r){var i=t;do i.z===0&&(i.z=B1(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,N7(i)}function N7(t){var e,n,r,i,s,o,a,c,h=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<h&&(a++,r=r.nextZ,!!r);e++);for(c=h;a>0||c>0&&r;)a!==0&&(c===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,c--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,h*=2}while(o>1);return t}function B1(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function U7(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function al(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function G7(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!z7(t,e)&&(qA(t,e)&&qA(e,t)&&V7(t,e)&&(tn(t.prev,t,e.prev)||tn(t,e.prev,e))||v0(t,e)&&tn(t.prev,t,t.next)>0&&tn(e.prev,e,e.next)>0)}function tn(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v0(t,e){return t.x===e.x&&t.y===e.y}function jM(t,e,n,r){var i=Ff(tn(t,e,n)),s=Ff(tn(t,e,r)),o=Ff(tn(n,r,t)),a=Ff(tn(n,r,e));return!!(i!==s&&o!==a||i===0&&Of(t,n,e)||s===0&&Of(t,r,e)||o===0&&Of(n,t,r)||a===0&&Of(n,e,r))}function Of(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ff(t){return t>0?1:t<0?-1:0}function z7(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&jM(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function qA(t,e){return tn(t.prev,t,t.next)<0?tn(t,e,t.next)>=0&&tn(t,t.prev,e)>=0:tn(t,e,t.prev)<0||tn(t,t.next,e)<0}function V7(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function WM(t,e){var n=new L1(t.i,t.x,t.y),r=new L1(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function FT(t,e,n,r){var i=new L1(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function eu(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function L1(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}_0.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(R1(t,0,s,n));if(i)for(var a=0,c=e.length;a<c;a++){var h=e[a]*n,p=a<c-1?e[a+1]*n:t.length;o-=Math.abs(R1(t,h,p,n))}var m=0;for(a=0;a<r.length;a+=3){var v=r[a]*n,E=r[a+1]*n,b=r[a+2]*n;m+=Math.abs((t[v]-t[b])*(t[E+1]-t[v+1])-(t[v]-t[E])*(t[b+1]-t[v+1]))}return o===0&&m===0?0:Math.abs((m-o)/o)};function R1(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}_0.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};const Df=k_.CLOCKWISE,DT=k_.COUNTER_CLOCKWISE,Ks={isClosed:!0};function H7(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Zc(t){return"positions"in t?t.positions:t}function Ph(t){return"holeIndices"in t?t.holeIndices:null}function j7(t){return Array.isArray(t[0])}function W7(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Q7(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function $7(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function kT(t,e,n,r,i){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let c=0;c<r;c++)t[s++]=n[a][c]||0;if(!Q7(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return Ks.start=e,Ks.end=s,Ks.size=r,N_(t,i,Ks),s}function NT(t,e,n,r,i=0,s,o){s=s||n.length;const a=s-i;if(a<=0)return e;let c=e;for(let h=0;h<a;h++)t[c++]=n[i+h];if(!$7(n,r,i,s))for(let h=0;h<r;h++)t[c++]=n[i+h];return Ks.start=e,Ks.end=c,Ks.size=r,N_(t,o,Ks),c}function QM(t,e){H7(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=NT(n,o,i,e,s[a-1],s[a],a===0?Df:DT),r.push(o);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!j7(t))return NT(n,0,t,e,0,n.length,Df),n;if(!W7(t)){let i=0;for(const[s,o]of t.entries())i=kT(n,i,o,e,s===0?Df:DT),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return kT(n,0,t,e,Df),n}function X7(t,e,n){let r=Ph(t);r&&(r=r.map(s=>s/e));let i=Zc(t);if(n){const s=i.length;i=i.slice();const o=[];for(let a=0;a<s;a+=e){o[0]=i[a],o[1]=i[a+1];const c=n(o);i[a]=c[0],i[a+1]=c[1]}}return U_.exports(i,r,e)}class Y7 extends bM{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=QM(e,this.positionSize);return this.opts.resolution?kM(Zc(n),Ph(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?f7(Zc(n),Ph(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(UT(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return Zc(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&UT(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let c=s.indices;if(!c||!e)return;let h=i;const p=X7(e,this.positionSize,this.opts.preproject);c=a.allocate(c,i+p.length,{copy:!0});for(let m=0;m<p.length;m++)c[h++]=p[m]+r;o[n+1]=i+p.length,s.indices=c}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=Zc(e);for(let a=n,c=0;c<r;a++,c++){const h=o[c*s],p=o[c*s+1],m=s>2?o[c*s+2]:0;i[a*3]=h,i[a*3+1]=p,i[a*3+2]=m}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&Ph(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function UT(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const $M=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,J7=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat($M,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),K7=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat($M,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Z7=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Cd=[0,0,0,255],q7={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Cd},getLineColor:{type:"accessor",value:Cd},material:!0},kf={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class E0 extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?J7:K7,fs:Z7,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[ci,T_,Ai]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;n.isGeospatial&&r===$e.DEFAULT&&(r=$e.LNGLAT),this.setState({numInstances:0,polygonTesselator:new Y7({preproject:r===$e.LNGLAT&&n.projectFlat.bind(n),fp64:this.use64bitPositions(),IndexType:!e||c_(e,Bt.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const i=this.getAttributeManager(),s=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:kf,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:kf,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:kf,accessor:"getFillColor",defaultValue:Cd,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:kf,accessor:"getLineColor",defaultValue:Cd,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(o,{index:a,target:c})=>this.encodePickingColor(o&&o.__source?o.__source.index:a,c),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else this._disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,polygonTesselator:c}=this.state,h={...e,extruded:Boolean(n),elevationScale:s};a&&(a.setInstanceCount(c.instanceCount-1),a.setUniforms(h),i&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),r&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(c.vertexCount),o.setUniforms(h).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(c=>c.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,o;if(r){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new tr(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new tr(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Ar({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,s].filter(Boolean),topModel:s,sideModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}T(E0,"defaultProps",q7);T(E0,"layerName","SolidPolygonLayer");function XM({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,o=t.length;let a=o,c=o;for(let v=0;v<o;v++){const E=e(t[v]);if(a>v&&E>=i&&(a=v),E>=s){c=v;break}}let h=a;const m=c-a!==r.length?t.slice(c):void 0;for(let v=0;v<r.length;v++)t[h++]=r[v];if(m){for(let v=0;v<m.length;v++)t[h++]=m[v];t.length=h}return{startRow:a,endRow:a+r.length}}const YM=[0,0,0,255],eW=[0,0,0,255],tW={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:eW},getLineColor:{type:"accessor",value:YM},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class tc extends xs{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&ze.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(s=>XM({data:r,getIndex:o=>o.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:s}=this.props,o=[],a=i==="XY"?2:3,{startRow:c,endRow:h}=e,{iterable:p,objectInfo:m}=_o(n,c,h);for(const v of p){m.index++;let E=r(v,m);s&&(E=QM(E,a));const{holeIndices:b}=E,x=E.positions||E;if(b)for(let I=0;I<=b.length;I++){const S=x.slice(b[I-1]||0,b[I]||x.length);o.push(this.getSubLayerRow({path:S},v,m.index))}else o.push(this.getSubLayerRow({path:x},v,m.index))}return o}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:s,wireframe:o,_normalize:a,_windingOrder:c,elevationScale:h,transitions:p,positionFormat:m}=this.props,{lineWidthUnits:v,lineWidthScale:E,lineWidthMinPixels:b,lineWidthMaxPixels:x,lineJointRounded:I,lineMiterLimit:S,lineDashJustified:P}=this.props,{getFillColor:M,getLineColor:O,getLineWidth:N,getLineDashArray:z,getElevation:X,getPolygon:Z,updateTriggers:Q,material:k}=this.props,{paths:D,pathsDiff:ne}=this.state,se=this.getSubLayerClass("fill",E0),oe=this.getSubLayerClass("stroke",oa),xe=this.shouldRenderSubLayer("fill",D)&&new se({_dataDiff:n,extruded:s,elevationScale:h,filled:i,wireframe:o,_normalize:a,_windingOrder:c,getElevation:X,getFillColor:M,getLineColor:s&&o?O:YM,material:k,transitions:p},this.getSubLayerProps({id:"fill",updateTriggers:Q&&{getPolygon:Q.getPolygon,getElevation:Q.getElevation,getFillColor:Q.getFillColor,lineColors:s&&o,getLineColor:Q.getLineColor}}),{data:e,positionFormat:m,getPolygon:Z}),Pe=!s&&r&&this.shouldRenderSubLayer("stroke",D)&&new oe({_dataDiff:ne&&(()=>ne),widthUnits:v,widthScale:E,widthMinPixels:b,widthMaxPixels:x,jointRounded:I,miterLimit:S,dashJustified:P,_pathType:"loop",transitions:p&&{getWidth:p.getLineWidth,getColor:p.getLineColor,getPath:p.getPolygon},getColor:this.getSubLayerAccessor(O),getWidth:this.getSubLayerAccessor(N),getDashArray:this.getSubLayerAccessor(z)},this.getSubLayerProps({id:"stroke",updateTriggers:Q&&{getWidth:Q.getLineWidth,getColor:Q.getLineColor,getDashArray:Q.getLineDashArray}}),{data:D,positionFormat:m,getPath:Ue=>Ue.path});return[!s&&xe,Pe,s&&xe]}}T(tc,"layerName","PolygonLayer");T(tc,"defaultProps",tW);function nW(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?rW(t,r,n):null}function rW(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function iW(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let o=0;o<i.length;o++)e(i[o],s),n[r][o*3+0]=s[0],n[r][o*3+1]=s[1],n[r][o*3+2]=s[2]}return n}const sW=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float buffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;

    // if enable sdf (signed distance fields)
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }

    // Take the global opacity and the alpha from color into account for the alpha component
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,GT=192/256,zT=[],oW={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class G_ extends p0{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:sW}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&ze.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state;e.uniforms={...e.uniforms,buffer:GT,outlineBuffer:i?Math.max(r,GT*(1-i)):-1,gamma:r,sdf:Boolean(n),outlineColor:s},super.draw(e)}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):zT}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):zT}}T(G_,"defaultProps",oW);T(G_,"layerName","MultiIconLayer");var z_={exports:{}};z_.exports=xu;z_.exports.default=xu;var Cl=1e20;function xu(t,e,n,r,i,s){this.fontSize=t||24,this.buffer=e===void 0?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=s||"normal",this.radius=n||8;var o=this.size=this.fontSize+this.buffer*2,a=o+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function aW(t,e,n,r,i,s,o){s.fill(Cl,0,e*n),o.fill(0,0,e*n);for(var a=(e-r)/2,c=0;c<i;c++)for(var h=0;h<r;h++){var p=(c+a)*e+h+a,m=t.data[4*(c*r+h)+3]/255;if(m===1)s[p]=0,o[p]=Cl;else if(m===0)s[p]=Cl,o[p]=0;else{var v=Math.max(0,.5-m),E=Math.max(0,m-.5);s[p]=v*v,o[p]=E*E}}}function lW(t,e,n,r,i,s,o){for(var a=0;a<e*n;a++){var c=Math.sqrt(r[a])-Math.sqrt(i[a]);t[a]=Math.round(255-255*(c/s+o))}}xu.prototype._draw=function(t,e){var n=this.ctx.measureText(t),r=n.width,i=2*this.buffer,s,o,a,c,h,p,m,v;e&&this.useMetrics?(h=Math.floor(n.actualBoundingBoxAscent),v=this.buffer+Math.ceil(n.actualBoundingBoxAscent),p=this.buffer,m=this.buffer,o=Math.min(this.size,Math.ceil(n.actualBoundingBoxRight-n.actualBoundingBoxLeft)),c=Math.min(this.size-p,Math.ceil(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)),s=o+i,a=c+i,this.ctx.textBaseline="alphabetic"):(s=o=this.size,a=c=this.size,h=19*this.fontSize/24,p=m=0,v=this.middle,this.ctx.textBaseline="middle");var E;o&&c&&(this.ctx.clearRect(m,p,o,c),this.ctx.fillText(t,this.buffer,v),E=this.ctx.getImageData(m,p,o,c));var b=new Uint8ClampedArray(s*a);return aW(E,s,a,o,c,this.gridOuter,this.gridInner),VT(this.gridOuter,s,a,this.f,this.v,this.z),VT(this.gridInner,s,a,this.f,this.v,this.z),lW(b,s,a,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:b,metrics:{width:o,height:c,sdfWidth:s,sdfHeight:a,top:h,left:0,advance:r}}};xu.prototype.draw=function(t){return this._draw(t,!1).data};xu.prototype.drawWithMetrics=function(t){return this._draw(t,!0)};function VT(t,e,n,r,i,s){for(var o=0;o<e;o++)HT(t,o,e,n,r,i,s);for(var a=0;a<n;a++)HT(t,a*e,1,e,r,i,s)}function HT(t,e,n,r,i,s,o){var a,c,h,p;for(s[0]=0,o[0]=-Cl,o[1]=Cl,a=0;a<r;a++)i[a]=t[e+a*n];for(a=1,c=0,h=0;a<r;a++){do p=s[c],h=(i[a]-i[p]+a*a-p*p)/(a-p)/2;while(h<=o[c]&&--c>-1);c++,s[c]=a,o[c]=h,o[c+1]=Cl}for(a=0,c=0;a<r;a++){for(;o[c+1]<a;)c++;p=s[c],t[e+a*n]=i[p]+(a-p)*(a-p)}}const cW=32,AW=[];function uW(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function fW({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let c=0,h=o;for(const m of t)if(!s[m]){const v=e(m);h+v+r*2>i&&(h=0,c++),s[m]={x:h+r,y:a+c*(n+r*2)+r,width:v,height:n},h+=v+r*2}const p=n+r*2;return{mapping:s,xOffset:h,yOffset:a+c*p,canvasHeight:uW(a+(c+1)*p)}}function JM(t,e,n,r){let i=0;for(let o=e;o<n;o++){var s;const a=t[o];i+=((s=r[a])===null||s===void 0?void 0:s.width)||0}return i}function KM(t,e,n,r,i,s){let o=e,a=0;for(let c=e;c<n;c++){const h=JM(t,c,c+1,i);a+h>r&&(o<c&&s.push(c),o=c,a=0),a+=h}return a}function hW(t,e,n,r,i,s){let o=e,a=e,c=e,h=0;for(let p=e;p<n;p++)if((t[p]===" "||t[p+1]===" "||p+1===n)&&(c=p+1),c>a){let m=JM(t,a,c,i);h+m>r&&(o<a&&(s.push(a),o=a,h=0),m>r&&(m=KM(t,a,c,r,i,s),o=s[s.length-1])),a=c,h+=m}return h}function dW(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?KM(t,i,s,n,r,o):hW(t,i,s,n,r,o),o}function pW(t,e,n,r,i,s){let o=0,a=0;for(let c=e;c<n;c++){const h=t[c],p=r[h];p?(a||(a=p.height),i[c]=o+p.width/2,o+=p.width):(ze.warn("Missing character: ".concat(h," (").concat(h.codePointAt(0),")"))(),i[c]=o,o+=cW)}s[0]=o,s[1]=a}function jT(t,e,n,r,i){const s=Array.from(t),o=s.length,a=new Array(o),c=new Array(o),h=new Array(o),p=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,m=[0,0],v=[0,0];let E=0,b=0,x=0;for(let I=0;I<=o;I++){const S=s[I];if((S===`
`||I===o)&&(x=I),x>b){const P=p?dW(s,n,r,i,b,x):AW;for(let M=0;M<=P.length;M++){const O=M===0?b:P[M-1],N=M<P.length?P[M]:x;pW(s,O,N,i,a,v);for(let z=O;z<N;z++)c[z]=E+v[1]/2,h[z]=v[0];E=E+v[1]*e,m[0]=Math.max(m[0],v[0])}b=x}S===`
`&&(a[b]=0,c[b]=0,h[b]=0,b++)}return m[1]=E,{x:a,y:c,rowWidth:h,size:m}}function gW({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,c=r?r/o:0,h=i[e]||Math.ceil((t.length-c)/a),p=s&&new Set,m=new Array(e);let v=t;if(a>1||c>0){const E=t.constructor;v=new E(h);for(let b=0;b<h;b++)v[b]=t[b*a+c]}for(let E=0;E<e;E++){const b=i[E],x=i[E+1]||h,I=v.subarray(b,x);m[E]=String.fromCodePoint.apply(null,I),p&&I.forEach(p.add,p)}if(p)for(const E of p)s.add(String.fromCodePoint(E));return{texts:m,characterCount:h}}class ZM{constructor(e=5){T(this,"limit",void 0),T(this,"_cache",{}),T(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function mW(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const mA={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:mW(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},WT=1024,yW=.9,QT=1.2,qM=3;let Sd=new ZM(qM);function _W(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=Sd.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function vW(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function $T(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function EW(t){ze.assert(Number.isFinite(t)&&t>=qM,"Invalid cache limit"),Sd=new ZM(t)}class wW{constructor(){T(this,"props",{...mA}),T(this,"_key",void 0),T(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return QT}setProps(e={}){Object.assign(this.props,e);const n=this._key;this._key=this._getKey();const r=_W(this._key,this.props.characterSet),i=Sd.get(this._key);if(i&&r.size===0){this._key!==n&&(this._atlas=i);return}const s=this._generateFontAtlas(this._key,r,i);this._atlas=s,Sd.set(this._key,s)}_generateFontAtlas(e,n,r){const{fontFamily:i,fontWeight:s,fontSize:o,buffer:a,sdf:c,radius:h,cutoff:p}=this.props;let m=r&&r.data;m||(m=document.createElement("canvas"),m.width=WT);const v=m.getContext("2d");$T(v,i,o,s);const{mapping:E,canvasHeight:b,xOffset:x,yOffset:I}=fW({getFontWidth:S=>v.measureText(S).width,fontHeight:o*QT,buffer:a,characterSet:n,maxCanvasWidth:WT,...r&&{mapping:r.mapping,xOffset:r.xOffset,yOffset:r.yOffset}});if(m.height!==b){const S=v.getImageData(0,0,m.width,m.height);m.height=b,v.putImageData(S,0,0)}if($T(v,i,o,s),c){const S=new z_.exports(o,a,h,p,i,s),P=v.getImageData(0,0,S.size,S.size);for(const M of n)vW(S.draw(M),P),v.putImageData(P,E[M].x-a,E[M].y+a)}else for(const S of n)v.fillText(S,E[S].x,E[S].y+o*yW);return{xOffset:x,yOffset:I,mapping:E,data:m,width:m.width,height:m.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(o," ").concat(a):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const TW=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;

  // convert size in meters to pixels, then scaled and clamp

  // project meters to pixels and clamp to limits
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply opacity to instance color, or return instance picking color
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,bW=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,xW={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class V_ extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:TW,fs:bW,modules:[ci,Ai]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:c}=this.props;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:Boolean(a),padding:c,sizeUnits:Vr[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}T(V_,"defaultProps",xW);T(V_,"layerName","TextBackgroundLayer");const XT={start:1,middle:0,end:-1},YT={top:1,center:0,bottom:-1},vg=[0,0,0,255],CW=1,SW={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:vg},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:mA.characterSet},fontFamily:mA.fontFamily,fontWeight:mA.fontWeight,lineHeight:CW,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:vg},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:vg},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class H_ extends xs{constructor(...e){super(...e),T(this,"state",void 0),T(this,"getBoundingRect",(n,r)=>{const i=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:h,getAlignmentBaseline:p}=this.props,m=s(n,r)||"",{size:[v,E]}=jT(m,c,o,a,i),b=XT[typeof h=="function"?h(n,r):h],x=YT[typeof p=="function"?p(n,r):p];return[(b-1)*v/2,(x-1)*E/2,v,E]}),T(this,"getIconOffsets",(n,r)=>{const i=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:h,getAlignmentBaseline:p}=this.props,m=s(n,r)||"",{x:v,y:E,rowWidth:b,size:[x,I]}=jT(m,c,o,a,i),S=XT[typeof h=="function"?h(n,r):h],P=YT[typeof p=="function"?p(n,r):p],M=v.length,O=new Array(M*2);let N=0;for(let z=0;z<M;z++){const X=(1-S)*(x-b[z])/2;O[N++]=(S-1)*x/2+X+v[z],O[N++]=(P-1)*I/2+E[z]}return O})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new wW}}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,o=n.startIndices,a;const c=r==="auto"&&new Set;if(i&&o){const{texts:h,characterCount:p}=gW({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:o,characterSet:c});a=p,s=(m,{index:v})=>h[v]}else{const{iterable:h,objectInfo:p}=_o(n);o=[0],a=0;for(const m of h){p.index++;const v=Array.from(s(m,p)||"");c&&v.forEach(c.add,c),a+=v.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:c||r})}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:o},styleVersion:a}=this.state,{data:c,_dataDiff:h,getPosition:p,getColor:m,getSize:v,getAngle:E,getPixelOffset:b,getBackgroundColor:x,getBorderColor:I,getBorderWidth:S,backgroundPadding:P,background:M,billboard:O,fontSettings:N,outlineWidth:z,outlineColor:X,sizeScale:Z,sizeUnits:Q,sizeMinPixels:k,sizeMaxPixels:D,transitions:ne,updateTriggers:se}=this.props,oe=this.getSubLayerClass("characters",G_),xe=this.getSubLayerClass("background",V_);return[M&&new xe({getFillColor:x,getLineColor:I,getLineWidth:S,padding:P,getPosition:p,getSize:v,getAngle:E,getPixelOffset:b,billboard:O,sizeScale:Z/this.state.fontAtlasManager.props.fontSize,sizeUnits:Q,sizeMinPixels:k,sizeMaxPixels:D,transitions:ne&&{getPosition:ne.getPosition,getAngle:ne.getAngle,getSize:ne.getSize,getFillColor:ne.getBackgroundColor,getLineColor:ne.getBorderColor,getLineWidth:ne.getBorderWidth,getPixelOffset:ne.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:se.getPosition,getAngle:se.getAngle,getSize:se.getSize,getFillColor:se.getBackgroundColor,getLineColor:se.getBorderColor,getLineWidth:se.getBorderWidth,getPixelOffset:se.getPixelOffset,getBoundingRect:{getText:se.getText,getTextAnchor:se.getTextAnchor,getAlignmentBaseline:se.getAlignmentBaseline,styleVersion:a}}}),{data:c.attributes&&c.attributes.background?{length:c.length,attributes:c.attributes.background}:c,_dataDiff:h,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new oe({sdf:N.sdf,smoothing:Number.isFinite(N.smoothing)?N.smoothing:mA.smoothing,outlineWidth:z,outlineColor:X,iconAtlas:s,iconMapping:o,getPosition:p,getColor:m,getSize:v,getAngle:E,getPixelOffset:b,billboard:O,sizeScale:Z*i,sizeUnits:Q,sizeMinPixels:k*i,sizeMaxPixels:D*i,transitions:ne&&{getPosition:ne.getPosition,getAngle:ne.getAngle,getColor:ne.getColor,getSize:ne.getSize,getPixelOffset:ne.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:se.getText,getPosition:se.getPosition,getAngle:se.getAngle,getColor:se.getColor,getSize:se.getSize,getPixelOffset:se.getPixelOffset,getIconOffsets:{getText:se.getText,getTextAnchor:se.getTextAnchor,getAlignmentBaseline:se.getAlignmentBaseline,styleVersion:a}}}),{data:c,_dataDiff:h,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){EW(e)}}T(H_,"defaultProps",SW);T(H_,"layerName","TextLayer");const Mh={circle:{type:g0,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:p0,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:H_,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Ih={type:oa,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},O1={type:E0,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Rc({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Eg(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function PW(t){if(Array.isArray(t))return t;switch(ze.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return ze.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function JT(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let o=i;o<s;o++){const a=t[o];ze.assert(a&&a.geometry,"GeoJSON does not have geometry");const{geometry:c}=a;if(c.type==="GeometryCollection"){ze.assert(Array.isArray(c.geometries),"GeoJSON does not have geometries array");const{geometries:h}=c;for(let p=0;p<h.length;p++){const m=h[p];KT(m,r,e,a,o)}}else KT(c,r,e,a,o)}return r}function KT(t,e,n,r,i){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:c,polygonFeatures:h,polygonOutlineFeatures:p}=e;if(!IW(s,o)){ze.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":o.forEach(m=>{a.push(n({geometry:{type:"Point",coordinates:m}},r,i))});break;case"LineString":c.push(n({geometry:t},r,i));break;case"MultiLineString":o.forEach(m=>{c.push(n({geometry:{type:"LineString",coordinates:m}},r,i))});break;case"Polygon":h.push(n({geometry:t},r,i)),o.forEach(m=>{p.push(n({geometry:{type:"LineString",coordinates:m}},r,i))});break;case"MultiPolygon":o.forEach(m=>{h.push(n({geometry:{type:"Polygon",coordinates:m}},r,i)),m.forEach(v=>{p.push(n({geometry:{type:"LineString",coordinates:v}},r,i))})});break}}const MW={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function IW(t,e){let n=MW[t];for(ze.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function eI(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function Nf(t){return t.geometry.coordinates}function BW(t,e){const n=eI(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=Nf,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=Nf,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=Nf,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=Nf,n}function LW(t,e){const n=eI(),{points:r,lines:i,polygons:s}=t,o=iW(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const RW=["points","linestrings","polygons"],OW={...Rc(Mh.circle),...Rc(Mh.icon),...Rc(Mh.text),...Rc(Ih),...Rc(O1),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Cu extends xs{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=LW(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=PW(e.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const c=this.state.features;for(const h in c)s[h]=c[h].slice(),o[h]=[];for(const h of n.dataChanged){const p=JT(r,i,h);for(const m in c)o[m].push(XM({data:s[m],getIndex:v=>v.__source.index,dataRange:h,replace:p[m]}))}}else s=JT(r,i);const a=BW(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=RW.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,O1.type);if(s){const o=Eg(this,O1.props),a=e&&n;return a||delete o.getLineColor,o.updateTriggers.lineColors=a,new s(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,Ih.type),a=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,Ih.type);if(o||a){const c=Eg(this,Ih.props);return[o&&new o(c,this.getSubLayerProps({id:i,updateTriggers:c.updateTriggers}),r.polygonsOutline),a&&new a(c,this.getSubLayerProps({id:s,updateTriggers:c.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(a=>a.__source.index===i));const s=new Set(e.split("+")),o=[];for(const a of s){const c="points-".concat(a),h=Mh[a],p=h&&this.shouldRenderSubLayer(c,n.points.data)&&this.getSubLayerClass(c,h.type);if(p){const m=Eg(this,h.props);let v=n.points;if(a==="text"&&r){const{instancePickingColors:E,...b}=v.data.attributes;v={...v,data:{...v.data,attributes:b}}}o.push(new p(m,this.getSubLayerProps({id:c,updateTriggers:m.updateTriggers,highlightedObjectIndex:i}),v))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:o}=i,a=nW(s,o);return e(a,i)}}}T(Cu,"layerName","GeoJsonLayer");T(Cu,"defaultProps",OW);const FW={getHeight:{type:"accessor",value:0},greatCircle:!0};class tI extends F_{}T(tI,"layerName","GreatCircleLayer");T(tI,"defaultProps",FW);const DW={...tc.defaultProps};class nc extends xs{indexToBounds(){return null}renderLayers(){const{elevationScale:e,extruded:n,wireframe:r,filled:i,stroked:s,lineWidthUnits:o,lineWidthScale:a,lineWidthMinPixels:c,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:m,lineDashJustified:v,getElevation:E,getFillColor:b,getLineColor:x,getLineWidth:I}=this.props,{updateTriggers:S,material:P,transitions:M}=this.props,O=this.getSubLayerClass("cell",tc);return new O({filled:i,wireframe:r,extruded:n,elevationScale:e,stroked:s,lineWidthUnits:o,lineWidthScale:a,lineWidthMinPixels:c,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:m,lineDashJustified:v,material:P,transitions:M,getElevation:E,getFillColor:b,getLineColor:x,getLineWidth:I},this.getSubLayerProps({id:"cell",updateTriggers:S&&{getElevation:S.getElevation,getFillColor:S.getFillColor,getLineColor:S.getLineColor,getLineWidth:S.getLineWidth}}),this.indexToBounds())}}T(nc,"layerName","GeoCellLayer");T(nc,"defaultProps",DW);function kW(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var nI={exports:{}};(function(t){/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */(function(e,n){typeof kW=="function"&&!0&&t&&t.exports?t.exports=n():(e.dcodeIO=e.dcodeIO||{}).Long=n()})(LR,function(){function e(k,D,ne){this.low=k|0,this.high=D|0,this.unsigned=!!ne}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function n(k){return(k&&k.__isLong__)===!0}e.isLong=n;var r={},i={};function s(k,D){var ne,se,oe;return D?(k>>>=0,(oe=0<=k&&k<256)&&(se=i[k],se)?se:(ne=a(k,(k|0)<0?-1:0,!0),oe&&(i[k]=ne),ne)):(k|=0,(oe=-128<=k&&k<128)&&(se=r[k],se)?se:(ne=a(k,k<0?-1:0,!1),oe&&(r[k]=ne),ne))}e.fromInt=s;function o(k,D){if(isNaN(k)||!isFinite(k))return D?P:S;if(D){if(k<0)return P;if(k>=b)return X}else{if(k<=-x)return Z;if(k+1>=x)return z}return k<0?o(-k,D).neg():a(k%E|0,k/E|0,D)}e.fromNumber=o;function a(k,D,ne){return new e(k,D,ne)}e.fromBits=a;var c=Math.pow;function h(k,D,ne){if(k.length===0)throw Error("empty string");if(k==="NaN"||k==="Infinity"||k==="+Infinity"||k==="-Infinity")return S;if(typeof D=="number"?(ne=D,D=!1):D=!!D,ne=ne||10,ne<2||36<ne)throw RangeError("radix");var se;if((se=k.indexOf("-"))>0)throw Error("interior hyphen");if(se===0)return h(k.substring(1),D,ne).neg();for(var oe=o(c(ne,8)),xe=S,Pe=0;Pe<k.length;Pe+=8){var Ue=Math.min(8,k.length-Pe),le=parseInt(k.substring(Pe,Pe+Ue),ne);if(Ue<8){var _e=o(c(ne,Ue));xe=xe.mul(_e).add(o(le))}else xe=xe.mul(oe),xe=xe.add(o(le))}return xe.unsigned=D,xe}e.fromString=h;function p(k){return k instanceof e?k:typeof k=="number"?o(k):typeof k=="string"?h(k):a(k.low,k.high,k.unsigned)}e.fromValue=p;var m=1<<16,v=1<<24,E=m*m,b=E*E,x=b/2,I=s(v),S=s(0);e.ZERO=S;var P=s(0,!0);e.UZERO=P;var M=s(1);e.ONE=M;var O=s(1,!0);e.UONE=O;var N=s(-1);e.NEG_ONE=N;var z=a(-1,2147483647,!1);e.MAX_VALUE=z;var X=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=X;var Z=a(0,-2147483648,!1);e.MIN_VALUE=Z;var Q=e.prototype;return Q.toInt=function(){return this.unsigned?this.low>>>0:this.low},Q.toNumber=function(){return this.unsigned?(this.high>>>0)*E+(this.low>>>0):this.high*E+(this.low>>>0)},Q.toString=function(D){if(D=D||10,D<2||36<D)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Z)){var ne=o(D),se=this.div(ne),oe=se.mul(ne).sub(this);return se.toString(D)+oe.toInt().toString(D)}else return"-"+this.neg().toString(D);for(var xe=o(c(D,6),this.unsigned),Pe=this,Ue="";;){var le=Pe.div(xe),_e=Pe.sub(le.mul(xe)).toInt()>>>0,Ce=_e.toString(D);if(Pe=le,Pe.isZero())return Ce+Ue;for(;Ce.length<6;)Ce="0"+Ce;Ue=""+Ce+Ue}},Q.getHighBits=function(){return this.high},Q.getHighBitsUnsigned=function(){return this.high>>>0},Q.getLowBits=function(){return this.low},Q.getLowBitsUnsigned=function(){return this.low>>>0},Q.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Z)?64:this.neg().getNumBitsAbs();for(var D=this.high!=0?this.high:this.low,ne=31;ne>0&&(D&1<<ne)==0;ne--);return this.high!=0?ne+33:ne+1},Q.isZero=function(){return this.high===0&&this.low===0},Q.isNegative=function(){return!this.unsigned&&this.high<0},Q.isPositive=function(){return this.unsigned||this.high>=0},Q.isOdd=function(){return(this.low&1)===1},Q.isEven=function(){return(this.low&1)===0},Q.equals=function(D){return n(D)||(D=p(D)),this.unsigned!==D.unsigned&&this.high>>>31===1&&D.high>>>31===1?!1:this.high===D.high&&this.low===D.low},Q.eq=Q.equals,Q.notEquals=function(D){return!this.eq(D)},Q.neq=Q.notEquals,Q.lessThan=function(D){return this.comp(D)<0},Q.lt=Q.lessThan,Q.lessThanOrEqual=function(D){return this.comp(D)<=0},Q.lte=Q.lessThanOrEqual,Q.greaterThan=function(D){return this.comp(D)>0},Q.gt=Q.greaterThan,Q.greaterThanOrEqual=function(D){return this.comp(D)>=0},Q.gte=Q.greaterThanOrEqual,Q.compare=function(D){if(n(D)||(D=p(D)),this.eq(D))return 0;var ne=this.isNegative(),se=D.isNegative();return ne&&!se?-1:!ne&&se?1:this.unsigned?D.high>>>0>this.high>>>0||D.high===this.high&&D.low>>>0>this.low>>>0?-1:1:this.sub(D).isNegative()?-1:1},Q.comp=Q.compare,Q.negate=function(){return!this.unsigned&&this.eq(Z)?Z:this.not().add(M)},Q.neg=Q.negate,Q.add=function(D){n(D)||(D=p(D));var ne=this.high>>>16,se=this.high&65535,oe=this.low>>>16,xe=this.low&65535,Pe=D.high>>>16,Ue=D.high&65535,le=D.low>>>16,_e=D.low&65535,Ce=0,Fe=0,ke=0,it=0;return it+=xe+_e,ke+=it>>>16,it&=65535,ke+=oe+le,Fe+=ke>>>16,ke&=65535,Fe+=se+Ue,Ce+=Fe>>>16,Fe&=65535,Ce+=ne+Pe,Ce&=65535,a(ke<<16|it,Ce<<16|Fe,this.unsigned)},Q.subtract=function(D){return n(D)||(D=p(D)),this.add(D.neg())},Q.sub=Q.subtract,Q.multiply=function(D){if(this.isZero()||(n(D)||(D=p(D)),D.isZero()))return S;if(this.eq(Z))return D.isOdd()?Z:S;if(D.eq(Z))return this.isOdd()?Z:S;if(this.isNegative())return D.isNegative()?this.neg().mul(D.neg()):this.neg().mul(D).neg();if(D.isNegative())return this.mul(D.neg()).neg();if(this.lt(I)&&D.lt(I))return o(this.toNumber()*D.toNumber(),this.unsigned);var ne=this.high>>>16,se=this.high&65535,oe=this.low>>>16,xe=this.low&65535,Pe=D.high>>>16,Ue=D.high&65535,le=D.low>>>16,_e=D.low&65535,Ce=0,Fe=0,ke=0,it=0;return it+=xe*_e,ke+=it>>>16,it&=65535,ke+=oe*_e,Fe+=ke>>>16,ke&=65535,ke+=xe*le,Fe+=ke>>>16,ke&=65535,Fe+=se*_e,Ce+=Fe>>>16,Fe&=65535,Fe+=oe*le,Ce+=Fe>>>16,Fe&=65535,Fe+=xe*Ue,Ce+=Fe>>>16,Fe&=65535,Ce+=ne*_e+se*le+oe*Ue+xe*Pe,Ce&=65535,a(ke<<16|it,Ce<<16|Fe,this.unsigned)},Q.mul=Q.multiply,Q.divide=function(D){if(n(D)||(D=p(D)),D.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?P:S;var ne,se,oe;if(this.unsigned){if(D.unsigned||(D=D.toUnsigned()),D.gt(this))return P;if(D.gt(this.shru(1)))return O;oe=P}else{if(this.eq(Z)){if(D.eq(M)||D.eq(N))return Z;if(D.eq(Z))return M;var xe=this.shr(1);return ne=xe.div(D).shl(1),ne.eq(S)?D.isNegative()?M:N:(se=this.sub(D.mul(ne)),oe=ne.add(se.div(D)),oe)}else if(D.eq(Z))return this.unsigned?P:S;if(this.isNegative())return D.isNegative()?this.neg().div(D.neg()):this.neg().div(D).neg();if(D.isNegative())return this.div(D.neg()).neg();oe=S}for(se=this;se.gte(D);){ne=Math.max(1,Math.floor(se.toNumber()/D.toNumber()));for(var Pe=Math.ceil(Math.log(ne)/Math.LN2),Ue=Pe<=48?1:c(2,Pe-48),le=o(ne),_e=le.mul(D);_e.isNegative()||_e.gt(se);)ne-=Ue,le=o(ne,this.unsigned),_e=le.mul(D);le.isZero()&&(le=M),oe=oe.add(le),se=se.sub(_e)}return oe},Q.div=Q.divide,Q.modulo=function(D){return n(D)||(D=p(D)),this.sub(this.div(D).mul(D))},Q.mod=Q.modulo,Q.not=function(){return a(~this.low,~this.high,this.unsigned)},Q.and=function(D){return n(D)||(D=p(D)),a(this.low&D.low,this.high&D.high,this.unsigned)},Q.or=function(D){return n(D)||(D=p(D)),a(this.low|D.low,this.high|D.high,this.unsigned)},Q.xor=function(D){return n(D)||(D=p(D)),a(this.low^D.low,this.high^D.high,this.unsigned)},Q.shiftLeft=function(D){return n(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?a(this.low<<D,this.high<<D|this.low>>>32-D,this.unsigned):a(0,this.low<<D-32,this.unsigned)},Q.shl=Q.shiftLeft,Q.shiftRight=function(D){return n(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?a(this.low>>>D|this.high<<32-D,this.high>>D,this.unsigned):a(this.high>>D-32,this.high>=0?0:-1,this.unsigned)},Q.shr=Q.shiftRight,Q.shiftRightUnsigned=function(D){if(n(D)&&(D=D.toInt()),D&=63,D===0)return this;var ne=this.high;if(D<32){var se=this.low;return a(se>>>D|ne<<32-D,ne>>>D,this.unsigned)}else return D===32?a(ne,0,this.unsigned):a(ne>>>D-32,0,this.unsigned)},Q.shru=Q.shiftRightUnsigned,Q.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},Q.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},Q.toBytes=function(k){return k?this.toBytesLE():this.toBytesBE()},Q.toBytesLE=function(){var k=this.high,D=this.low;return[D&255,D>>>8&255,D>>>16&255,D>>>24&255,k&255,k>>>8&255,k>>>16&255,k>>>24&255]},Q.toBytesBE=function(){var k=this.high,D=this.low;return[k>>>24&255,k>>>16&255,k>>>8&255,k&255,D>>>24&255,D>>>16&255,D>>>8&255,D&255]},e})})(nI);const Bh=nI.exports,NW=3,UW=30,GW=2*UW+1,ZT=180/Math.PI;function zW(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function qT(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function VW(t){return[qT(t[0]),qT(t[1])]}function HW(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function jW([t,e,n]){const r=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*ZT,r*ZT]}function WW(t){let e=Bh.fromString(t,!0,10).toString(2);for(;e.length<NW+GW;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),s=i.length/2,o=Bh.fromString(r,!0,2).toString(10);let a=Bh.fromString(i,!0,2).toString(4);for(;a.length<s;)a="0"+a;return"".concat(o,"/").concat(a)}function QW(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function $W(t){const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length,s=[0,0];let o;for(let a=i-1;a>=0;a--){o=i-a;const c=r[a];let h=0,p=0;c==="1"?p=1:c==="2"?(h=1,p=1):c==="3"&&(h=1);const m=Math.pow(2,o-1);QW(m,s,h,p),s[0]+=m*h,s[1]+=m*p}if(n%2===1){const a=s[0];s[0]=s[1],s[1]=a}return{face:n,ij:s,level:o}}function XW(t){const e=t.padEnd(16,"0");return Bh.fromString(e,16)}const YW=100;function JW({face:t,ij:e,level:n}){const r=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(YW*Math.pow(2,-n))),s=new Float64Array(4*i*2+2);let o=0,a=0;for(let c=0;c<4;c++){const h=r[c].slice(0),p=r[c+1],m=(p[0]-h[0])/i,v=(p[1]-h[1])/i;for(let E=0;E<i;E++){h[0]+=m,h[1]+=v;const b=zW(e,n,h),x=VW(b),I=HW(t,x),S=jW(I);Math.abs(S[1])>89.999&&(S[0]=a);const P=S[0]-a;S[0]+=P>180?-360:P<-180?360:0,s[o++]=S[0],s[o++]=S[1],a=S[0]}}return s[o++]=s[0],s[o++]=s[1],s}function KW(t){if(typeof t=="string"){if(t.indexOf("/")>0)return t;t=XW(t)}return WW(t.toString())}function ZW(t){const e=KW(t),n=$W(e);return JW(n)}const qW={getS2Token:{type:"accessor",value:t=>t.token}};class rI extends nc{indexToBounds(){const{data:e,getS2Token:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(r,i)=>ZW(n(r,i))}}}T(rI,"layerName","S2Layer");T(rI,"defaultProps",qW);const wg=512;function eQ(t){let e=0,n=0,r=1<<t.length;const i=r/wg;for(let s=0;s<t.length;s++){r>>=1;const o=parseInt(t[s]);o%2&&(e|=r),o>1&&(n|=r)}return[[e/i,wg-n/i],[(e+.99)/i,wg-(n+.99)/i]]}function tQ(t){const[e,n]=eQ(t),[r,i]=fo(e),[s,o]=fo(n);return[s,i,s,o,r,o,r,i,s,i]}const nQ={getQuadkey:{type:"accessor",value:t=>t.quadkey}};class iI extends nc{indexToBounds(){const{data:e,getQuadkey:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(r,i)=>tQ(n(r,i))}}}T(iI,"layerName","QuadkeyLayer");T(iI,"defaultProps",nQ);class rQ{constructor(e){T(this,"index",void 0),T(this,"isVisible",void 0),T(this,"isSelected",void 0),T(this,"parent",void 0),T(this,"children",void 0),T(this,"content",void 0),T(this,"state",void 0),T(this,"layers",void 0),T(this,"id",void 0),T(this,"bbox",void 0),T(this,"zoom",void 0),T(this,"userData",void 0),T(this,"_abortController",void 0),T(this,"_loader",void 0),T(this,"_loaderId",void 0),T(this,"_isLoaded",void 0),T(this,"_isCancelled",void 0),T(this,"_needsReload",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||ze.error("byteLength not defined in tile data")(),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:s,id:o,bbox:a,userData:c,zoom:h}=this,p=this._loaderId;this._abortController=new AbortController;const{signal:m}=this._abortController,v=await n.scheduleRequest(this,x=>x.isSelected?1:-1);if(!v){this._isCancelled=!0;return}if(this._isCancelled){v.done();return}let E=null,b;try{E=await e({index:s,id:o,bbox:a,userData:c,zoom:h,signal:m})}catch(x){b=x||!0}finally{v.done()}if(p===this._loaderId){if(this._loader=void 0,this.content=E,this._isCancelled&&!E){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,b?i(b,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const Kn={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},eb=new ee,iQ=new ee;class j_{constructor(e=[0,0,0],n=[0,0,0],r){T(this,"center",void 0),T(this,"halfDiagonal",void 0),T(this,"minimum",void 0),T(this,"maximum",void 0),r=r||eb.copy(e).add(n).scale(.5),this.center=new ee(r),this.halfDiagonal=new ee(n).subtract(this.center),this.minimum=new ee(e),this.maximum=new ee(n)}clone(){return new j_(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=iQ.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),s=this.center.dot(r)+e.distance;return s-i>0?Kn.INSIDE:s+i<0?Kn.OUTSIDE:Kn.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=eb.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,s;return s=Math.abs(n.x)-r.x,s>0&&(i+=s*s),s=Math.abs(n.y)-r.y,s>0&&(i+=s*s),s=Math.abs(n.z)-r.z,s>0&&(i+=s*s),i}}const Oc=new ee,tb=new ee;class Su{constructor(e=[0,0,0],n=0){T(this,"center",void 0),T(this,"radius",void 0),this.radius=-0,this.center=new ee,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Oc.from(n),this.center=new ee().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new Su(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,o=Oc.copy(i).subtract(n),a=o.magnitude();if(r>=a+s)return this.clone();if(s>=a+r)return e.clone();const c=(r+a+s)*.5;return tb.copy(o).scale((-r+c)/a).add(n),this.center.copy(tb),this.radius=c,this}expand(e){const r=Oc.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=EU(Oc,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Oc.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?Kn.OUTSIDE:s<r?Kn.INTERSECTING:Kn.INSIDE}}const sQ=new ee,oQ=new ee,Uf=new ee,Gf=new ee,zf=new ee,aQ=new ee,lQ=new ee,is={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class Pu{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){T(this,"center",void 0),T(this,"halfAxes",void 0),this.center=new ee().from(e),this.halfAxes=new xn(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new ee(e).len(),new ee(n).len(),new ee(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new ee(e).normalize(),s=new ee(n).normalize(),o=new ee(r).normalize();return new HA().fromMatrix3(new xn([...i,...s,...o]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new HA(r),s=new xn().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new ee().from(e),this.halfAxes=s,this}clone(){return new Pu(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new Su){const n=this.halfAxes,r=n.getColumn(0,Uf),i=n.getColumn(1,Gf),s=n.getColumn(2,zf),o=sQ.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,o=r.y,a=r.z,c=Math.abs(s*i[is.COLUMN0ROW0]+o*i[is.COLUMN0ROW1]+a*i[is.COLUMN0ROW2])+Math.abs(s*i[is.COLUMN1ROW0]+o*i[is.COLUMN1ROW1]+a*i[is.COLUMN1ROW2])+Math.abs(s*i[is.COLUMN2ROW0]+o*i[is.COLUMN2ROW1]+a*i[is.COLUMN2ROW2]),h=r.dot(n)+e.distance;return h<=-c?Kn.OUTSIDE:h>=c?Kn.INSIDE:Kn.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=oQ.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,Uf),s=r.getColumn(1,Gf),o=r.getColumn(2,zf),a=i.magnitude(),c=s.magnitude(),h=o.magnitude();i.normalize(),s.normalize(),o.normalize();let p=0,m;return m=Math.abs(n.dot(i))-a,m>0&&(p+=m*m),m=Math.abs(n.dot(s))-c,m>0&&(p+=m*m),m=Math.abs(n.dot(o))-h,m>0&&(p+=m*m),p}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,c=a.getColumn(0,Uf),h=a.getColumn(1,Gf),p=a.getColumn(2,zf),m=aQ.copy(c).add(h).add(p).add(o),v=lQ.copy(m).subtract(e);let E=n.dot(v);return i=Math.min(E,i),s=Math.max(E,s),m.copy(o).add(c).add(h).subtract(p),v.copy(m).subtract(e),E=n.dot(v),i=Math.min(E,i),s=Math.max(E,s),m.copy(o).add(c).subtract(h).add(p),v.copy(m).subtract(e),E=n.dot(v),i=Math.min(E,i),s=Math.max(E,s),m.copy(o).add(c).subtract(h).subtract(p),v.copy(m).subtract(e),E=n.dot(v),i=Math.min(E,i),s=Math.max(E,s),o.copy(m).subtract(c).add(h).add(p),v.copy(m).subtract(e),E=n.dot(v),i=Math.min(E,i),s=Math.max(E,s),o.copy(m).subtract(c).add(h).subtract(p),v.copy(m).subtract(e),E=n.dot(v),i=Math.min(E,i),s=Math.max(E,s),o.copy(m).subtract(c).subtract(h).add(p),v.copy(m).subtract(e),E=n.dot(v),i=Math.min(E,i),s=Math.max(E,s),o.copy(m).subtract(c).subtract(h).subtract(p),v.copy(m).subtract(e),E=n.dot(v),i=Math.min(E,i),s=Math.max(E,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,Uf);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,Gf);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,zf);return i.transformAsPoint(e),this.halfAxes=new xn([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const nb=new ee,rb=new ee;class ni{constructor(e=[0,0,1],n=0){T(this,"normal",void 0),T(this,"distance",void 0),this.normal=new ee,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return bi(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=nb.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),bi(Ur(this.normal.len(),1)),this.distance=i,this}clone(){return new ni(this.normal,this.distance)}equals(e){return Ur(this.distance,e.distance)&&Ur(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=rb.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=nb.from(e);const r=this.getPointDistance(e),i=rb.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const ib=[new ee([1,0,0]),new ee([0,1,0]),new ee([0,0,1])],sb=new ee,cQ=new ee;new ni(new ee(1,0,0),0);class Fr{constructor(e=[]){T(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*ib.length;const n=e.center,r=e.radius;let i=0;for(const s of ib){let o=this.planes[i],a=this.planes[i+1];o||(o=this.planes[i]=new ni),a||(a=this.planes[i+1]=new ni);const c=sb.copy(s).scale(-r).add(n);-s.dot(c),o.fromPointNormal(c,s);const h=sb.copy(s).scale(r).add(n),p=cQ.copy(s).negate();-p.dot(h),a.fromPointNormal(h,p),i+=2}return this}computeVisibility(e){let n=Kn.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case Kn.OUTSIDE:return Kn.OUTSIDE;case Kn.INTERSECTING:n=Kn.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(bi(Number.isFinite(n),"parentPlaneMask is required."),n===Fr.MASK_OUTSIDE||n===Fr.MASK_INSIDE)return n;let r=Fr.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const o=s<31?1<<s:0;if(s<31&&(n&o)===0)continue;const a=i[s],c=e.intersectPlane(a);if(c===Kn.OUTSIDE)return Fr.MASK_OUTSIDE;c===Kn.INTERSECTING&&(r|=o)}return r}}T(Fr,"MASK_OUTSIDE",4294967295);T(Fr,"MASK_INSIDE",0);T(Fr,"MASK_INDETERMINATE",2147483647);new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;const Vi=new xn,AQ=new xn,uQ=new xn,Vf=new xn,ob=new xn;function fQ(t,e={}){const n=jA.EPSILON20,r=10;let i=0,s=0;const o=AQ,a=uQ;o.identity(),a.copy(t);const c=n*hQ(a);for(;s<r&&dQ(a)>c;)pQ(a,Vf),ob.copy(Vf).transpose(),a.multiplyRight(Vf),a.multiplyLeft(ob),o.multiplyRight(Vf),++i>2&&(++s,i=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function hQ(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const F1=[1,0,0],D1=[2,2,1];function dQ(t){let e=0;for(let n=0;n<3;++n){const r=t[Vi.getElementIndex(D1[n],F1[n])];e+=2*r*r}return Math.sqrt(e)}function pQ(t,e){const n=jA.EPSILON15;let r=0,i=1;for(let h=0;h<3;++h){const p=Math.abs(t[Vi.getElementIndex(D1[h],F1[h])]);p>r&&(i=h,r=p)}const s=F1[i],o=D1[i];let a=1,c=0;if(Math.abs(t[Vi.getElementIndex(o,s)])>n){const h=t[Vi.getElementIndex(o,o)],p=t[Vi.getElementIndex(s,s)],m=t[Vi.getElementIndex(o,s)],v=(h-p)/2/m;let E;v<0?E=-1/(-v+Math.sqrt(1+v*v)):E=1/(v+Math.sqrt(1+v*v)),a=1/Math.sqrt(1+E*E),c=E*a}return xn.IDENTITY.to(e),e[Vi.getElementIndex(s,s)]=e[Vi.getElementIndex(o,o)]=a,e[Vi.getElementIndex(o,s)]=c,e[Vi.getElementIndex(s,o)]=-c,e}const Ns=new ee,gQ=new ee,mQ=new ee,yQ=new ee,_Q=new ee,vQ=new xn,EQ={diagonal:new xn,unitary:new xn};function wQ(t,e=new Pu){if(!t||t.length===0)return e.halfAxes=new xn([0,0,0,0,0,0,0,0,0]),e.center=new ee,e;const n=t.length,r=new ee(0,0,0);for(const Q of t)r.add(Q);const i=1/n;r.multiplyByScalar(i);let s=0,o=0,a=0,c=0,h=0,p=0;for(const Q of t){const k=Ns.copy(Q).subtract(r);s+=k.x*k.x,o+=k.x*k.y,a+=k.x*k.z,c+=k.y*k.y,h+=k.y*k.z,p+=k.z*k.z}s*=i,o*=i,a*=i,c*=i,h*=i,p*=i;const m=vQ;m[0]=s,m[1]=o,m[2]=a,m[3]=o,m[4]=c,m[5]=h,m[6]=a,m[7]=h,m[8]=p;const{unitary:v}=fQ(m,EQ),E=e.halfAxes.copy(v);let b=E.getColumn(0,mQ),x=E.getColumn(1,yQ),I=E.getColumn(2,_Q),S=-Number.MAX_VALUE,P=-Number.MAX_VALUE,M=-Number.MAX_VALUE,O=Number.MAX_VALUE,N=Number.MAX_VALUE,z=Number.MAX_VALUE;for(const Q of t)Ns.copy(Q),S=Math.max(Ns.dot(b),S),P=Math.max(Ns.dot(x),P),M=Math.max(Ns.dot(I),M),O=Math.min(Ns.dot(b),O),N=Math.min(Ns.dot(x),N),z=Math.min(Ns.dot(I),z);b=b.multiplyByScalar(.5*(O+S)),x=x.multiplyByScalar(.5*(N+P)),I=I.multiplyByScalar(.5*(z+M)),e.center.copy(b).add(x).add(I);const X=gQ.set(S-O,P-N,M-z).multiplyByScalar(.5),Z=new xn([X[0],0,0,0,X[1],0,0,0,X[2]]);return e.halfAxes.multiplyRight(Z),e}const ll=512,ab=3,sI=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],oI=sI.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),TQ=oI.concat([[.25,.5],[.75,.5]]);class cl{constructor(e,n,r){T(this,"x",void 0),T(this,"y",void 0),T(this,"z",void 0),T(this,"childVisible",void 0),T(this,"selected",void 0),T(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new cl(e,n,r),new cl(e,n+1,r),new cl(e+1,n,r),new cl(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:s,maxZ:o,bounds:a,offset:c,project:h}=e,p=this.getBoundingVolume(i,c,h);if(a&&!this.insideBounds(a)||r.computeVisibility(p)<0)return!1;if(!this.childVisible){let{z:v}=this;if(v<o&&v>=s){const E=p.distanceTo(n.cameraPosition)*n.scale/n.height;v+=Math.floor(Math.log2(E))}if(v>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const v of this.children)v.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const s=Math.pow(2,this.z),o=ll/s;return this.x*o<r&&this.y*o<i&&(this.x+1)*o>e&&(this.y+1)*o>n}getBoundingVolume(e,n,r){if(r){const c=this.z<1?TQ:this.z<2?oI:sI,h=[];for(const p of c){const m=N1(this.x+p[0],this.y+p[1],this.z);m[2]=e[0],h.push(r(m)),e[0]!==e[1]&&(m[2]=e[1],h.push(r(m)))}return wQ(h)}const i=Math.pow(2,this.z),s=ll/i,o=this.x*s+n*ll,a=ll-(this.y+1)*s;return new j_([o,a,e[0]],[o+s,a+s,e[1]])}}function bQ(t,e,n,r){const i=t instanceof JH&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:E,distance:b})=>new ni(E.clone().negate(),b)),o=new Fr(s),a=t.distanceScales.unitsPerMeter[2],c=n&&n[0]*a||0,h=n&&n[1]*a||0,p=t instanceof ts&&t.pitch<=60?e:0;if(r){const[E,b,x,I]=r,S=uo([E,I]),P=uo([x,b]);r=[S[0],ll-S[1],P[0],ll-P[1]]}const m=new cl(0,0,0),v={viewport:t,project:i,cullingVolume:o,elevationBounds:[c,h],minZ:p,maxZ:e,bounds:r,offset:0};if(m.update(v),t instanceof ts&&t.subViewports&&t.subViewports.length>1){for(v.offset=-1;m.update(v)&&!(--v.offset<-ab););for(v.offset=1;m.update(v)&&!(++v.offset>ab););}return m.getSelected()}const Es=512,xQ=[-1/0,-1/0,1/0,1/0],k1={type:"url",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equals:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function aI(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function CQ(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function Pd(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const s=CQ(r)%t.length;t=t[s]}let i=t;for(const s of Object.keys(n)){const o=new RegExp("{".concat(s,"}"),"g");i=i.replace(o,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function SQ(t,e,n){let r;if(e&&e.length===2){const[i,s]=e,o=t.getBounds({z:i}),a=t.getBounds({z:s});r=[Math.min(o[0],a[0]),Math.min(o[1],a[1]),Math.max(o[2],a[2]),Math.max(o[3],a[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function Md({viewport:t,z:e,cullRect:n}){const r=n.x-t.x,i=n.y-t.y,{width:s,height:o}=n;if(!Array.isArray(e)){const h={targetZ:e||0},p=t.unproject([r,i],h),m=t.unproject([r+s,i],h),v=t.unproject([r,i+o],h),E=t.unproject([r+s,i+o],h);return[Math.min(p[0],m[0],v[0],E[0]),Math.min(p[1],m[1],v[1],E[1]),Math.max(p[0],m[0],v[0],E[0]),Math.max(p[1],m[1],v[1],E[1])]}const a=Md({viewport:t,z:e[0],cullRect:n}),c=Md({viewport:t,z:e[1],cullRect:n});return[Math.min(a[0],c[0]),Math.min(a[1],c[1]),Math.max(a[2],c[2]),Math.max(a[3],c[3])]}function PQ(t,e,n){return n?aI(t,n).map(i=>i*e/Es):t.map(r=>r*e/Es)}function W_(t,e){return Math.pow(2,t)*Es/e}function N1(t,e,n){const r=W_(n,Es),i=t/r*360-180,s=Math.PI-2*Math.PI*e/r,o=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,o]}function lb(t,e,n,r){const i=W_(n,r);return[t/i*Es,e/i*Es]}function MQ(t,e,n,r,i=Es){if(t.isGeospatial){const[h,p]=N1(e,n,r),[m,v]=N1(e+1,n+1,r);return{west:h,north:p,east:m,south:v}}const[s,o]=lb(e,n,r,i),[a,c]=lb(e+1,n+1,r,i);return{left:s,top:o,right:a,bottom:c}}function IQ(t,e,n,r,i){const s=SQ(t,null,r),o=W_(e,n),[a,c,h,p]=PQ(s,o,i),m=[];for(let v=Math.floor(a);v<h;v++)for(let E=Math.floor(c);E<p;E++)m.push({x:v,y:E,z:e});return m}function BQ({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:s=Es,modelMatrix:o,modelMatrixInverse:a,zoomOffset:c=0}){let h=t.isGeospatial?Math.round(t.zoom+Math.log2(Es/s))+c:Math.ceil(t.zoom)+c;if(typeof n=="number"&&Number.isFinite(n)&&h<n){if(!i)return[];h=n}typeof e=="number"&&Number.isFinite(e)&&h>e&&(h=e);let p=i;return o&&a&&i&&!t.isGeospatial&&(p=aI(i,o)),t.isGeospatial?bQ(t,h,r,i):IQ(t,h,s,p||xQ,a)}function LQ(t){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t)}function RQ(t){return Number.isFinite(t.west)&&Number.isFinite(t.north)&&Number.isFinite(t.east)&&Number.isFinite(t.south)}const cb=1,w0=2,OQ="never",FQ="no-overlap",Q_="best-available",DQ=5,kQ={[Q_]:UQ,[FQ]:GQ,[OQ]:()=>{}};class NQ{constructor(e){T(this,"opts",void 0),T(this,"_requestScheduler",void 0),T(this,"_cache",void 0),T(this,"_dirty",void 0),T(this,"_tiles",void 0),T(this,"_cacheByteSize",void 0),T(this,"_viewport",void 0),T(this,"_zRange",void 0),T(this,"_selectedTiles",void 0),T(this,"_frameNumber",void 0),T(this,"_modelMatrix",void 0),T(this,"_modelMatrixInverse",void 0),T(this,"_maxZoom",void 0),T(this,"_minZoom",void 0),T(this,"onTileLoad",void 0),T(this,"_getCullBounds",Tu(Md)),this.opts=e,this.onTileLoad=n=>{this.opts.onTileLoad(n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new b3({maxRequests:e.maxRequests,throttleRequests:e.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Ye,this._modelMatrixInverse=new Ye,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new Ye(r),s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Ur(this._zRange,n)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(c=>this._getTile(c,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const[r,i,s,o]=Md({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:a}=e;if("west"in a)return a.west<s&&a.east>r&&a.south<o&&a.north>i;const c=Math.min(a.top,a.bottom),h=Math.max(a.top,a.bottom);return a.left<s&&a.right>r&&c<o&&h>i}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:o}){const{tileSize:a,extent:c,zoomOffset:h}=this.opts;return BQ({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:a,extent:c,modelMatrix:s,modelMatrixInverse:o,zoomOffset:h})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:MQ(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||Q_,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:kQ[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:DQ*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[o,a]of e)if(a.isVisible||(this._cacheByteSize-=n.maxCacheByteSize?a.byteLength:0,e.delete(o),this.opts.onTileUnload(a)),e.size<=r&&this._cacheByteSize<=i)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((o,a)=>o.zoom-a.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),s=!1;return!i&&n?(i=new rQ(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function UQ(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!lI(e)&&$_(e);for(const e of t)e.isVisible=Boolean(e.state&w0)}function GQ(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&lI(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=Boolean(n.state&w0),n.children&&(n.isVisible||n.state&cb))for(const r of n.children)r.state=cb;else n.isSelected&&$_(n)}function lI(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=w0,!0;e=e.parent}return!1}function $_(t){for(const e of t.children)e.isLoaded||e.content?e.state|=w0:$_(e)}const zQ={TilesetClass:NQ,data:{type:"data",value:[]},dataComparator:k1.equals,renderSubLayers:{type:"function",value:t=>new Cu(t),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:t=>console.error(t),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Q_,zRange:null,maxRequests:6,zoomOffset:0};class Mu extends xs{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0?void 0:n.selectedTiles.every(r=>r.isLoaded&&r.layers&&r.layers.every(i=>i.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:s,maxZoom:o,minZoom:a,maxRequests:c,zoomOffset:h}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:o,minZoom:a,tileSize:e,refinementStrategy:i,extent:s,maxRequests:c,zoomOffset:h,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:s}=e,o=this.state.isLoaded!==s,a=this.state.frameNumber!==i;s&&(o||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?Pd(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){return e.tile=n.props.tile,e}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(e.id),data:e.content,_offset:0,tile:e});e.layers=u0(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}T(Mu,"defaultProps",zQ);T(Mu,"layerName","TileLayer");const VQ={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}};class X_ extends oa{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:n,trailLength:r,currentTime:i}=this.props;e.uniforms={...e.uniforms,fadeTrail:n,trailLength:r,currentTime:i},super.draw(e)}}T(X_,"layerName","TripsLayer");T(X_,"defaultProps",VQ);var Kt=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(J){return e.locateFile?e.locateFile(J,i):i+J}var o;document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",o=function(ae,me,Ge){var u=new XMLHttpRequest;u.open("GET",ae,!0),u.responseType="arraybuffer",u.onload=function(){if(u.status==200||u.status==0&&u.response){me(u.response);return}var At=oc(ae);if(At){me(At.buffer);return}Ge()},u.onerror=Ge,u.send(null)};var a=e.print||console.log.bind(console),c=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var h=0,p=function(J){h=J},m=function(){return h},v=8;function E(J,ae,me,Ge){switch(me=me||"i8",me.charAt(me.length-1)==="*"&&(me="i32"),me){case"i1":ne[J>>0]=ae;break;case"i8":ne[J>>0]=ae;break;case"i16":oe[J>>1]=ae;break;case"i32":xe[J>>2]=ae;break;case"i64":Oe=[ae>>>0,(pe=ae,+In(pe)>=1?pe>0?(yn(+kn(pe/4294967296),4294967295)|0)>>>0:~~+jn((pe-+(~~pe>>>0))/4294967296)>>>0:0)],xe[J>>2]=Oe[0],xe[J+4>>2]=Oe[1];break;case"float":Pe[J>>2]=ae;break;case"double":Ue[J>>3]=ae;break;default:Fi("invalid type for setValue: "+me)}}function b(J,ae,me){switch(ae=ae||"i8",ae.charAt(ae.length-1)==="*"&&(ae="i32"),ae){case"i1":return ne[J>>0];case"i8":return ne[J>>0];case"i16":return oe[J>>1];case"i32":return xe[J>>2];case"i64":return xe[J>>2];case"float":return Pe[J>>2];case"double":return Ue[J>>3];default:Fi("invalid type for getValue: "+ae)}return null}var x=!1;function I(J,ae){J||Fi("Assertion failed: "+ae)}function S(J){var ae=e["_"+J];return I(ae,"Cannot call unknown function "+J+", make sure it is exported"),ae}function P(J,ae,me,Ge,u){var G={string:function(on){var Di=0;if(on!=null&&on!==0){var ya=(on.length<<2)+1;Di=Nu(ya),Z(on,Di,ya)}return Di},array:function(on){var Di=Nu(on.length);return Q(on,Di),Di}};function At(on){return ae==="string"?z(on):ae==="boolean"?Boolean(on):on}var ht=S(J),Ze=[],tt=0;if(Ge)for(var Ht=0;Ht<Ge.length;Ht++){var ut=G[me[Ht]];ut?(tt===0&&(tt=Uu()),Ze[Ht]=ut(Ge[Ht])):Ze[Ht]=Ge[Ht]}var st=ht.apply(null,Ze);return st=At(st),tt!==0&&K0(tt),st}function M(J,ae,me,Ge){me=me||[];var u=me.every(function(At){return At==="number"}),G=ae!=="string";return G&&u&&!Ge?S(J):function(){return P(J,ae,me,arguments)}}var O=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function N(J,ae,me){for(var Ge=ae+me,u=ae;J[u]&&!(u>=Ge);)++u;if(u-ae>16&&J.subarray&&O)return O.decode(J.subarray(ae,u));for(var G="";ae<u;){var At=J[ae++];if(!(At&128)){G+=String.fromCharCode(At);continue}var ht=J[ae++]&63;if((At&224)==192){G+=String.fromCharCode((At&31)<<6|ht);continue}var Ze=J[ae++]&63;if((At&240)==224?At=(At&15)<<12|ht<<6|Ze:At=(At&7)<<18|ht<<12|Ze<<6|J[ae++]&63,At<65536)G+=String.fromCharCode(At);else{var tt=At-65536;G+=String.fromCharCode(55296|tt>>10,56320|tt&1023)}}return G}function z(J,ae){return J?N(se,J,ae):""}function X(J,ae,me,Ge){if(!(Ge>0))return 0;for(var u=me,G=me+Ge-1,At=0;At<J.length;++At){var ht=J.charCodeAt(At);if(ht>=55296&&ht<=57343){var Ze=J.charCodeAt(++At);ht=65536+((ht&1023)<<10)|Ze&1023}if(ht<=127){if(me>=G)break;ae[me++]=ht}else if(ht<=2047){if(me+1>=G)break;ae[me++]=192|ht>>6,ae[me++]=128|ht&63}else if(ht<=65535){if(me+2>=G)break;ae[me++]=224|ht>>12,ae[me++]=128|ht>>6&63,ae[me++]=128|ht&63}else{if(me+3>=G)break;ae[me++]=240|ht>>18,ae[me++]=128|ht>>12&63,ae[me++]=128|ht>>6&63,ae[me++]=128|ht&63}}return ae[me]=0,me-u}function Z(J,ae,me){return X(J,se,ae,me)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Q(J,ae){ne.set(J,ae)}function k(J,ae){return J%ae>0&&(J+=ae-J%ae),J}var D,ne,se,oe,xe,Pe,Ue;function le(J){D=J,e.HEAP8=ne=new Int8Array(J),e.HEAP16=oe=new Int16Array(J),e.HEAP32=xe=new Int32Array(J),e.HEAPU8=se=new Uint8Array(J),e.HEAPU16=new Uint16Array(J),e.HEAPU32=new Uint32Array(J),e.HEAPF32=Pe=new Float32Array(J),e.HEAPF64=Ue=new Float64Array(J)}var _e=5266928,Ce=24016,Fe=e.TOTAL_MEMORY||33554432;e.buffer?D=e.buffer:D=new ArrayBuffer(Fe),Fe=D.byteLength,le(D),xe[Ce>>2]=_e;function ke(J){for(;J.length>0;){var ae=J.shift();if(typeof ae=="function"){ae();continue}var me=ae.func;typeof me=="number"?ae.arg===void 0?e.dynCall_v(me):e.dynCall_vi(me,ae.arg):me(ae.arg===void 0?null:ae.arg)}}var it=[],Rt=[],Pn=[],An=[];function Tt(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)zt(e.preRun.shift());ke(it)}function Ut(){ke(Rt)}function ot(){ke(Pn)}function Gt(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Mn(e.postRun.shift());ke(An)}function zt(J){it.unshift(J)}function Mn(J){An.unshift(J)}var In=Math.abs,jn=Math.ceil,kn=Math.floor,yn=Math.min,sn=0,rr=null;function $r(J){sn++,e.monitorRunDependencies&&e.monitorRunDependencies(sn)}function ir(J){if(sn--,e.monitorRunDependencies&&e.monitorRunDependencies(sn),sn==0&&rr){var ae=rr;rr=null,ae()}}e.preloadedImages={},e.preloadedAudios={};var _t=null,Xr="data:application/octet-stream;base64,";function fi(J){return String.prototype.startsWith?J.startsWith(Xr):J.indexOf(Xr)===0}var pe,Oe;_t="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Xe=24032;function et(J){return J}function We(J){var ae=/\b__Z[\w\d_]+/g;return J.replace(ae,function(me){var Ge=me;return me===Ge?me:Ge+" ["+me+"]"})}function lt(){var J=new Error;if(!J.stack){try{throw new Error(0)}catch(ae){J=ae}if(!J.stack)return"(no stack trace available)"}return J.stack.toString()}function Me(){var J=lt();return e.extraStackTrace&&(J+=`
`+e.extraStackTrace()),We(J)}function Vt(J,ae,me,Ge){Fi("Assertion failed: "+z(J)+", at: "+[ae?z(ae):"unknown filename",me,Ge?z(Ge):"unknown function"])}function at(){return ne.length}function sr(J,ae,me){se.set(se.subarray(ae,ae+me),J)}function Cs(J){return e.___errno_location&&(xe[e.___errno_location()>>2]=J),J}function $0(J){Fi("OOM")}function Fu(J){try{var ae=new ArrayBuffer(J);return ae.byteLength!=J?void 0:(new Int8Array(ae).set(ne),J0(ae),le(ae),1)}catch{}}function X0(J){var ae=at(),me=16777216,Ge=2147483648-me;if(J>Ge)return!1;for(var u=16777216,G=Math.max(ae,u);G<J;)G<=536870912?G=k(2*G,me):G=Math.min(k((3*G+2147483648)/4,me),Ge);var At=Fu(G);return!!At}var ga=typeof atob=="function"?atob:function(J){var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",me="",Ge,u,G,At,ht,Ze,tt,Ht=0;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");do At=ae.indexOf(J.charAt(Ht++)),ht=ae.indexOf(J.charAt(Ht++)),Ze=ae.indexOf(J.charAt(Ht++)),tt=ae.indexOf(J.charAt(Ht++)),Ge=At<<2|ht>>4,u=(ht&15)<<4|Ze>>2,G=(Ze&3)<<6|tt,me=me+String.fromCharCode(Ge),Ze!==64&&(me=me+String.fromCharCode(u)),tt!==64&&(me=me+String.fromCharCode(G));while(Ht<J.length);return me};function Y0(J){try{for(var ae=ga(J),me=new Uint8Array(ae.length),Ge=0;Ge<ae.length;++Ge)me[Ge]=ae.charCodeAt(Ge);return me}catch{throw new Error("Converting base64 string to bytes failed.")}}function oc(J){if(!!fi(J))return Y0(J.slice(Xr.length))}var Du={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},ku={a:Fi,b:p,c:m,d:Vt,e:Cs,f:at,g:sr,h:X0,i:$0,j:et,k:We,l:Fu,m:lt,n:Me,o:Xe,p:Ce},ge=function(J,ae,me){var Ge=new J.Int8Array(me),u=new J.Int32Array(me);new J.Uint8Array(me),new J.Float32Array(me);var G=new J.Float64Array(me),At=ae.p|0,ht=J.Math.floor,Ze=J.Math.abs,tt=J.Math.sqrt,Ht=J.Math.pow,ut=J.Math.cos,st=J.Math.sin,on=J.Math.tan,Di=J.Math.acos,ya=J.Math.asin,Ss=J.Math.atan,jt=J.Math.atan2,hi=J.Math.ceil,Bn=J.Math.imul,di=J.Math.min,xr=J.Math.clz32,De=ae.b,j=ae.c,dt=ae.d,cc=ae.e,_a=ae.f,Cr=ae.g,va=ae.h,Ac=ae.i,U=24048;function uc(l){return Ge=new Int8Array(l),u=new Int32Array(l),G=new Float64Array(l),me=l,!0}function fc(l){l=l|0;var A=0;return A=U,U=U+l|0,U=U+15&-16,A|0}function Ea(){return U|0}function pi(l){l=l|0,U=l}function Z0(l,A){l=l|0,U=l}function Vu(l){return l=l|0,(Bn(l*3|0,l+1|0)|0)+1|0}function wa(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0;!(hc(l,A,f,d,0)|0)||(_=(Bn(f*3|0,f+1|0)|0)+1|0,mi(d|0,0,_<<3|0)|0,g=gi(_,4)|0,g&&(Yr(l,A,f,d,g,_,0),Ke(g)))}function Hu(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0;if(!!(hc(l,A,f,d,g)|0)){if(_=(Bn(f*3|0,f+1|0)|0)+1|0,mi(d|0,0,_<<3|0)|0,g|0){mi(g|0,0,_<<2|0)|0,Yr(l,A,f,d,g,_,0);return}g=gi(_,4)|0,g&&(Yr(l,A,f,d,g,_,0),Ke(g))}}function hc(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0;if(Y=U,U=U+16|0,W=Y,_=d,u[_>>2]=l,u[_+4>>2]=A,_=(g|0)!=0,_&&(u[g>>2]=0),vn(l,A)|0)return W=1,U=Y,W|0;u[W>>2]=0;e:do if((f|0)>=1)if(_)for(B=0,L=1,V=1,y=0,_=l;;){if(!(y|B)){if(_=R(_,A,4,W)|0,A=j()|0,(_|0)==0&(A|0)==0){_=2;break e}if(vn(_,A)|0){_=1;break e}}if(_=R(_,A,u[16+(B<<2)>>2]|0,W)|0,A=j()|0,(_|0)==0&(A|0)==0){_=2;break e}if(l=d+(V<<3)|0,u[l>>2]=_,u[l+4>>2]=A,u[g+(V<<2)>>2]=L,y=y+1|0,l=(y|0)==(L|0),w=B+1|0,C=(w|0)==6,vn(_,A)|0){_=1;break e}if(L=L+(C&l&1)|0,(L|0)>(f|0)){_=0;break}else B=l?C?0:w:B,V=V+1|0,y=l?0:y}else for(B=0,L=1,V=1,y=0,_=l;;){if(!(y|B)){if(_=R(_,A,4,W)|0,A=j()|0,(_|0)==0&(A|0)==0){_=2;break e}if(vn(_,A)|0){_=1;break e}}if(_=R(_,A,u[16+(B<<2)>>2]|0,W)|0,A=j()|0,(_|0)==0&(A|0)==0){_=2;break e}if(l=d+(V<<3)|0,u[l>>2]=_,u[l+4>>2]=A,y=y+1|0,l=(y|0)==(L|0),w=B+1|0,C=(w|0)==6,vn(_,A)|0){_=1;break e}if(L=L+(C&l&1)|0,(L|0)>(f|0)){_=0;break}else B=l?C?0:w:B,V=V+1|0,y=l?0:y}else _=0;while(0);return W=_,U=Y,W|0}function Yr(l,A,f,d,g,_,y){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0,_=_|0,y=y|0;var w=0,C=0,B=0,L=0,V=0,W=0,Y=0;if(V=U,U=U+16|0,L=V,(l|0)==0&(A|0)==0){U=V;return}if(w=Is(l|0,A|0,_|0,((_|0)<0)<<31>>31|0)|0,j()|0,C=d+(w<<3)|0,W=C,Y=u[W>>2]|0,W=u[W+4>>2]|0,B=(Y|0)==(l|0)&(W|0)==(A|0),!((Y|0)==0&(W|0)==0|B))do w=(w+1|0)%(_|0)|0,C=d+(w<<3)|0,Y=C,W=u[Y>>2]|0,Y=u[Y+4>>2]|0,B=(W|0)==(l|0)&(Y|0)==(A|0);while(!((W|0)==0&(Y|0)==0|B));if(w=g+(w<<2)|0,B&&(u[w>>2]|0)<=(y|0)){U=V;return}if(Y=C,u[Y>>2]=l,u[Y+4>>2]=A,u[w>>2]=y,(y|0)>=(f|0)){U=V;return}Y=y+1|0,u[L>>2]=0,W=R(l,A,2,L)|0,Yr(W,j()|0,f,d,g,_,Y),u[L>>2]=0,W=R(l,A,3,L)|0,Yr(W,j()|0,f,d,g,_,Y),u[L>>2]=0,W=R(l,A,1,L)|0,Yr(W,j()|0,f,d,g,_,Y),u[L>>2]=0,W=R(l,A,5,L)|0,Yr(W,j()|0,f,d,g,_,Y),u[L>>2]=0,W=R(l,A,4,L)|0,Yr(W,j()|0,f,d,g,_,Y),u[L>>2]=0,W=R(l,A,6,L)|0,Yr(W,j()|0,f,d,g,_,Y),U=V}function R(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0;if((u[d>>2]|0)>0){g=0;do f=Co(f)|0,g=g+1|0;while((g|0)<(u[d>>2]|0))}w=he(l|0,A|0,45)|0,j()|0,C=w&127,_=dr(l,A)|0,g=he(l|0,A|0,52)|0,j()|0,g=g&15;e:do if(!g)y=6;else for(;;){if(V=(15-g|0)*3|0,W=he(l|0,A|0,V|0)|0,j()|0,W=W&7,Y=(Jr(g)|0)==0,g=g+-1|0,L=we(7,0,V|0)|0,A=A&~(j()|0),V=we(u[(Y?464:48)+(W*28|0)+(f<<2)>>2]|0,0,V|0)|0,B=j()|0,f=u[(Y?672:256)+(W*28|0)+(f<<2)>>2]|0,l=V|l&~L,A=B|A,!f){f=0;break e}if(!g){y=6;break}}while(0);(y|0)==6&&(Y=u[880+(C*28|0)+(f<<2)>>2]|0,W=we(Y|0,0,45)|0,l=W|l,A=j()|0|A&-1040385,f=u[4304+(C*28|0)+(f<<2)>>2]|0,(Y&127|0)==127&&(Y=we(u[880+(C*28|0)+20>>2]|0,0,45)|0,A=j()|0|A&-1040385,f=u[4304+(C*28|0)+20>>2]|0,l=Ms(Y|l,A)|0,A=j()|0,u[d>>2]=(u[d>>2]|0)+1)),y=he(l|0,A|0,45)|0,j()|0,y=y&127;e:do if(Je(y)|0){t:do if((dr(l,A)|0)==1){if((C|0)!=(y|0))if(kv(y,u[7728+(C*28|0)>>2]|0)|0){l=ap(l,A)|0,_=1,A=j()|0;break}else{l=Ms(l,A)|0,_=1,A=j()|0;break}switch(_|0){case 5:{l=ap(l,A)|0,A=j()|0,u[d>>2]=(u[d>>2]|0)+5,_=0;break t}case 3:{l=Ms(l,A)|0,A=j()|0,u[d>>2]=(u[d>>2]|0)+1,_=0;break t}default:return W=0,Y=0,De(W|0),Y|0}}else _=0;while(0);if((f|0)>0){g=0;do l=op(l,A)|0,A=j()|0,g=g+1|0;while((g|0)!=(f|0))}if((C|0)!=(y|0)){if(!(_n(y)|0)){if((_|0)!=0|(dr(l,A)|0)!=5)break;u[d>>2]=(u[d>>2]|0)+1;break}switch(w&127){case 8:case 118:break e}(dr(l,A)|0)!=3&&(u[d>>2]=(u[d>>2]|0)+1)}}else if((f|0)>0){g=0;do l=Ms(l,A)|0,A=j()|0,g=g+1|0;while((g|0)!=(f|0))}while(0);return u[d>>2]=((u[d>>2]|0)+f|0)%6|0,W=A,Y=l,De(W|0),Y|0}function F(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0;if(V=U,U=U+16|0,L=V,!f)return L=d,u[L>>2]=l,u[L+4>>2]=A,L=0,U=V,L|0;u[L>>2]=0;e:do if(vn(l,A)|0)l=1;else{if(_=(f|0)>0,_){g=0,B=l;do{if(B=R(B,A,4,L)|0,A=j()|0,(B|0)==0&(A|0)==0){l=2;break e}if(g=g+1|0,vn(B,A)|0){l=1;break e}}while((g|0)<(f|0));if(C=d,u[C>>2]=B,u[C+4>>2]=A,C=f+-1|0,_){_=0,y=1,g=B,l=A;do{if(g=R(g,l,2,L)|0,l=j()|0,(g|0)==0&(l|0)==0){l=2;break e}if(w=d+(y<<3)|0,u[w>>2]=g,u[w+4>>2]=l,y=y+1|0,vn(g,l)|0){l=1;break e}_=_+1|0}while((_|0)<(f|0));w=0,_=y;do{if(g=R(g,l,3,L)|0,l=j()|0,(g|0)==0&(l|0)==0){l=2;break e}if(y=d+(_<<3)|0,u[y>>2]=g,u[y+4>>2]=l,_=_+1|0,vn(g,l)|0){l=1;break e}w=w+1|0}while((w|0)<(f|0));y=0;do{if(g=R(g,l,1,L)|0,l=j()|0,(g|0)==0&(l|0)==0){l=2;break e}if(w=d+(_<<3)|0,u[w>>2]=g,u[w+4>>2]=l,_=_+1|0,vn(g,l)|0){l=1;break e}y=y+1|0}while((y|0)<(f|0));y=0;do{if(g=R(g,l,5,L)|0,l=j()|0,(g|0)==0&(l|0)==0){l=2;break e}if(w=d+(_<<3)|0,u[w>>2]=g,u[w+4>>2]=l,_=_+1|0,vn(g,l)|0){l=1;break e}y=y+1|0}while((y|0)<(f|0));y=0;do{if(g=R(g,l,4,L)|0,l=j()|0,(g|0)==0&(l|0)==0){l=2;break e}if(w=d+(_<<3)|0,u[w>>2]=g,u[w+4>>2]=l,_=_+1|0,vn(g,l)|0){l=1;break e}y=y+1|0}while((y|0)<(f|0));for(y=0;;){if(g=R(g,l,6,L)|0,l=j()|0,(g|0)==0&(l|0)==0){l=2;break e}if((y|0)!=(C|0))if(w=d+(_<<3)|0,u[w>>2]=g,u[w+4>>2]=l,!(vn(g,l)|0))_=_+1|0;else{l=1;break e}if(y=y+1|0,(y|0)>=(f|0)){y=B,_=A;break}}}else y=B,g=B,_=A,l=A}else y=d,u[y>>2]=l,u[y+4>>2]=A,y=l,g=l,_=A,l=A;l=((y|0)!=(g|0)|(_|0)!=(l|0))&1}while(0);return L=l,U=V,L|0}function H(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0;if(_=U,U=U+48|0,g=_+8|0,d=_,w=l,y=u[w+4>>2]|0,f=d,u[f>>2]=u[w>>2],u[f+4>>2]=y,Ap(d,g),g=tp(g,A)|0,A=u[d>>2]|0,d=u[l+8>>2]|0,(d|0)<=0)return w=A,y=(g|0)<(w|0),w=y?w:g,w=w+12|0,U=_,w|0;f=u[l+12>>2]|0,l=0;do A=(u[f+(l<<3)>>2]|0)+A|0,l=l+1|0;while((l|0)<(d|0));return w=(g|0)<(A|0),w=w?A:g,w=w+12|0,U=_,w|0}function q(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0;if(w=U,U=U+48|0,d=w+8|0,g=w,!(ce(l,A,f)|0)){U=w;return}if(C=l,_=u[C+4>>2]|0,y=g,u[y>>2]=u[C>>2],u[y+4>>2]=_,Ap(g,d),y=tp(d,A)|0,A=u[g>>2]|0,_=u[l+8>>2]|0,(_|0)>0){g=u[l+12>>2]|0,d=0;do A=(u[g+(d<<3)>>2]|0)+A|0,d=d+1|0;while((d|0)!=(_|0))}if(A=(y|0)<(A|0)?A:y,(A|0)<=-12){U=w;return}C=A+11|0,mi(f|0,0,(((C|0)>0?C:0)<<3)+8|0)|0,U=w}function ce(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0,It=0,pt=0,Ot=0,Ft=0,He=0;if(He=U,U=U+112|0,It=He+80|0,C=He+72|0,pt=He,Ot=He+56|0,B=l+8|0,Ft=ki((u[B>>2]<<5)+32|0)|0,Ft||dt(22848,22448,800,22456),fR(l,Ft),_=l,d=u[_+4>>2]|0,w=C,u[w>>2]=u[_>>2],u[w+4>>2]=d,Ap(C,It),w=tp(It,A)|0,d=u[C>>2]|0,_=u[B>>2]|0,(_|0)>0){y=u[l+12>>2]|0,g=0;do d=(u[y+(g<<3)>>2]|0)+d|0,g=g+1|0;while((g|0)!=(_|0))}if(w=(w|0)<(d|0)?d:w,yt=w+12|0,g=gi(yt,8)|0,L=gi(yt,8)|0,u[It>>2]=0,Qe=l,bt=u[Qe+4>>2]|0,d=C,u[d>>2]=u[Qe>>2],u[d+4>>2]=bt,d=Se(C,yt,A,It,g,L)|0,d|0)return Ke(g),Ke(L),Ke(Ft),Ft=d,U=He,Ft|0;e:do if((u[B>>2]|0)>0){for(_=l+12|0,d=0;y=Se((u[_>>2]|0)+(d<<3)|0,yt,A,It,g,L)|0,d=d+1|0,!(y|0);)if((d|0)>=(u[B>>2]|0))break e;return Ke(g),Ke(L),Ke(Ft),Ft=y,U=He,Ft|0}while(0);(w|0)>-12&&mi(L|0,0,((yt|0)>1?yt:1)<<3|0)|0;e:do if((u[It>>2]|0)>0){bt=((yt|0)<0)<<31>>31,$=g,be=L,Ie=g,ye=g,Ee=L,Qe=g,d=g,de=g,Te=L,te=L,Ae=L,g=L;t:for(;;){for(ie=u[It>>2]|0,Y=0,re=0,_=0;;){y=pt,w=y+56|0;do u[y>>2]=0,y=y+4|0;while((y|0)<(w|0));if(A=$+(Y<<3)|0,C=u[A>>2]|0,A=u[A+4>>2]|0,hc(C,A,1,pt,0)|0){y=pt,w=y+56|0;do u[y>>2]=0,y=y+4|0;while((y|0)<(w|0));y=gi(7,4)|0,y|0&&(Yr(C,A,1,pt,y,7,0),Ke(y))}W=0;do{V=pt+(W<<3)|0,L=u[V>>2]|0,V=u[V+4>>2]|0;n:do if(!((L|0)==0&(V|0)==0)){if(C=Is(L|0,V|0,yt|0,bt|0)|0,j()|0,y=f+(C<<3)|0,w=y,A=u[w>>2]|0,w=u[w+4>>2]|0,!((A|0)==0&(w|0)==0))for(B=0;;){if((B|0)>(yt|0))break t;if((A|0)==(L|0)&(w|0)==(V|0))break n;if(C=(C+1|0)%(yt|0)|0,y=f+(C<<3)|0,w=y,A=u[w>>2]|0,w=u[w+4>>2]|0,(A|0)==0&(w|0)==0)break;B=B+1|0}(L|0)==0&(V|0)==0||(So(L,V,Ot),hR(l,Ft,Ot)|0&&(B=y,u[B>>2]=L,u[B+4>>2]=V,B=be+(_<<3)|0,u[B>>2]=L,u[B+4>>2]=V,_=_+1|0))}while(0);W=W+1|0}while(W>>>0<7);if(re=re+1|0,(re|0)>=(ie|0))break;Y=Y+1|0}if((ie|0)>0&&mi(Ie|0,0,ie<<3|0)|0,u[It>>2]=_,(_|0)>0)L=g,V=Ae,W=Qe,Y=te,re=Te,ie=be,g=de,Ae=d,te=ye,Te=Ie,de=L,d=V,Qe=Ee,Ee=W,ye=Y,Ie=re,be=$,$=ie;else break e}return Ke(ye),Ke(Ee),Ke(Ft),Ft=-1,U=He,Ft|0}else d=L;while(0);return Ke(Ft),Ke(g),Ke(d),Ft=0,U=He,Ft|0}function Se(l,A,f,d,g,_){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0,_=_|0;var y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0,It=0;if(bt=U,U=U+48|0,Ie=bt+32|0,ye=bt+16|0,Ee=bt,y=u[l>>2]|0,(y|0)<=0)return Qe=0,U=bt,Qe|0;Te=l+4|0,te=Ie+8|0,Ae=ye+8|0,$=Ee+8|0,be=((A|0)<0)<<31>>31,de=0;e:for(;;){w=u[Te>>2]|0,re=w+(de<<4)|0,u[Ie>>2]=u[re>>2],u[Ie+4>>2]=u[re+4>>2],u[Ie+8>>2]=u[re+8>>2],u[Ie+12>>2]=u[re+12>>2],(de|0)==(y+-1|0)?(u[ye>>2]=u[w>>2],u[ye+4>>2]=u[w+4>>2],u[ye+8>>2]=u[w+8>>2],u[ye+12>>2]=u[w+12>>2]):(re=w+(de+1<<4)|0,u[ye>>2]=u[re>>2],u[ye+4>>2]=u[re+4>>2],u[ye+8>>2]=u[re+8>>2],u[ye+12>>2]=u[re+12>>2]),re=pL(Ie,ye,f)|0;t:do if((re|0)>0){ie=+(re|0),Y=0;n:for(;;){It=+(re-Y|0),yt=+(Y|0),G[Ee>>3]=+G[Ie>>3]*It/ie+ +G[ye>>3]*yt/ie,G[$>>3]=+G[te>>3]*It/ie+ +G[Ae>>3]*yt/ie,V=qv(Ee,f)|0,W=j()|0,w=Is(V|0,W|0,A|0,be|0)|0,j()|0,y=_+(w<<3)|0,C=y,B=u[C>>2]|0,C=u[C+4>>2]|0;r:do if((B|0)==0&(C|0)==0)Qe=14;else for(L=0;;){if((L|0)>(A|0)){y=1;break r}if((B|0)==(V|0)&(C|0)==(W|0)){y=7;break r}if(w=(w+1|0)%(A|0)|0,y=_+(w<<3)|0,C=y,B=u[C>>2]|0,C=u[C+4>>2]|0,(B|0)==0&(C|0)==0){Qe=14;break}else L=L+1|0}while(0);switch((Qe|0)==14&&(Qe=0,(V|0)==0&(W|0)==0?y=7:(u[y>>2]=V,u[y+4>>2]=W,y=u[d>>2]|0,L=g+(y<<3)|0,u[L>>2]=V,u[L+4>>2]=W,u[d>>2]=y+1,y=0)),y&7){case 7:case 0:break;default:break n}if(Y=Y+1|0,(re|0)<=(Y|0)){Qe=8;break t}}if(y|0){y=-1,Qe=20;break e}}else Qe=8;while(0);if((Qe|0)==8&&(Qe=0),de=de+1|0,y=u[l>>2]|0,(de|0)>=(y|0)){y=0,Qe=20;break}}return(Qe|0)==20?(U=bt,y|0):0}function rt(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0;if(B=U,U=U+176|0,C=B,(A|0)<1){l2(f,0,0),U=B;return}y=l,y=he(u[y>>2]|0,u[y+4>>2]|0,52)|0,j()|0,l2(f,(A|0)>6?A:6,y&15),y=0;do{if(d=l+(y<<3)|0,Po(u[d>>2]|0,u[d+4>>2]|0,C),d=u[C>>2]|0,(d|0)>0){w=0;do _=C+8+(w<<4)|0,w=w+1|0,d=C+8+(((w|0)%(d|0)|0)<<4)|0,g=CR(f,d,_)|0,g?u2(f,g)|0:xR(f,_,d)|0,d=u[C>>2]|0;while((w|0)<(d|0))}y=y+1|0}while((y|0)!=(A|0));U=B}function un(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0;if(_=U,U=U+32|0,d=_,g=_+16|0,rt(l,A,g),u[f>>2]=0,u[f+4>>2]=0,u[f+8>>2]=0,l=A2(g)|0,!l){n2(f)|0,c2(g),U=_;return}do{A=iR(f)|0;do sR(A,l)|0,y=l+16|0,u[d>>2]=u[y>>2],u[d+4>>2]=u[y+4>>2],u[d+8>>2]=u[y+8>>2],u[d+12>>2]=u[y+12>>2],u2(g,l)|0,l=SR(g,d)|0;while((l|0)!=0);l=A2(g)|0}while((l|0)!=0);n2(f)|0,c2(g),U=_}function Je(l){return l=l|0,u[7728+(l*28|0)+16>>2]|0}function _n(l){return l=l|0,(l|0)==4|(l|0)==117|0}function Sr(l){return l=l|0,u[11152+((u[l>>2]|0)*216|0)+((u[l+4>>2]|0)*72|0)+((u[l+8>>2]|0)*24|0)+(u[l+12>>2]<<3)>>2]|0}function AL(l){return l=l|0,u[11152+((u[l>>2]|0)*216|0)+((u[l+4>>2]|0)*72|0)+((u[l+8>>2]|0)*24|0)+(u[l+12>>2]<<3)+4>>2]|0}function uL(l,A){l=l|0,A=A|0,l=7728+(l*28|0)|0,u[A>>2]=u[l>>2],u[A+4>>2]=u[l+4>>2],u[A+8>>2]=u[l+8>>2],u[A+12>>2]=u[l+12>>2]}function fL(l,A){l=l|0,A=A|0;var f=0,d=0;if(A>>>0>20)return A=-1,A|0;do if((u[11152+(A*216|0)>>2]|0)!=(l|0))if((u[11152+(A*216|0)+8>>2]|0)!=(l|0))if((u[11152+(A*216|0)+16>>2]|0)!=(l|0))if((u[11152+(A*216|0)+24>>2]|0)!=(l|0))if((u[11152+(A*216|0)+32>>2]|0)!=(l|0))if((u[11152+(A*216|0)+40>>2]|0)!=(l|0))if((u[11152+(A*216|0)+48>>2]|0)!=(l|0))if((u[11152+(A*216|0)+56>>2]|0)!=(l|0))if((u[11152+(A*216|0)+64>>2]|0)!=(l|0))if((u[11152+(A*216|0)+72>>2]|0)!=(l|0))if((u[11152+(A*216|0)+80>>2]|0)!=(l|0))if((u[11152+(A*216|0)+88>>2]|0)!=(l|0))if((u[11152+(A*216|0)+96>>2]|0)!=(l|0))if((u[11152+(A*216|0)+104>>2]|0)!=(l|0))if((u[11152+(A*216|0)+112>>2]|0)!=(l|0))if((u[11152+(A*216|0)+120>>2]|0)!=(l|0))if((u[11152+(A*216|0)+128>>2]|0)!=(l|0))if((u[11152+(A*216|0)+136>>2]|0)==(l|0))l=2,f=1,d=2;else{if((u[11152+(A*216|0)+144>>2]|0)==(l|0)){l=0,f=2,d=0;break}if((u[11152+(A*216|0)+152>>2]|0)==(l|0)){l=0,f=2,d=1;break}if((u[11152+(A*216|0)+160>>2]|0)==(l|0)){l=0,f=2,d=2;break}if((u[11152+(A*216|0)+168>>2]|0)==(l|0)){l=1,f=2,d=0;break}if((u[11152+(A*216|0)+176>>2]|0)==(l|0)){l=1,f=2,d=1;break}if((u[11152+(A*216|0)+184>>2]|0)==(l|0)){l=1,f=2,d=2;break}if((u[11152+(A*216|0)+192>>2]|0)==(l|0)){l=2,f=2,d=0;break}if((u[11152+(A*216|0)+200>>2]|0)==(l|0)){l=2,f=2,d=1;break}if((u[11152+(A*216|0)+208>>2]|0)==(l|0)){l=2,f=2,d=2;break}else l=-1;return l|0}else l=2,f=1,d=1;else l=2,f=1,d=0;else l=1,f=1,d=2;else l=1,f=1,d=1;else l=1,f=1,d=0;else l=0,f=1,d=2;else l=0,f=1,d=1;else l=0,f=1,d=0;else l=2,f=0,d=2;else l=2,f=0,d=1;else l=2,f=0,d=0;else l=1,f=0,d=2;else l=1,f=0,d=1;else l=1,f=0,d=0;else l=0,f=0,d=2;else l=0,f=0,d=1;else l=0,f=0,d=0;while(0);return A=u[11152+(A*216|0)+(f*72|0)+(l*24|0)+(d<<3)+4>>2]|0,A|0}function kv(l,A){return l=l|0,A=A|0,(u[7728+(l*28|0)+20>>2]|0)==(A|0)?(A=1,A|0):(A=(u[7728+(l*28|0)+24>>2]|0)==(A|0),A|0)}function q0(l,A){return l=l|0,A=A|0,u[880+(l*28|0)+(A<<2)>>2]|0}function ep(l,A){return l=l|0,A=A|0,(u[880+(l*28|0)>>2]|0)==(A|0)?(A=0,A|0):(u[880+(l*28|0)+4>>2]|0)==(A|0)?(A=1,A|0):(u[880+(l*28|0)+8>>2]|0)==(A|0)?(A=2,A|0):(u[880+(l*28|0)+12>>2]|0)==(A|0)?(A=3,A|0):(u[880+(l*28|0)+16>>2]|0)==(A|0)?(A=4,A|0):(u[880+(l*28|0)+20>>2]|0)==(A|0)?(A=5,A|0):((u[880+(l*28|0)+24>>2]|0)==(A|0)?6:7)|0}function hL(){return 122}function dL(l){l=l|0;var A=0,f=0,d=0;A=0;do we(A|0,0,45)|0,d=j()|0|134225919,f=l+(A<<3)|0,u[f>>2]=-1,u[f+4>>2]=d,A=A+1|0;while((A|0)!=122)}function Nv(l){return l=l|0,+G[l+16>>3]<+G[l+24>>3]|0}function Uv(l,A){l=l|0,A=A|0;var f=0,d=0,g=0;return f=+G[A>>3],!(f>=+G[l+8>>3])||!(f<=+G[l>>3])?(A=0,A|0):(d=+G[l+16>>3],f=+G[l+24>>3],g=+G[A+8>>3],A=g>=f,l=g<=d&1,d<f?A&&(l=1):A||(l=0),A=(l|0)!=0,A|0)}function tp(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0;y=U,U=U+288|0,f=y+264|0,d=y+96|0,g=y,_=g,w=_+96|0;do u[_>>2]=0,_=_+4|0;while((_|0)<(w|0));return cp(A,g),_=g,w=u[_>>2]|0,_=u[_+4>>2]|0,So(w,_,f),Po(w,_,d),C=+gc(f,d+8|0),G[f>>3]=+G[l>>3],_=f+8|0,G[_>>3]=+G[l+16>>3],G[d>>3]=+G[l+8>>3],w=d+8|0,G[w>>3]=+G[l+24>>3],B=+gc(f,d),w=~~+hi(+(B*B/+h2(+ +Ze(+((+G[_>>3]-+G[w>>3])/(+G[f>>3]-+G[d>>3]))),3)/(C*(C*2.59807621135)*.8))),U=y,((w|0)==0?1:w)|0}function pL(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0;w=U,U=U+288|0,d=w+264|0,g=w+96|0,_=w,y=_,C=y+96|0;do u[y>>2]=0,y=y+4|0;while((y|0)<(C|0));return cp(f,_),C=_,y=u[C>>2]|0,C=u[C+4>>2]|0,So(y,C,d),Po(y,C,g),B=+gc(d,g+8|0),C=~~+hi(+(+gc(l,A)/(B*2))),U=w,((C|0)==0?1:C)|0}function gL(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0,u[l>>2]=A,u[l+4>>2]=f,u[l+8>>2]=d}function mL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0;V=A+8|0,u[V>>2]=0,C=+G[l>>3],y=+Ze(+C),B=+G[l+8>>3],w=+Ze(+B)/.8660254037844386,y=y+w*.5,f=~~y,l=~~w,y=y-+(f|0),w=w-+(l|0);do if(y<.5)if(y<.3333333333333333)if(u[A>>2]=f,w<(y+1)*.5){u[A+4>>2]=l;break}else{l=l+1|0,u[A+4>>2]=l;break}else if(W=1-y,l=(!(w<W)&1)+l|0,u[A+4>>2]=l,W<=w&w<y*2){f=f+1|0,u[A>>2]=f;break}else{u[A>>2]=f;break}else{if(!(y<.6666666666666666))if(f=f+1|0,u[A>>2]=f,w<y*.5){u[A+4>>2]=l;break}else{l=l+1|0,u[A+4>>2]=l;break}if(w<1-y){if(u[A+4>>2]=l,y*2+-1<w){u[A>>2]=f;break}}else l=l+1|0,u[A+4>>2]=l;f=f+1|0,u[A>>2]=f}while(0);do if(C<0)if(l&1){L=(l+1|0)/2|0,L=yc(f|0,((f|0)<0)<<31>>31|0,L|0,((L|0)<0)<<31>>31|0)|0,f=~~(+(f|0)-((+(L>>>0)+4294967296*+(j()|0))*2+1)),u[A>>2]=f;break}else{L=(l|0)/2|0,L=yc(f|0,((f|0)<0)<<31>>31|0,L|0,((L|0)<0)<<31>>31|0)|0,f=~~(+(f|0)-(+(L>>>0)+4294967296*+(j()|0))*2),u[A>>2]=f;break}while(0);L=A+4|0,B<0&&(f=f-((l<<1|1|0)/2|0)|0,u[A>>2]=f,l=0-l|0,u[L>>2]=l),d=l-f|0,(f|0)<0?(g=0-f|0,u[L>>2]=d,u[V>>2]=g,u[A>>2]=0,l=d,f=0):g=0,(l|0)<0&&(f=f-l|0,u[A>>2]=f,g=g-l|0,u[V>>2]=g,u[L>>2]=0,l=0),_=f-g|0,d=l-g|0,(g|0)<0&&(u[A>>2]=_,u[L>>2]=d,u[V>>2]=0,l=d,f=_,g=0),d=(l|0)<(f|0)?l:f,d=(g|0)<(d|0)?g:d,!((d|0)<=0)&&(u[A>>2]=f-d,u[L>>2]=l-d,u[V>>2]=g-d)}function Wn(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0;A=u[l>>2]|0,y=l+4|0,f=u[y>>2]|0,(A|0)<0&&(f=f-A|0,u[y>>2]=f,_=l+8|0,u[_>>2]=(u[_>>2]|0)-A,u[l>>2]=0,A=0),(f|0)<0?(A=A-f|0,u[l>>2]=A,_=l+8|0,g=(u[_>>2]|0)-f|0,u[_>>2]=g,u[y>>2]=0,f=0):(g=l+8|0,_=g,g=u[g>>2]|0),(g|0)<0&&(A=A-g|0,u[l>>2]=A,f=f-g|0,u[y>>2]=f,u[_>>2]=0,g=0),d=(f|0)<(A|0)?f:A,d=(g|0)<(d|0)?g:d,!((d|0)<=0)&&(u[l>>2]=A-d,u[y>>2]=f-d,u[_>>2]=g-d)}function bo(l,A){l=l|0,A=A|0;var f=0,d=0;d=u[l+8>>2]|0,f=+((u[l+4>>2]|0)-d|0),G[A>>3]=+((u[l>>2]|0)-d|0)-f*.5,G[A+8>>3]=f*.8660254037844386}function or(l,A,f){l=l|0,A=A|0,f=f|0,u[f>>2]=(u[A>>2]|0)+(u[l>>2]|0),u[f+4>>2]=(u[A+4>>2]|0)+(u[l+4>>2]|0),u[f+8>>2]=(u[A+8>>2]|0)+(u[l+8>>2]|0)}function np(l,A,f){l=l|0,A=A|0,f=f|0,u[f>>2]=(u[l>>2]|0)-(u[A>>2]|0),u[f+4>>2]=(u[l+4>>2]|0)-(u[A+4>>2]|0),u[f+8>>2]=(u[l+8>>2]|0)-(u[A+8>>2]|0)}function Gv(l,A){l=l|0,A=A|0;var f=0,d=0;f=Bn(u[l>>2]|0,A)|0,u[l>>2]=f,f=l+4|0,d=Bn(u[f>>2]|0,A)|0,u[f>>2]=d,l=l+8|0,A=Bn(u[l>>2]|0,A)|0,u[l>>2]=A}function ju(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;y=u[l>>2]|0,w=(y|0)<0,d=(u[l+4>>2]|0)-(w?y:0)|0,_=(d|0)<0,g=(_?0-d|0:0)+((u[l+8>>2]|0)-(w?y:0))|0,f=(g|0)<0,l=f?0:g,A=(_?0:d)-(f?g:0)|0,g=(w?0:y)-(_?d:0)-(f?g:0)|0,f=(A|0)<(g|0)?A:g,f=(l|0)<(f|0)?l:f,d=(f|0)>0,l=l-(d?f:0)|0,A=A-(d?f:0)|0;e:do switch(g-(d?f:0)|0){case 0:switch(A|0){case 0:return w=(l|0)==0?0:(l|0)==1?1:7,w|0;case 1:return w=(l|0)==0?2:(l|0)==1?3:7,w|0;default:break e}case 1:switch(A|0){case 0:return w=(l|0)==0?4:(l|0)==1?5:7,w|0;case 1:{if(!l)l=6;else break e;return l|0}default:break e}}while(0);return w=7,w|0}function zv(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;y=l+8|0,f=u[y>>2]|0,A=(u[l>>2]|0)-f|0,w=l+4|0,f=(u[w>>2]|0)-f|0,d=Yu(+((A*3|0)-f|0)/7)|0,u[l>>2]=d,A=Yu(+((f<<1)+A|0)/7)|0,u[w>>2]=A,u[y>>2]=0,f=A-d|0,(d|0)<0?(_=0-d|0,u[w>>2]=f,u[y>>2]=_,u[l>>2]=0,A=f,d=0,f=_):f=0,(A|0)<0&&(d=d-A|0,u[l>>2]=d,f=f-A|0,u[y>>2]=f,u[w>>2]=0,A=0),_=d-f|0,g=A-f|0,(f|0)<0?(u[l>>2]=_,u[w>>2]=g,u[y>>2]=0,A=g,g=_,f=0):g=d,d=(A|0)<(g|0)?A:g,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(u[l>>2]=g-d,u[w>>2]=A-d,u[y>>2]=f-d)}function rp(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;y=l+8|0,f=u[y>>2]|0,A=(u[l>>2]|0)-f|0,w=l+4|0,f=(u[w>>2]|0)-f|0,d=Yu(+((A<<1)+f|0)/7)|0,u[l>>2]=d,A=Yu(+((f*3|0)-A|0)/7)|0,u[w>>2]=A,u[y>>2]=0,f=A-d|0,(d|0)<0?(_=0-d|0,u[w>>2]=f,u[y>>2]=_,u[l>>2]=0,A=f,d=0,f=_):f=0,(A|0)<0&&(d=d-A|0,u[l>>2]=d,f=f-A|0,u[y>>2]=f,u[w>>2]=0,A=0),_=d-f|0,g=A-f|0,(f|0)<0?(u[l>>2]=_,u[w>>2]=g,u[y>>2]=0,A=g,g=_,f=0):g=d,d=(A|0)<(g|0)?A:g,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(u[l>>2]=g-d,u[w>>2]=A-d,u[y>>2]=f-d)}function Wu(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;A=u[l>>2]|0,y=l+4|0,f=u[y>>2]|0,w=l+8|0,d=u[w>>2]|0,g=f+(A*3|0)|0,u[l>>2]=g,f=d+(f*3|0)|0,u[y>>2]=f,A=(d*3|0)+A|0,u[w>>2]=A,d=f-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=d,u[w>>2]=A,u[l>>2]=0,f=d,d=0):d=g,(f|0)<0&&(d=d-f|0,u[l>>2]=d,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),_=d-A|0,g=f-A|0,(A|0)<0?(u[l>>2]=_,u[y>>2]=g,u[w>>2]=0,d=_,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[l>>2]=d-f,u[y>>2]=g-f,u[w>>2]=A-f)}function xo(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;g=u[l>>2]|0,y=l+4|0,A=u[y>>2]|0,w=l+8|0,f=u[w>>2]|0,d=(A*3|0)+g|0,g=f+(g*3|0)|0,u[l>>2]=g,u[y>>2]=d,A=(f*3|0)+A|0,u[w>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=f,u[w>>2]=A,u[l>>2]=0,g=0):f=d,(f|0)<0&&(g=g-f|0,u[l>>2]=g,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),_=g-A|0,d=f-A|0,(A|0)<0?(u[l>>2]=_,u[y>>2]=d,u[w>>2]=0,g=_,A=0):d=f,f=(d|0)<(g|0)?d:g,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[l>>2]=g-f,u[y>>2]=d-f,u[w>>2]=A-f)}function Vv(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0;(A+-1|0)>>>0>=6||(g=(u[15472+(A*12|0)>>2]|0)+(u[l>>2]|0)|0,u[l>>2]=g,w=l+4|0,d=(u[15472+(A*12|0)+4>>2]|0)+(u[w>>2]|0)|0,u[w>>2]=d,y=l+8|0,A=(u[15472+(A*12|0)+8>>2]|0)+(u[y>>2]|0)|0,u[y>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[w>>2]=f,u[y>>2]=A,u[l>>2]=0,d=0):(f=d,d=g),(f|0)<0&&(d=d-f|0,u[l>>2]=d,A=A-f|0,u[y>>2]=A,u[w>>2]=0,f=0),_=d-A|0,g=f-A|0,(A|0)<0?(u[l>>2]=_,u[w>>2]=g,u[y>>2]=0,d=_,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[l>>2]=d-f,u[w>>2]=g-f,u[y>>2]=A-f))}function Hv(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;g=u[l>>2]|0,y=l+4|0,A=u[y>>2]|0,w=l+8|0,f=u[w>>2]|0,d=A+g|0,g=f+g|0,u[l>>2]=g,u[y>>2]=d,A=f+A|0,u[w>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=f,u[w>>2]=A,u[l>>2]=0,d=0):(f=d,d=g),(f|0)<0&&(d=d-f|0,u[l>>2]=d,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),_=d-A|0,g=f-A|0,(A|0)<0?(u[l>>2]=_,u[y>>2]=g,u[w>>2]=0,d=_,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[l>>2]=d-f,u[y>>2]=g-f,u[w>>2]=A-f)}function Qu(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;A=u[l>>2]|0,y=l+4|0,d=u[y>>2]|0,w=l+8|0,f=u[w>>2]|0,g=d+A|0,u[l>>2]=g,d=f+d|0,u[y>>2]=d,A=f+A|0,u[w>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=f,u[w>>2]=A,u[l>>2]=0,d=0):(f=d,d=g),(f|0)<0&&(d=d-f|0,u[l>>2]=d,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),_=d-A|0,g=f-A|0,(A|0)<0?(u[l>>2]=_,u[y>>2]=g,u[w>>2]=0,d=_,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[l>>2]=d-f,u[y>>2]=g-f,u[w>>2]=A-f)}function Co(l){switch(l=l|0,l|0){case 1:{l=5;break}case 5:{l=4;break}case 4:{l=6;break}case 6:{l=2;break}case 2:{l=3;break}case 3:{l=1;break}}return l|0}function Ps(l){switch(l=l|0,l|0){case 1:{l=3;break}case 3:{l=2;break}case 2:{l=6;break}case 6:{l=4;break}case 4:{l=5;break}case 5:{l=1;break}}return l|0}function jv(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;A=u[l>>2]|0,y=l+4|0,f=u[y>>2]|0,w=l+8|0,d=u[w>>2]|0,g=f+(A<<1)|0,u[l>>2]=g,f=d+(f<<1)|0,u[y>>2]=f,A=(d<<1)+A|0,u[w>>2]=A,d=f-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=d,u[w>>2]=A,u[l>>2]=0,f=d,d=0):d=g,(f|0)<0&&(d=d-f|0,u[l>>2]=d,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),_=d-A|0,g=f-A|0,(A|0)<0?(u[l>>2]=_,u[y>>2]=g,u[w>>2]=0,d=_,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[l>>2]=d-f,u[y>>2]=g-f,u[w>>2]=A-f)}function Wv(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;g=u[l>>2]|0,y=l+4|0,A=u[y>>2]|0,w=l+8|0,f=u[w>>2]|0,d=(A<<1)+g|0,g=f+(g<<1)|0,u[l>>2]=g,u[y>>2]=d,A=(f<<1)+A|0,u[w>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=f,u[w>>2]=A,u[l>>2]=0,g=0):f=d,(f|0)<0&&(g=g-f|0,u[l>>2]=g,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),_=g-A|0,d=f-A|0,(A|0)<0?(u[l>>2]=_,u[y>>2]=d,u[w>>2]=0,g=_,A=0):d=f,f=(d|0)<(g|0)?d:g,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[l>>2]=g-f,u[y>>2]=d-f,u[w>>2]=A-f)}function ip(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0;return y=(u[l>>2]|0)-(u[A>>2]|0)|0,w=(y|0)<0,d=(u[l+4>>2]|0)-(u[A+4>>2]|0)-(w?y:0)|0,_=(d|0)<0,g=(w?0-y|0:0)+(u[l+8>>2]|0)-(u[A+8>>2]|0)+(_?0-d|0:0)|0,l=(g|0)<0,A=l?0:g,f=(_?0:d)-(l?g:0)|0,g=(w?0:y)-(_?d:0)-(l?g:0)|0,l=(f|0)<(g|0)?f:g,l=(A|0)<(l|0)?A:l,d=(l|0)>0,A=A-(d?l:0)|0,f=f-(d?l:0)|0,l=g-(d?l:0)|0,l=(l|0)>-1?l:0-l|0,f=(f|0)>-1?f:0-f|0,A=(A|0)>-1?A:0-A|0,A=(f|0)>(A|0)?f:A,((l|0)>(A|0)?l:A)|0}function yL(l,A){l=l|0,A=A|0;var f=0;f=u[l+8>>2]|0,u[A>>2]=(u[l>>2]|0)-f,u[A+4>>2]=(u[l+4>>2]|0)-f}function _L(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0;d=u[l>>2]|0,u[A>>2]=d,l=u[l+4>>2]|0,y=A+4|0,u[y>>2]=l,w=A+8|0,u[w>>2]=0,f=l-d|0,(d|0)<0?(l=0-d|0,u[y>>2]=f,u[w>>2]=l,u[A>>2]=0,d=0):(f=l,l=0),(f|0)<0&&(d=d-f|0,u[A>>2]=d,l=l-f|0,u[w>>2]=l,u[y>>2]=0,f=0),_=d-l|0,g=f-l|0,(l|0)<0?(u[A>>2]=_,u[y>>2]=g,u[w>>2]=0,f=g,g=_,l=0):g=d,d=(f|0)<(g|0)?f:g,d=(l|0)<(d|0)?l:d,!((d|0)<=0)&&(u[A>>2]=g-d,u[y>>2]=f-d,u[w>>2]=l-d)}function Qv(l){l=l|0;var A=0,f=0,d=0,g=0;A=l+8|0,g=u[A>>2]|0,f=g-(u[l>>2]|0)|0,u[l>>2]=f,d=l+4|0,l=(u[d>>2]|0)-g|0,u[d>>2]=l,u[A>>2]=0-(l+f)}function vL(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;f=u[l>>2]|0,A=0-f|0,u[l>>2]=A,y=l+8|0,u[y>>2]=0,w=l+4|0,d=u[w>>2]|0,g=d+f|0,(f|0)>0?(u[w>>2]=g,u[y>>2]=f,u[l>>2]=0,A=0,d=g):f=0,(d|0)<0?(_=A-d|0,u[l>>2]=_,f=f-d|0,u[y>>2]=f,u[w>>2]=0,g=_-f|0,A=0-f|0,(f|0)<0?(u[l>>2]=g,u[w>>2]=A,u[y>>2]=0,d=A,f=0):(d=0,g=_)):g=A,A=(d|0)<(g|0)?d:g,A=(f|0)<(A|0)?f:A,!((A|0)<=0)&&(u[l>>2]=g-A,u[w>>2]=d-A,u[y>>2]=f-A)}function EL(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0;d=U,U=U+16|0,g=d,wL(l,A,f,g),mL(g,f+4|0),U=d}function wL(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0,w=0,C=0;if(C=U,U=U+32|0,_=C,wR(l,_),u[f>>2]=0,g=+fn(15888,_),y=+fn(15912,_),y<g&&(u[f>>2]=1,g=y),y=+fn(15936,_),y<g&&(u[f>>2]=2,g=y),y=+fn(15960,_),y<g&&(u[f>>2]=3,g=y),y=+fn(15984,_),y<g&&(u[f>>2]=4,g=y),y=+fn(16008,_),y<g&&(u[f>>2]=5,g=y),y=+fn(16032,_),y<g&&(u[f>>2]=6,g=y),y=+fn(16056,_),y<g&&(u[f>>2]=7,g=y),y=+fn(16080,_),y<g&&(u[f>>2]=8,g=y),y=+fn(16104,_),y<g&&(u[f>>2]=9,g=y),y=+fn(16128,_),y<g&&(u[f>>2]=10,g=y),y=+fn(16152,_),y<g&&(u[f>>2]=11,g=y),y=+fn(16176,_),y<g&&(u[f>>2]=12,g=y),y=+fn(16200,_),y<g&&(u[f>>2]=13,g=y),y=+fn(16224,_),y<g&&(u[f>>2]=14,g=y),y=+fn(16248,_),y<g&&(u[f>>2]=15,g=y),y=+fn(16272,_),y<g&&(u[f>>2]=16,g=y),y=+fn(16296,_),y<g&&(u[f>>2]=17,g=y),y=+fn(16320,_),y<g&&(u[f>>2]=18,g=y),y=+fn(16344,_),y<g&&(u[f>>2]=19,g=y),y=+Di(+(1-g*.5)),y<1e-16){u[d>>2]=0,u[d+4>>2]=0,u[d+8>>2]=0,u[d+12>>2]=0,U=C;return}if(f=u[f>>2]|0,g=+G[16368+(f*24|0)>>3],g=+pc(g-+pc(+SL(15568+(f<<4)|0,l))),Jr(A)|0?w=+pc(g+-.3334731722518321):w=g,g=+on(+y)/.381966011250105,(A|0)>0){_=0;do g=g*2.6457513110645907,_=_+1|0;while((_|0)!=(A|0))}y=+ut(+w)*g,G[d>>3]=y,w=+st(+w)*g,G[d+8>>3]=w,U=C}function dc(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0;if(_=+ER(l),_<1e-16){A=15568+(A<<4)|0,u[g>>2]=u[A>>2],u[g+4>>2]=u[A+4>>2],u[g+8>>2]=u[A+8>>2],u[g+12>>2]=u[A+12>>2];return}if(y=+jt(+ +G[l+8>>3],+ +G[l>>3]),(f|0)>0){l=0;do _=_/2.6457513110645907,l=l+1|0;while((l|0)!=(f|0))}d?(_=_/3,f=(Jr(f)|0)==0,_=+Ss(+((f?_:_/2.6457513110645907)*.381966011250105))):(_=+Ss(+(_*.381966011250105)),Jr(f)|0&&(y=+pc(y+.3334731722518321))),PL(15568+(A<<4)|0,+pc(+G[16368+(A*24|0)>>3]-y),_,g)}function TL(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0;d=U,U=U+16|0,g=d,bo(l+4|0,g),dc(g,u[l>>2]|0,A,0,f),U=d}function $v(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0,It=0,pt=0,Ot=0,Ft=0,He=0;if(Ot=U,U=U+272|0,_=Ot+256|0,te=Ot+240|0,yt=Ot,It=Ot+224|0,pt=Ot+208|0,Ae=Ot+176|0,$=Ot+160|0,be=Ot+192|0,Ie=Ot+144|0,ye=Ot+128|0,Ee=Ot+112|0,Qe=Ot+96|0,bt=Ot+80|0,u[_>>2]=A,u[te>>2]=u[l>>2],u[te+4>>2]=u[l+4>>2],u[te+8>>2]=u[l+8>>2],u[te+12>>2]=u[l+12>>2],Xv(te,_,yt),u[g>>2]=0,te=d+f+((d|0)==5&1)|0,(te|0)<=(f|0)){U=Ot;return}C=u[_>>2]|0,B=It+4|0,L=Ae+4|0,V=f+5|0,W=16848+(C<<2)|0,Y=16928+(C<<2)|0,re=ye+8|0,ie=Ee+8|0,de=Qe+8|0,Te=pt+4|0,w=f;e:for(;;){y=yt+(((w|0)%5|0)<<4)|0,u[pt>>2]=u[y>>2],u[pt+4>>2]=u[y+4>>2],u[pt+8>>2]=u[y+8>>2],u[pt+12>>2]=u[y+12>>2];do;while((Ta(pt,C,0,1)|0)==2);if((w|0)>(f|0)&(Jr(A)|0)!=0){if(u[Ae>>2]=u[pt>>2],u[Ae+4>>2]=u[pt+4>>2],u[Ae+8>>2]=u[pt+8>>2],u[Ae+12>>2]=u[pt+12>>2],bo(B,$),d=u[Ae>>2]|0,_=u[17008+(d*80|0)+(u[It>>2]<<2)>>2]|0,u[Ae>>2]=u[18608+(d*80|0)+(_*20|0)>>2],y=u[18608+(d*80|0)+(_*20|0)+16>>2]|0,(y|0)>0){l=0;do Hv(L),l=l+1|0;while((l|0)<(y|0))}switch(y=18608+(d*80|0)+(_*20|0)+4|0,u[be>>2]=u[y>>2],u[be+4>>2]=u[y+4>>2],u[be+8>>2]=u[y+8>>2],Gv(be,(u[W>>2]|0)*3|0),or(L,be,L),Wn(L),bo(L,Ie),Ft=+(u[Y>>2]|0),G[ye>>3]=Ft*3,G[re>>3]=0,He=Ft*-1.5,G[Ee>>3]=He,G[ie>>3]=Ft*2.598076211353316,G[Qe>>3]=He,G[de>>3]=Ft*-2.598076211353316,u[17008+((u[Ae>>2]|0)*80|0)+(u[pt>>2]<<2)>>2]|0){case 1:{l=Ee,d=ye;break}case 3:{l=Qe,d=Ee;break}case 2:{l=ye,d=Qe;break}default:{l=12;break e}}o2($,Ie,d,l,bt),dc(bt,u[Ae>>2]|0,C,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1}if((w|0)<(V|0)&&(bo(Te,Ae),dc(Ae,u[pt>>2]|0,C,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1),u[It>>2]=u[pt>>2],u[It+4>>2]=u[pt+4>>2],u[It+8>>2]=u[pt+8>>2],u[It+12>>2]=u[pt+12>>2],w=w+1|0,(w|0)>=(te|0)){l=3;break}}if((l|0)==3){U=Ot;return}else(l|0)==12&&dt(22474,22521,581,22531)}function Xv(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0;C=U,U=U+128|0,d=C+64|0,g=C,_=d,y=20208,w=_+60|0;do u[_>>2]=u[y>>2],_=_+4|0,y=y+4|0;while((_|0)<(w|0));_=g,y=20272,w=_+60|0;do u[_>>2]=u[y>>2],_=_+4|0,y=y+4|0;while((_|0)<(w|0));w=(Jr(u[A>>2]|0)|0)==0,d=w?d:g,g=l+4|0,jv(g),Wv(g),Jr(u[A>>2]|0)|0&&(xo(g),u[A>>2]=(u[A>>2]|0)+1),u[f>>2]=u[l>>2],A=f+4|0,or(g,d,A),Wn(A),u[f+16>>2]=u[l>>2],A=f+20|0,or(g,d+12|0,A),Wn(A),u[f+32>>2]=u[l>>2],A=f+36|0,or(g,d+24|0,A),Wn(A),u[f+48>>2]=u[l>>2],A=f+52|0,or(g,d+36|0,A),Wn(A),u[f+64>>2]=u[l>>2],f=f+68|0,or(g,d+48|0,f),Wn(f),U=C}function Ta(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0;if(re=U,U=U+32|0,W=re+12|0,w=re,Y=l+4|0,V=u[16928+(A<<2)>>2]|0,L=(d|0)!=0,V=L?V*3|0:V,g=u[Y>>2]|0,B=l+8|0,y=u[B>>2]|0,L){if(_=l+12|0,d=u[_>>2]|0,g=y+g+d|0,(g|0)==(V|0))return Y=1,U=re,Y|0;C=_}else C=l+12|0,d=u[C>>2]|0,g=y+g+d|0;if((g|0)<=(V|0))return Y=0,U=re,Y|0;do if((d|0)>0){if(d=u[l>>2]|0,(y|0)>0){_=18608+(d*80|0)+60|0,d=l;break}d=18608+(d*80|0)+40|0,f?(gL(W,V,0,0),np(Y,W,w),Qu(w),or(w,W,Y),_=d,d=l):(_=d,d=l)}else _=18608+((u[l>>2]|0)*80|0)+20|0,d=l;while(0);if(u[d>>2]=u[_>>2],g=_+16|0,(u[g>>2]|0)>0){d=0;do Hv(Y),d=d+1|0;while((d|0)<(u[g>>2]|0))}return l=_+4|0,u[W>>2]=u[l>>2],u[W+4>>2]=u[l+4>>2],u[W+8>>2]=u[l+8>>2],A=u[16848+(A<<2)>>2]|0,Gv(W,L?A*3|0:A),or(Y,W,Y),Wn(Y),L?d=((u[B>>2]|0)+(u[Y>>2]|0)+(u[C>>2]|0)|0)==(V|0)?1:2:d=2,Y=d,U=re,Y|0}function bL(l,A){l=l|0,A=A|0;var f=0;do f=Ta(l,A,0,1)|0;while((f|0)==2);return f|0}function Yv(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0;if(Qe=U,U=U+240|0,_=Qe+224|0,be=Qe+208|0,Ie=Qe,ye=Qe+192|0,Ee=Qe+176|0,de=Qe+160|0,Te=Qe+144|0,te=Qe+128|0,Ae=Qe+112|0,$=Qe+96|0,u[_>>2]=A,u[be>>2]=u[l>>2],u[be+4>>2]=u[l+4>>2],u[be+8>>2]=u[l+8>>2],u[be+12>>2]=u[l+12>>2],Jv(be,_,Ie),u[g>>2]=0,ie=d+f+((d|0)==6&1)|0,(ie|0)<=(f|0)){U=Qe;return}C=u[_>>2]|0,B=f+6|0,L=16928+(C<<2)|0,V=Te+8|0,W=te+8|0,Y=Ae+8|0,re=ye+4|0,y=0,w=f,d=-1;e:for(;;){if(_=(w|0)%6|0,l=Ie+(_<<4)|0,u[ye>>2]=u[l>>2],u[ye+4>>2]=u[l+4>>2],u[ye+8>>2]=u[l+8>>2],u[ye+12>>2]=u[l+12>>2],l=y,y=Ta(ye,C,0,1)|0,(w|0)>(f|0)&(Jr(A)|0)!=0&&(l|0)!=1&&(u[ye>>2]|0)!=(d|0)){switch(bo(Ie+(((_+5|0)%6|0)<<4)+4|0,Ee),bo(Ie+(_<<4)+4|0,de),bt=+(u[L>>2]|0),G[Te>>3]=bt*3,G[V>>3]=0,yt=bt*-1.5,G[te>>3]=yt,G[W>>3]=bt*2.598076211353316,G[Ae>>3]=yt,G[Y>>3]=bt*-2.598076211353316,_=u[be>>2]|0,u[17008+(_*80|0)+(((d|0)==(_|0)?u[ye>>2]|0:d)<<2)>>2]|0){case 1:{l=te,d=Te;break}case 3:{l=Ae,d=te;break}case 2:{l=Te,d=Ae;break}default:{l=8;break e}}o2(Ee,de,d,l,$),!(a2(Ee,$)|0)&&!(a2(de,$)|0)&&(dc($,u[be>>2]|0,C,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1)}if((w|0)<(B|0)&&(bo(re,Ee),dc(Ee,u[ye>>2]|0,C,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1),w=w+1|0,(w|0)>=(ie|0)){l=3;break}else d=u[ye>>2]|0}if((l|0)==3){U=Qe;return}else(l|0)==8&&dt(22557,22521,746,22602)}function Jv(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0;C=U,U=U+160|0,d=C+80|0,g=C,_=d,y=20336,w=_+72|0;do u[_>>2]=u[y>>2],_=_+4|0,y=y+4|0;while((_|0)<(w|0));_=g,y=20416,w=_+72|0;do u[_>>2]=u[y>>2],_=_+4|0,y=y+4|0;while((_|0)<(w|0));w=(Jr(u[A>>2]|0)|0)==0,d=w?d:g,g=l+4|0,jv(g),Wv(g),Jr(u[A>>2]|0)|0&&(xo(g),u[A>>2]=(u[A>>2]|0)+1),u[f>>2]=u[l>>2],A=f+4|0,or(g,d,A),Wn(A),u[f+16>>2]=u[l>>2],A=f+20|0,or(g,d+12|0,A),Wn(A),u[f+32>>2]=u[l>>2],A=f+36|0,or(g,d+24|0,A),Wn(A),u[f+48>>2]=u[l>>2],A=f+52|0,or(g,d+36|0,A),Wn(A),u[f+64>>2]=u[l>>2],A=f+68|0,or(g,d+48|0,A),Wn(A),u[f+80>>2]=u[l>>2],f=f+84|0,or(g,d+60|0,f),Wn(f),U=C}function pc(l){l=+l;var A=0;return A=l<0?l+6.283185307179586:l,+(l>=6.283185307179586?A+-6.283185307179586:A)}function ba(l,A){return l=l|0,A=A|0,+Ze(+(+G[l>>3]-+G[A>>3]))<17453292519943298e-27?(A=+Ze(+(+G[l+8>>3]-+G[A+8>>3]))<17453292519943298e-27,A|0):(A=0,A|0)}function xL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0;return g=+G[A>>3],d=+G[l>>3],_=+st(+((g-d)*.5)),f=+st(+((+G[A+8>>3]-+G[l+8>>3])*.5)),f=_*_+f*(+ut(+g)*+ut(+d)*f),+(+jt(+ +tt(+f),+ +tt(+(1-f)))*2)}function gc(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0;return g=+G[A>>3],d=+G[l>>3],_=+st(+((g-d)*.5)),f=+st(+((+G[A+8>>3]-+G[l+8>>3])*.5)),f=_*_+f*(+ut(+g)*+ut(+d)*f),+(+jt(+ +tt(+f),+ +tt(+(1-f)))*2*6371.007180918475)}function CL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0;return g=+G[A>>3],d=+G[l>>3],_=+st(+((g-d)*.5)),f=+st(+((+G[A+8>>3]-+G[l+8>>3])*.5)),f=_*_+f*(+ut(+g)*+ut(+d)*f),+(+jt(+ +tt(+f),+ +tt(+(1-f)))*2*6371.007180918475*1e3)}function SL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0;return _=+G[A>>3],d=+ut(+_),g=+G[A+8>>3]-+G[l+8>>3],y=d*+st(+g),f=+G[l>>3],+ +jt(+y,+(+st(+_)*+ut(+f)-+ut(+g)*(d*+st(+f))))}function PL(l,A,f,d){l=l|0,A=+A,f=+f,d=d|0;var g=0,_=0,y=0,w=0;if(f<1e-16){u[d>>2]=u[l>>2],u[d+4>>2]=u[l+4>>2],u[d+8>>2]=u[l+8>>2],u[d+12>>2]=u[l+12>>2];return}_=A<0?A+6.283185307179586:A,_=A>=6.283185307179586?_+-6.283185307179586:_;do if(_<1e-16)A=+G[l>>3]+f,G[d>>3]=A,g=d;else{if(g=+Ze(+(_+-3.141592653589793))<1e-16,A=+G[l>>3],g){A=A-f,G[d>>3]=A,g=d;break}if(y=+ut(+f),f=+st(+f),A=y*+st(+A)+ +ut(+_)*(f*+ut(+A)),A=A>1?1:A,A=+ya(+(A<-1?-1:A)),G[d>>3]=A,+Ze(+(A+-1.5707963267948966))<1e-16){G[d>>3]=1.5707963267948966,G[d+8>>3]=0;return}if(+Ze(+(A+1.5707963267948966))<1e-16){G[d>>3]=-1.5707963267948966,G[d+8>>3]=0;return}if(w=+ut(+A),_=f*+st(+_)/w,f=+G[l>>3],A=(y-+st(+A)*+st(+f))/+ut(+f)/w,y=_>1?1:_,A=A>1?1:A,A=+G[l+8>>3]+ +jt(+(y<-1?-1:y),+(A<-1?-1:A)),A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);G[d+8>>3]=A;return}while(0);if(+Ze(+(A+-1.5707963267948966))<1e-16){G[g>>3]=1.5707963267948966,G[d+8>>3]=0;return}if(+Ze(+(A+1.5707963267948966))<1e-16){G[g>>3]=-1.5707963267948966,G[d+8>>3]=0;return}if(A=+G[l+8>>3],A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);G[d+8>>3]=A}function ML(l){return l=l|0,+ +G[20496+(l<<3)>>3]}function IL(l){return l=l|0,+ +G[20624+(l<<3)>>3]}function BL(l){return l=l|0,+ +G[20752+(l<<3)>>3]}function LL(l){return l=l|0,+ +G[20880+(l<<3)>>3]}function RL(l){l=l|0;var A=0;return A=21008+(l<<3)|0,l=u[A>>2]|0,De(u[A+4>>2]|0),l|0}function xa(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0;return W=+G[A>>3],L=+G[l>>3],C=+st(+((W-L)*.5)),_=+G[A+8>>3],B=+G[l+8>>3],y=+st(+((_-B)*.5)),w=+ut(+L),V=+ut(+W),y=C*C+y*(V*w*y),y=+jt(+ +tt(+y),+ +tt(+(1-y)))*2,C=+G[f>>3],W=+st(+((C-W)*.5)),d=+G[f+8>>3],_=+st(+((d-_)*.5)),g=+ut(+C),_=W*W+_*(V*g*_),_=+jt(+ +tt(+_),+ +tt(+(1-_)))*2,C=+st(+((L-C)*.5)),d=+st(+((B-d)*.5)),d=C*C+d*(w*g*d),d=+jt(+ +tt(+d),+ +tt(+(1-d)))*2,g=(y+_+d)*.5,+(+Ss(+ +tt(+(+on(+(g*.5))*+on(+((g-y)*.5))*+on(+((g-_)*.5))*+on(+((g-d)*.5)))))*4)}function OL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0;if(_=U,U=U+192|0,d=_+168|0,g=_,So(l,A,d),Po(l,A,g),A=u[g>>2]|0,(A|0)<=0)return f=0,U=_,+f;if(f=+xa(g+8|0,g+8+(((A|0)!=1&1)<<4)|0,d)+0,(A|0)==1)return U=_,+f;l=1;do y=l,l=l+1|0,f=f+ +xa(g+8+(y<<4)|0,g+8+(((l|0)%(A|0)|0)<<4)|0,d);while((l|0)<(A|0));return U=_,+f}function FL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0;if(_=U,U=U+192|0,d=_+168|0,g=_,So(l,A,d),Po(l,A,g),A=u[g>>2]|0,(A|0)>0){if(f=+xa(g+8|0,g+8+(((A|0)!=1&1)<<4)|0,d)+0,(A|0)!=1){l=1;do y=l,l=l+1|0,f=f+ +xa(g+8+(y<<4)|0,g+8+(((l|0)%(A|0)|0)<<4)|0,d);while((l|0)<(A|0))}}else f=0;return U=_,+(f*6371.007180918475*6371.007180918475)}function DL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0;if(_=U,U=U+192|0,d=_+168|0,g=_,So(l,A,d),Po(l,A,g),A=u[g>>2]|0,(A|0)>0){if(f=+xa(g+8|0,g+8+(((A|0)!=1&1)<<4)|0,d)+0,(A|0)!=1){l=1;do y=l,l=l+1|0,f=f+ +xa(g+8+(y<<4)|0,g+8+(((l|0)%(A|0)|0)<<4)|0,d);while((l|0)<(A|0))}}else f=0;return U=_,+(f*6371.007180918475*6371.007180918475*1e3*1e3)}function kL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0;if(y=U,U=U+176|0,_=y,$u(l,A,_),l=u[_>>2]|0,(l|0)<=1)return g=0,U=y,+g;A=l+-1|0,l=0,f=0,d=+G[_+8>>3],g=+G[_+16>>3];do l=l+1|0,C=d,d=+G[_+8+(l<<4)>>3],B=+st(+((d-C)*.5)),w=g,g=+G[_+8+(l<<4)+8>>3],w=+st(+((g-w)*.5)),w=B*B+w*(+ut(+d)*+ut(+C)*w),f=f+ +jt(+ +tt(+w),+ +tt(+(1-w)))*2;while((l|0)<(A|0));return U=y,+f}function NL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0;if(y=U,U=U+176|0,_=y,$u(l,A,_),l=u[_>>2]|0,(l|0)<=1)return g=0,U=y,+g;A=l+-1|0,l=0,f=0,d=+G[_+8>>3],g=+G[_+16>>3];do l=l+1|0,C=d,d=+G[_+8+(l<<4)>>3],B=+st(+((d-C)*.5)),w=g,g=+G[_+8+(l<<4)+8>>3],w=+st(+((g-w)*.5)),w=B*B+w*(+ut(+C)*+ut(+d)*w),f=f+ +jt(+ +tt(+w),+ +tt(+(1-w)))*2;while((l|0)!=(A|0));return B=f*6371.007180918475,U=y,+B}function UL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0;if(y=U,U=U+176|0,_=y,$u(l,A,_),l=u[_>>2]|0,(l|0)<=1)return g=0,U=y,+g;A=l+-1|0,l=0,f=0,d=+G[_+8>>3],g=+G[_+16>>3];do l=l+1|0,C=d,d=+G[_+8+(l<<4)>>3],B=+st(+((d-C)*.5)),w=g,g=+G[_+8+(l<<4)+8>>3],w=+st(+((g-w)*.5)),w=B*B+w*(+ut(+C)*+ut(+d)*w),f=f+ +jt(+ +tt(+w),+ +tt(+(1-w)))*2;while((l|0)!=(A|0));return B=f*6371.007180918475*1e3,U=y,+B}function zL(l,A){return l=l|0,A=A|0,A=he(l|0,A|0,52)|0,j()|0,A&15|0}function Kv(l,A){return l=l|0,A=A|0,A=he(l|0,A|0,45)|0,j()|0,A&127|0}function Zv(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0;if(!(!0&(A&-16777216|0)==134217728)||(y=he(l|0,A|0,45)|0,j()|0,y=y&127,y>>>0>121))return A=0,A|0;f=he(l|0,A|0,52)|0,j()|0,f=f&15;do if(f|0){for(g=1,d=0;;){if(_=he(l|0,A|0,(15-g|0)*3|0)|0,j()|0,_=_&7,(_|0)!=0&(d^1))if((_|0)==1&(Je(y)|0)!=0){w=0,d=13;break}else d=1;if((_|0)==7){w=0,d=13;break}if(g>>>0<f>>>0)g=g+1|0;else{d=9;break}}if((d|0)==9){if((f|0)==15)w=1;else break;return w|0}else if((d|0)==13)return w|0}while(0);for(;;){if(w=he(l|0,A|0,(14-f|0)*3|0)|0,j()|0,!((w&7|0)==7&!0)){w=0,d=13;break}if(f>>>0<14)f=f+1|0;else{w=1,d=13;break}}return(d|0)==13?w|0:0}function sp(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0;if(d=he(l|0,A|0,52)|0,j()|0,d=d&15,(d|0)>=(f|0)){if((d|0)!=(f|0))if(f>>>0<=15){if(g=we(f|0,0,52)|0,l=g|l,A=j()|0|A&-15728641,(d|0)>(f|0))do g=we(7,0,(14-f|0)*3|0)|0,f=f+1|0,l=g|l,A=j()|0|A;while((f|0)<(d|0))}else A=0,l=0}else A=0,l=0;return De(A|0),l|0}function VL(l,A,f){return l=l|0,A=A|0,f=f|0,l=he(l|0,A|0,52)|0,j()|0,l=l&15,(f|0)<16&(l|0)<=(f|0)?(f=Xu(7,f-l|0)|0,f|0):(f=0,f|0)}function hr(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0,w=0,C=0,B=0,L=0;if(y=he(l|0,A|0,52)|0,j()|0,y=y&15,!!((f|0)<16&(y|0)<=(f|0))){if((y|0)==(f|0)){f=d,u[f>>2]=l,u[f+4>>2]=A;return}if(C=Xu(7,f-y|0)|0,B=(C|0)/7|0,w=he(l|0,A|0,45)|0,j()|0,!(Je(w&127)|0))_=0;else{e:do if(!y)g=0;else for(_=1;;){if(g=he(l|0,A|0,(15-_|0)*3|0)|0,j()|0,g=g&7,g|0)break e;if(_>>>0<y>>>0)_=_+1|0;else{g=0;break}}while(0);_=(g|0)==0}if(L=we(y+1|0,0,52)|0,g=j()|0|A&-15728641,w=(14-y|0)*3|0,A=we(7,0,w|0)|0,A=(L|l)&~A,y=g&~(j()|0),hr(A,y,f,d),g=d+(B<<3)|0,!_){L=we(1,0,w|0)|0,hr(L|A,j()|0|y,f,g),L=g+(B<<3)|0,C=we(2,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(3,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(4,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(5,0,w|0)|0,hr(C|A,j()|0|y,f,L),C=we(6,0,w|0)|0,hr(C|A,j()|0|y,f,L+(B<<3)|0);return}_=g+(B<<3)|0,(C|0)>6&&(C=g+8|0,L=(_>>>0>C>>>0?_:C)+-1+(0-g)|0,mi(g|0,0,L+8&-8|0)|0,g=C+(L>>>3<<3)|0),L=we(2,0,w|0)|0,hr(L|A,j()|0|y,f,g),L=g+(B<<3)|0,C=we(3,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(4,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(5,0,w|0)|0,hr(C|A,j()|0|y,f,L),C=we(6,0,w|0)|0,hr(C|A,j()|0|y,f,L+(B<<3)|0)}}function vn(l,A){l=l|0,A=A|0;var f=0,d=0,g=0;if(g=he(l|0,A|0,45)|0,j()|0,!(Je(g&127)|0))return g=0,g|0;g=he(l|0,A|0,52)|0,j()|0,g=g&15;e:do if(!g)f=0;else for(d=1;;){if(f=he(l|0,A|0,(15-d|0)*3|0)|0,j()|0,f=f&7,f|0)break e;if(d>>>0<g>>>0)d=d+1|0;else{f=0;break}}while(0);return g=(f|0)==0&1,g|0}function HL(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0;if(d=he(l|0,A|0,52)|0,j()|0,d=d&15,(f|0)<16&(d|0)<=(f|0)){if((d|0)!=(f|0)&&(g=we(f|0,0,52)|0,l=g|l,A=j()|0|A&-15728641,(d|0)<(f|0)))do g=we(7,0,(14-d|0)*3|0)|0,d=d+1|0,l=l&~g,A=A&~(j()|0);while((d|0)<(f|0))}else A=0,l=0;return De(A|0),l|0}function jL(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0;if(!f)return ye=0,ye|0;if(g=l,d=u[g>>2]|0,g=u[g+4>>2]|0,!0&(g&15728640|0)==0){if((f|0)<=0||(ye=A,u[ye>>2]=d,u[ye+4>>2]=g,(f|0)==1))return ye=0,ye|0;d=1;do be=l+(d<<3)|0,Ie=u[be+4>>2]|0,ye=A+(d<<3)|0,u[ye>>2]=u[be>>2],u[ye+4>>2]=Ie,d=d+1|0;while((d|0)!=(f|0));return d=0,d|0}if(be=f<<3,Ie=ki(be)|0,!Ie)return ye=-3,ye|0;if(Ku(Ie|0,l|0,be|0)|0,$=gi(f,8)|0,!$)return Ke(Ie),ye=-3,ye|0;d=f;e:for(;;){y=Ie,L=u[y>>2]|0,y=u[y+4>>2]|0,te=he(L|0,y|0,52)|0,j()|0,te=te&15,Ae=te+-1|0,Te=(d|0)>0;t:do if(Te){if(de=((d|0)<0)<<31>>31,re=we(Ae|0,0,52)|0,ie=j()|0,Ae>>>0>15)for(g=0,l=L,f=y;;){if(!((l|0)==0&(f|0)==0)){if(_=he(l|0,f|0,52)|0,j()|0,_=_&15,w=(_|0)<(Ae|0),_=(_|0)==(Ae|0),B=w?0:_?l:0,l=w?0:_?f:0,f=Is(B|0,l|0,d|0,de|0)|0,j()|0,_=$+(f<<3)|0,w=_,C=u[w>>2]|0,w=u[w+4>>2]|0,(C|0)==0&(w|0)==0)f=B;else for(re=0,Y=f,W=w,f=B;;){if((re|0)>(d|0)){ye=41;break e}if((C|0)==(f|0)&(W&-117440513|0)==(l|0)){B=he(C|0,W|0,56)|0,j()|0,B=B&7,V=B+1|0,ie=he(C|0,W|0,45)|0,j()|0;n:do if(!(Je(ie&127)|0))w=7;else{if(C=he(C|0,W|0,52)|0,j()|0,C=C&15,!C){w=6;break}for(w=1;;){if(ie=we(7,0,(15-w|0)*3|0)|0,!((ie&f|0)==0&((j()|0)&l|0)==0)){w=7;break n}if(w>>>0<C>>>0)w=w+1|0;else{w=6;break}}}while(0);if((B+2|0)>>>0>w>>>0){ye=51;break e}ie=we(V|0,0,56)|0,l=j()|0|l&-117440513,w=_,u[w>>2]=0,u[w+4>>2]=0,w=Y,f=ie|f}else w=(Y+1|0)%(d|0)|0;if(_=$+(w<<3)|0,W=_,C=u[W>>2]|0,W=u[W+4>>2]|0,(C|0)==0&(W|0)==0)break;re=re+1|0,Y=w}ie=_,u[ie>>2]=f,u[ie+4>>2]=l}if(g=g+1|0,(g|0)>=(d|0))break t;f=Ie+(g<<3)|0,l=u[f>>2]|0,f=u[f+4>>2]|0}for(g=0,l=L,f=y;;){if(!((l|0)==0&(f|0)==0)){if(w=he(l|0,f|0,52)|0,j()|0,w=w&15,(w|0)>=(Ae|0)){if((w|0)!=(Ae|0)&&(l=l|re,f=f&-15728641|ie,w>>>0>=te>>>0)){_=Ae;do Y=we(7,0,(14-_|0)*3|0)|0,_=_+1|0,l=Y|l,f=j()|0|f;while(_>>>0<w>>>0)}}else l=0,f=0;if(w=Is(l|0,f|0,d|0,de|0)|0,j()|0,_=$+(w<<3)|0,C=_,B=u[C>>2]|0,C=u[C+4>>2]|0,!((B|0)==0&(C|0)==0))for(Y=0;;){if((Y|0)>(d|0)){ye=41;break e}if((B|0)==(l|0)&(C&-117440513|0)==(f|0)){V=he(B|0,C|0,56)|0,j()|0,V=V&7,W=V+1|0,Ee=he(B|0,C|0,45)|0,j()|0;n:do if(!(Je(Ee&127)|0))C=7;else{if(B=he(B|0,C|0,52)|0,j()|0,B=B&15,!B){C=6;break}for(C=1;;){if(Ee=we(7,0,(15-C|0)*3|0)|0,!((Ee&l|0)==0&((j()|0)&f|0)==0)){C=7;break n}if(C>>>0<B>>>0)C=C+1|0;else{C=6;break}}}while(0);if((V+2|0)>>>0>C>>>0){ye=51;break e}Ee=we(W|0,0,56)|0,f=j()|0|f&-117440513,W=_,u[W>>2]=0,u[W+4>>2]=0,l=Ee|l}else w=(w+1|0)%(d|0)|0;if(_=$+(w<<3)|0,C=_,B=u[C>>2]|0,C=u[C+4>>2]|0,(B|0)==0&(C|0)==0)break;Y=Y+1|0}Ee=_,u[Ee>>2]=l,u[Ee+4>>2]=f}if(g=g+1|0,(g|0)>=(d|0))break t;f=Ie+(g<<3)|0,l=u[f>>2]|0,f=u[f+4>>2]|0}}while(0);if((d+5|0)>>>0<11){ye=99;break}if(ie=gi((d|0)/6|0,8)|0,!ie){ye=58;break}t:do if(Te){Y=0,W=0;do{if(w=$+(Y<<3)|0,l=w,g=u[l>>2]|0,l=u[l+4>>2]|0,!((g|0)==0&(l|0)==0)){C=he(g|0,l|0,56)|0,j()|0,C=C&7,f=C+1|0,B=l&-117440513,Ee=he(g|0,l|0,45)|0,j()|0;n:do if(Je(Ee&127)|0){if(V=he(g|0,l|0,52)|0,j()|0,V=V&15,V|0)for(_=1;;){if(Ee=we(7,0,(15-_|0)*3|0)|0,!((g&Ee|0)==0&(B&(j()|0)|0)==0))break n;if(_>>>0<V>>>0)_=_+1|0;else break}l=we(f|0,0,56)|0,g=l|g,l=j()|0|B,f=w,u[f>>2]=g,u[f+4>>2]=l,f=C+2|0}while(0);(f|0)==7&&(Ee=ie+(W<<3)|0,u[Ee>>2]=g,u[Ee+4>>2]=l&-117440513,W=W+1|0)}Y=Y+1|0}while((Y|0)!=(d|0));if(Te){if(re=((d|0)<0)<<31>>31,V=we(Ae|0,0,52)|0,Y=j()|0,Ae>>>0>15)for(l=0,g=0;;){do if(!((L|0)==0&(y|0)==0)){for(C=he(L|0,y|0,52)|0,j()|0,C=C&15,_=(C|0)<(Ae|0),C=(C|0)==(Ae|0),w=_?0:C?L:0,C=_?0:C?y:0,_=Is(w|0,C|0,d|0,re|0)|0,j()|0,f=0;;){if((f|0)>(d|0)){ye=98;break e}if(Ee=$+(_<<3)|0,B=u[Ee+4>>2]|0,(B&-117440513|0)==(C|0)&&(u[Ee>>2]|0)==(w|0)){ye=70;break}if(_=(_+1|0)%(d|0)|0,Ee=$+(_<<3)|0,(u[Ee>>2]|0)==(w|0)&&(u[Ee+4>>2]|0)==(C|0))break;f=f+1|0}if((ye|0)==70&&(ye=0,!0&(B&117440512|0)==100663296))break;Ee=A+(g<<3)|0,u[Ee>>2]=L,u[Ee+4>>2]=y,g=g+1|0}while(0);if(l=l+1|0,(l|0)>=(d|0)){d=W;break t}y=Ie+(l<<3)|0,L=u[y>>2]|0,y=u[y+4>>2]|0}for(l=0,g=0;;){do if(!((L|0)==0&(y|0)==0)){if(C=he(L|0,y|0,52)|0,j()|0,C=C&15,(C|0)>=(Ae|0))if((C|0)!=(Ae|0))if(f=L|V,_=y&-15728641|Y,C>>>0<te>>>0)C=_;else{w=Ae;do Ee=we(7,0,(14-w|0)*3|0)|0,w=w+1|0,f=Ee|f,_=j()|0|_;while(w>>>0<C>>>0);C=_}else f=L,C=y;else f=0,C=0;for(w=Is(f|0,C|0,d|0,re|0)|0,j()|0,_=0;;){if((_|0)>(d|0)){ye=98;break e}if(Ee=$+(w<<3)|0,B=u[Ee+4>>2]|0,(B&-117440513|0)==(C|0)&&(u[Ee>>2]|0)==(f|0)){ye=93;break}if(w=(w+1|0)%(d|0)|0,Ee=$+(w<<3)|0,(u[Ee>>2]|0)==(f|0)&&(u[Ee+4>>2]|0)==(C|0))break;_=_+1|0}if((ye|0)==93&&(ye=0,!0&(B&117440512|0)==100663296))break;Ee=A+(g<<3)|0,u[Ee>>2]=L,u[Ee+4>>2]=y,g=g+1|0}while(0);if(l=l+1|0,(l|0)>=(d|0)){d=W;break t}y=Ie+(l<<3)|0,L=u[y>>2]|0,y=u[y+4>>2]|0}}else g=0,d=W}else g=0,d=0;while(0);if(mi($|0,0,be|0)|0,Ku(Ie|0,ie|0,d<<3|0)|0,Ke(ie),d)A=A+(g<<3)|0;else break}return(ye|0)==41?(Ke(Ie),Ke($),Ee=-1,Ee|0):(ye|0)==51?(Ke(Ie),Ke($),Ee=-2,Ee|0):(ye|0)==58?(Ke(Ie),Ke($),Ee=-3,Ee|0):(ye|0)==98?(Ke(ie),Ke(Ie),Ke($),Ee=-1,Ee|0):((ye|0)==99&&Ku(A|0,Ie|0,d<<3|0)|0,Ke(Ie),Ke($),Ee=0,Ee|0)}function WL(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0,w=0,C=0,B=0,L=0;if((A|0)<=0)return g=0,g|0;if((g|0)>=16){for(_=0;;){if(L=l+(_<<3)|0,!((u[L>>2]|0)==0&(u[L+4>>2]|0)==0)){_=14;break}if(_=_+1|0,(_|0)>=(A|0)){y=0,_=16;break}}if((_|0)==14)return((d|0)>0?-2:-1)|0;if((_|0)==16)return y|0}_=0,L=0;e:for(;;){B=l+(L<<3)|0,w=B,y=u[w>>2]|0,w=u[w+4>>2]|0;do if(!((y|0)==0&(w|0)==0)){if((_|0)>=(d|0)){y=-1,_=16;break e}if(C=he(y|0,w|0,52)|0,j()|0,C=C&15,(C|0)>(g|0)){y=-2,_=16;break e}if((C|0)==(g|0)){B=f+(_<<3)|0,u[B>>2]=y,u[B+4>>2]=w,_=_+1|0;break}if(y=(Xu(7,g-C|0)|0)+_|0,(y|0)>(d|0)){y=-1,_=16;break e}hr(u[B>>2]|0,u[B+4>>2]|0,g,f+(_<<3)|0),_=y}while(0);if(L=L+1|0,(L|0)>=(A|0)){y=0,_=16;break}}return(_|0)==16?y|0:0}function QL(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0;if((A|0)<=0)return f=0,f|0;if((f|0)>=16){for(d=0;;){if(y=l+(d<<3)|0,!((u[y>>2]|0)==0&(u[y+4>>2]|0)==0)){d=-1,g=13;break}if(d=d+1|0,(d|0)>=(A|0)){d=0,g=13;break}}if((g|0)==13)return d|0}d=0,y=0;e:for(;;){g=l+(y<<3)|0,_=u[g>>2]|0,g=u[g+4>>2]|0;do if(!((_|0)==0&(g|0)==0)){if(g=he(_|0,g|0,52)|0,j()|0,g=g&15,(g|0)>(f|0)){d=-1,g=13;break e}if((g|0)==(f|0)){d=d+1|0;break}else{d=(Xu(7,f-g|0)|0)+d|0;break}}while(0);if(y=y+1|0,(y|0)>=(A|0)){g=13;break}}return(g|0)==13?d|0:0}function $L(l,A){return l=l|0,A=A|0,A=he(l|0,A|0,52)|0,j()|0,A&1|0}function dr(l,A){l=l|0,A=A|0;var f=0,d=0,g=0;if(g=he(l|0,A|0,52)|0,j()|0,g=g&15,!g)return g=0,g|0;for(d=1;;){if(f=he(l|0,A|0,(15-d|0)*3|0)|0,j()|0,f=f&7,f|0){d=5;break}if(d>>>0<g>>>0)d=d+1|0;else{f=0,d=5;break}}return(d|0)==5?f|0:0}function op(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0;if(C=he(l|0,A|0,52)|0,j()|0,C=C&15,!C)return w=A,C=l,De(w|0),C|0;for(w=1,f=0;;){_=(15-w|0)*3|0,d=we(7,0,_|0)|0,g=j()|0,y=he(l|0,A|0,_|0)|0,j()|0,_=we(Co(y&7)|0,0,_|0)|0,y=j()|0,l=_|l&~d,A=y|A&~g;e:do if(!f)if((_&d|0)==0&(y&g|0)==0)f=0;else if(d=he(l|0,A|0,52)|0,j()|0,d=d&15,!d)f=1;else{f=1;t:for(;;){switch(y=he(l|0,A|0,(15-f|0)*3|0)|0,j()|0,y&7){case 1:break t;case 0:break;default:{f=1;break e}}if(f>>>0<d>>>0)f=f+1|0;else{f=1;break e}}for(f=1;;)if(y=(15-f|0)*3|0,g=he(l|0,A|0,y|0)|0,j()|0,_=we(7,0,y|0)|0,A=A&~(j()|0),y=we(Co(g&7)|0,0,y|0)|0,l=l&~_|y,A=A|(j()|0),f>>>0<d>>>0)f=f+1|0;else{f=1;break}}while(0);if(w>>>0<C>>>0)w=w+1|0;else break}return De(A|0),l|0}function Ms(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0;if(d=he(l|0,A|0,52)|0,j()|0,d=d&15,!d)return f=A,d=l,De(f|0),d|0;for(f=1;_=(15-f|0)*3|0,y=he(l|0,A|0,_|0)|0,j()|0,g=we(7,0,_|0)|0,A=A&~(j()|0),_=we(Co(y&7)|0,0,_|0)|0,l=_|l&~g,A=j()|0|A,f>>>0<d>>>0;)f=f+1|0;return De(A|0),l|0}function XL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0;if(C=he(l|0,A|0,52)|0,j()|0,C=C&15,!C)return w=A,C=l,De(w|0),C|0;for(w=1,f=0;;){_=(15-w|0)*3|0,d=we(7,0,_|0)|0,g=j()|0,y=he(l|0,A|0,_|0)|0,j()|0,_=we(Ps(y&7)|0,0,_|0)|0,y=j()|0,l=_|l&~d,A=y|A&~g;e:do if(!f)if((_&d|0)==0&(y&g|0)==0)f=0;else if(d=he(l|0,A|0,52)|0,j()|0,d=d&15,!d)f=1;else{f=1;t:for(;;){switch(y=he(l|0,A|0,(15-f|0)*3|0)|0,j()|0,y&7){case 1:break t;case 0:break;default:{f=1;break e}}if(f>>>0<d>>>0)f=f+1|0;else{f=1;break e}}for(f=1;;)if(g=(15-f|0)*3|0,_=we(7,0,g|0)|0,y=A&~(j()|0),A=he(l|0,A|0,g|0)|0,j()|0,A=we(Ps(A&7)|0,0,g|0)|0,l=l&~_|A,A=y|(j()|0),f>>>0<d>>>0)f=f+1|0;else{f=1;break}}while(0);if(w>>>0<C>>>0)w=w+1|0;else break}return De(A|0),l|0}function ap(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0;if(d=he(l|0,A|0,52)|0,j()|0,d=d&15,!d)return f=A,d=l,De(f|0),d|0;for(f=1;y=(15-f|0)*3|0,_=we(7,0,y|0)|0,g=A&~(j()|0),A=he(l|0,A|0,y|0)|0,j()|0,A=we(Ps(A&7)|0,0,y|0)|0,l=A|l&~_,A=j()|0|g,f>>>0<d>>>0;)f=f+1|0;return De(A|0),l|0}function YL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0;if(C=U,U=U+64|0,w=C+40|0,d=C+24|0,g=C+12|0,_=C,we(A|0,0,52)|0,f=j()|0|134225919,!A)return(u[l+4>>2]|0)>2||(u[l+8>>2]|0)>2||(u[l+12>>2]|0)>2?(y=0,w=0,De(y|0),U=C,w|0):(we(Sr(l)|0,0,45)|0,y=j()|0|f,w=-1,De(y|0),U=C,w|0);if(u[w>>2]=u[l>>2],u[w+4>>2]=u[l+4>>2],u[w+8>>2]=u[l+8>>2],u[w+12>>2]=u[l+12>>2],y=w+4|0,(A|0)>0)for(l=-1;u[d>>2]=u[y>>2],u[d+4>>2]=u[y+4>>2],u[d+8>>2]=u[y+8>>2],A&1?(zv(y),u[g>>2]=u[y>>2],u[g+4>>2]=u[y+4>>2],u[g+8>>2]=u[y+8>>2],Wu(g)):(rp(y),u[g>>2]=u[y>>2],u[g+4>>2]=u[y+4>>2],u[g+8>>2]=u[y+8>>2],xo(g)),np(d,g,_),Wn(_),L=(15-A|0)*3|0,B=we(7,0,L|0)|0,f=f&~(j()|0),L=we(ju(_)|0,0,L|0)|0,l=L|l&~B,f=j()|0|f,(A|0)>1;)A=A+-1|0;else l=-1;e:do if((u[y>>2]|0)<=2&&(u[w+8>>2]|0)<=2&&(u[w+12>>2]|0)<=2){if(d=Sr(w)|0,A=we(d|0,0,45)|0,A=A|l,l=j()|0|f&-1040385,_=AL(w)|0,!(Je(d)|0)){if((_|0)<=0)break;for(g=0;;){if(d=he(A|0,l|0,52)|0,j()|0,d=d&15,d)for(f=1;L=(15-f|0)*3|0,w=he(A|0,l|0,L|0)|0,j()|0,B=we(7,0,L|0)|0,l=l&~(j()|0),L=we(Co(w&7)|0,0,L|0)|0,A=A&~B|L,l=l|(j()|0),f>>>0<d>>>0;)f=f+1|0;if(g=g+1|0,(g|0)==(_|0))break e}}g=he(A|0,l|0,52)|0,j()|0,g=g&15;t:do if(g){f=1;n:for(;;){switch(L=he(A|0,l|0,(15-f|0)*3|0)|0,j()|0,L&7){case 1:break n;case 0:break;default:break t}if(f>>>0<g>>>0)f=f+1|0;else break t}if(kv(d,u[w>>2]|0)|0)for(f=1;w=(15-f|0)*3|0,B=we(7,0,w|0)|0,L=l&~(j()|0),l=he(A|0,l|0,w|0)|0,j()|0,l=we(Ps(l&7)|0,0,w|0)|0,A=A&~B|l,l=L|(j()|0),f>>>0<g>>>0;)f=f+1|0;else for(f=1;L=(15-f|0)*3|0,w=he(A|0,l|0,L|0)|0,j()|0,B=we(7,0,L|0)|0,l=l&~(j()|0),L=we(Co(w&7)|0,0,L|0)|0,A=A&~B|L,l=l|(j()|0),f>>>0<g>>>0;)f=f+1|0}while(0);if((_|0)>0){f=0;do A=op(A,l)|0,l=j()|0,f=f+1|0;while((f|0)!=(_|0))}}else A=0,l=0;while(0);return B=l,L=A,De(B|0),U=C,L|0}function Jr(l){return l=l|0,(l|0)%2|0|0}function qv(l,A){l=l|0,A=A|0;var f=0,d=0;return d=U,U=U+16|0,f=d,A>>>0<=15&&(u[l+4>>2]&2146435072|0)!=2146435072&&(u[l+8+4>>2]&2146435072|0)!=2146435072?(EL(l,A,f),A=YL(f,A)|0,l=j()|0):(l=0,A=0),De(l|0),U=d,A|0}function lp(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0;if(g=f+4|0,_=he(l|0,A|0,52)|0,j()|0,_=_&15,y=he(l|0,A|0,45)|0,j()|0,d=(_|0)==0,Je(y&127)|0){if(d)return y=1,y|0;d=1}else{if(d)return y=0,y|0;(u[g>>2]|0)==0&&(u[f+8>>2]|0)==0?d=(u[f+12>>2]|0)!=0&1:d=1}for(f=1;f&1?Wu(g):xo(g),y=he(l|0,A|0,(15-f|0)*3|0)|0,j()|0,Vv(g,y&7),f>>>0<_>>>0;)f=f+1|0;return d|0}function mc(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0;L=U,U=U+16|0,C=L,B=he(l|0,A|0,45)|0,j()|0,B=B&127;e:do if((Je(B)|0)!=0&&(_=he(l|0,A|0,52)|0,j()|0,_=_&15,(_|0)!=0)){d=1;t:for(;;){switch(w=he(l|0,A|0,(15-d|0)*3|0)|0,j()|0,w&7){case 5:break t;case 0:break;default:{d=A;break e}}if(d>>>0<_>>>0)d=d+1|0;else{d=A;break e}}for(g=1,d=A;A=(15-g|0)*3|0,y=we(7,0,A|0)|0,w=d&~(j()|0),d=he(l|0,d|0,A|0)|0,j()|0,d=we(Ps(d&7)|0,0,A|0)|0,l=l&~y|d,d=w|(j()|0),g>>>0<_>>>0;)g=g+1|0}else d=A;while(0);if(w=7728+(B*28|0)|0,u[f>>2]=u[w>>2],u[f+4>>2]=u[w+4>>2],u[f+8>>2]=u[w+8>>2],u[f+12>>2]=u[w+12>>2],!(lp(l,d,f)|0)){U=L;return}if(y=f+4|0,u[C>>2]=u[y>>2],u[C+4>>2]=u[y+4>>2],u[C+8>>2]=u[y+8>>2],_=he(l|0,d|0,52)|0,j()|0,w=_&15,_&1?(xo(y),_=w+1|0):_=w,!(Je(B)|0))d=0;else{e:do if(!w)d=0;else for(A=1;;){if(g=he(l|0,d|0,(15-A|0)*3|0)|0,j()|0,g=g&7,g|0){d=g;break e}if(A>>>0<w>>>0)A=A+1|0;else{d=0;break}}while(0);d=(d|0)==4&1}if(!(Ta(f,_,d,0)|0))(_|0)!=(w|0)&&(u[y>>2]=u[C>>2],u[y+4>>2]=u[C+4>>2],u[y+8>>2]=u[C+8>>2]);else{if(Je(B)|0)do;while((Ta(f,_,0,0)|0)!=0);(_|0)!=(w|0)&&rp(y)}U=L}function So(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0;d=U,U=U+16|0,g=d,mc(l,A,g),A=he(l|0,A|0,52)|0,j()|0,TL(g,A&15,f),U=d}function Po(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0;y=U,U=U+16|0,_=y,mc(l,A,_),d=he(l|0,A|0,45)|0,j()|0,d=(Je(d&127)|0)==0,g=he(l|0,A|0,52)|0,j()|0,g=g&15;e:do if(!d){if(g|0)for(d=1;;){if(w=we(7,0,(15-d|0)*3|0)|0,!((w&l|0)==0&((j()|0)&A|0)==0))break e;if(d>>>0<g>>>0)d=d+1|0;else break}$v(_,g,0,5,f),U=y;return}while(0);Yv(_,g,0,6,f),U=y}function JL(l,A){l=l|0,A=A|0;var f=0,d=0,g=0;if(d=he(l|0,A|0,45)|0,j()|0,!(Je(d&127)|0))return d=2,d|0;if(d=he(l|0,A|0,52)|0,j()|0,d=d&15,!d)return d=5,d|0;for(f=1;;){if(g=we(7,0,(15-f|0)*3|0)|0,!((g&l|0)==0&((j()|0)&A|0)==0)){f=2,l=6;break}if(f>>>0<d>>>0)f=f+1|0;else{f=5,l=6;break}}return(l|0)==6?f|0:0}function e2(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0;V=U,U=U+128|0,B=V+112|0,_=V+96|0,L=V,g=he(l|0,A|0,52)|0,j()|0,w=g&15,u[B>>2]=w,y=he(l|0,A|0,45)|0,j()|0,y=y&127;e:do if(Je(y)|0){if(w|0)for(d=1;;){if(C=we(7,0,(15-d|0)*3|0)|0,!((C&l|0)==0&((j()|0)&A|0)==0)){g=0;break e}if(d>>>0<w>>>0)d=d+1|0;else break}if(g&1)g=1;else{C=we(w+1|0,0,52)|0,L=j()|0|A&-15728641,B=we(7,0,(14-w|0)*3|0)|0,e2((C|l)&~B,L&~(j()|0),f),U=V;return}}else g=0;while(0);mc(l,A,_),g?(Xv(_,B,L),C=5):(Jv(_,B,L),C=6);e:do if(Je(y)|0)if(!w)d=20;else for(d=1;;){if(y=we(7,0,(15-d|0)*3|0)|0,!((y&l|0)==0&((j()|0)&A|0)==0)){d=8;break e}if(d>>>0<w>>>0)d=d+1|0;else{d=20;break}}else d=8;while(0);if(mi(f|0,-1,d|0)|0,g){g=0;do{for(_=L+(g<<4)|0,bL(_,u[B>>2]|0)|0,_=u[_>>2]|0,d=0;y=f+(d<<2)|0,w=u[y>>2]|0,!((w|0)==-1|(w|0)==(_|0));)d=d+1|0;u[y>>2]=_,g=g+1|0}while((g|0)!=(C|0))}else{g=0;do{for(_=L+(g<<4)|0,Ta(_,u[B>>2]|0,0,1)|0,_=u[_>>2]|0,d=0;y=f+(d<<2)|0,w=u[y>>2]|0,!((w|0)==-1|(w|0)==(_|0));)d=d+1|0;u[y>>2]=_,g=g+1|0}while((g|0)!=(C|0))}U=V}function KL(){return 12}function cp(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0;if(we(l|0,0,52)|0,w=j()|0|134225919,(l|0)<1){d=0,f=0;do Je(d)|0&&(we(d|0,0,45)|0,y=w|(j()|0),l=A+(f<<3)|0,u[l>>2]=-1,u[l+4>>2]=y,f=f+1|0),d=d+1|0;while((d|0)!=122);return}y=0,f=0;do{if(Je(y)|0){for(we(y|0,0,45)|0,d=1,g=-1,_=w|(j()|0);C=we(7,0,(15-d|0)*3|0)|0,g=g&~C,_=_&~(j()|0),(d|0)!=(l|0);)d=d+1|0;C=A+(f<<3)|0,u[C>>2]=g,u[C+4>>2]=_,f=f+1|0}y=y+1|0}while((y|0)!=122)}function t2(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0,w=0,C=0,B=0;if(w=U,U=U+64|0,y=w,(l|0)==(f|0)&(A|0)==(d|0)|(!1|(A&2013265920|0)!=134217728|(!1|(d&2013265920|0)!=134217728))||(g=he(l|0,A|0,52)|0,j()|0,g=g&15,_=he(f|0,d|0,52)|0,j()|0,(g|0)!=(_&15|0)))return y=0,U=w,y|0;if(_=g+-1|0,g>>>0>1&&(B=sp(l,A,_)|0,C=j()|0,_=sp(f,d,_)|0,(B|0)==(_|0)&(C|0)==(j()|0))&&(_=(g^15)*3|0,g=he(l|0,A|0,_|0)|0,j()|0,g=g&7,_=he(f|0,d|0,_|0)|0,j()|0,_=_&7,(g|0)==0|(_|0)==0||(u[21136+(g<<2)>>2]|0)==(_|0)||(u[21168+(g<<2)>>2]|0)==(_|0)))return B=1,U=w,B|0;g=y,_=g+56|0;do u[g>>2]=0,g=g+4|0;while((g|0)<(_|0));return wa(l,A,1,y),B=y,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0))&&(B=y+8|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))&&(B=y+16|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))&&(B=y+24|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))&&(B=y+32|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))&&(B=y+40|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))?(g=y+48|0,g=((u[g>>2]|0)==(f|0)?(u[g+4>>2]|0)==(d|0):0)&1):g=1,B=g,U=w,B|0}function ZL(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0,w=0,C=0,B=0,L=0;if(B=U,U=U+16|0,y=B,!(t2(l,A,f,d)|0))return w=0,C=0,De(w|0),U=B,C|0;for(w=A&-2130706433,g=(vn(l,A)|0)==0,g=g?1:2;u[y>>2]=0,L=R(l,A,g,y)|0,_=g+1|0,!((L|0)==(f|0)&(j()|0)==(d|0));)if(_>>>0<7)g=_;else{g=0,l=0,C=6;break}return(C|0)==6?(De(g|0),U=B,l|0):(L=we(g|0,0,56)|0,C=w|(j()|0)|268435456,L=l|L,De(C|0),U=B,L|0)}function qL(l,A){l=l|0,A=A|0;var f=0;return f=!0&(A&2013265920|0)==268435456,De((f?A&-2130706433|134217728:0)|0),(f?l:0)|0}function eR(l,A){l=l|0,A=A|0;var f=0,d=0,g=0;return d=U,U=U+16|0,f=d,!0&(A&2013265920|0)==268435456?(g=he(l|0,A|0,56)|0,j()|0,u[f>>2]=0,f=R(l,A&-2130706433|134217728,g&7,f)|0,A=j()|0,De(A|0),U=d,f|0):(A=0,f=0,De(A|0),U=d,f|0)}function tR(l,A){l=l|0,A=A|0;var f=0;if(!(!0&(A&2013265920|0)==268435456))return f=0,f|0;switch(f=he(l|0,A|0,56)|0,j()|0,f&7){case 0:case 7:return f=0,f|0}return f=A&-2130706433|134217728,!0&(A&117440512|0)==16777216&(vn(l,f)|0)!=0?(f=0,f|0):(f=Zv(l,f)|0,f|0)}function nR(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0;_=U,U=U+16|0,d=_,y=!0&(A&2013265920|0)==268435456,g=A&-2130706433|134217728,w=f,u[w>>2]=y?l:0,u[w+4>>2]=y?g:0,y?(A=he(l|0,A|0,56)|0,j()|0,u[d>>2]=0,l=R(l,g,A&7,d)|0,A=j()|0):(l=0,A=0),w=f+8|0,u[w>>2]=l,u[w+4>>2]=A,U=_}function rR(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0;g=(vn(l,A)|0)==0,A=A&-2130706433,d=f,u[d>>2]=g?l:0,u[d+4>>2]=g?A|285212672:0,d=f+8|0,u[d>>2]=l,u[d+4>>2]=A|301989888,d=f+16|0,u[d>>2]=l,u[d+4>>2]=A|318767104,d=f+24|0,u[d>>2]=l,u[d+4>>2]=A|335544320,d=f+32|0,u[d>>2]=l,u[d+4>>2]=A|352321536,f=f+40|0,u[f>>2]=l,u[f+4>>2]=A|369098752}function $u(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0;if(y=U,U=U+16|0,_=y,d=he(l|0,A|0,56)|0,j()|0,w=!0&(A&2013265920|0)==268435456,g=w?l:0,l=w?A&-2130706433|134217728:0,A=bR(g,l,d&7)|0,(A|0)==-1){u[f>>2]=0,U=y;return}mc(g,l,_),d=he(g|0,l|0,52)|0,j()|0,d=d&15,vn(g,l)|0?$v(_,d,A,2,f):Yv(_,d,A,2,f),U=y}function iR(l){l=l|0;var A=0,f=0,d=0;return A=gi(1,12)|0,A||dt(22691,22646,49,22704),f=l+4|0,d=u[f>>2]|0,d|0?(d=d+8|0,u[d>>2]=A,u[f>>2]=A,A|0):(u[l>>2]|0&&dt(22721,22646,61,22744),d=l,u[d>>2]=A,u[f>>2]=A,A|0)}function sR(l,A){l=l|0,A=A|0;var f=0,d=0;return d=ki(24)|0,d||dt(22758,22646,78,22772),u[d>>2]=u[A>>2],u[d+4>>2]=u[A+4>>2],u[d+8>>2]=u[A+8>>2],u[d+12>>2]=u[A+12>>2],u[d+16>>2]=0,A=l+4|0,f=u[A>>2]|0,f|0?(u[f+16>>2]=d,u[A>>2]=d,d|0):(u[l>>2]|0&&dt(22787,22646,82,22772),u[l>>2]=d,u[A>>2]=d,d|0)}function oR(l){l=l|0;var A=0,f=0,d=0,g=0;if(!!l)for(d=1;;){if(A=u[l>>2]|0,A|0)do{if(f=u[A>>2]|0,f|0)do g=f,f=u[f+16>>2]|0,Ke(g);while((f|0)!=0);g=A,A=u[A+8>>2]|0,Ke(g)}while((A|0)!=0);if(A=l,l=u[l+8>>2]|0,d||Ke(A),l)d=0;else break}}function n2(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0,It=0,pt=0,Ot=0,Ft=0,He=0;if(g=l+8|0,u[g>>2]|0)return He=1,He|0;if(d=u[l>>2]|0,!d)return He=0,He|0;A=d,f=0;do f=f+1|0,A=u[A+8>>2]|0;while((A|0)!=0);if(f>>>0<2)return He=0,He|0;Ot=ki(f<<2)|0,Ot||dt(22807,22646,317,22826),pt=ki(f<<5)|0,pt||dt(22848,22646,321,22826),u[l>>2]=0,Ie=l+4|0,u[Ie>>2]=0,u[g>>2]=0,f=0,It=0,be=0,V=0;e:for(;;){if(L=u[d>>2]|0,L){_=0,y=L;do{if(C=+G[y+8>>3],A=y,y=u[y+16>>2]|0,B=(y|0)==0,g=B?L:y,w=+G[g+8>>3],+Ze(+(C-w))>3.141592653589793){He=14;break}_=_+(w-C)*(+G[A>>3]+ +G[g>>3])}while(!B);if((He|0)==14){He=0,_=0,A=L;do $=+G[A+8>>3],yt=A+16|0,bt=u[yt>>2]|0,bt=(bt|0)==0?L:bt,Ae=+G[bt+8>>3],_=_+(+G[A>>3]+ +G[bt>>3])*((Ae<0?Ae+6.283185307179586:Ae)-($<0?$+6.283185307179586:$)),A=u[((A|0)==0?d:yt)>>2]|0;while((A|0)!=0)}_>0?(u[Ot+(It<<2)>>2]=d,It=It+1|0,g=be,A=V):He=19}else He=19;if((He|0)==19){He=0;do if(f){if(A=f+8|0,u[A>>2]|0){He=21;break e}if(f=gi(1,12)|0,!f){He=23;break e}u[A>>2]=f,g=f+4|0,y=f,A=V}else if(V){g=Ie,y=V+8|0,A=d,f=l;break}else if(u[l>>2]|0){He=27;break e}else{g=Ie,y=l,A=d,f=l;break}while(0);if(u[y>>2]=d,u[g>>2]=d,y=pt+(be<<5)|0,B=u[d>>2]|0,B){for(L=pt+(be<<5)+8|0,G[L>>3]=17976931348623157e292,V=pt+(be<<5)+24|0,G[V>>3]=17976931348623157e292,G[y>>3]=-17976931348623157e292,W=pt+(be<<5)+16|0,G[W>>3]=-17976931348623157e292,Te=17976931348623157e292,te=-17976931348623157e292,g=0,Y=B,C=17976931348623157e292,ie=17976931348623157e292,de=-17976931348623157e292,w=-17976931348623157e292;_=+G[Y>>3],$=+G[Y+8>>3],Y=u[Y+16>>2]|0,re=(Y|0)==0,Ae=+G[(re?B:Y)+8>>3],_<C&&(G[L>>3]=_,C=_),$<ie&&(G[V>>3]=$,ie=$),_>de?G[y>>3]=_:_=de,$>w&&(G[W>>3]=$,w=$),Te=$>0&$<Te?$:Te,te=$<0&$>te?$:te,g=g|+Ze(+($-Ae))>3.141592653589793,!re;)de=_;g&&(G[W>>3]=te,G[V>>3]=Te)}else u[y>>2]=0,u[y+4>>2]=0,u[y+8>>2]=0,u[y+12>>2]=0,u[y+16>>2]=0,u[y+20>>2]=0,u[y+24>>2]=0,u[y+28>>2]=0;g=be+1|0}if(yt=d+8|0,d=u[yt>>2]|0,u[yt>>2]=0,d)be=g,V=A;else{He=45;break}}if((He|0)==21)dt(22624,22646,35,22658);else if((He|0)==23)dt(22678,22646,37,22658);else if((He|0)==27)dt(22721,22646,61,22744);else if((He|0)==45){e:do if((It|0)>0){for(yt=(g|0)==0,Qe=g<<2,bt=(l|0)==0,Ee=0,A=0;;){if(ye=u[Ot+(Ee<<2)>>2]|0,yt)He=73;else{if(be=ki(Qe)|0,!be){He=50;break}if(Ie=ki(Qe)|0,!Ie){He=52;break}t:do if(bt)f=0;else{for(g=0,f=0,y=l;d=pt+(g<<5)|0,r2(u[y>>2]|0,d,u[ye>>2]|0)|0?(u[be+(f<<2)>>2]=y,u[Ie+(f<<2)>>2]=d,re=f+1|0):re=f,y=u[y+8>>2]|0,y;)g=g+1|0,f=re;if((re|0)>0)if(d=u[be>>2]|0,(re|0)==1)f=d;else for(W=0,Y=-1,f=d,V=d;;){for(B=u[V>>2]|0,d=0,y=0;g=u[u[be+(y<<2)>>2]>>2]|0,(g|0)==(B|0)?L=d:L=d+((r2(g,u[Ie+(y<<2)>>2]|0,u[B>>2]|0)|0)&1)|0,y=y+1|0,(y|0)!=(re|0);)d=L;if(g=(L|0)>(Y|0),f=g?V:f,d=W+1|0,(d|0)==(re|0))break t;W=d,Y=g?L:Y,V=u[be+(d<<2)>>2]|0}else f=0}while(0);if(Ke(be),Ke(Ie),f){if(g=f+4|0,d=u[g>>2]|0,d)f=d+8|0;else if(u[f>>2]|0){He=70;break}u[f>>2]=ye,u[g>>2]=ye}else He=73}if((He|0)==73){if(He=0,A=u[ye>>2]|0,A|0)do Ie=A,A=u[A+16>>2]|0,Ke(Ie);while((A|0)!=0);Ke(ye),A=2}if(Ee=Ee+1|0,(Ee|0)>=(It|0)){Ft=A;break e}}(He|0)==50?dt(22863,22646,249,22882):(He|0)==52?dt(22901,22646,252,22882):(He|0)==70&&dt(22721,22646,61,22744)}else Ft=0;while(0);return Ke(Ot),Ke(pt),He=Ft,He|0}return 0}function r2(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0;if(!(Uv(A,f)|0)||(A=Nv(A)|0,B=+G[f>>3],d=+G[f+8>>3],d=A&d<0?d+6.283185307179586:d,l=u[l>>2]|0,!l))return l=0,l|0;if(A){A=0,f=l;e:for(;;){for(;y=+G[f>>3],C=+G[f+8>>3],f=f+16|0,L=u[f>>2]|0,L=(L|0)==0?l:L,_=+G[L>>3],g=+G[L+8>>3],y>_?(w=y,y=C):(w=_,_=y,y=g,g=C),!!(B<_|B>w);)if(f=u[f>>2]|0,!f){f=22;break e}if(C=g<0?g+6.283185307179586:g,y=y<0?y+6.283185307179586:y,d=y==d|C==d?d+-2220446049250313e-31:d,C=C+(B-_)/(w-_)*(y-C),(C<0?C+6.283185307179586:C)>d&&(A=A^1),f=u[f>>2]|0,!f){f=22;break}}if((f|0)==22)return A|0}else{A=0,f=l;e:for(;;){for(;y=+G[f>>3],C=+G[f+8>>3],f=f+16|0,L=u[f>>2]|0,L=(L|0)==0?l:L,_=+G[L>>3],g=+G[L+8>>3],y>_?(w=y,y=C):(w=_,_=y,y=g,g=C),!!(B<_|B>w);)if(f=u[f>>2]|0,!f){f=22;break e}if(d=y==d|g==d?d+-2220446049250313e-31:d,g+(B-_)/(w-_)*(y-g)>d&&(A=A^1),f=u[f>>2]|0,!f){f=22;break}}if((f|0)==22)return A|0}return 0}function ns(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0;if(te=U,U=U+32|0,Te=te+16|0,de=te,_=he(l|0,A|0,52)|0,j()|0,_=_&15,Y=he(f|0,d|0,52)|0,j()|0,(_|0)!=(Y&15|0))return Te=1,U=te,Te|0;if(B=he(l|0,A|0,45)|0,j()|0,B=B&127,L=he(f|0,d|0,45)|0,j()|0,L=L&127,Y=(B|0)!=(L|0),Y){if(w=ep(B,L)|0,(w|0)==7)return Te=2,U=te,Te|0;C=ep(L,B)|0,(C|0)==7?dt(22925,22949,151,22959):(re=w,y=C)}else re=0,y=0;V=Je(B)|0,W=Je(L)|0,u[Te>>2]=0,u[Te+4>>2]=0,u[Te+8>>2]=0,u[Te+12>>2]=0;do if(re){if(L=u[4304+(B*28|0)+(re<<2)>>2]|0,w=(L|0)>0,W)if(w){B=0,C=f,w=d;do C=XL(C,w)|0,w=j()|0,y=Ps(y)|0,(y|0)==1&&(y=Ps(1)|0),B=B+1|0;while((B|0)!=(L|0));L=y,B=C,C=w}else L=y,B=f,C=d;else if(w){B=0,C=f,w=d;do C=ap(C,w)|0,w=j()|0,y=Ps(y)|0,B=B+1|0;while((B|0)!=(L|0));L=y,B=C,C=w}else L=y,B=f,C=d;if(lp(B,C,Te)|0,Y||dt(22972,22949,181,22959),w=(V|0)!=0,y=(W|0)!=0,w&y&&dt(22999,22949,182,22959),w){if(y=dr(l,A)|0,Ge[22032+(y*7|0)+re>>0]|0){_=3;break}C=u[21200+(y*28|0)+(re<<2)>>2]|0,B=C,ie=26}else if(y){if(y=dr(B,C)|0,Ge[22032+(y*7|0)+L>>0]|0){_=4;break}B=0,C=u[21200+(L*28|0)+(y<<2)>>2]|0,ie=26}else y=0;if((ie|0)==26)if((C|0)<=-1&&dt(23030,22949,212,22959),(B|0)<=-1&&dt(23053,22949,213,22959),(C|0)>0){w=Te+4|0,y=0;do Qu(w),y=y+1|0;while((y|0)!=(C|0));y=B}else y=B;if(u[de>>2]=0,u[de+4>>2]=0,u[de+8>>2]=0,Vv(de,re),_|0)for(;Jr(_)|0?Wu(de):xo(de),(_|0)>1;)_=_+-1|0;if((y|0)>0){_=0;do Qu(de),_=_+1|0;while((_|0)!=(y|0))}ie=Te+4|0,or(ie,de,ie),Wn(ie),ie=50}else if(lp(f,d,Te)|0,(V|0)!=0&(W|0)!=0)if((L|0)!=(B|0)&&dt(23077,22949,243,22959),y=dr(l,A)|0,_=dr(f,d)|0,Ge[22032+(y*7|0)+_>>0]|0)_=5;else if(y=u[21200+(y*28|0)+(_<<2)>>2]|0,(y|0)>0){w=Te+4|0,_=0;do Qu(w),_=_+1|0;while((_|0)!=(y|0));ie=50}else ie=50;else ie=50;while(0);return(ie|0)==50&&(_=Te+4|0,u[g>>2]=u[_>>2],u[g+4>>2]=u[_+4>>2],u[g+8>>2]=u[_+8>>2],_=0),Te=_,U=te,Te|0}function i2(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0;if(re=U,U=U+48|0,y=re+36|0,w=re+24|0,C=re+12|0,B=re,_=he(l|0,A|0,52)|0,j()|0,_=_&15,W=he(l|0,A|0,45)|0,j()|0,W=W&127,L=Je(W)|0,we(_|0,0,52)|0,de=j()|0|134225919,ie=d,u[ie>>2]=-1,u[ie+4>>2]=de,!_)return(u[f>>2]|0)>1||(u[f+4>>2]|0)>1||(u[f+8>>2]|0)>1||(g=q0(W,ju(f)|0)|0,(g|0)==127)?(de=1,U=re,de|0):(Y=we(g|0,0,45)|0,ie=j()|0,W=d,ie=u[W+4>>2]&-1040385|ie,de=d,u[de>>2]=u[W>>2]|Y,u[de+4>>2]=ie,de=0,U=re,de|0);for(u[y>>2]=u[f>>2],u[y+4>>2]=u[f+4>>2],u[y+8>>2]=u[f+8>>2];u[w>>2]=u[y>>2],u[w+4>>2]=u[y+4>>2],u[w+8>>2]=u[y+8>>2],Jr(_)|0?(zv(y),u[C>>2]=u[y>>2],u[C+4>>2]=u[y+4>>2],u[C+8>>2]=u[y+8>>2],Wu(C)):(rp(y),u[C>>2]=u[y>>2],u[C+4>>2]=u[y+4>>2],u[C+8>>2]=u[y+8>>2],xo(C)),np(w,C,B),Wn(B),ie=d,Te=u[ie>>2]|0,ie=u[ie+4>>2]|0,te=(15-_|0)*3|0,f=we(7,0,te|0)|0,ie=ie&~(j()|0),te=we(ju(B)|0,0,te|0)|0,ie=j()|0|ie,de=d,u[de>>2]=te|Te&~f,u[de+4>>2]=ie,(_|0)>1;)_=_+-1|0;e:do if((u[y>>2]|0)<=1&&(u[y+4>>2]|0)<=1&&(u[y+8>>2]|0)<=1){_=ju(y)|0,w=q0(W,_)|0,(w|0)==127?B=0:B=Je(w)|0;t:do if(_){if(L){if(y=21408+((dr(l,A)|0)*28|0)+(_<<2)|0,y=u[y>>2]|0,(y|0)>0){f=0;do _=Co(_)|0,f=f+1|0;while((f|0)!=(y|0))}if((_|0)==1){g=3;break e}f=q0(W,_)|0,(f|0)==127&&dt(23104,22949,376,23134),Je(f)|0?dt(23147,22949,377,23134):(Y=y,V=_,g=f)}else Y=0,V=_,g=w;if(C=u[4304+(W*28|0)+(V<<2)>>2]|0,(C|0)<=-1&&dt(23178,22949,384,23134),!B){if((Y|0)<=-1&&dt(23030,22949,417,23134),Y|0){y=d,_=0,f=u[y>>2]|0,y=u[y+4>>2]|0;do f=Ms(f,y)|0,y=j()|0,te=d,u[te>>2]=f,u[te+4>>2]=y,_=_+1|0;while((_|0)<(Y|0))}if((C|0)<=0){_=54;break}for(y=d,_=0,f=u[y>>2]|0,y=u[y+4>>2]|0;;)if(f=Ms(f,y)|0,y=j()|0,te=d,u[te>>2]=f,u[te+4>>2]=y,_=_+1|0,(_|0)==(C|0)){_=54;break t}}if(w=ep(g,W)|0,(w|0)==7&&dt(22925,22949,393,23134),_=d,f=u[_>>2]|0,_=u[_+4>>2]|0,(C|0)>0){y=0;do f=Ms(f,_)|0,_=j()|0,te=d,u[te>>2]=f,u[te+4>>2]=_,y=y+1|0;while((y|0)!=(C|0))}if(f=dr(f,_)|0,te=_n(g)|0,f=u[(te?21824:21616)+(w*28|0)+(f<<2)>>2]|0,(f|0)<=-1&&dt(23030,22949,412,23134),!f)_=54;else{w=d,_=0,y=u[w>>2]|0,w=u[w+4>>2]|0;do y=op(y,w)|0,w=j()|0,te=d,u[te>>2]=y,u[te+4>>2]=w,_=_+1|0;while((_|0)<(f|0));_=54}}else if((L|0)!=0&(B|0)!=0)if(te=dr(l,A)|0,_=d,_=21408+(te*28|0)+((dr(u[_>>2]|0,u[_+4>>2]|0)|0)<<2)|0,_=u[_>>2]|0,(_|0)<=-1&&dt(23201,22949,433,23134),!_)g=w,_=55;else{y=d,g=0,f=u[y>>2]|0,y=u[y+4>>2]|0;do f=Ms(f,y)|0,y=j()|0,te=d,u[te>>2]=f,u[te+4>>2]=y,g=g+1|0;while((g|0)<(_|0));g=w,_=54}else g=w,_=54;while(0);if((_|0)==54&&B&&(_=55),(_|0)==55&&(te=d,(dr(u[te>>2]|0,u[te+4>>2]|0)|0)==1)){g=4;break}te=d,de=u[te>>2]|0,te=u[te+4>>2]&-1040385,Te=we(g|0,0,45)|0,te=te|(j()|0),g=d,u[g>>2]=de|Te,u[g+4>>2]=te,g=0}else g=2;while(0);return te=g,U=re,te|0}function aR(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0;return y=U,U=U+16|0,_=y,l=ns(l,A,f,d,_)|0,l||(yL(_,g),l=0),U=y,l|0}function lR(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0;return g=U,U=U+16|0,_=g,_L(f,_),d=i2(l,A,_,d)|0,U=g,d|0}function cR(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0;return y=U,U=U+32|0,g=y+12|0,_=y,(ns(l,A,l,A,g)|0)==0&&(ns(l,A,f,d,_)|0)==0?l=ip(g,_)|0:l=-1,U=y,l|0}function AR(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0,y=0;return y=U,U=U+32|0,g=y+12|0,_=y,(ns(l,A,l,A,g)|0)==0&&(ns(l,A,f,d,_)|0)==0?l=ip(g,_)|0:l=-1,U=y,(l>>>31^1)+l|0}function uR(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0;if(be=U,U=U+48|0,_=be+24|0,y=be+12|0,$=be,(ns(l,A,l,A,_)|0)==0&&(ns(l,A,f,d,y)|0)==0){if(Ae=ip(_,y)|0,(Ae|0)<0)return $=Ae,U=be,$|0;for(u[_>>2]=0,u[_+4>>2]=0,u[_+8>>2]=0,u[y>>2]=0,u[y+4>>2]=0,u[y+8>>2]=0,ns(l,A,l,A,_)|0,ns(l,A,f,d,y)|0,Qv(_),Qv(y),Ae?(L=u[_>>2]|0,Y=+(Ae|0),de=_+4|0,V=u[de>>2]|0,Te=_+8|0,W=u[Te>>2]|0,te=_,f=L,d=V,_=W,re=+((u[y>>2]|0)-L|0)/Y,ie=+((u[y+4>>2]|0)-V|0)/Y,Y=+((u[y+8>>2]|0)-W|0)/Y):(d=_+4|0,W=_+8|0,de=d,Te=W,te=_,f=u[_>>2]|0,d=u[d>>2]|0,_=u[W>>2]|0,re=0,ie=0,Y=0),u[$>>2]=f,W=$+4|0,u[W>>2]=d,V=$+8|0,u[V>>2]=_,L=0;;){C=+(L|0),Ie=re*C+ +(f|0),w=ie*C+ +(u[de>>2]|0),C=Y*C+ +(u[Te>>2]|0),d=~~+Ju(+Ie),y=~~+Ju(+w),f=~~+Ju(+C),Ie=+Ze(+(+(d|0)-Ie)),w=+Ze(+(+(y|0)-w)),C=+Ze(+(+(f|0)-C));do if(Ie>w&Ie>C)d=0-(y+f)|0,_=y;else if(B=0-d|0,w>C){_=B-f|0;break}else{_=y,f=B-y|0;break}while(0);if(u[$>>2]=d,u[W>>2]=_,u[V>>2]=f,vL($),i2(l,A,$,g+(L<<3)|0)|0,(L|0)==(Ae|0))break;L=L+1|0,f=u[te>>2]|0}return $=0,U=be,$|0}return $=-1,U=be,$|0}function Xu(l,A){l=l|0,A=A|0;var f=0;if(!A)return f=1,f|0;f=l,l=1;do l=Bn((A&1|0)==0?1:f,l)|0,A=A>>1,f=Bn(f,f)|0;while((A|0)!=0);return l|0}function s2(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0;if(!(Uv(A,f)|0)||(A=Nv(A)|0,W=+G[f>>3],d=+G[f+8>>3],d=A&d<0?d+6.283185307179586:d,V=u[l>>2]|0,(V|0)<=0))return V=0,V|0;if(L=u[l+4>>2]|0,A){A=0,f=-1,l=0;e:for(;;){for(B=l;y=+G[L+(B<<4)>>3],C=+G[L+(B<<4)+8>>3],l=(f+2|0)%(V|0)|0,_=+G[L+(l<<4)>>3],g=+G[L+(l<<4)+8>>3],y>_?(w=y,y=C):(w=_,_=y,y=g,g=C),!!(W<_|W>w);)if(f=B+1|0,(f|0)<(V|0))l=B,B=f,f=l;else{f=22;break e}if(C=g<0?g+6.283185307179586:g,y=y<0?y+6.283185307179586:y,d=y==d|C==d?d+-2220446049250313e-31:d,C=C+(W-_)/(w-_)*(y-C),(C<0?C+6.283185307179586:C)>d&&(A=A^1),l=B+1|0,(l|0)>=(V|0)){f=22;break}else f=B}if((f|0)==22)return A|0}else{A=0,f=-1,l=0;e:for(;;){for(B=l;y=+G[L+(B<<4)>>3],C=+G[L+(B<<4)+8>>3],l=(f+2|0)%(V|0)|0,_=+G[L+(l<<4)>>3],g=+G[L+(l<<4)+8>>3],y>_?(w=y,y=C):(w=_,_=y,y=g,g=C),!!(W<_|W>w);)if(f=B+1|0,(f|0)<(V|0))l=B,B=f,f=l;else{f=22;break e}if(d=y==d|g==d?d+-2220446049250313e-31:d,g+(W-_)/(w-_)*(y-g)>d&&(A=A^1),l=B+1|0,(l|0)>=(V|0)){f=22;break}else f=B}if((f|0)==22)return A|0}return 0}function Ap(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0;if(re=u[l>>2]|0,!re){u[A>>2]=0,u[A+4>>2]=0,u[A+8>>2]=0,u[A+12>>2]=0,u[A+16>>2]=0,u[A+20>>2]=0,u[A+24>>2]=0,u[A+28>>2]=0;return}if(ie=A+8|0,G[ie>>3]=17976931348623157e292,de=A+24|0,G[de>>3]=17976931348623157e292,G[A>>3]=-17976931348623157e292,Te=A+16|0,G[Te>>3]=-17976931348623157e292,!((re|0)<=0)){for(W=u[l+4>>2]|0,B=17976931348623157e292,L=-17976931348623157e292,V=0,l=-1,_=17976931348623157e292,y=17976931348623157e292,C=-17976931348623157e292,d=-17976931348623157e292,Y=0;f=+G[W+(Y<<4)>>3],w=+G[W+(Y<<4)+8>>3],l=l+2|0,g=+G[W+(((l|0)==(re|0)?0:l)<<4)+8>>3],f<_&&(G[ie>>3]=f,_=f),w<y&&(G[de>>3]=w,y=w),f>C?G[A>>3]=f:f=C,w>d&&(G[Te>>3]=w,d=w),B=w>0&w<B?w:B,L=w<0&w>L?w:L,V=V|+Ze(+(w-g))>3.141592653589793,l=Y+1|0,(l|0)!=(re|0);)te=Y,C=f,Y=l,l=te;!V||(G[Te>>3]=L,G[de>>3]=B)}}function fR(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0;if(re=u[l>>2]|0,re){if(ie=A+8|0,G[ie>>3]=17976931348623157e292,de=A+24|0,G[de>>3]=17976931348623157e292,G[A>>3]=-17976931348623157e292,Te=A+16|0,G[Te>>3]=-17976931348623157e292,(re|0)>0){for(g=u[l+4>>2]|0,W=17976931348623157e292,Y=-17976931348623157e292,d=0,f=-1,C=17976931348623157e292,B=17976931348623157e292,V=-17976931348623157e292,y=-17976931348623157e292,te=0;_=+G[g+(te<<4)>>3],L=+G[g+(te<<4)+8>>3],Ie=f+2|0,w=+G[g+(((Ie|0)==(re|0)?0:Ie)<<4)+8>>3],_<C&&(G[ie>>3]=_,C=_),L<B&&(G[de>>3]=L,B=L),_>V?G[A>>3]=_:_=V,L>y&&(G[Te>>3]=L,y=L),W=L>0&L<W?L:W,Y=L<0&L>Y?L:Y,d=d|+Ze(+(L-w))>3.141592653589793,f=te+1|0,(f|0)!=(re|0);)Ie=te,V=_,te=f,f=Ie;d&&(G[Te>>3]=Y,G[de>>3]=W)}}else u[A>>2]=0,u[A+4>>2]=0,u[A+8>>2]=0,u[A+12>>2]=0,u[A+16>>2]=0,u[A+20>>2]=0,u[A+24>>2]=0,u[A+28>>2]=0;if(Ie=l+8|0,f=u[Ie>>2]|0,!((f|0)<=0)){be=l+12|0,$=0;do if(g=u[be>>2]|0,d=$,$=$+1|0,de=A+($<<5)|0,Te=u[g+(d<<3)>>2]|0,Te){if(te=A+($<<5)+8|0,G[te>>3]=17976931348623157e292,l=A+($<<5)+24|0,G[l>>3]=17976931348623157e292,G[de>>3]=-17976931348623157e292,Ae=A+($<<5)+16|0,G[Ae>>3]=-17976931348623157e292,(Te|0)>0){for(re=u[g+(d<<3)+4>>2]|0,W=17976931348623157e292,Y=-17976931348623157e292,g=0,d=-1,ie=0,C=17976931348623157e292,B=17976931348623157e292,L=-17976931348623157e292,y=-17976931348623157e292;_=+G[re+(ie<<4)>>3],V=+G[re+(ie<<4)+8>>3],d=d+2|0,w=+G[re+(((d|0)==(Te|0)?0:d)<<4)+8>>3],_<C&&(G[te>>3]=_,C=_),V<B&&(G[l>>3]=V,B=V),_>L?G[de>>3]=_:_=L,V>y&&(G[Ae>>3]=V,y=V),W=V>0&V<W?V:W,Y=V<0&V>Y?V:Y,g=g|+Ze(+(V-w))>3.141592653589793,d=ie+1|0,(d|0)!=(Te|0);)ye=ie,ie=d,L=_,d=ye;g&&(G[Ae>>3]=Y,G[l>>3]=W)}}else u[de>>2]=0,u[de+4>>2]=0,u[de+8>>2]=0,u[de+12>>2]=0,u[de+16>>2]=0,u[de+20>>2]=0,u[de+24>>2]=0,u[de+28>>2]=0,f=u[Ie>>2]|0;while(($|0)<(f|0))}}function hR(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0;if(!(s2(l,A,f)|0))return g=0,g|0;if(g=l+8|0,(u[g>>2]|0)<=0)return g=1,g|0;for(d=l+12|0,l=0;;){if(_=l,l=l+1|0,s2((u[d>>2]|0)+(_<<3)|0,A+(l<<5)|0,f)|0){l=0,d=6;break}if((l|0)>=(u[g>>2]|0)){l=1,d=6;break}}return(d|0)==6?l|0:0}function dR(){return 8}function pR(){return 16}function gR(){return 168}function mR(){return 8}function yR(){return 16}function _R(){return 12}function vR(){return 8}function ER(l){l=l|0;var A=0,f=0;return f=+G[l>>3],A=+G[l+8>>3],+ +tt(+(f*f+A*A))}function o2(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0;B=+G[l>>3],C=+G[A>>3]-B,w=+G[l+8>>3],y=+G[A+8>>3]-w,V=+G[f>>3],_=+G[d>>3]-V,W=+G[f+8>>3],L=+G[d+8>>3]-W,_=(_*(w-W)-(B-V)*L)/(C*L-y*_),G[g>>3]=B+C*_,G[g+8>>3]=w+y*_}function a2(l,A){return l=l|0,A=A|0,+G[l>>3]!=+G[A>>3]?(A=0,A|0):(A=+G[l+8>>3]==+G[A+8>>3],A|0)}function fn(l,A){l=l|0,A=A|0;var f=0,d=0,g=0;return g=+G[l>>3]-+G[A>>3],d=+G[l+8>>3]-+G[A+8>>3],f=+G[l+16>>3]-+G[A+16>>3],+(g*g+d*d+f*f)}function wR(l,A){l=l|0,A=A|0;var f=0,d=0,g=0;f=+G[l>>3],d=+ut(+f),f=+st(+f),G[A+16>>3]=f,f=+G[l+8>>3],g=d*+ut(+f),G[A>>3]=g,f=d*+st(+f),G[A+8>>3]=f}function TR(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0;if(B=U,U=U+32|0,g=B+16|0,_=B,mc(l,A,g),y=Kv(l,A)|0,C=dr(l,A)|0,uL(y,_),A=fL(y,u[g>>2]|0)|0,!(Je(y)|0))return C=A,U=B,C|0;do switch(y|0){case 4:{l=0,f=14;break}case 14:{l=1,f=14;break}case 24:{l=2,f=14;break}case 38:{l=3,f=14;break}case 49:{l=4,f=14;break}case 58:{l=5,f=14;break}case 63:{l=6,f=14;break}case 72:{l=7,f=14;break}case 83:{l=8,f=14;break}case 97:{l=9,f=14;break}case 107:{l=10,f=14;break}case 117:{l=11,f=14;break}default:w=0,d=0}while(0);return(f|0)==14&&(w=u[22096+(l*24|0)+8>>2]|0,d=u[22096+(l*24|0)+16>>2]|0),l=u[g>>2]|0,(l|0)!=(u[_>>2]|0)&&(y=_n(y)|0,l=u[g>>2]|0,y|(l|0)==(d|0)&&(A=(A+1|0)%6|0)),(C|0)==3&(l|0)==(d|0)?(C=(A+5|0)%6|0,U=B,C|0):(C|0)==5&(l|0)==(w|0)?(C=(A+1|0)%6|0,U=B,C|0):(C=A,U=B,C|0)}function bR(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0;return d=vn(l,A)|0,(f+-1|0)>>>0>5||(g=(d|0)!=0,(f|0)==1&g)?(f=-1,f|0):(d=TR(l,A)|0,g?(f=(5-d+(u[22384+(f<<2)>>2]|0)|0)%5|0,f|0):(f=(6-d+(u[22416+(f<<2)>>2]|0)|0)%6|0,f|0))}function l2(l,A,f){l=l|0,A=A|0,f=f|0;var d=0;(A|0)>0?(d=gi(A,4)|0,u[l>>2]=d,d||dt(23230,23253,40,23267)):u[l>>2]=0,u[l+4>>2]=A,u[l+8>>2]=0,u[l+12>>2]=f}function c2(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0;g=l+4|0,_=l+12|0,y=l+8|0;e:for(;;){for(f=u[g>>2]|0,A=0;;){if((A|0)>=(f|0))break e;if(d=u[l>>2]|0,w=u[d+(A<<2)>>2]|0,!w)A=A+1|0;else break}A=d+(~~(+Ze(+(+Ht(10,+ +(15-(u[_>>2]|0)|0))*(+G[w>>3]+ +G[w+8>>3])))%+(f|0))>>>0<<2)|0,f=u[A>>2]|0;t:do if(f|0){if(d=w+32|0,(f|0)==(w|0))u[A>>2]=u[d>>2];else{if(f=f+32|0,A=u[f>>2]|0,!A)break;for(;(A|0)!=(w|0);)if(f=A+32|0,A=u[f>>2]|0,!A)break t;u[f>>2]=u[d>>2]}Ke(w),u[y>>2]=(u[y>>2]|0)+-1}while(0)}Ke(u[l>>2]|0)}function A2(l){l=l|0;var A=0,f=0,d=0;for(d=u[l+4>>2]|0,f=0;;){if((f|0)>=(d|0)){A=0,f=4;break}if(A=u[(u[l>>2]|0)+(f<<2)>>2]|0,!A)f=f+1|0;else{f=4;break}}return(f|0)==4?A|0:0}function u2(l,A){l=l|0,A=A|0;var f=0,d=0,g=0,_=0;if(f=~~(+Ze(+(+Ht(10,+ +(15-(u[l+12>>2]|0)|0))*(+G[A>>3]+ +G[A+8>>3])))%+(u[l+4>>2]|0))>>>0,f=(u[l>>2]|0)+(f<<2)|0,d=u[f>>2]|0,!d)return _=1,_|0;_=A+32|0;do if((d|0)!=(A|0)){if(f=u[d+32>>2]|0,!f)return _=1,_|0;for(g=f;;){if((g|0)==(A|0)){g=8;break}if(f=u[g+32>>2]|0,f)d=g,g=f;else{f=1,g=10;break}}if((g|0)==8){u[d+32>>2]=u[_>>2];break}else if((g|0)==10)return f|0}else u[f>>2]=u[_>>2];while(0);return Ke(A),_=l+8|0,u[_>>2]=(u[_>>2]|0)+-1,_=0,_|0}function xR(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0;_=ki(40)|0,_||dt(23283,23253,98,23296),u[_>>2]=u[A>>2],u[_+4>>2]=u[A+4>>2],u[_+8>>2]=u[A+8>>2],u[_+12>>2]=u[A+12>>2],g=_+16|0,u[g>>2]=u[f>>2],u[g+4>>2]=u[f+4>>2],u[g+8>>2]=u[f+8>>2],u[g+12>>2]=u[f+12>>2],u[_+32>>2]=0,g=~~(+Ze(+(+Ht(10,+ +(15-(u[l+12>>2]|0)|0))*(+G[A>>3]+ +G[A+8>>3])))%+(u[l+4>>2]|0))>>>0,g=(u[l>>2]|0)+(g<<2)|0,d=u[g>>2]|0;do if(!d)u[g>>2]=_;else{for(;!(ba(d,A)|0&&ba(d+16|0,f)|0);)if(g=u[d+32>>2]|0,d=(g|0)==0?d:g,!(u[d+32>>2]|0)){y=10;break}if((y|0)==10){u[d+32>>2]=_;break}return Ke(_),y=d,y|0}while(0);return y=l+8|0,u[y>>2]=(u[y>>2]|0)+1,y=_,y|0}function CR(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0;if(g=~~(+Ze(+(+Ht(10,+ +(15-(u[l+12>>2]|0)|0))*(+G[A>>3]+ +G[A+8>>3])))%+(u[l+4>>2]|0))>>>0,g=u[(u[l>>2]|0)+(g<<2)>>2]|0,!g)return f=0,f|0;if(!f){for(l=g;;){if(ba(l,A)|0){d=10;break}if(l=u[l+32>>2]|0,!l){l=0,d=10;break}}if((d|0)==10)return l|0}for(l=g;;){if(ba(l,A)|0&&ba(l+16|0,f)|0){d=10;break}if(l=u[l+32>>2]|0,!l){l=0,d=10;break}}return(d|0)==10?l|0:0}function SR(l,A){l=l|0,A=A|0;var f=0;if(f=~~(+Ze(+(+Ht(10,+ +(15-(u[l+12>>2]|0)|0))*(+G[A>>3]+ +G[A+8>>3])))%+(u[l+4>>2]|0))>>>0,l=u[(u[l>>2]|0)+(f<<2)>>2]|0,!l)return f=0,f|0;for(;;){if(ba(l,A)|0){A=5;break}if(l=u[l+32>>2]|0,!l){l=0,A=5;break}}return(A|0)==5?l|0:0}function PR(){return 23312}function MR(l){return l=+l,+ +d2(+l)}function Yu(l){return l=+l,~~+MR(l)|0}function ki(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0;be=U,U=U+16|0,W=be;do if(l>>>0<245){if(B=l>>>0<11?16:l+11&-8,l=B>>>3,V=u[5829]|0,f=V>>>l,f&3|0)return A=(f&1^1)+l|0,l=23356+(A<<1<<2)|0,f=l+8|0,d=u[f>>2]|0,g=d+8|0,_=u[g>>2]|0,(_|0)==(l|0)?u[5829]=V&~(1<<A):(u[_+12>>2]=l,u[f>>2]=_),$=A<<3,u[d+4>>2]=$|3,$=d+$+4|0,u[$>>2]=u[$>>2]|1,$=g,U=be,$|0;if(L=u[5831]|0,B>>>0>L>>>0){if(f|0)return A=2<<l,A=f<<l&(A|0-A),A=(A&0-A)+-1|0,w=A>>>12&16,A=A>>>w,f=A>>>5&8,A=A>>>f,_=A>>>2&4,A=A>>>_,l=A>>>1&2,A=A>>>l,d=A>>>1&1,d=(f|w|_|l|d)+(A>>>d)|0,A=23356+(d<<1<<2)|0,l=A+8|0,_=u[l>>2]|0,w=_+8|0,f=u[w>>2]|0,(f|0)==(A|0)?(l=V&~(1<<d),u[5829]=l):(u[f+12>>2]=A,u[l>>2]=f,l=V),$=d<<3,y=$-B|0,u[_+4>>2]=B|3,g=_+B|0,u[g+4>>2]=y|1,u[_+$>>2]=y,L|0&&(d=u[5834]|0,A=L>>>3,f=23356+(A<<1<<2)|0,A=1<<A,l&A?(l=f+8|0,A=u[l>>2]|0):(u[5829]=l|A,A=f,l=f+8|0),u[l>>2]=d,u[A+12>>2]=d,u[d+8>>2]=A,u[d+12>>2]=f),u[5831]=y,u[5834]=g,$=w,U=be,$|0;if(_=u[5830]|0,_){for(f=(_&0-_)+-1|0,g=f>>>12&16,f=f>>>g,d=f>>>5&8,f=f>>>d,y=f>>>2&4,f=f>>>y,w=f>>>1&2,f=f>>>w,C=f>>>1&1,C=u[23620+((d|g|y|w|C)+(f>>>C)<<2)>>2]|0,f=C,w=C,C=(u[C+4>>2]&-8)-B|0;l=u[f+16>>2]|0,!(!l&&(l=u[f+20>>2]|0,!l));)y=(u[l+4>>2]&-8)-B|0,g=y>>>0<C>>>0,f=l,w=g?l:w,C=g?y:C;if(y=w+B|0,y>>>0>w>>>0){g=u[w+24>>2]|0,A=u[w+12>>2]|0;do if((A|0)==(w|0)){if(l=w+20|0,A=u[l>>2]|0,!A&&(l=w+16|0,A=u[l>>2]|0,!A)){f=0;break}for(;;)if(d=A+20|0,f=u[d>>2]|0,f)A=f,l=d;else if(d=A+16|0,f=u[d>>2]|0,f)A=f,l=d;else break;u[l>>2]=0,f=A}else f=u[w+8>>2]|0,u[f+12>>2]=A,u[A+8>>2]=f,f=A;while(0);do if(g|0){if(A=u[w+28>>2]|0,l=23620+(A<<2)|0,(w|0)==(u[l>>2]|0)){if(u[l>>2]=f,!f){u[5830]=_&~(1<<A);break}}else if($=g+16|0,u[((u[$>>2]|0)==(w|0)?$:g+20|0)>>2]=f,!f)break;u[f+24>>2]=g,A=u[w+16>>2]|0,A|0&&(u[f+16>>2]=A,u[A+24>>2]=f),A=u[w+20>>2]|0,A|0&&(u[f+20>>2]=A,u[A+24>>2]=f)}while(0);return C>>>0<16?($=C+B|0,u[w+4>>2]=$|3,$=w+$+4|0,u[$>>2]=u[$>>2]|1):(u[w+4>>2]=B|3,u[y+4>>2]=C|1,u[y+C>>2]=C,L|0&&(d=u[5834]|0,A=L>>>3,f=23356+(A<<1<<2)|0,A=1<<A,A&V?(l=f+8|0,A=u[l>>2]|0):(u[5829]=A|V,A=f,l=f+8|0),u[l>>2]=d,u[A+12>>2]=d,u[d+8>>2]=A,u[d+12>>2]=f),u[5831]=C,u[5834]=y),$=w+8|0,U=be,$|0}else V=B}else V=B}else V=B}else if(l>>>0<=4294967231)if(l=l+11|0,B=l&-8,d=u[5830]|0,d){g=0-B|0,l=l>>>8,l?B>>>0>16777215?C=31:(V=(l+1048320|0)>>>16&8,ie=l<<V,w=(ie+520192|0)>>>16&4,ie=ie<<w,C=(ie+245760|0)>>>16&2,C=14-(w|V|C)+(ie<<C>>>15)|0,C=B>>>(C+7|0)&1|C<<1):C=0,f=u[23620+(C<<2)>>2]|0;e:do if(!f)f=0,l=0,ie=61;else for(l=0,w=B<<((C|0)==31?0:25-(C>>>1)|0),_=0;;){if(y=(u[f+4>>2]&-8)-B|0,y>>>0<g>>>0)if(y)l=f,g=y;else{l=f,g=0,ie=65;break e}if(ie=u[f+20>>2]|0,f=u[f+16+(w>>>31<<2)>>2]|0,_=(ie|0)==0|(ie|0)==(f|0)?_:ie,f)w=w<<1;else{f=_,ie=61;break}}while(0);if((ie|0)==61){if((f|0)==0&(l|0)==0){if(l=2<<C,l=(l|0-l)&d,!l){V=B;break}V=(l&0-l)+-1|0,y=V>>>12&16,V=V>>>y,_=V>>>5&8,V=V>>>_,w=V>>>2&4,V=V>>>w,C=V>>>1&2,V=V>>>C,f=V>>>1&1,l=0,f=u[23620+((_|y|w|C|f)+(V>>>f)<<2)>>2]|0}f?ie=65:(w=l,y=g)}if((ie|0)==65)for(_=f;;)if(V=(u[_+4>>2]&-8)-B|0,f=V>>>0<g>>>0,g=f?V:g,l=f?_:l,f=u[_+16>>2]|0,f||(f=u[_+20>>2]|0),f)_=f;else{w=l,y=g;break}if((w|0)!=0&&y>>>0<((u[5831]|0)-B|0)>>>0&&(L=w+B|0,L>>>0>w>>>0)){_=u[w+24>>2]|0,A=u[w+12>>2]|0;do if((A|0)==(w|0)){if(l=w+20|0,A=u[l>>2]|0,!A&&(l=w+16|0,A=u[l>>2]|0,!A)){A=0;break}for(;;)if(g=A+20|0,f=u[g>>2]|0,f)A=f,l=g;else if(g=A+16|0,f=u[g>>2]|0,f)A=f,l=g;else break;u[l>>2]=0}else $=u[w+8>>2]|0,u[$+12>>2]=A,u[A+8>>2]=$;while(0);do if(_){if(l=u[w+28>>2]|0,f=23620+(l<<2)|0,(w|0)==(u[f>>2]|0)){if(u[f>>2]=A,!A){d=d&~(1<<l),u[5830]=d;break}}else if($=_+16|0,u[((u[$>>2]|0)==(w|0)?$:_+20|0)>>2]=A,!A)break;u[A+24>>2]=_,l=u[w+16>>2]|0,l|0&&(u[A+16>>2]=l,u[l+24>>2]=A),l=u[w+20>>2]|0,l&&(u[A+20>>2]=l,u[l+24>>2]=A)}while(0);e:do if(y>>>0<16)$=y+B|0,u[w+4>>2]=$|3,$=w+$+4|0,u[$>>2]=u[$>>2]|1;else{if(u[w+4>>2]=B|3,u[L+4>>2]=y|1,u[L+y>>2]=y,A=y>>>3,y>>>0<256){f=23356+(A<<1<<2)|0,l=u[5829]|0,A=1<<A,l&A?(l=f+8|0,A=u[l>>2]|0):(u[5829]=l|A,A=f,l=f+8|0),u[l>>2]=L,u[A+12>>2]=L,u[L+8>>2]=A,u[L+12>>2]=f;break}if(A=y>>>8,A?y>>>0>16777215?f=31:(Ae=(A+1048320|0)>>>16&8,$=A<<Ae,te=($+520192|0)>>>16&4,$=$<<te,f=($+245760|0)>>>16&2,f=14-(te|Ae|f)+($<<f>>>15)|0,f=y>>>(f+7|0)&1|f<<1):f=0,A=23620+(f<<2)|0,u[L+28>>2]=f,l=L+16|0,u[l+4>>2]=0,u[l>>2]=0,l=1<<f,!(d&l)){u[5830]=d|l,u[A>>2]=L,u[L+24>>2]=A,u[L+12>>2]=L,u[L+8>>2]=L;break}A=u[A>>2]|0;t:do if((u[A+4>>2]&-8|0)!=(y|0)){for(d=y<<((f|0)==31?0:25-(f>>>1)|0);f=A+16+(d>>>31<<2)|0,l=u[f>>2]|0,!!l;)if((u[l+4>>2]&-8|0)==(y|0)){A=l;break t}else d=d<<1,A=l;u[f>>2]=L,u[L+24>>2]=A,u[L+12>>2]=L,u[L+8>>2]=L;break e}while(0);Ae=A+8|0,$=u[Ae>>2]|0,u[$+12>>2]=L,u[Ae>>2]=L,u[L+8>>2]=$,u[L+12>>2]=A,u[L+24>>2]=0}while(0);return $=w+8|0,U=be,$|0}else V=B}else V=B;else V=-1;while(0);if(f=u[5831]|0,f>>>0>=V>>>0)return A=f-V|0,l=u[5834]|0,A>>>0>15?($=l+V|0,u[5834]=$,u[5831]=A,u[$+4>>2]=A|1,u[l+f>>2]=A,u[l+4>>2]=V|3):(u[5831]=0,u[5834]=0,u[l+4>>2]=f|3,$=l+f+4|0,u[$>>2]=u[$>>2]|1),$=l+8|0,U=be,$|0;if(y=u[5832]|0,y>>>0>V>>>0)return te=y-V|0,u[5832]=te,$=u[5835]|0,Ae=$+V|0,u[5835]=Ae,u[Ae+4>>2]=te|1,u[$+4>>2]=V|3,$=$+8|0,U=be,$|0;if(u[5947]|0?l=u[5949]|0:(u[5949]=4096,u[5948]=4096,u[5950]=-1,u[5951]=-1,u[5952]=0,u[5940]=0,u[5947]=W&-16^1431655768,l=4096),w=V+48|0,C=V+47|0,_=l+C|0,g=0-l|0,B=_&g,B>>>0<=V>>>0||(l=u[5939]|0,l|0&&(L=u[5937]|0,W=L+B|0,W>>>0<=L>>>0|W>>>0>l>>>0)))return $=0,U=be,$|0;e:do if(u[5940]&4)A=0,ie=143;else{f=u[5835]|0;t:do if(f){for(d=23764;W=u[d>>2]|0,!(W>>>0<=f>>>0&&(W+(u[d+4>>2]|0)|0)>>>0>f>>>0);)if(l=u[d+8>>2]|0,l)d=l;else{ie=128;break t}if(A=_-y&g,A>>>0<2147483647)if(l=Bs(A|0)|0,(l|0)==((u[d>>2]|0)+(u[d+4>>2]|0)|0)){if((l|0)!=-1){y=A,_=l,ie=145;break e}}else d=l,ie=136;else A=0}else ie=128;while(0);do if((ie|0)==128)if(f=Bs(0)|0,(f|0)!=-1&&(A=f,Y=u[5948]|0,re=Y+-1|0,A=((re&A|0)==0?0:(re+A&0-Y)-A|0)+B|0,Y=u[5937]|0,re=A+Y|0,A>>>0>V>>>0&A>>>0<2147483647)){if(W=u[5939]|0,W|0&&re>>>0<=Y>>>0|re>>>0>W>>>0){A=0;break}if(l=Bs(A|0)|0,(l|0)==(f|0)){y=A,_=f,ie=145;break e}else d=l,ie=136}else A=0;while(0);do if((ie|0)==136){if(f=0-A|0,!(w>>>0>A>>>0&(A>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){A=0;break}else{y=A,_=d,ie=145;break e}if(l=u[5949]|0,l=C-A+l&0-l,l>>>0>=2147483647){y=A,_=d,ie=145;break e}if((Bs(l|0)|0)==-1){Bs(f|0)|0,A=0;break}else{y=l+A|0,_=d,ie=145;break e}}while(0);u[5940]=u[5940]|4,ie=143}while(0);if((ie|0)==143&&B>>>0<2147483647&&(te=Bs(B|0)|0,re=Bs(0)|0,de=re-te|0,Te=de>>>0>(V+40|0)>>>0,!((te|0)==-1|Te^1|te>>>0<re>>>0&((te|0)!=-1&(re|0)!=-1)^1))&&(y=Te?de:A,_=te,ie=145),(ie|0)==145){A=(u[5937]|0)+y|0,u[5937]=A,A>>>0>(u[5938]|0)>>>0&&(u[5938]=A),C=u[5835]|0;e:do if(C){for(A=23764;;){if(l=u[A>>2]|0,f=u[A+4>>2]|0,(_|0)==(l+f|0)){ie=154;break}if(d=u[A+8>>2]|0,d)A=d;else break}if((ie|0)==154&&(Ae=A+4|0,(u[A+12>>2]&8|0)==0)&&_>>>0>C>>>0&l>>>0<=C>>>0){u[Ae>>2]=f+y,$=(u[5832]|0)+y|0,te=C+8|0,te=(te&7|0)==0?0:0-te&7,Ae=C+te|0,te=$-te|0,u[5835]=Ae,u[5832]=te,u[Ae+4>>2]=te|1,u[C+$+4>>2]=40,u[5836]=u[5951];break}for(_>>>0<(u[5833]|0)>>>0&&(u[5833]=_),f=_+y|0,A=23764;;){if((u[A>>2]|0)==(f|0)){ie=162;break}if(l=u[A+8>>2]|0,l)A=l;else break}if((ie|0)==162&&(u[A+12>>2]&8|0)==0){u[A>>2]=_,L=A+4|0,u[L>>2]=(u[L>>2]|0)+y,L=_+8|0,L=_+((L&7|0)==0?0:0-L&7)|0,A=f+8|0,A=f+((A&7|0)==0?0:0-A&7)|0,B=L+V|0,w=A-L-V|0,u[L+4>>2]=V|3;t:do if((C|0)==(A|0))$=(u[5832]|0)+w|0,u[5832]=$,u[5835]=B,u[B+4>>2]=$|1;else{if((u[5834]|0)==(A|0)){$=(u[5831]|0)+w|0,u[5831]=$,u[5834]=B,u[B+4>>2]=$|1,u[B+$>>2]=$;break}if(l=u[A+4>>2]|0,(l&3|0)==1){y=l&-8,d=l>>>3;n:do if(l>>>0<256)if(l=u[A+8>>2]|0,f=u[A+12>>2]|0,(f|0)==(l|0)){u[5829]=u[5829]&~(1<<d);break}else{u[l+12>>2]=f,u[f+8>>2]=l;break}else{_=u[A+24>>2]|0,l=u[A+12>>2]|0;do if((l|0)==(A|0)){if(f=A+16|0,d=f+4|0,l=u[d>>2]|0,l)f=d;else if(l=u[f>>2]|0,!l){l=0;break}for(;;)if(g=l+20|0,d=u[g>>2]|0,d)l=d,f=g;else if(g=l+16|0,d=u[g>>2]|0,d)l=d,f=g;else break;u[f>>2]=0}else $=u[A+8>>2]|0,u[$+12>>2]=l,u[l+8>>2]=$;while(0);if(!_)break;f=u[A+28>>2]|0,d=23620+(f<<2)|0;do if((u[d>>2]|0)!=(A|0)){if($=_+16|0,u[((u[$>>2]|0)==(A|0)?$:_+20|0)>>2]=l,!l)break n}else{if(u[d>>2]=l,l|0)break;u[5830]=u[5830]&~(1<<f);break n}while(0);if(u[l+24>>2]=_,f=A+16|0,d=u[f>>2]|0,d|0&&(u[l+16>>2]=d,u[d+24>>2]=l),f=u[f+4>>2]|0,!f)break;u[l+20>>2]=f,u[f+24>>2]=l}while(0);A=A+y|0,g=y+w|0}else g=w;if(A=A+4|0,u[A>>2]=u[A>>2]&-2,u[B+4>>2]=g|1,u[B+g>>2]=g,A=g>>>3,g>>>0<256){f=23356+(A<<1<<2)|0,l=u[5829]|0,A=1<<A,l&A?(l=f+8|0,A=u[l>>2]|0):(u[5829]=l|A,A=f,l=f+8|0),u[l>>2]=B,u[A+12>>2]=B,u[B+8>>2]=A,u[B+12>>2]=f;break}A=g>>>8;do if(!A)d=0;else{if(g>>>0>16777215){d=31;break}Ae=(A+1048320|0)>>>16&8,$=A<<Ae,te=($+520192|0)>>>16&4,$=$<<te,d=($+245760|0)>>>16&2,d=14-(te|Ae|d)+($<<d>>>15)|0,d=g>>>(d+7|0)&1|d<<1}while(0);if(A=23620+(d<<2)|0,u[B+28>>2]=d,l=B+16|0,u[l+4>>2]=0,u[l>>2]=0,l=u[5830]|0,f=1<<d,!(l&f)){u[5830]=l|f,u[A>>2]=B,u[B+24>>2]=A,u[B+12>>2]=B,u[B+8>>2]=B;break}A=u[A>>2]|0;n:do if((u[A+4>>2]&-8|0)!=(g|0)){for(d=g<<((d|0)==31?0:25-(d>>>1)|0);f=A+16+(d>>>31<<2)|0,l=u[f>>2]|0,!!l;)if((u[l+4>>2]&-8|0)==(g|0)){A=l;break n}else d=d<<1,A=l;u[f>>2]=B,u[B+24>>2]=A,u[B+12>>2]=B,u[B+8>>2]=B;break t}while(0);Ae=A+8|0,$=u[Ae>>2]|0,u[$+12>>2]=B,u[Ae>>2]=B,u[B+8>>2]=$,u[B+12>>2]=A,u[B+24>>2]=0}while(0);return $=L+8|0,U=be,$|0}for(A=23764;l=u[A>>2]|0,!(l>>>0<=C>>>0&&($=l+(u[A+4>>2]|0)|0,$>>>0>C>>>0));)A=u[A+8>>2]|0;g=$+-47|0,l=g+8|0,l=g+((l&7|0)==0?0:0-l&7)|0,g=C+16|0,l=l>>>0<g>>>0?C:l,A=l+8|0,f=y+-40|0,te=_+8|0,te=(te&7|0)==0?0:0-te&7,Ae=_+te|0,te=f-te|0,u[5835]=Ae,u[5832]=te,u[Ae+4>>2]=te|1,u[_+f+4>>2]=40,u[5836]=u[5951],f=l+4|0,u[f>>2]=27,u[A>>2]=u[5941],u[A+4>>2]=u[5942],u[A+8>>2]=u[5943],u[A+12>>2]=u[5944],u[5941]=_,u[5942]=y,u[5944]=0,u[5943]=A,A=l+24|0;do Ae=A,A=A+4|0,u[A>>2]=7;while((Ae+8|0)>>>0<$>>>0);if((l|0)!=(C|0)){if(_=l-C|0,u[f>>2]=u[f>>2]&-2,u[C+4>>2]=_|1,u[l>>2]=_,A=_>>>3,_>>>0<256){f=23356+(A<<1<<2)|0,l=u[5829]|0,A=1<<A,l&A?(l=f+8|0,A=u[l>>2]|0):(u[5829]=l|A,A=f,l=f+8|0),u[l>>2]=C,u[A+12>>2]=C,u[C+8>>2]=A,u[C+12>>2]=f;break}if(A=_>>>8,A?_>>>0>16777215?d=31:(Ae=(A+1048320|0)>>>16&8,$=A<<Ae,te=($+520192|0)>>>16&4,$=$<<te,d=($+245760|0)>>>16&2,d=14-(te|Ae|d)+($<<d>>>15)|0,d=_>>>(d+7|0)&1|d<<1):d=0,f=23620+(d<<2)|0,u[C+28>>2]=d,u[C+20>>2]=0,u[g>>2]=0,A=u[5830]|0,l=1<<d,!(A&l)){u[5830]=A|l,u[f>>2]=C,u[C+24>>2]=f,u[C+12>>2]=C,u[C+8>>2]=C;break}A=u[f>>2]|0;t:do if((u[A+4>>2]&-8|0)!=(_|0)){for(d=_<<((d|0)==31?0:25-(d>>>1)|0);f=A+16+(d>>>31<<2)|0,l=u[f>>2]|0,!!l;)if((u[l+4>>2]&-8|0)==(_|0)){A=l;break t}else d=d<<1,A=l;u[f>>2]=C,u[C+24>>2]=A,u[C+12>>2]=C,u[C+8>>2]=C;break e}while(0);Ae=A+8|0,$=u[Ae>>2]|0,u[$+12>>2]=C,u[Ae>>2]=C,u[C+8>>2]=$,u[C+12>>2]=A,u[C+24>>2]=0}}else $=u[5833]|0,($|0)==0|_>>>0<$>>>0&&(u[5833]=_),u[5941]=_,u[5942]=y,u[5944]=0,u[5838]=u[5947],u[5837]=-1,u[5842]=23356,u[5841]=23356,u[5844]=23364,u[5843]=23364,u[5846]=23372,u[5845]=23372,u[5848]=23380,u[5847]=23380,u[5850]=23388,u[5849]=23388,u[5852]=23396,u[5851]=23396,u[5854]=23404,u[5853]=23404,u[5856]=23412,u[5855]=23412,u[5858]=23420,u[5857]=23420,u[5860]=23428,u[5859]=23428,u[5862]=23436,u[5861]=23436,u[5864]=23444,u[5863]=23444,u[5866]=23452,u[5865]=23452,u[5868]=23460,u[5867]=23460,u[5870]=23468,u[5869]=23468,u[5872]=23476,u[5871]=23476,u[5874]=23484,u[5873]=23484,u[5876]=23492,u[5875]=23492,u[5878]=23500,u[5877]=23500,u[5880]=23508,u[5879]=23508,u[5882]=23516,u[5881]=23516,u[5884]=23524,u[5883]=23524,u[5886]=23532,u[5885]=23532,u[5888]=23540,u[5887]=23540,u[5890]=23548,u[5889]=23548,u[5892]=23556,u[5891]=23556,u[5894]=23564,u[5893]=23564,u[5896]=23572,u[5895]=23572,u[5898]=23580,u[5897]=23580,u[5900]=23588,u[5899]=23588,u[5902]=23596,u[5901]=23596,u[5904]=23604,u[5903]=23604,$=y+-40|0,te=_+8|0,te=(te&7|0)==0?0:0-te&7,Ae=_+te|0,te=$-te|0,u[5835]=Ae,u[5832]=te,u[Ae+4>>2]=te|1,u[_+$+4>>2]=40,u[5836]=u[5951];while(0);if(A=u[5832]|0,A>>>0>V>>>0)return te=A-V|0,u[5832]=te,$=u[5835]|0,Ae=$+V|0,u[5835]=Ae,u[Ae+4>>2]=te|1,u[$+4>>2]=V|3,$=$+8|0,U=be,$|0}return $=PR()|0,u[$>>2]=12,$=0,U=be,$|0}function Ke(l){l=l|0;var A=0,f=0,d=0,g=0,_=0,y=0,w=0,C=0;if(!l)return;f=l+-8|0,g=u[5833]|0,l=u[l+-4>>2]|0,A=l&-8,C=f+A|0;do if(l&1)w=f,y=f;else{if(d=u[f>>2]|0,!(l&3)||(y=f+(0-d)|0,_=d+A|0,y>>>0<g>>>0))return;if((u[5834]|0)==(y|0)){if(l=C+4|0,A=u[l>>2]|0,(A&3|0)!=3){w=y,A=_;break}u[5831]=_,u[l>>2]=A&-2,u[y+4>>2]=_|1,u[y+_>>2]=_;return}if(f=d>>>3,d>>>0<256)if(l=u[y+8>>2]|0,A=u[y+12>>2]|0,(A|0)==(l|0)){u[5829]=u[5829]&~(1<<f),w=y,A=_;break}else{u[l+12>>2]=A,u[A+8>>2]=l,w=y,A=_;break}g=u[y+24>>2]|0,l=u[y+12>>2]|0;do if((l|0)==(y|0)){if(A=y+16|0,f=A+4|0,l=u[f>>2]|0,l)A=f;else if(l=u[A>>2]|0,!l){l=0;break}for(;;)if(d=l+20|0,f=u[d>>2]|0,f)l=f,A=d;else if(d=l+16|0,f=u[d>>2]|0,f)l=f,A=d;else break;u[A>>2]=0}else w=u[y+8>>2]|0,u[w+12>>2]=l,u[l+8>>2]=w;while(0);if(g){if(A=u[y+28>>2]|0,f=23620+(A<<2)|0,(u[f>>2]|0)==(y|0)){if(u[f>>2]=l,!l){u[5830]=u[5830]&~(1<<A),w=y,A=_;break}}else if(w=g+16|0,u[((u[w>>2]|0)==(y|0)?w:g+20|0)>>2]=l,!l){w=y,A=_;break}u[l+24>>2]=g,A=y+16|0,f=u[A>>2]|0,f|0&&(u[l+16>>2]=f,u[f+24>>2]=l),A=u[A+4>>2]|0,A?(u[l+20>>2]=A,u[A+24>>2]=l,w=y,A=_):(w=y,A=_)}else w=y,A=_}while(0);if(y>>>0>=C>>>0||(l=C+4|0,d=u[l>>2]|0,!(d&1)))return;if(d&2)u[l>>2]=d&-2,u[w+4>>2]=A|1,u[y+A>>2]=A,g=A;else{if((u[5835]|0)==(C|0)){if(C=(u[5832]|0)+A|0,u[5832]=C,u[5835]=w,u[w+4>>2]=C|1,(w|0)!=(u[5834]|0))return;u[5834]=0,u[5831]=0;return}if((u[5834]|0)==(C|0)){C=(u[5831]|0)+A|0,u[5831]=C,u[5834]=y,u[w+4>>2]=C|1,u[y+C>>2]=C;return}g=(d&-8)+A|0,f=d>>>3;do if(d>>>0<256)if(A=u[C+8>>2]|0,l=u[C+12>>2]|0,(l|0)==(A|0)){u[5829]=u[5829]&~(1<<f);break}else{u[A+12>>2]=l,u[l+8>>2]=A;break}else{_=u[C+24>>2]|0,l=u[C+12>>2]|0;do if((l|0)==(C|0)){if(A=C+16|0,f=A+4|0,l=u[f>>2]|0,l)A=f;else if(l=u[A>>2]|0,!l){f=0;break}for(;;)if(d=l+20|0,f=u[d>>2]|0,f)l=f,A=d;else if(d=l+16|0,f=u[d>>2]|0,f)l=f,A=d;else break;u[A>>2]=0,f=l}else f=u[C+8>>2]|0,u[f+12>>2]=l,u[l+8>>2]=f,f=l;while(0);if(_|0){if(l=u[C+28>>2]|0,A=23620+(l<<2)|0,(u[A>>2]|0)==(C|0)){if(u[A>>2]=f,!f){u[5830]=u[5830]&~(1<<l);break}}else if(d=_+16|0,u[((u[d>>2]|0)==(C|0)?d:_+20|0)>>2]=f,!f)break;u[f+24>>2]=_,l=C+16|0,A=u[l>>2]|0,A|0&&(u[f+16>>2]=A,u[A+24>>2]=f),l=u[l+4>>2]|0,l|0&&(u[f+20>>2]=l,u[l+24>>2]=f)}}while(0);if(u[w+4>>2]=g|1,u[y+g>>2]=g,(w|0)==(u[5834]|0)){u[5831]=g;return}}if(l=g>>>3,g>>>0<256){f=23356+(l<<1<<2)|0,A=u[5829]|0,l=1<<l,A&l?(A=f+8|0,l=u[A>>2]|0):(u[5829]=A|l,l=f,A=f+8|0),u[A>>2]=w,u[l+12>>2]=w,u[w+8>>2]=l,u[w+12>>2]=f;return}l=g>>>8,l?g>>>0>16777215?d=31:(y=(l+1048320|0)>>>16&8,C=l<<y,_=(C+520192|0)>>>16&4,C=C<<_,d=(C+245760|0)>>>16&2,d=14-(_|y|d)+(C<<d>>>15)|0,d=g>>>(d+7|0)&1|d<<1):d=0,l=23620+(d<<2)|0,u[w+28>>2]=d,u[w+20>>2]=0,u[w+16>>2]=0,A=u[5830]|0,f=1<<d;e:do if(!(A&f))u[5830]=A|f,u[l>>2]=w,u[w+24>>2]=l,u[w+12>>2]=w,u[w+8>>2]=w;else{l=u[l>>2]|0;t:do if((u[l+4>>2]&-8|0)!=(g|0)){for(d=g<<((d|0)==31?0:25-(d>>>1)|0);f=l+16+(d>>>31<<2)|0,A=u[f>>2]|0,!!A;)if((u[A+4>>2]&-8|0)==(g|0)){l=A;break t}else d=d<<1,l=A;u[f>>2]=w,u[w+24>>2]=l,u[w+12>>2]=w,u[w+8>>2]=w;break e}while(0);y=l+8|0,C=u[y>>2]|0,u[C+12>>2]=w,u[y>>2]=w,u[w+8>>2]=C,u[w+12>>2]=l,u[w+24>>2]=0}while(0);if(C=(u[5837]|0)+-1|0,u[5837]=C,!(C|0)){for(l=23772;l=u[l>>2]|0,l;)l=l+8|0;u[5837]=-1}}function gi(l,A){l=l|0,A=A|0;var f=0;return l?(f=Bn(A,l)|0,(A|l)>>>0>65535&&(f=((f>>>0)/(l>>>0)|0|0)==(A|0)?f:-1)):f=0,l=ki(f)|0,!l||!(u[l+-4>>2]&3)||mi(l|0,0,f|0)|0,l|0}function IR(l,A,f,d){return l=l|0,A=A|0,f=f|0,d=d|0,f=l+f>>>0,De(A+d+(f>>>0<l>>>0|0)>>>0|0),f|0|0}function yc(l,A,f,d){return l=l|0,A=A|0,f=f|0,d=d|0,d=A-d-(f>>>0>l>>>0|0)>>>0,De(d|0),l-f>>>0|0|0}function f2(l){return l=l|0,(l?31-(xr(l^l-1)|0)|0:32)|0}function BR(l,A,f,d,g){l=l|0,A=A|0,f=f|0,d=d|0,g=g|0;var _=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0;if(L=l,C=A,B=C,y=f,W=d,w=W,!B)return _=(g|0)!=0,w?_?(u[g>>2]=l|0,u[g+4>>2]=A&0,W=0,g=0,De(W|0),g|0):(W=0,g=0,De(W|0),g|0):(_&&(u[g>>2]=(L>>>0)%(y>>>0),u[g+4>>2]=0),W=0,g=(L>>>0)/(y>>>0)>>>0,De(W|0),g|0);_=(w|0)==0;do if(y){if(!_){if(_=(xr(w|0)|0)-(xr(B|0)|0)|0,_>>>0<=31){V=_+1|0,w=31-_|0,A=_-31>>31,y=V,l=L>>>(V>>>0)&A|B<<w,A=B>>>(V>>>0)&A,_=0,w=L<<w;break}return g?(u[g>>2]=l|0,u[g+4>>2]=C|A&0,W=0,g=0,De(W|0),g|0):(W=0,g=0,De(W|0),g|0)}if(_=y-1|0,_&y|0){w=(xr(y|0)|0)+33-(xr(B|0)|0)|0,re=64-w|0,V=32-w|0,C=V>>31,Y=w-32|0,A=Y>>31,y=w,l=V-1>>31&B>>>(Y>>>0)|(B<<V|L>>>(w>>>0))&A,A=A&B>>>(w>>>0),_=L<<re&C,w=(B<<re|L>>>(Y>>>0))&C|L<<V&w-33>>31;break}return g|0&&(u[g>>2]=_&L,u[g+4>>2]=0),(y|0)==1?(Y=C|A&0,re=l|0|0,De(Y|0),re|0):(re=f2(y|0)|0,Y=B>>>(re>>>0)|0,re=B<<32-re|L>>>(re>>>0)|0,De(Y|0),re|0)}else{if(_)return g|0&&(u[g>>2]=(B>>>0)%(y>>>0),u[g+4>>2]=0),Y=0,re=(B>>>0)/(y>>>0)>>>0,De(Y|0),re|0;if(!L)return g|0&&(u[g>>2]=0,u[g+4>>2]=(B>>>0)%(w>>>0)),Y=0,re=(B>>>0)/(w>>>0)>>>0,De(Y|0),re|0;if(_=w-1|0,!(_&w))return g|0&&(u[g>>2]=l|0,u[g+4>>2]=_&B|A&0),Y=0,re=B>>>((f2(w|0)|0)>>>0),De(Y|0),re|0;if(_=(xr(w|0)|0)-(xr(B|0)|0)|0,_>>>0<=30){A=_+1|0,w=31-_|0,y=A,l=B<<w|L>>>(A>>>0),A=B>>>(A>>>0),_=0,w=L<<w;break}return g?(u[g>>2]=l|0,u[g+4>>2]=C|A&0,Y=0,re=0,De(Y|0),re|0):(Y=0,re=0,De(Y|0),re|0)}while(0);if(!y)B=w,C=0,w=0;else{V=f|0|0,L=W|d&0,B=IR(V|0,L|0,-1,-1)|0,f=j()|0,C=w,w=0;do d=C,C=_>>>31|C<<1,_=w|_<<1,d=l<<1|d>>>31|0,W=l>>>31|A<<1|0,yc(B|0,f|0,d|0,W|0)|0,re=j()|0,Y=re>>31|((re|0)<0?-1:0)<<1,w=Y&1,l=yc(d|0,W|0,Y&V|0,(((re|0)<0?-1:0)>>31|((re|0)<0?-1:0)<<1)&L|0)|0,A=j()|0,y=y-1|0;while((y|0)!=0);B=C,C=0}return y=0,g|0&&(u[g>>2]=l,u[g+4>>2]=A),Y=(_|0)>>>31|(B|y)<<1|(y<<1|_>>>31)&0|C,re=(_<<1|0>>>31)&-2|w,De(Y|0),re|0}function Is(l,A,f,d){l=l|0,A=A|0,f=f|0,d=d|0;var g=0,_=0;return _=U,U=U+16|0,g=_|0,BR(l,A,f,d,g)|0,U=_,De(u[g+4>>2]|0),u[g>>2]|0|0}function he(l,A,f){return l=l|0,A=A|0,f=f|0,(f|0)<32?(De(A>>>f|0),l>>>f|(A&(1<<f)-1)<<32-f):(De(0),A>>>f-32|0)}function we(l,A,f){return l=l|0,A=A|0,f=f|0,(f|0)<32?(De(A<<f|(l&(1<<f)-1<<32-f)>>>32-f|0),l<<f):(De(l<<f-32|0),0)}function h2(l,A){return l=+l,A=+A,l!=l?+A:A!=A?+l:+di(+l,+A)}function Ju(l){return l=+l,l>=0?+ht(l+.5):+hi(l-.5)}function Ku(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0;if((f|0)>=8192)return Cr(l|0,A|0,f|0)|0,l|0;if(_=l|0,g=l+f|0,(l&3)==(A&3)){for(;l&3;){if(!f)return _|0;Ge[l>>0]=Ge[A>>0]|0,l=l+1|0,A=A+1|0,f=f-1|0}for(f=g&-4|0,d=f-64|0;(l|0)<=(d|0);)u[l>>2]=u[A>>2],u[l+4>>2]=u[A+4>>2],u[l+8>>2]=u[A+8>>2],u[l+12>>2]=u[A+12>>2],u[l+16>>2]=u[A+16>>2],u[l+20>>2]=u[A+20>>2],u[l+24>>2]=u[A+24>>2],u[l+28>>2]=u[A+28>>2],u[l+32>>2]=u[A+32>>2],u[l+36>>2]=u[A+36>>2],u[l+40>>2]=u[A+40>>2],u[l+44>>2]=u[A+44>>2],u[l+48>>2]=u[A+48>>2],u[l+52>>2]=u[A+52>>2],u[l+56>>2]=u[A+56>>2],u[l+60>>2]=u[A+60>>2],l=l+64|0,A=A+64|0;for(;(l|0)<(f|0);)u[l>>2]=u[A>>2],l=l+4|0,A=A+4|0}else for(f=g-4|0;(l|0)<(f|0);)Ge[l>>0]=Ge[A>>0]|0,Ge[l+1>>0]=Ge[A+1>>0]|0,Ge[l+2>>0]=Ge[A+2>>0]|0,Ge[l+3>>0]=Ge[A+3>>0]|0,l=l+4|0,A=A+4|0;for(;(l|0)<(g|0);)Ge[l>>0]=Ge[A>>0]|0,l=l+1|0,A=A+1|0;return _|0}function mi(l,A,f){l=l|0,A=A|0,f=f|0;var d=0,g=0,_=0,y=0;if(_=l+f|0,A=A&255,(f|0)>=67){for(;l&3;)Ge[l>>0]=A,l=l+1|0;for(d=_&-4|0,y=A|A<<8|A<<16|A<<24,g=d-64|0;(l|0)<=(g|0);)u[l>>2]=y,u[l+4>>2]=y,u[l+8>>2]=y,u[l+12>>2]=y,u[l+16>>2]=y,u[l+20>>2]=y,u[l+24>>2]=y,u[l+28>>2]=y,u[l+32>>2]=y,u[l+36>>2]=y,u[l+40>>2]=y,u[l+44>>2]=y,u[l+48>>2]=y,u[l+52>>2]=y,u[l+56>>2]=y,u[l+60>>2]=y,l=l+64|0;for(;(l|0)<(d|0);)u[l>>2]=y,l=l+4|0}for(;(l|0)<(_|0);)Ge[l>>0]=A,l=l+1|0;return _-f|0}function d2(l){return l=+l,l>=0?+ht(l+.5):+hi(l-.5)}function Bs(l){l=l|0;var A=0,f=0,d=0;return d=_a()|0,f=u[At>>2]|0,A=f+l|0,(l|0)>0&(A|0)<(f|0)|(A|0)<0?(Ac(A|0)|0,cc(12),-1):(A|0)>(d|0)&&!(va(A|0)|0)?(cc(12),-1):(u[At>>2]=A,f|0)}return{___uremdi3:Is,_bitshift64Lshr:he,_bitshift64Shl:we,_calloc:gi,_cellAreaKm2:FL,_cellAreaM2:DL,_cellAreaRads2:OL,_compact:jL,_destroyLinkedPolygon:oR,_edgeLengthKm:BL,_edgeLengthM:LL,_emscripten_replace_memory:uc,_exactEdgeLengthKm:NL,_exactEdgeLengthM:UL,_exactEdgeLengthRads:kL,_experimentalH3ToLocalIj:aR,_experimentalLocalIjToH3:lR,_free:Ke,_geoToH3:qv,_getDestinationH3IndexFromUnidirectionalEdge:eR,_getH3IndexesFromUnidirectionalEdge:nR,_getH3UnidirectionalEdge:ZL,_getH3UnidirectionalEdgeBoundary:$u,_getH3UnidirectionalEdgesFromHexagon:rR,_getOriginH3IndexFromUnidirectionalEdge:qL,_getPentagonIndexes:cp,_getRes0Indexes:dL,_h3Distance:cR,_h3GetBaseCell:Kv,_h3GetFaces:e2,_h3GetResolution:zL,_h3IndexesAreNeighbors:t2,_h3IsPentagon:vn,_h3IsResClassIII:$L,_h3IsValid:Zv,_h3Line:uR,_h3LineSize:AR,_h3SetToLinkedGeo:un,_h3ToCenterChild:HL,_h3ToChildren:hr,_h3ToGeo:So,_h3ToGeoBoundary:Po,_h3ToParent:sp,_h3UnidirectionalEdgeIsValid:tR,_hexAreaKm2:ML,_hexAreaM2:IL,_hexRing:F,_i64Subtract:yc,_kRing:wa,_kRingDistances:Hu,_llvm_minnum_f64:h2,_llvm_round_f64:Ju,_malloc:ki,_maxFaceCount:JL,_maxH3ToChildrenSize:VL,_maxKringSize:Vu,_maxPolyfillSize:H,_maxUncompactSize:QL,_memcpy:Ku,_memset:mi,_numHexagons:RL,_pentagonIndexCount:KL,_pointDistKm:gc,_pointDistM:CL,_pointDistRads:xL,_polyfill:q,_res0IndexCount:hL,_round:d2,_sbrk:Bs,_sizeOfCoordIJ:vR,_sizeOfGeoBoundary:gR,_sizeOfGeoCoord:pR,_sizeOfGeoPolygon:yR,_sizeOfGeofence:mR,_sizeOfH3Index:dR,_sizeOfLinkedGeoPolygon:_R,_uncompact:WL,establishStackSpace:Z0,stackAlloc:fc,stackRestore:pi,stackSave:Ea}}(Du,ku,D);e.___uremdi3=ge.___uremdi3,e._bitshift64Lshr=ge._bitshift64Lshr,e._bitshift64Shl=ge._bitshift64Shl,e._calloc=ge._calloc,e._cellAreaKm2=ge._cellAreaKm2,e._cellAreaM2=ge._cellAreaM2,e._cellAreaRads2=ge._cellAreaRads2,e._compact=ge._compact,e._destroyLinkedPolygon=ge._destroyLinkedPolygon,e._edgeLengthKm=ge._edgeLengthKm,e._edgeLengthM=ge._edgeLengthM;var J0=e._emscripten_replace_memory=ge._emscripten_replace_memory;e._exactEdgeLengthKm=ge._exactEdgeLengthKm,e._exactEdgeLengthM=ge._exactEdgeLengthM,e._exactEdgeLengthRads=ge._exactEdgeLengthRads,e._experimentalH3ToLocalIj=ge._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=ge._experimentalLocalIjToH3,e._free=ge._free,e._geoToH3=ge._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=ge._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=ge._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=ge._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=ge._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=ge._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=ge._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=ge._getPentagonIndexes,e._getRes0Indexes=ge._getRes0Indexes,e._h3Distance=ge._h3Distance,e._h3GetBaseCell=ge._h3GetBaseCell,e._h3GetFaces=ge._h3GetFaces,e._h3GetResolution=ge._h3GetResolution,e._h3IndexesAreNeighbors=ge._h3IndexesAreNeighbors,e._h3IsPentagon=ge._h3IsPentagon,e._h3IsResClassIII=ge._h3IsResClassIII,e._h3IsValid=ge._h3IsValid,e._h3Line=ge._h3Line,e._h3LineSize=ge._h3LineSize,e._h3SetToLinkedGeo=ge._h3SetToLinkedGeo,e._h3ToCenterChild=ge._h3ToCenterChild,e._h3ToChildren=ge._h3ToChildren,e._h3ToGeo=ge._h3ToGeo,e._h3ToGeoBoundary=ge._h3ToGeoBoundary,e._h3ToParent=ge._h3ToParent,e._h3UnidirectionalEdgeIsValid=ge._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=ge._hexAreaKm2,e._hexAreaM2=ge._hexAreaM2,e._hexRing=ge._hexRing,e._i64Subtract=ge._i64Subtract,e._kRing=ge._kRing,e._kRingDistances=ge._kRingDistances,e._llvm_minnum_f64=ge._llvm_minnum_f64,e._llvm_round_f64=ge._llvm_round_f64,e._malloc=ge._malloc,e._maxFaceCount=ge._maxFaceCount,e._maxH3ToChildrenSize=ge._maxH3ToChildrenSize,e._maxKringSize=ge._maxKringSize,e._maxPolyfillSize=ge._maxPolyfillSize,e._maxUncompactSize=ge._maxUncompactSize,e._memcpy=ge._memcpy,e._memset=ge._memset,e._numHexagons=ge._numHexagons,e._pentagonIndexCount=ge._pentagonIndexCount,e._pointDistKm=ge._pointDistKm,e._pointDistM=ge._pointDistM,e._pointDistRads=ge._pointDistRads,e._polyfill=ge._polyfill,e._res0IndexCount=ge._res0IndexCount,e._round=ge._round,e._sbrk=ge._sbrk,e._sizeOfCoordIJ=ge._sizeOfCoordIJ,e._sizeOfGeoBoundary=ge._sizeOfGeoBoundary,e._sizeOfGeoCoord=ge._sizeOfGeoCoord,e._sizeOfGeoPolygon=ge._sizeOfGeoPolygon,e._sizeOfGeofence=ge._sizeOfGeofence,e._sizeOfH3Index=ge._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=ge._sizeOfLinkedGeoPolygon,e._uncompact=ge._uncompact,e.establishStackSpace=ge.establishStackSpace;var Nu=e.stackAlloc=ge.stackAlloc,K0=e.stackRestore=ge.stackRestore,Uu=e.stackSave=ge.stackSave;if(e.asm=ge,e.cwrap=M,e.setValue=E,e.getValue=b,e.getTempRet0=m,_t){fi(_t)||(_t=s(_t));{$r();var ac=function(J){J.byteLength&&(J=new Uint8Array(J)),se.set(J,v),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,ir()},Gu=function(){o(_t,ac,function(){throw"could not load memory initializer "+_t})},zu=oc(_t);if(zu)ac(zu.buffer);else if(e.memoryInitializerRequest){var To=function(){var J=e.memoryInitializerRequest,ae=J.response;if(J.status!==200&&J.status!==0){var me=oc(e.memoryInitializerRequestURL);if(me)ae=me.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+J.status+", retrying "+_t),Gu();return}}ac(ae)};e.memoryInitializerRequest.response?setTimeout(To,0):e.memoryInitializerRequest.addEventListener("load",To)}else Gu()}}var ma;rr=function J(){ma||lc(),ma||(rr=J)};function lc(J){if(sn>0||(Tt(),sn>0))return;function ae(){ma||(ma=!0,!x&&(Ut(),ot(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Gt()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),ae()},1)):ae()}e.run=lc;function Fi(J){throw e.onAbort&&e.onAbort(J),J+="",a(J),c(J),x=!0,"abort("+J+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Fi,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return lc(),t}(typeof Kt=="object"?Kt:{}),Ne="number",Fc=Ne,je=Ne,qe=Ne,pr=Ne,ft=Ne,HQ=[["sizeOfH3Index",Ne],["sizeOfGeoCoord",Ne],["sizeOfGeoBoundary",Ne],["sizeOfGeoPolygon",Ne],["sizeOfGeofence",Ne],["sizeOfLinkedGeoPolygon",Ne],["sizeOfCoordIJ",Ne],["h3IsValid",Fc,[je,qe]],["geoToH3",je,[Ne,Ne,pr]],["h3ToGeo",null,[je,qe,ft]],["h3ToGeoBoundary",null,[je,qe,ft]],["maxKringSize",Ne,[Ne]],["kRing",null,[je,qe,Ne,ft]],["kRingDistances",null,[je,qe,Ne,ft,ft]],["hexRing",null,[je,qe,Ne,ft]],["maxPolyfillSize",Ne,[ft,pr]],["polyfill",null,[ft,pr,ft]],["h3SetToLinkedGeo",null,[ft,Ne,ft]],["destroyLinkedPolygon",null,[ft]],["compact",Ne,[ft,ft,Ne]],["uncompact",Ne,[ft,Ne,ft,Ne,pr]],["maxUncompactSize",Ne,[ft,Ne,pr]],["h3IsPentagon",Fc,[je,qe]],["h3IsResClassIII",Fc,[je,qe]],["h3GetBaseCell",Ne,[je,qe]],["h3GetResolution",Ne,[je,qe]],["maxFaceCount",Ne,[je,qe]],["h3GetFaces",null,[je,qe,ft]],["h3ToParent",je,[je,qe,pr]],["h3ToChildren",null,[je,qe,pr,ft]],["h3ToCenterChild",je,[je,qe,pr]],["maxH3ToChildrenSize",Ne,[je,qe,pr]],["h3IndexesAreNeighbors",Fc,[je,qe,je,qe]],["getH3UnidirectionalEdge",je,[je,qe,je,qe]],["getOriginH3IndexFromUnidirectionalEdge",je,[je,qe]],["getDestinationH3IndexFromUnidirectionalEdge",je,[je,qe]],["h3UnidirectionalEdgeIsValid",Fc,[je,qe]],["getH3IndexesFromUnidirectionalEdge",null,[je,qe,ft]],["getH3UnidirectionalEdgesFromHexagon",null,[je,qe,ft]],["getH3UnidirectionalEdgeBoundary",null,[je,qe,ft]],["h3Distance",Ne,[je,qe,je,qe]],["h3Line",Ne,[je,qe,je,qe,ft]],["h3LineSize",Ne,[je,qe,je,qe]],["experimentalH3ToLocalIj",Ne,[je,qe,je,qe,ft]],["experimentalLocalIjToH3",Ne,[je,qe,ft,ft]],["hexAreaM2",Ne,[pr]],["hexAreaKm2",Ne,[pr]],["edgeLengthM",Ne,[pr]],["edgeLengthKm",Ne,[pr]],["pointDistM",Ne,[ft,ft]],["pointDistKm",Ne,[ft,ft]],["pointDistRads",Ne,[ft,ft]],["cellAreaM2",Ne,[je,qe]],["cellAreaKm2",Ne,[je,qe]],["cellAreaRads2",Ne,[je,qe]],["exactEdgeLengthM",Ne,[je,qe]],["exactEdgeLengthKm",Ne,[je,qe]],["exactEdgeLengthRads",Ne,[je,qe]],["numHexagons",Ne,[pr]],["getRes0Indexes",null,[ft]],["res0IndexCount",Ne],["getPentagonIndexes",null,[Ne,ft]],["pentagonIndexCount",Ne]],Sn={};HQ.forEach(function(e){Sn[e[0]]=Kt.cwrap.apply(Kt,e)});var Al=16,jQ=4,Ab=4,Hl=8,WQ=Sn.sizeOfH3Index(),cI=Sn.sizeOfGeoCoord(),QQ=Sn.sizeOfGeoBoundary();Sn.sizeOfGeoPolygon();Sn.sizeOfGeofence();var $Q=Sn.sizeOfLinkedGeoPolygon();Sn.sizeOfCoordIJ();var ub={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function XQ(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var YQ=/[^0-9a-fA-F]/;function la(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||YQ.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),Al),n=parseInt(t.substring(t.length-8),Al);return[n,e]}function fb(t){if(t>=0)return t.toString(Al);t=t&2147483647;var e=AI(8,t.toString(Al)),n=(parseInt(e[0],Al)+8).toString(Al);return e=n+e.substring(1),e}function JQ(t,e){return fb(e)+AI(8,fb(t))}function AI(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function KQ(t){var e=Kt.getTempRet0();return[t,e]}function ZQ(t){var e=KQ(t),n=e[0],r=e[1];return r?JQ(n,r):null}function qQ(t,e,n){Kt.HEAPU32.set(la(t),e/jQ+2*n)}function e$(t,e){for(var n=e.length,r=0;r<n;r++)qQ(e[r],t,r)}function Id(t){return u$(Kt.getValue(t,"double"))}function Y_(t){return[Id(t),Id(t+Hl)]}function uI(t){return[Id(t+Hl),Id(t)]}function t$(t,e,n){for(var r=Kt.getValue(t,"i32"),i=t+Hl,s=[],o=e?uI:Y_,a=0;a<r*2;a+=2)s.push(o(i+Hl*a));return n&&s.push(s[0]),s}function n$(t,e){for(var n=[],r=e?uI:Y_,i,s,o,a;t;){for(n.push(i=[]),s=Kt.getValue(t,"i8*");s;){for(i.push(o=[]),a=Kt.getValue(s,"i8*");a;)o.push(r(a)),a=Kt.getValue(a+Hl*2,"i8*");e&&o.push(o[0]),s=Kt.getValue(s+Ab*2,"i8*")}t=Kt.getValue(t+Ab*2,"i8*")}return n}function r$(t){var e=la(t),n=e[0],r=e[1];return Boolean(Sn.h3IsPentagon(n,r))}function i$(t){var e=la(t),n=e[0],r=e[1];return Sn.h3IsValid(n,r)?Sn.h3GetResolution(n,r):-1}function s$(t,e,n){var r=Kt._malloc(cI);Kt.HEAPF64.set([t,e].map(A$),r/Hl);var i=ZQ(Sn.geoToH3(r,n));return Kt._free(r),i}function J_(t){var e=Kt._malloc(cI),n=la(t),r=n[0],i=n[1];Sn.h3ToGeo(r,i,e);var s=Y_(e);return Kt._free(e),s}function o$(t,e){var n=Kt._malloc(QQ),r=la(t),i=r[0],s=r[1];Sn.h3ToGeoBoundary(i,s,n);var o=t$(n,e,e);return Kt._free(n),o}function a$(t,e){if(!t||!t.length)return[];var n=t.length,r=Kt._calloc(n,WQ);e$(r,t);var i=Kt._calloc($Q),s=i;Sn.h3SetToLinkedGeo(r,n,i);var o=n$(i,e);return Sn.destroyLinkedPolygon(s),Kt._free(s),Kt._free(r),o}function l$(t,e){var n=la(t),r=n[0],i=n[1],s=la(e),o=s[0],a=s[1];return Sn.h3Distance(r,i,o,a)}function c$(t,e){switch(XQ(t),e){case ub.m:return Sn.edgeLengthM(t);case ub.km:return Sn.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function A$(t){return t*Math.PI/180}function u$(t){return t*180/Math.PI}const f$={getHexagons:{type:"accessor",value:t=>t.hexagons}};class fI extends nc{initializeState(){rc._checkH3Lib()}updateState({props:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagons){const{data:r,getHexagons:i}=e,s=[],{iterable:o,objectInfo:a}=_o(r);for(const c of o){a.index++;const h=i(c,a),p=a$(h,!0);for(const m of p)s.push(this.getSubLayerRow({polygon:m},c,a.index))}this.setState({polygons:s})}}indexToBounds(){return{data:this.state.polygons,getPolygon:e=>e.polygon}}}T(fI,"layerName","H3ClusterLayer");T(fI,"defaultProps",f$);const h$=10;function hI(t,e){e=e===void 0?t[0][0]:e;for(const n of t){const r=n[0]-e;r>180?n[0]-=360:r<-180&&(n[0]+=360)}}function d$(t,e,n){const[r,i]=J_(t),s=e.length;hI(e,i);const o=e[0]===e[s-1]?s-1:s;for(let a=0;a<o;a++)e[a][0]=Ii(i,e[a][0],n),e[a][1]=Ii(r,e[a][1],n)}function p$(t,e,n){const r=t(e,n),[i,s]=J_(r);return[s,i]}function hb(t,e=1){const n=o$(t,!0);return e!==1?d$(t,n,e):hI(n),n}function g$(t){const e=new Float64Array(t.length*2);let n=0;for(const r of t)e[n++]=r[0],e[n++]=r[1];return e}function m$(t,e){let n;return t==null?n=e:typeof t=="object"?n={...t,coverage:e}:n={getHexagon:t,coverage:e},n}const y$={...tc.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class rc extends xs{constructor(...e){super(...e),T(this,"state",void 0)}initializeState(){rc._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:e}){return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}updateState({props:e,changeFlags:n}){if(e.highPrecision!==!0&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){const r=this._calculateH3DataProps();this.setState(r)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,n=!1,r=!1;const{iterable:i,objectInfo:s}=_o(this.props.data);for(const o of i){s.index++;const a=this.props.getHexagon(o,s),c=i$(a);if(e<0){if(e=c,!this.props.highPrecision)break}else if(e!==c){r=!0;break}if(r$(a)){n=!0;break}}return{resolution:e,edgeLengthKM:e>=0?c$(e,"km"):0,hasMultipleRes:r,hasPentagon:n}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){const{resolution:e,hasPentagon:n,hasMultipleRes:r}=this.state,{viewport:i}=this.context;return Boolean(i==null?void 0:i.resolution)||r||n||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;const{resolution:n,edgeLengthKM:r,centerHex:i}=this.state;if(n<0)return;const s=this.props.centerHexagon||s$(e.latitude,e.longitude,n);if(i===s)return;if(i){const v=l$(i,s);if(v>=0&&v*r<h$)return}const{unitsPerMeter:o}=e.distanceScales;let a=hb(s);const[c,h]=J_(s),[p,m]=e.projectFlat([h,c]);a=a.map(v=>{const E=e.projectFlat(v);return[(E[0]-p)/o[0],(E[1]-m)/o[1]]}),this.setState({centerHex:s,vertices:a})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:e,material:n,coverage:r,extruded:i,wireframe:s,stroked:o,filled:a,lineWidthUnits:c,lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:m,getFillColor:v,getElevation:E,getLineColor:b,getLineWidth:x,transitions:I,updateTriggers:S}=this.props;return{elevationScale:e,extruded:i,coverage:r,wireframe:s,stroked:o,filled:a,lineWidthUnits:c,lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:m,material:n,getElevation:E,getFillColor:v,getLineColor:b,getLineWidth:x,transitions:I,updateTriggers:{getFillColor:S.getFillColor,getElevation:S.getElevation,getLineColor:S.getLineColor,getLineWidth:S.getLineWidth}}}_renderPolygonLayer(){const{data:e,getHexagon:n,updateTriggers:r,coverage:i}=this.props,s=this.getSubLayerClass("hexagon-cell-hifi",tc),o=this._getForwardProps();return o.updateTriggers.getPolygon=m$(r.getHexagon,i),new s(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(a,c)=>{const h=n(a,c);return g$(hb(h,i))}})}_renderColumnLayer(){const{data:e,getHexagon:n,updateTriggers:r}=this.props,i=this.getSubLayerClass("hexagon-cell",y0),s=this._getForwardProps();return s.updateTriggers.getPosition=r.getHexagon,new i(s,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:s.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:p$.bind(null,n)})}}T(rc,"defaultProps",y$);T(rc,"layerName","H3HexagonLayer");T(rc,"_checkH3Lib",()=>{});const Tg=Math.PI/180,Hf=new Float32Array(16),db=new Float32Array(12);function pb(t,e,n){const r=e[0]*Tg,i=e[1]*Tg,s=e[2]*Tg,o=Math.sin(s),a=Math.sin(r),c=Math.sin(i),h=Math.cos(s),p=Math.cos(r),m=Math.cos(i),v=n[0],E=n[1],b=n[2];t[0]=v*m*p,t[1]=v*c*p,t[2]=v*-a,t[3]=E*(-c*h+m*a*o),t[4]=E*(m*h+c*a*o),t[5]=E*p*o,t[6]=b*(c*o+m*a*h),t[7]=b*(-m*o+c*a*h),t[8]=b*p*h}function gb(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const dI={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,c=Array.isArray(a),h=c&&a.length===16,p=Array.isArray(s),m=Array.isArray(i),v=Array.isArray(o),E=h||!c&&Boolean(a(r[0]));E?t.constant=h:t.constant=m&&p&&v;const b=t.value;if(t.constant){let x;E?(Hf.set(a),x=gb(Hf)):(x=db,pb(x,i,s),x.set(o,9)),t.value=new Float32Array(x)}else{let x=e*t.size;const{iterable:I,objectInfo:S}=_o(r,e,n);for(const P of I){S.index++;let M;if(E)Hf.set(h?a:a(P,S)),M=gb(Hf);else{M=db;const O=m?i:i(P,S),N=p?s:s(P,S);pb(M,O,N),M.set(v?o:o(P,S),9)}b[x++]=M[0],b[x++]=M[1],b[x++]=M[2],b[x++]=M[3],b[x++]=M[4],b[x++]=M[5],b[x++]=M[6],b[x++]=M[7],b[x++]=M[8],b[x++]=M[9],b[x++]=M[10],b[x++]=M[11]}}}};function pI(t,e){return e===$e.CARTESIAN||e===$e.METER_OFFSETS||e===$e.DEFAULT&&!t.isGeospatial}const _$=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs

// Scale the model
uniform float sizeScale;
uniform bool composeModelMatrix;

// Primitive attributes
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;

// Instance attributes
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;

// Outputs to fragment shader
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    // using instancePositions as world coordinates
    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth
    // call project_normal before setting position to avoid rotation
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,v$=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {

// NOTE(Tarek): This is necessary because
// headless.gl reports the extension as
// available but does not support it in
// the shader.
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function mb(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),ze.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function E$(t,e){if(t.attributes)return mb(t.attributes,e),t instanceof Ar?t:new Ar(t);if(t.positions||t.POSITION)return mb(t,e),new Ar({attributes:t});throw Error("Invalid mesh")}const w$=[0,0,0,255],T$={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:w$},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};class tu extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){const e=!nt(this.context.gl),n={};return l0(this.context.gl,Bt.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:_$,fs:v$,modules:[ci,GP,Ai],transpileToGLSL100:e,defines:n})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:dI}),this.setState({emptyTexture:new Hn(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var s;if((s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const o=n.mesh.attributes||n.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||pI(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new tr(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:E$(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:Boolean(r)}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:Boolean(e)})}}T(tu,"defaultProps",T$);T(tu,"layerName","SimpleMeshLayer");class Sl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n}=e;this.id=n||Ri(this.constructor.name),this.display=!0,this.position=new ee,this.rotation=new ee,this.scale=new ee(1,1,1),this.matrix=new Ye,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}setPosition(e){return ve(e.length===3,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return ve(e.length===3,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return ve(e.length===3,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:n,rotation:r,scale:i,update:s=!0}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,n=this.rotation,r=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(r),this}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:n,rotation:r,scale:i}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(e,n){ve(e),n=n||this.matrix;const r=new Ye(e).multiplyRight(n),i=r.invert(),s=i.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:r,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class yA extends Sl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:n=[]}=e;Le.assert(n.every(r=>r instanceof Sl),"every child must an instance of ScenegraphNode"),super(e),this.children=n}add(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(e){const n=this.children,r=n.indexOf(e);return r>-1&&n.splice(r,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e){let{worldMatrix:n=new Ye}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new Ye(n).multiplyRight(this.matrix);for(const i of this.children)i instanceof yA?i.traverse(e,{worldMatrix:r}):e(i,{worldMatrix:r})}}const b$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},x$={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function yb(t){if(!t._animation){const e=x$[t.componentType],n=b$[t.type],r=n*t.count,{buffer:i,byteOffset:s}=t.bufferView.data,o=new e(i,s+(t.byteOffset||0),r);if(n===1)t._animation=Array.from(o);else{const a=[];for(let c=0;c<o.length;c+=n)a.push(Array.from(o.slice(c,c+n)));t._animation=a}}return t._animation}const C$=new Ye;function S$(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=C$.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}const bg=new HA;function P$(t,e,n,r,i){if(e==="rotation"){bg.slerp({start:n,target:r,ratio:i});for(let s=0;s<bg.length;s++)t[e][s]=bg[s]}else for(let s=0;s<n.length;s++)t[e][s]=i*r[s]+(1-i)*n[s]}function M$(t,e,n){let{p0:r,outTangent0:i,inTangent1:s,p1:o,tDiff:a,ratio:c}=n;for(let h=0;h<t[e].length;h++){const p=i[h]*a,m=s[h]*a;t[e][h]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*r[h]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*p+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[h]+(Math.pow(c,3)-Math.pow(c,2))*m}}function I$(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}function B$(t,e,n,r){let{input:i,interpolation:s,output:o}=e;const a=i[i.length-1],c=t%a,h=i.findIndex(E=>E>=c),p=Math.max(0,h-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:Le.warn("Bad animation path ".concat(r))()}ve(n[r].length===o[p].length);const m=i[p],v=i[h];switch(s){case"STEP":I$(n,r,o[p]);break;case"LINEAR":if(v>m){const E=(c-m)/(v-m);P$(n,r,o[p],o[h],E)}break;case"CUBICSPLINE":if(v>m){const E=(c-m)/(v-m),b=v-m,x=o[3*p+1],I=o[3*p+2],S=o[3*h+0],P=o[3*h+1];M$(n,r,{p0:x,outTangent0:I,inTangent1:S,p1:P,tDiff:b,ratio:E})}break;default:Le.warn("Interpolation ".concat(s," not supported"))();break}}class L${constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const r=(e/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:s,target:o,path:a}=i;B$(r,s,o,a),S$(o,o._node)})}}class R${constructor(e){this.animations=e.animations.map((n,r)=>{const i=n.name||"Animation-".concat(r),s=n.samplers.map(a=>{let{input:c,interpolation:h="LINEAR",output:p}=a;return{input:yb(e.accessors[c]),interpolation:h,output:yb(e.accessors[p])}}),o=n.channels.map(a=>{let{sampler:c,target:h}=a;return{sampler:s[c],target:e.nodes[h.node],path:h.path}});return new L$({name:i,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(n=>n.animate(e))}getAnimations(){return this.animations}}class O$ extends Sl{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(n),this.onBeforeRender=null,this.AfterRender=null,e instanceof tr?(this.model=e,this._setModelNodeProps(n)):this.model=new tr(e,n),this.managedResources=n.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class gI{constructor(e,n){let{attributes:r,material:i,pbrDebug:s,imageBasedLightingEnvironment:o,lights:a,useTangents:c}=n;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},l0(e,Bt.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,n){e&&(this.defines[n]=1)}parseTexture(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const c=new Hn(this.gl,{id:e.name||e.id,parameters:{...i,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...o});this.uniforms[n]=c,this.defineIfPresent(r,r),this.generatedTextures.push(c)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:n=1,roughnessFactor:r=1}=e;this.uniforms.u_MetallicRoughnessValues=[n,r]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:n=1}=e.normalTexture;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:n=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=n}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode==="MASK"){const{alphaCutoff:n=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=n}else e.alphaMode==="BLEND"&&(Le.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}const F$=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,D$=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function _b(t,e){return nt(t)?`#version 300 es
`.concat(e):e}function k$(t,e){const{id:n,drawMode:r,vertexCount:i,attributes:s,modelOptions:o}=e,a=new gI(t,e);Le.info(4,"createGLTFModel defines: ",a.defines)();const c=[];c.push(...a.generatedTextures),c.push(...Object.values(s).map(p=>p.buffer));const h=new O$(t,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[b_],defines:a.defines,parameters:a.parameters,vs:_b(t,F$),fs:_b(t,D$),managedResources:c},o));return h.setProps({attributes:s}),h.setUniforms(a.uniforms),h}const N$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},U$={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class G${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.options=Object.assign({},U$,n)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(r=>this.createScene(r))}createAnimator(){return Array.isArray(this.gltf.animations)?new R$(this.gltf):null}createScene(e){const r=(e.nodes||[]).map(s=>this.createNode(s));return new yA({id:e.name||e.id,children:r})}createNode(e){if(!e._node){const r=(e.children||[]).map(s=>this.createNode(s));e.mesh&&r.push(this.createMesh(e.mesh));const i=new yA({id:e.name||e.id,children:r});if(e.matrix)i.setMatrix(e.matrix);else{if(i.matrix.identity(),e.translation&&i.matrix.translate(e.translation),e.rotation){const s=new Ye().fromQuaternion(e.rotation);i.matrix.multiplyRight(s)}e.scale&&i.matrix.scale(e.scale)}e._node=i}return e._node}createMesh(e){if(!e._mesh){const r=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),i=new yA({id:e.name||e.id,children:r});e._mesh=i}return e._mesh}getVertexCount(e){Le.warn("getVertexCount() not found")()}createPrimitive(e,n,r){return k$(this.gl,Object.assign({id:e.name||"".concat(r.name||r.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,n){const r={};return Object.keys(e).forEach(i=>{r[i]=this.createAccessor(e[i],this.createBuffer(e[i],this.gl.ARRAY_BUFFER))}),n&&(r.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),Le.info(4,"glTF Attributes",{attributes:e,indices:n,generated:r})(),r}createBuffer(e,n){e.bufferView||(e.bufferView={});const{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[n]||(r.lumaBuffers[n]=new St(this.gl,{id:"from-".concat(r.id),data:r.data||e.value,target:n})),r.lumaBuffers[n]}createAccessor(e,n){return new _r({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:N$[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function z$(t,e,n){const r=new G$(t,n),i=r.instantiate(e),s=r.createAnimator();return{scenes:i,animator:s}}const V$="3.2.9",H$="3.2.9",mI="3.2.9",j$="https://unpkg.com/@loaders.gl/textures@".concat(mI,"/dist/libs/basis_encoder.wasm"),W$="https://unpkg.com/@loaders.gl/textures@".concat(mI,"/dist/libs/basis_encoder.js");let xg;async function vb(t){const e=t.modules||{};return e.basis?e.basis:(xg=xg||Q$(t),await xg)}async function Q$(t){let e=null,n=null;return[e,n]=await Promise.all([await Xo("basis_transcoder.js","textures",t),await Xo("basis_transcoder.wasm","textures",t)]),e=e||globalThis.BASIS,await $$(e,n)}function $$(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{const{BasisFile:s,initializeBasis:o}=i;o(),r({BasisFile:s})})})}let Cg;async function Eb(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(Cg=Cg||X$(t),await Cg)}async function X$(t){let e=null,n=null;return[e,n]=await Promise.all([await Xo(W$,"textures",t),await Xo(j$,"textures",t)]),e=e||globalThis.BASIS,await Y$(e,n)}function Y$(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{const{BasisFile:s,KTX2File:o,initializeBasis:a,BasisEncoder:c}=i;a(),r({BasisFile:s,KTX2File:o,BasisEncoder:c})})})}const Ra={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},J$=["","WEBKIT_","MOZ_"],wb={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let jf=null;function K$(t){if(!jf){t=t||Z$()||void 0,jf=new Set;for(const e of J$)for(const n in wb)if(t&&t.getExtension("".concat(e).concat(n))){const r=wb[n];jf.add(r)}}return jf}function Z$(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var Tb,bb,xb,Cb,Sb,Pb,Mb,Ib;(function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"})(Tb||(Tb={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(bb||(bb={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(xb||(xb={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(Cb||(Cb={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(Sb||(Sb={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(Pb||(Pb={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(Mb||(Mb={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(Ib||(Ib={}));const Ir=[171,75,84,88,32,50,48,187,13,10,26,10];function q$(t){const e=new Uint8Array(t);return!(e.byteLength<Ir.length||e[0]!==Ir[0]||e[1]!==Ir[1]||e[2]!==Ir[2]||e[3]!==Ir[3]||e[4]!==Ir[4]||e[5]!==Ir[5]||e[6]!==Ir[6]||e[7]!==Ir[7]||e[8]!==Ir[8]||e[9]!==Ir[9]||e[10]!==Ir[10]||e[11]!==Ir[11])}const eX={etc1:{basisFormat:0,compressed:!0,format:Ra.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Ra.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Ra.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Ra.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Ra.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Ra.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function tX(t,e){if(e.basis.containerFormat==="auto"){if(q$(t)){const r=await Eb(e);return Bb(r.KTX2File,t,e)}const{BasisFile:n}=await vb(e);return Sg(n,t,e)}switch(e.basis.module){case"encoder":const n=await Eb(e);switch(e.basis.containerFormat){case"ktx2":return Bb(n.KTX2File,t,e);case"basis":default:return Sg(n.BasisFile,t,e)}case"transcoder":default:const{BasisFile:r}=await vb(e);return Sg(r,t,e)}}function Sg(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const i=r.getNumImages(),s=[];for(let o=0;o<i;o++){const a=r.getNumLevels(o),c=[];for(let h=0;h<a;h++)c.push(nX(r,o,h,n));s.push(c)}return s}finally{r.close(),r.delete()}}function nX(t,e,n,r){const i=t.getImageWidth(e,n),s=t.getImageHeight(e,n),o=t.getHasAlpha(),{compressed:a,format:c,basisFormat:h}=yI(r,o),p=t.getImageTranscodedSizeInBytes(e,n,h),m=new Uint8Array(p);if(!t.transcodeImage(m,e,n,h,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:m,compressed:a,format:c,hasAlpha:o}}function Bb(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=r.getLevels(),s=[];for(let o=0;o<i;o++){s.push(rX(r,o,n));break}return[s]}finally{r.close(),r.delete()}}function rX(t,e,n){const{alphaFlag:r,height:i,width:s}=t.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:c}=yI(n,r),h=t.getImageTranscodedSizeInBytes(e,0,0,c),p=new Uint8Array(h);if(!t.transcodeImage(p,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:p,compressed:o,hasAlpha:r,format:a}}function yI(t,e){let n=t&&t.basis&&t.basis.format;return n==="auto"&&(n=_I()),typeof n=="object"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),eX[n]}function _I(){const t=K$();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const iX={name:"Basis",id:"basis",module:"textures",version:H$,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},sX={...iX,parse:tX};function Dr(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function vI(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const r=e.baseUri||e.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return r.substr(0,r.lastIndexOf("/")+1)+t}function oX(t,e,n){const r=t.bufferViews[n];Dr(r);const i=r.buffer,s=e[i];Dr(s);const o=(r.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,o,r.byteLength)}const Lb=["SCALAR","VEC2","VEC3","VEC4"],aX=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],lX=new Map(aX),cX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},AX={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},uX={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function EI(t){return Lb[t-1]||Lb[0]}function wI(t){const e=lX.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function TI(t,e){const n=uX[t.componentType],r=cX[t.type],i=AX[t.componentType],s=t.count*r,o=t.count*r*i;return Dr(o>=0&&o<=e.byteLength),{ArrayType:n,length:s,byteLength:o}}const fX={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class ui{constructor(e){T(this,"gltf",void 0),T(this,"sourceBuffers",void 0),T(this,"byteLength",void 0),this.gltf=e||{json:{...fX},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){const n=this.getUsedExtensions().find(i=>i===e),r=this.json.extensions||{};return n?r[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(n,"]"));return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);const n=e.buffer,r=this.gltf.buffers[n];Dr(r);const i=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,i,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,{ArrayType:s,length:o}=TI(e,n),a=n.byteOffset+e.byteOffset;return new s(i,a,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,s=n.byteOffset||0;return new Uint8Array(i,s,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,r){return e.extensions=e.extensions||{},e.extensions[n]=r,this.registerUsedExtension(n),this}setObjectExtension(e,n,r){const i=e.extensions||{};i[n]=r}removeObjectExtension(e,n){const r=e.extensions||{},i=r[n];return delete r[n],i}addExtension(e,n={}){return Dr(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e,n={}){return Dr(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){const{meshIndex:n,matrix:r}=e;this.json.nodes=this.json.nodes||[];const i={mesh:n};return r&&(i.matrix=r),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){const{attributes:n,indices:r,material:i,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(n),mode:s}]};if(r){const c=this._addIndices(r);a.primitives[0].indices=c}return Number.isFinite(i)&&(a.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,n){const r=n_(e),i=n||(r==null?void 0:r.mimeType),o={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const n=e.byteLength;Dr(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const r={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=du(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}addAccessor(e,n){const r={bufferView:e,type:EI(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e,n={size:3}){const r=this.addBufferView(e);let i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,n.size));const s={size:n.size,componentType:wI(e),count:Math.round(e.length/n.size),min:i.min,max:i.max};return this.addAccessor(r,Object.assign(s,n))}addTexture(e){const{imageIndex:n}=e,r={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];const r=this.byteLength,i=new ArrayBuffer(r),s=new Uint8Array(i);let o=0;for(const a of this.sourceBuffers||[])o=e4(a,s,o);(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(e,n){let r=!0;for(;r;){const i=e.indexOf(n);i>-1?e.splice(i,1):r=!1}}_addAttributes(e={}){const n={};for(const r in e){const i=e[r],s=this._getGltfAttributeName(r),o=this.addBinaryBuffer(i.value,i);n[s]=o}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){const r={min:null,max:null};if(e.length<n)return r;r.min=[],r.max=[];const i=e.subarray(0,n);for(const s of i)r.min.push(s),r.max.push(s);for(let s=n;s<e.length;s+=n)for(let o=0;o<n;o++)r.min[0+o]=Math.min(r.min[0+o],e[s+o]),r.max[0+o]=Math.max(r.max[0+o],e[s+o]);return r}}const hX="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",dX="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",pX=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),gX=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),mX={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},yX={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function _X(t,e,n,r,i,s="NONE"){const o=await vX();TX(o,o.exports[yX[i]],t,e,n,r,o.exports[mX[s||"NONE"]])}let Pg;async function vX(){return Pg||(Pg=EX()),Pg}async function EX(){let t=hX;WebAssembly.validate(pX)&&(t=dX,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(wX(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function wX(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){const i=t.charCodeAt(r);e[r]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?gX[e[r]]:(e[r]-60)*64+e[++r];return e.buffer.slice(0,n)}function TX(t,e,n,r,i,s,o){const a=t.exports.sbrk,c=r+3&-4,h=a(c*i),p=a(s.length),m=new Uint8Array(t.exports.memory.buffer);m.set(s,p);const v=e(h,r,i,p,s.length);if(v===0&&o&&o(h,c,i),n.set(m.subarray(h,h+r*i)),a(h-a(0)),v!==0)throw new Error("Malformed buffer data: ".concat(v))}const K_="EXT_meshopt_compression",bX=K_;async function xX(t,e){var n;const r=new ui(t);if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const i=[];for(const s of t.json.bufferViews||[])i.push(CX(r,s));await Promise.all(i),r.removeExtension(K_)}async function CX(t,e){const n=t.getObjectExtension(e,K_);if(n){const{byteOffset:r=0,byteLength:i=0,byteStride:s,count:o,mode:a,filter:c="NONE",buffer:h}=n,p=t.gltf.buffers[h],m=new Uint8Array(p.arrayBuffer,p.byteOffset+r,i),v=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return await _X(v,o,s,m,a,c),v}return null}const SX=Object.freeze(Object.defineProperty({__proto__:null,name:bX,decode:xX},Symbol.toStringTag,{value:"Module"})),ja="EXT_texture_webp",PX=ja;function MX(t,e){const n=new ui(t);if(!Wk("image/webp")){if(n.getRequiredExtensions().includes(ja))throw new Error("gltf: Required extension ".concat(ja," not supported by browser"));return}const{json:r}=n;for(const i of r.textures||[]){const s=n.getObjectExtension(i,ja);s&&(i.source=s.source),n.removeObjectExtension(i,ja)}n.removeExtension(ja)}const IX=Object.freeze(Object.defineProperty({__proto__:null,name:PX,preprocess:MX},Symbol.toStringTag,{value:"Module"})),Lh="KHR_texture_basisu",BX=Lh;function LX(t,e){const n=new ui(t),{json:r}=n;for(const i of r.textures||[]){const s=n.getObjectExtension(i,Lh);s&&(i.source=s.source),n.removeObjectExtension(i,Lh)}n.removeExtension(Lh)}const RX=Object.freeze(Object.defineProperty({__proto__:null,name:BX,preprocess:LX},Symbol.toStringTag,{value:"Module"})),OX="3.2.9",FX={draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},DX={name:"Draco",id:"draco",module:"draco",shapes:["mesh"],version:OX,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:FX};function Z_(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;const a=t.POSITION?t.POSITION.value:[],c=a&&a.length;for(let h=0;h<c;h+=3){const p=a[h],m=a[h+1],v=a[h+2];e=p<e?p:e,n=m<n?m:n,r=v<r?v:r,i=p>i?p:i,s=m>s?m:s,o=v>o?v:o}return[[e,n,r],[i,s,o]]}function kX(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class ul{constructor(e,n){T(this,"fields",void 0),T(this,"metadata",void 0),kX(Array.isArray(e)),NX(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(...e){const n=Object.create(null);for(const i of e)n[i]=!0;const r=this.fields.filter(i=>n[i.name]);return new ul(r,this.metadata)}selectAt(...e){const n=e.map(r=>this.fields[r]).filter(Boolean);return new ul(n,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof ul){const o=e;n=o.fields,r=Rb(Rb(new Map,this.metadata),o.metadata)}else n=e;const i=Object.create(null);for(const o of this.fields)i[o.name]=o;for(const o of n)i[o.name]=o;const s=Object.values(i);return new ul(s,r)}}function NX(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function Rb(t,e){return new Map([...t||new Map,...e||new Map])}class Bd{constructor(e,n,r=!1,i=new Map){T(this,"name",void 0),T(this,"type",void 0),T(this,"nullable",void 0),T(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new Bd(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Yt;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"})(Yt||(Yt={}));let bI,xI,CI;class q_{static isNull(e){return e&&e.typeId===Yt.Null}static isInt(e){return e&&e.typeId===Yt.Int}static isFloat(e){return e&&e.typeId===Yt.Float}static isBinary(e){return e&&e.typeId===Yt.Binary}static isUtf8(e){return e&&e.typeId===Yt.Utf8}static isBool(e){return e&&e.typeId===Yt.Bool}static isDecimal(e){return e&&e.typeId===Yt.Decimal}static isDate(e){return e&&e.typeId===Yt.Date}static isTime(e){return e&&e.typeId===Yt.Time}static isTimestamp(e){return e&&e.typeId===Yt.Timestamp}static isInterval(e){return e&&e.typeId===Yt.Interval}static isList(e){return e&&e.typeId===Yt.List}static isStruct(e){return e&&e.typeId===Yt.Struct}static isUnion(e){return e&&e.typeId===Yt.Union}static isFixedSizeBinary(e){return e&&e.typeId===Yt.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Yt.FixedSizeList}static isMap(e){return e&&e.typeId===Yt.Map}static isDictionary(e){return e&&e.typeId===Yt.Dictionary}get typeId(){return Yt.NONE}compareTo(e){return this===e}}bI=Symbol.toStringTag;class ic extends q_{constructor(e,n){super(),T(this,"isSigned",void 0),T(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Yt.Int}get[bI](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class UX extends ic{constructor(){super(!0,8)}}class GX extends ic{constructor(){super(!0,16)}}class zX extends ic{constructor(){super(!0,32)}}class VX extends ic{constructor(){super(!1,8)}}class HX extends ic{constructor(){super(!1,16)}}class jX extends ic{constructor(){super(!1,32)}}const SI={HALF:16,SINGLE:32,DOUBLE:64};xI=Symbol.toStringTag;class PI extends q_{constructor(e){super(),T(this,"precision",void 0),this.precision=e}get typeId(){return Yt.Float}get[xI](){return"Float"}toString(){return"Float".concat(this.precision)}}class WX extends PI{constructor(){super(SI.SINGLE)}}class QX extends PI{constructor(){super(SI.DOUBLE)}}CI=Symbol.toStringTag;class $X extends q_{constructor(e,n){super(),T(this,"listSize",void 0),T(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Yt.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[CI](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function XX(t){switch(t.constructor){case Int8Array:return new UX;case Uint8Array:return new VX;case Int16Array:return new GX;case Uint16Array:return new HX;case Int32Array:return new zX;case Uint32Array:return new jX;case Float32Array:return new WX;case Float64Array:return new QX;default:throw new Error("array type not supported")}}function YX(t,e,n){const r=XX(e.value),i=n||JX(e);return new Bd(t,new $X(e.size,new Bd("value",r)),!1,i)}function JX(t){const e=new Map;return"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&e.set("normalized",t.normalized.toString()),e}function KX(t,e,n){const r=MI(e.metadata),i=[],s=ZX(e.attributes);for(const o in t){const a=t[o],c=Ob(o,a,s[o]);i.push(c)}if(n){const o=Ob("indices",n);i.push(o)}return new ul(i,r)}function ZX(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}function Ob(t,e,n){const r=n?MI(n.metadata):void 0;return YX(t,e,r)}function MI(t){const e=new Map;for(const n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}const Fb={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},qX={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},eY=4;class tY{constructor(e){T(this,"draco",void 0),T(this,"decoder",void 0),T(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,n={}){const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);const i=this.decoder.GetEncodedGeometryType(r),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(i){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(r,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(r,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const v="DRACO decompression failed: ".concat(o.error_msg());throw new Error(v)}const a=this._getDracoLoaderData(s,i,n),c=this._getMeshData(s,a,n),h=Z_(c.attributes),p=KX(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:h},...c,schema:p}}finally{this.draco.destroy(r),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,n,r){const i=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,r);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(e,n){const r={};for(let i=0;i<e.num_attributes();i++){const s=this.decoder.GetAttribute(e,i),o=this._getAttributeMetadata(e,i);r[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:o};const a=this._getQuantizationTransform(s,n);a&&(r[s.unique_id()].quantization_transform=a);const c=this._getOctahedronTransform(s,n);c&&(r[s.unique_id()].octahedron_transform=c)}return r}_getMeshData(e,n,r){const i=this._getMeshAttributes(n,e,r);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(r.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(e,n,r){const i={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,r);s.name=o;const{value:a,size:c}=this._getAttributeValues(n,s);i[o]={value:a,size:c,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return i}_getTriangleListIndices(e){const r=e.num_faces()*3,i=r*eY,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,r).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),iY(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){const r=qX[n.data_type],i=n.num_components,o=e.num_points()*i,a=o*r.BYTES_PER_ELEMENT,c=nY(this.draco,r);let h;const p=this.draco._malloc(a);try{const m=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,m,c,a,p),h=new r(this.draco.HEAPF32.buffer,p,o).slice()}finally{this.draco._free(p)}return{value:h,size:i}}_deduceAttributeName(e,n){const r=e.unique_id;for(const[o,a]of Object.entries(n.extraAttributes||{}))if(a===r)return o;const i=e.attribute_type;for(const o in Fb)if(this.draco[o]===i)return Fb[o];const s=n.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(r)}_getTopLevelMetadata(e){const n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){const r=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const n={},r=this.metadataQuerier.NumEntries(e);for(let i=0;i<r;i++){const s=this.metadataQuerier.GetEntryName(e,i);n[s]=this._getDracoMetadataField(e,s)}return n}_getDracoMetadataField(e,n){const r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,r);const i=rY(r);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:i}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){const{quantizedAttributes:n=[],octahedronAttributes:r=[]}=e,i=[...n,...r];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,n){const{quantizedAttributes:r=[]}=n,i=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(i)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,n){const{octahedronAttributes:r=[]}=n,i=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(i)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}function nY(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function rY(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}function iY(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}const ev="1.4.1",sY="https://www.gstatic.com/draco/versioned/decoders/".concat(ev,"/draco_decoder.js"),oY="https://www.gstatic.com/draco/versioned/decoders/".concat(ev,"/draco_wasm_wrapper.js"),aY="https://www.gstatic.com/draco/versioned/decoders/".concat(ev,"/draco_decoder.wasm");let Dc;async function lY(t){const e=t.modules||{};return e.draco3d?Dc=Dc||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):Dc=Dc||cY(t),await Dc}async function cY(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await Xo(sY,"draco",t);break;case"wasm":default:[e,n]=await Promise.all([await Xo(oY,"draco",t),await Xo(aY,"draco",t)])}return e=e||globalThis.DracoDecoderModule,await AY(e,n)}function AY(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t({...n,onModuleLoaded:i=>r({draco:i})})})}const II={...DX,parse:uY};async function uY(t,e){const{draco:n}=await lY(e),r=new tY(n);try{return r.parseSync(t,e==null?void 0:e.draco)}finally{r.destroy()}}function fY(t){const e={};for(const n in t){const r=t[n];if(n!=="indices"){const i=BI(r);e[n]=i}}return e}function BI(t){const{buffer:e,size:n,count:r}=hY(t);return{value:e,size:n,byteOffset:0,count:r,type:EI(n),componentType:wI(e)}}function hY(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=dY(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}function dY(t,e,n=!1){return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}const ca="KHR_draco_mesh_compression",pY=ca;function gY(t,e,n){const r=new ui(t);for(const i of LI(r))r.getObjectExtension(i,ca)}async function mY(t,e,n){var r;if(!(e!=null&&(r=e.gltf)!==null&&r!==void 0&&r.decompressMeshes))return;const i=new ui(t),s=[];for(const o of LI(i))i.getObjectExtension(o,ca)&&s.push(_Y(i,o,e,n));await Promise.all(s),i.removeExtension(ca)}function yY(t,e={}){const n=new ui(t);for(const r of n.json.meshes||[])vY(r),n.addRequiredExtension(ca)}async function _Y(t,e,n,r){const i=t.getObjectExtension(e,ca);if(!i)return;const s=t.getTypedArrayForBufferView(i.bufferView),o=Ky(s.buffer,s.byteOffset),{parse:a}=r,c={...n};delete c["3d-tiles"];const h=await a(o,II,c,r),p=fY(h.attributes);for(const[m,v]of Object.entries(p))if(m in e.attributes){const E=e.attributes[m],b=t.getAccessor(E);b!=null&&b.min&&b!==null&&b!==void 0&&b.max&&(v.min=b.min,v.max=b.max)}e.attributes=p,h.indices&&(e.indices=BI(h.indices)),EY(e)}function vY(t,e,n=4,r,i){var s;if(!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=r.DracoWriter.encodeSync({attributes:t}),a=i==null||(s=i.parseSync)===null||s===void 0?void 0:s.call(i,{attributes:t}),c=r._addFauxAttributes(a.attributes),h=r.addBufferView(o);return{primitives:[{attributes:c,mode:n,extensions:{[ca]:{bufferView:h,attributes:c}}}]}}function EY(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*LI(t){for(const e of t.json.meshes||[])for(const n of e.primitives)yield n}const wY=Object.freeze(Object.defineProperty({__proto__:null,name:pY,preprocess:gY,decode:mY,encode:yY},Symbol.toStringTag,{value:"Module"})),Vo="KHR_lights_punctual",TY=Vo;async function bY(t){const e=new ui(t),{json:n}=e,r=e.getExtension(Vo);r&&(e.json.lights=r.lights,e.removeExtension(Vo));for(const i of n.nodes||[]){const s=e.getObjectExtension(i,Vo);s&&(i.light=s.light),e.removeObjectExtension(i,Vo)}}async function xY(t){const e=new ui(t),{json:n}=e;if(n.lights){const r=e.addExtension(Vo);Dr(!r.lights),r.lights=n.lights,delete n.lights}if(e.json.lights){for(const r of e.json.lights){const i=r.node;e.addObjectExtension(i,Vo,r)}delete e.json.lights}}const CY=Object.freeze(Object.defineProperty({__proto__:null,name:TY,decode:bY,encode:xY},Symbol.toStringTag,{value:"Module"})),nu="KHR_materials_unlit",SY=nu;async function PY(t){const e=new ui(t),{json:n}=e;e.removeExtension(nu);for(const r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,nu)}function MY(t){const e=new ui(t),{json:n}=e;if(e.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,nu,{}),e.addExtension(nu))}const IY=Object.freeze(Object.defineProperty({__proto__:null,name:SY,decode:PY,encode:MY},Symbol.toStringTag,{value:"Module"})),qc="KHR_techniques_webgl",BY=qc;async function LY(t){const e=new ui(t),{json:n}=e,r=e.getExtension(qc);if(r){const i=OY(r,e);for(const s of n.materials||[]){const o=e.getObjectExtension(s,qc);o&&(s.technique=Object.assign({},o,i[o.technique]),s.technique.values=FY(s.technique,e)),e.removeObjectExtension(s,qc)}e.removeExtension(qc)}}async function RY(t,e){}function OY(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,s=new TextDecoder;return r.forEach(o=>{if(Number.isFinite(o.bufferView))o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(o=>{o.fragmentShader=r[o.fragmentShader],o.vertexShader=r[o.vertexShader]}),i.forEach(o=>{o.program=n[o.program]}),i}function FY(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(r=>{t.uniforms[r].value&&!(r in n)&&(n[r]=t.uniforms[r].value)}),Object.keys(n).forEach(r=>{typeof n[r]=="object"&&n[r].index!==void 0&&(n[r].texture=e.getTexture(n[r].index))}),n}const DY=Object.freeze(Object.defineProperty({__proto__:null,name:BY,decode:LY,encode:RY},Symbol.toStringTag,{value:"Module"})),RI=[SX,IX,RX,wY,CY,IY,DY];function kY(t,e={},n){const r=RI.filter(s=>OI(s.name,e));for(const s of r){var i;(i=s.preprocess)===null||i===void 0||i.call(s,t,e,n)}}async function NY(t,e={},n){const r=RI.filter(s=>OI(s.name,e));for(const s of r){var i;await((i=s.decode)===null||i===void 0?void 0:i.call(s,t,e,n))}}function OI(t,e){var n;const r=(e==null||(n=e.gltf)===null||n===void 0?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}const Mg="KHR_binary_glTF";function UY(t){const e=new ui(t),{json:n}=e;for(const r of n.images||[]){const i=e.getObjectExtension(r,Mg);i&&Object.assign(r,i),e.removeObjectExtension(r,Mg)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(Mg)}const Db={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},GY={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class zY{constructor(){T(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),T(this,"json",void 0)}normalize(e,n){this.json=e.json;const r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(r.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),UY(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const n in Db)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){const r=e[n];if(!(!r||Array.isArray(r))){e[n]=[];for(const i in r){const s=r[i];s.id=s.id||i;const o=e[n].length;e[n].push(s),this.idToIndexMap[n][i]=o}}}_convertObjectIdsToArrayIndices(e){for(const n in Db)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const n of e.textures)this._convertTextureIds(n);for(const n of e.meshes)this._convertMeshIds(n);for(const n of e.nodes)this._convertNodeIds(n);for(const n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const n of e.primitives){const{attributes:r,indices:i,material:s}=n;for(const o in r)r[o]=this._convertIdToIndex(r[o],"accessor");i&&(n.indices=this._convertIdToIndex(i,"accessor")),s&&(n.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),e[n]=[]);for(const r of e[n])for(const i in r){const s=r[i],o=this._convertIdToIndex(s,i);r[i]=o}}_convertIdToIndex(e,n){const r=GY[n];if(r in this.idToIndexMap){const i=this.idToIndexMap[r][e];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(e));return i}return e}_updateObjects(e){for(const n of this.json.buffers)delete n.type}_updateMaterial(e){for(const i of e.materials){var n,r;i.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const s=((n=i.values)===null||n===void 0?void 0:n.tex)||((r=i.values)===null||r===void 0?void 0:r.texture2d_0),o=e.textures.findIndex(a=>a.id===s);o!==-1&&(i.pbrMetallicRoughness.baseColorTexture={index:o})}}}function VY(t,e={}){return new zY().normalize(t,e)}const HY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},jY={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Kr={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},WY={magFilter:Kr.TEXTURE_MAG_FILTER,minFilter:Kr.TEXTURE_MIN_FILTER,wrapS:Kr.TEXTURE_WRAP_S,wrapT:Kr.TEXTURE_WRAP_T},QY={[Kr.TEXTURE_MAG_FILTER]:Kr.LINEAR,[Kr.TEXTURE_MIN_FILTER]:Kr.NEAREST_MIPMAP_LINEAR,[Kr.TEXTURE_WRAP_S]:Kr.REPEAT,[Kr.TEXTURE_WRAP_T]:Kr.REPEAT};function $Y(t){return jY[t]}function XY(t){return HY[t]}class YY{constructor(){T(this,"baseUri",""),T(this,"json",{}),T(this,"buffers",[]),T(this,"images",[])}postProcess(e,n={}){const{json:r,buffers:i=[],images:s=[],baseUri:o=""}=e;return Dr(r),this.baseUri=o,this.json=r,this.buffers=i,this.images=s,this._resolveTree(this.json,n),this.json}_resolveTree(e,n={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((r,i)=>this._resolveBufferView(r,i))),e.images&&(e.images=e.images.map((r,i)=>this._resolveImage(r,i))),e.samplers&&(e.samplers=e.samplers.map((r,i)=>this._resolveSampler(r,i))),e.textures&&(e.textures=e.textures.map((r,i)=>this._resolveTexture(r,i))),e.accessors&&(e.accessors=e.accessors.map((r,i)=>this._resolveAccessor(r,i))),e.materials&&(e.materials=e.materials.map((r,i)=>this._resolveMaterial(r,i))),e.meshes&&(e.meshes=e.meshes.map((r,i)=>this._resolveMesh(r,i))),e.nodes&&(e.nodes=e.nodes.map((r,i)=>this._resolveNode(r,i))),e.skins&&(e.skins=e.skins.map((r,i)=>this._resolveSkin(r,i))),e.scenes&&(e.scenes=e.scenes.map((r,i)=>this._resolveScene(r,i))),e.scene!==void 0&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(n,"]")),r}_resolveScene(e,n){return e.id=e.id||"scene-".concat(n),e.nodes=(e.nodes||[]).map(r=>this.getNode(r)),e}_resolveNode(e,n){return e.id=e.id||"node-".concat(n),e.children&&(e.children=e.children.map(r=>this.getNode(r))),e.mesh!==void 0?e.mesh=this.getMesh(e.mesh):e.meshes!==void 0&&e.meshes.length&&(e.mesh=e.meshes.reduce((r,i)=>{const s=this.getMesh(i);return r.id=s.id,r.primitives=r.primitives.concat(s.primitives),r},{primitives:[]})),e.camera!==void 0&&(e.camera=this.getCamera(e.camera)),e.skin!==void 0&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,n){return e.id=e.id||"skin-".concat(n),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,n){return e.id=e.id||"mesh-".concat(n),e.primitives&&(e.primitives=e.primitives.map(r=>{r={...r};const i=r.attributes;r.attributes={};for(const s in i)r.attributes[s]=this.getAccessor(i[s]);return r.indices!==void 0&&(r.indices=this.getAccessor(r.indices)),r.material!==void 0&&(r.material=this.getMaterial(r.material)),r})),e}_resolveMaterial(e,n){if(e.id=e.id||"material-".concat(n),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture={...r.baseColorTexture},r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture={...r.metallicRoughnessTexture},r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,n){if(e.id=e.id||"accessor-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=$Y(e.componentType),e.components=XY(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const r=e.bufferView.buffer,{ArrayType:i,byteLength:s}=TI(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+r.byteOffset;let a=r.arrayBuffer.slice(o,o+s);e.bufferView.byteStride&&(a=this._getValueFromInterleavedBuffer(r,o,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new i(a)}return e}_getValueFromInterleavedBuffer(e,n,r,i,s){const o=new Uint8Array(s*i);for(let a=0;a<s;a++){const c=n+a*r;o.set(new Uint8Array(e.arrayBuffer.slice(c,c+i)),a*i)}return o.buffer}_resolveTexture(e,n){return e.id=e.id||"texture-".concat(n),e.sampler="sampler"in e?this.getSampler(e.sampler):QY,e.source=this.getImage(e.source),e}_resolveSampler(e,n){e.id=e.id||"sampler-".concat(n),e.parameters={};for(const r in e){const i=this._enumSamplerParameter(r);i!==void 0&&(e.parameters[i]=e[r])}return e}_enumSamplerParameter(e){return WY[e]}_resolveImage(e,n){e.id=e.id||"image-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView));const r=this.images[n];return r&&(e.image=r),e}_resolveBufferView(e,n){const r=e.buffer,i={id:"bufferView-".concat(n),...e,buffer:this.buffers[r]},s=this.buffers[r].arrayBuffer;let o=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(o+=e.byteOffset),i.data=new Uint8Array(s,o,e.byteLength),i}_resolveCamera(e,n){return e.id=e.id||"camera-".concat(n),e.perspective,e.orthographic,e}}function JY(t,e){return new YY().postProcess(t,e)}const kb=1735152710,tv=12,Ld=8,KY=1313821514,ZY=5130562,qY=0,eJ=1,tJ=0,jl=!0;function nJ(t,e=0){return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function rJ(t,e=0,n={}){const r=new DataView(t),{magic:i=kb}=n,s=r.getUint32(e,!1);return s===i||s===kb}function iJ(t,e,n=0,r={}){const i=new DataView(e),s=nJ(i,n+0),o=i.getUint32(n+4,jl),a=i.getUint32(n+8,jl);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),n+=tv,t.version){case 1:return sJ(t,i,n);case 2:return oJ(t,i,n,r={});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}function sJ(t,e,n){Ct(t.header.byteLength>tv+Ld);const r=e.getUint32(n+0,jl),i=e.getUint32(n+4,jl);return n+=Ld,Ct(i===tJ),U1(t,e,n,r),n+=r,n+=G1(t,e,n,t.header.byteLength),n}function oJ(t,e,n,r){return Ct(t.header.byteLength>tv+Ld),aJ(t,e,n,r),n+t.header.byteLength}function aJ(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,jl),s=e.getUint32(n+4,jl);switch(n+=Ld,s){case KY:U1(t,e,n,i);break;case ZY:G1(t,e,n,i);break;case qY:r.strict||U1(t,e,n,i);break;case eJ:r.strict||G1(t,e,n,i);break}n+=du(i,4)}return n}function U1(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),du(r,4)}function G1(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),du(r,4)}async function lJ(t,e,n=0,r,i){var s,o,a,c;cJ(t,e,n,r),VY(t,{normalize:r==null||(s=r.gltf)===null||s===void 0?void 0:s.normalize}),kY(t,r,i);const h=[];if(r!=null&&(o=r.gltf)!==null&&o!==void 0&&o.loadBuffers&&t.json.buffers&&await AJ(t,r,i),r!=null&&(a=r.gltf)!==null&&a!==void 0&&a.loadImages){const m=uJ(t,r,i);h.push(m)}const p=NY(t,r,i);return h.push(p),await Promise.all(h),r!=null&&(c=r.gltf)!==null&&c!==void 0&&c.postProcess?JY(t,r):t}function cJ(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!rJ(e,n,r)&&(e=new TextDecoder().decode(e)),typeof e=="string")t.json=JD(e);else if(e instanceof ArrayBuffer){const o={};n=iJ(o,e,n,r.glb),Dr(o.type==="glTF","Invalid GLB magic string ".concat(o.type)),t._glb=o,t.json=o.json}else Dr(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:o}=t._glb;t.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}const s=t.json.images||[];t.images=new Array(s.length).fill({})}async function AJ(t,e,n){const r=t.json.buffers||[];for(let o=0;o<r.length;++o){const a=r[o];if(a.uri){var i,s;const{fetch:c}=n;Dr(c);const h=vI(a.uri,e),p=await(n==null||(i=n.fetch)===null||i===void 0?void 0:i.call(n,h)),m=await(p==null||(s=p.arrayBuffer)===null||s===void 0?void 0:s.call(p));t.buffers[o]={arrayBuffer:m,byteOffset:0,byteLength:m.byteLength},delete a.uri}else t.buffers[o]===null&&(t.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}async function uJ(t,e,n){const r=fJ(t),i=t.json.images||[],s=[];for(const o of r)s.push(hJ(t,i[o],o,e,n));return await Promise.all(s)}function fJ(t){const e=new Set,n=t.json.textures||[];for(const r of n)r.source!==void 0&&e.add(r.source);return Array.from(e).sort()}async function hJ(t,e,n,r,i){const{fetch:s,parse:o}=i;let a;if(e.uri){const h=vI(e.uri,r);a=await(await s(h)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const h=oX(t.json,t.buffers,e.bufferView);a=Ky(h.buffer,h.byteOffset,h.byteLength)}Dr(a,"glTF image has no data");let c=await o(a,[r_,sX],{mimeType:e.mimeType,basis:r.basis||{format:_I()}},i);c&&c[0]&&(c={compressed:!0,mipmaps:!1,width:c[0].width,height:c[0].height,data:c[0]}),t.images=t.images||[],t.images[n]=c}const ru={name:"glTF",id:"gltf",module:"gltf",version:V$,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:dJ,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function dJ(t,e={},n){e={...ru.options,...e},e.gltf={...ru.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await lJ({},t,r,e,n)}async function pJ(t){const e=[];return t.scenes.forEach(n=>{n.traverse(r=>{Object.values(r.model.getUniforms()).forEach(i=>{i.loaded===!1&&e.push(i)})})}),await gJ(()=>e.some(n=>!n.loaded))}async function gJ(t){for(;t();)await new Promise(e=>requestAnimationFrame(e))}const mJ=`#version 300 es

// Instance attributes
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;

// Uniforms
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;

// Attributes
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif

// Varying
out vec4 vColor;

// MODULE_PBR contains all the varying definitions needed
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif

// Main
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    // using instancePositions as world coordinates
    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth
    // call project_normal before setting position to avoid rotation
    geometry.normal = project_normal(normal);
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    // set PBR data
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,yJ=`#version 300 es

// Uniforms
uniform float opacity;

// Varying
in vec4 vColor;

out vec4 fragmentColor;

// MODULE_PBR contains all the varying definitions needed
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,FI=[255,255,255,255],_J={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?typeof t.scene=="object"?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:FI},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[ru]};class nv extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){const e=[ci,Ai];return this.props._lighting==="pbr"&&e.push(b_),{vs:mJ,fs:yJ,modules:e}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:FI,transition:!0},instanceModelMatrix:dI})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.scenegraph!==r.scenegraph?this._updateScenegraph():n._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:n}=this.context;let r=null;if(e.scenegraph instanceof Sl)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const a=e.scenegraph,c=z$(n,a,this._getModelOptions());r={gltf:a,...c},pJ(c).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(ze.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);const i={layer:this,gl:n},s=e.getScene(r,i),o=e.getAnimator(r,i);s instanceof Sl?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,o,e._animations),this.setState({scenegraph:s,animator:o})):s!==null&&ze.warn("invalid scenegraph:",s)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const n=this.getAttributeManager().getAttributes();e.traverse(r=>{this._setModelAttributes(r.model,n)})}}_applyAnimationsProp(e,n,r){if(!e||!n||!r)return;const i=n.getAnimations();Object.keys(r).sort().forEach(s=>{const o=r[s];if(s==="*")i.forEach(a=>{Object.assign(a,o)});else if(Number.isFinite(Number(s))){const a=Number(s);a>=0&&a<i.length?Object.assign(i[a],o):ze.warn("animation ".concat(s," not found"))()}else{const a=i.find(({name:c})=>c===s);a?Object.assign(a,o):ze.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof Sl&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let n=null;return e&&(typeof e=="function"?n=e({gl:this.context.gl,layer:this}):n=e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:n,modelOptions:{isInstanced:!0,transpileToGLSL100:!nt(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(n=>{this._setModelAttributes(n.model,e)})}draw({moduleParameters:e=null,parameters:n={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:i}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:a,opacity:c,coordinateSystem:h}=this.props,p=this.getNumInstances();this.state.scenegraph.traverse((m,{worldMatrix:v})=>{m.model.setInstanceCount(p),m.updateModuleSettings(e),m.draw({parameters:n,uniforms:{sizeScale:s,opacity:c,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:pI(i,h),sceneModelMatrix:v,u_Camera:m.model.getUniforms().project_uCameraPosition}})})}}T(nv,"defaultProps",_J);T(nv,"layerName","ScenegraphLayer");const vJ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs

// Scale the model
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;

// Primitive attributes
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;

// Instance attributes
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;

// Outputs to fragment shader
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    // https://github.com/Esri/i3s-spec/blob/master/docs/1.7/geometryUVRegion.cmn.md
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    // set PBR data
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,EJ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {

// NOTE(Tarek): This is necessary because
// headless.gl reports the extension as
// available but does not support it in
// the shader.
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function wJ(t){t.COLOR_0||t.colors||(t.colors={constant:!0,value:new Float32Array([1,1,1])})}const TJ={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class rv extends tu{getShaders(){const e=super.getShaders();return e.modules.push(b_),{...e,vs:vJ,fs:EJ}}initializeState(){const{featureIds:e}=this.props;super.initializeState();const n=this.getAttributeManager();e&&n.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.pbrMaterial!==r.pbrMaterial&&this.updatePbrMaterialUniforms(n.pbrMaterial)}draw(e){const{featureIds:n}=this.props;!this.state.model||(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:Boolean(n)}),super.draw(e))}getModel(e){const{id:n,pbrMaterial:r}=this.props,i=this.parseMaterial(r,e);this.setState({materialParser:i});const s=this.getShaders();return wJ(e.attributes),new tr(this.context.gl,{...this.getShaders(),id:n,geometry:e,defines:{...s.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:e.attributes.uvRegions},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){const{model:n}=this.state;if(n){const{mesh:r}=this.props,i=this.parseMaterial(e,r);this.setState({materialParser:i}),n.setUniforms(i.uniforms)}}parseMaterial(e,n){var r;const i=Boolean(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return(r=this.state.materialParser)===null||r===void 0||r.delete(),new gI(this.context.gl,{attributes:{NORMAL:n.attributes.normals,TEXCOORD_0:n.attributes.texCoords},material:{unlit:i,...e},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){const n=this.props.featureIds,r=new Uint8ClampedArray(n.length*e.size),i=[];for(let s=0;s<n.length;s++)this.encodePickingColor(n[s],i),r[s*3]=i[0],r[s*3+1]=i[1],r[s*3+2]=i[2];e.value=r}finalizeState(e){var n;super.finalizeState(e),(n=this.state.materialParser)===null||n===void 0||n.delete(),this.setState({materialParser:null})}}T(rv,"layerName","MeshLayer");T(rv,"defaultProps",TJ);const bJ=6378137,xJ=6378137,CJ=6356752314245179e-9;function T0(t){return t}new ee;function SJ(t,e=[],n=T0){return"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):"x"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function PJ(t,e=[]){return SJ(t,e,bn._cartographicRadians?T0:U5)}function MJ(t,e,n=T0){return"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):"x"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function IJ(t,e){return MJ(t,e,bn._cartographicRadians?T0:G5)}const Oa=new ee,BJ=new ee,LJ=new ee;function RJ(t,e,n=[]){const{oneOverRadii:r,oneOverRadiiSquared:i,centerToleranceSquared:s}=e;Oa.from(t);const o=Oa.x,a=Oa.y,c=Oa.z,h=r.x,p=r.y,m=r.z,v=o*o*h*h,E=a*a*p*p,b=c*c*m*m,x=v+E+b,I=Math.sqrt(1/x);if(!Number.isFinite(I))return;const S=BJ;if(S.copy(t).scale(I),x<s)return S.to(n);const P=i.x,M=i.y,O=i.z,N=LJ;N.set(S.x*P*2,S.y*M*2,S.z*O*2);let z=(1-I)*Oa.len()/(.5*N.len()),X=0,Z,Q,k,D;do{z-=X,Z=1/(1+z*P),Q=1/(1+z*M),k=1/(1+z*O);const ne=Z*Z,se=Q*Q,oe=k*k,xe=ne*Z,Pe=se*Q,Ue=oe*k;D=v*ne+E*se+b*oe-1;const le=v*xe*P+E*Pe*M+b*Ue*O,_e=-2*le;X=D/_e}while(Math.abs(D)>jA.EPSILON12);return Oa.scale([Z,Q,k]).to(n)}const Nb=1e-14,OJ=new ee,Ub={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Ig={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},kc={east:new ee,north:new ee,up:new ee,west:new ee,south:new ee,down:new ee},FJ=new ee,DJ=new ee,kJ=new ee;function Gb(t,e,n,r,i,s){const o=Ub[e]&&Ub[e][n];bi(o&&(!r||r===o));let a,c,h;const p=OJ.copy(i);if(Ur(p.x,0,Nb)&&Ur(p.y,0,Nb)){const v=Math.sign(p.z);a=FJ.fromArray(Ig[e]),e!=="east"&&e!=="west"&&a.scale(v),c=DJ.fromArray(Ig[n]),n!=="east"&&n!=="west"&&c.scale(v),h=kJ.fromArray(Ig[r]),r!=="east"&&r!=="west"&&h.scale(v)}else{const{up:v,east:E,north:b}=kc;E.set(-p.y,p.x,0).normalize(),t.geodeticSurfaceNormal(p,v),b.copy(v).cross(E);const{down:x,west:I,south:S}=kc;x.copy(v).scale(-1),I.copy(E).scale(-1),S.copy(b).scale(-1),a=kc[e],c=kc[n],h=kc[r]}return s[0]=a.x,s[1]=a.y,s[2]=a.z,s[3]=0,s[4]=c.x,s[5]=c.y,s[6]=c.z,s[7]=0,s[8]=h.x,s[9]=h.y,s[10]=h.z,s[11]=0,s[12]=p.x,s[13]=p.y,s[14]=p.z,s[15]=1,s}const Wf=new ee,zb=new ee,NJ=new ee,_i=new ee,UJ=new ee,Qf=new ee;class Cn{constructor(e=0,n=0,r=0){T(this,"radii",void 0),T(this,"radiiSquared",void 0),T(this,"radiiToTheFourth",void 0),T(this,"oneOverRadii",void 0),T(this,"oneOverRadiiSquared",void 0),T(this,"minimumRadius",void 0),T(this,"maximumRadius",void 0),T(this,"centerToleranceSquared",jA.EPSILON1),T(this,"squaredXOverSquaredZ",void 0),bi(e>=0),bi(n>=0),bi(r>=0),this.radii=new ee(e,n,r),this.radiiSquared=new ee(e*e,n*n,r*r),this.radiiToTheFourth=new ee(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new ee(e===0?0:1/e,n===0?0:1/n,r===0?0:1/r),this.oneOverRadiiSquared=new ee(e===0?0:1/(e*e),n===0?0:1/(n*n),r===0?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||Boolean(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,n=[0,0,0]){const r=zb,i=NJ,[,,s]=e;this.geodeticSurfaceNormalCartographic(e,r),i.copy(this.radiiSquared).scale(r);const o=Math.sqrt(r.dot(i));return i.scale(1/o),r.scale(s),i.add(r),i.to(n)}cartesianToCartographic(e,n=[0,0,0]){Qf.from(e);const r=this.scaleToGeodeticSurface(Qf,_i);if(!r)return;const i=this.geodeticSurfaceNormal(r,zb),s=UJ;s.copy(Qf).subtract(r);const o=Math.atan2(i.y,i.x),a=Math.asin(i.z),c=Math.sign(m_(s,Qf))*CP(s);return IJ([o,a,c],n)}eastNorthUpToFixedFrame(e,n=new Ye){return Gb(this,"east","north","up",e,n)}localFrameToFixedFrame(e,n,r,i,s=new Ye){return Gb(this,e,n,r,i,s)}geocentricSurfaceNormal(e,n=[0,0,0]){return Wf.from(e).normalize().to(n)}geodeticSurfaceNormalCartographic(e,n=[0,0,0]){const r=PJ(e),i=r[0],s=r[1],o=Math.cos(s);return Wf.set(o*Math.cos(i),o*Math.sin(i),Math.sin(s)).normalize(),Wf.to(n)}geodeticSurfaceNormal(e,n=[0,0,0]){return Wf.from(e).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(e,n){return RJ(e,this,n)}scaleToGeocentricSurface(e,n=[0,0,0]){_i.from(e);const r=_i.x,i=_i.y,s=_i.z,o=this.oneOverRadiiSquared,a=1/Math.sqrt(r*r*o.x+i*i*o.y+s*s*o.z);return _i.multiplyScalar(a).to(n)}transformPositionToScaledSpace(e,n=[0,0,0]){return _i.from(e).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(e,n=[0,0,0]){return _i.from(e).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(e,n=0,r=[0,0,0]){bi(Ur(this.radii.x,this.radii.y,jA.EPSILON15)),bi(this.radii.z>0),_i.from(e);const i=_i.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-n))return _i.set(0,0,i).to(r)}}T(Cn,"WGS84",new Cn(bJ,xJ,CJ));class GJ{constructor(e,n,r){T(this,"item",void 0),T(this,"previous",void 0),T(this,"next",void 0),this.item=e,this.previous=n,this.next=r}}class zJ{constructor(){T(this,"head",null),T(this,"tail",null),T(this,"_length",0)}get length(){return this._length}add(e){const n=new GJ(e,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}remove(e){!e||(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,n){e!==n&&(this.remove(n),this._insert(e,n))}_insert(e,n){const r=e.next;e.next=n,this.tail===e?this.tail=n:r.previous=n,n.next=r,n.previous=e,++this._length}}function Bg(t){return t!=null}class VJ{constructor(){T(this,"_list",void 0),T(this,"_sentinel",void 0),T(this,"_trimTiles",void 0),this._list=new zJ,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const n=e._cacheNode;Bg(n)&&this._list.splice(this._sentinel,n)}add(e,n,r){Bg(n._cacheNode)||(n._cacheNode=this._list.add(n),r&&r(e,n))}unloadTile(e,n,r){const i=n._cacheNode;!Bg(i)||(this._list.remove(i),n._cacheNode=void 0,r&&r(e,n))}unloadTiles(e,n){const r=this._trimTiles;this._trimTiles=!1;const i=this._list,s=e.maximumMemoryUsage*1024*1024,o=this._sentinel;let a=i.head;for(;a!==o&&(e.gpuMemoryUsageInBytes>s||r);){const c=a.item;a=a.next,this.unloadTile(e,c,n)}}trim(){this._trimTiles=!0}}function HJ(t,e){Ct(t),Ct(e);const{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:i,boundingVolume:{center:s}}=t;let o=new Ye(i);switch(n&&o.translate(n),r){case"Z":break;case"Y":const m=new Ye().rotateX(Math.PI/2);o=o.multiplyRight(m);break;case"X":const v=new Ye().rotateY(-Math.PI/2);o=o.multiplyRight(v);break}e.isQuantized&&o.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const a=new ee(s);e.cartesianModelMatrix=o,e.cartesianOrigin=a;const c=Cn.WGS84.cartesianToCartographic(a,new ee),p=Cn.WGS84.eastNorthUpToFixedFrame(a).invert();e.cartographicModelMatrix=p.multiplyRight(o),e.cartographicOrigin=c,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}const Vb=new ee,Lg=new ee,z1=new Fr([new ni,new ni,new ni,new ni,new ni,new ni]);function jJ(t,e){const{cameraDirection:n,cameraUp:r,height:i}=t,{metersPerUnit:s}=t.distanceScales,o=Rh(t,t.center),a=Cn.WGS84.eastNorthUpToFixedFrame(o),c=t.unprojectPosition(t.cameraPosition),h=Cn.WGS84.cartographicToCartesian(c,new ee),p=new ee(a.transformAsVector(new ee(n).scale(s))).normalize(),m=new ee(a.transformAsVector(new ee(r).scale(s))).normalize();QJ(t);const v=t.constructor,{longitude:E,latitude:b,width:x,bearing:I,zoom:S}=t,P=new v({longitude:E,latitude:b,height:i,width:x,bearing:I,zoom:S,pitch:0});return{camera:{position:h,direction:p,up:m},viewport:t,topDownViewport:P,height:i,cullingVolume:z1,frameNumber:e,sseDenominator:1.15}}function WJ(t,e,n){if(n===0||t.length<=n)return[t,[]];const r=[],{longitude:i,latitude:s}=e.viewport;for(const[h,p]of t.entries()){const[m,v]=p.header.mbs,E=Math.abs(i-m),b=Math.abs(s-v),x=Math.sqrt(b*b+E*E);r.push([h,x])}const o=r.sort((h,p)=>h[1]-p[1]),a=[];for(let h=0;h<n;h++)a.push(t[o[h][0]]);const c=[];for(let h=n;h<o.length;h++)c.push(t[o[h][0]]);return[a,c]}function QJ(t){const e=t.getFrustumPlanes(),n=Hb(e.near,t.cameraPosition),r=Rh(t,n),i=Rh(t,t.cameraPosition,Lg);let s=0;z1.planes[s++].fromPointNormal(r,Vb.copy(r).subtract(i));for(const o in e){if(o==="near")continue;const a=e[o],c=Hb(a,n,Lg),h=Rh(t,c,Lg);z1.planes[s++].fromPointNormal(h,Vb.copy(r).subtract(h))}}function Hb(t,e,n=new ee){const r=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-r).add(e),n}function Rh(t,e,n=new ee){const r=t.unprojectPosition(e);return Cn.WGS84.cartographicToCartesian(r,n)}const $J=6378137,XJ=6378137,V1=6356752314245179e-9,jb=new ee;function YJ(t,e){if(t instanceof Pu){const{halfAxes:n}=t,r=KJ(n);return Math.log2(V1/(r+e[2]))}else if(t instanceof Su){const{radius:n}=t;return Math.log2(V1/(n+e[2]))}else if(t.width&&t.height){const{width:n,height:r}=t,i=Math.log2($J/n),s=Math.log2(XJ/r);return(i+s)/2}return 1}function DI(t,e,n){const r=Cn.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],new ee),i=Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2));return Math.log2(V1/(i+e[2]))}function JJ(t,e,n){const[r,i,s,o]=t;return DI({xmin:r,xmax:s,ymin:i,ymax:o,zmin:0,zmax:0},e,n)}function KJ(t){t.getColumn(0,jb);const e=t.getColumn(1),n=t.getColumn(2);return jb.add(e).add(n).len()}const Br={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},fs={ADD:1,REPLACE:2},Pl={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},ji={I3S:"I3S",TILES3D:"TILES3D"},b0={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},ZJ={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function kI(t){return t!=null}const qJ=new ee,eK=new ee,tK=new ee;function Rg(t,e,n){if(Ct(t,"3D Tile: boundingVolume must be defined"),t.box)return nK(t.box,e,n);if(t.region){const[r,i,s,o,a,c]=t.region,h=Cn.WGS84.cartographicToCartesian([Jc(r),Jc(o),a],eK),p=Cn.WGS84.cartographicToCartesian([Jc(s),Jc(i),c],tK),m=new ee().addVectors(h,p).multiplyScalar(.5),v=new ee().subVectors(h,p).len()/2;return Wb([m[0],m[1],m[2],v],new Ye)}if(t.sphere)return Wb(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function nK(t,e,n){const r=new ee(t[0],t[1],t[2]);e.transform(r,r);let i=[];if(t.length===10){const h=t.slice(3,6),p=new HA;p.fromArray(t,6);const m=new ee([1,0,0]),v=new ee([0,1,0]),E=new ee([0,0,1]);m.transformByQuaternion(p),m.scale(h[0]),v.transformByQuaternion(p),v.scale(h[1]),E.transformByQuaternion(p),E.scale(h[2]),i=[...m.toArray(),...v.toArray(),...E.toArray()]}else i=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const s=e.transformAsVector(i.slice(0,3)),o=e.transformAsVector(i.slice(3,6)),a=e.transformAsVector(i.slice(6,9)),c=new xn([s[0],s[1],s[2],o[0],o[1],o[2],a[0],a[1],a[2]]);return kI(n)?(n.center=r,n.halfAxes=c,n):new Pu(r,c)}function Wb(t,e,n){const r=new ee(t[0],t[1],t[2]);e.transform(r,r);const i=e.getScale(qJ),s=Math.max(Math.max(i[0],i[1]),i[2]),o=t[3]*s;return kI(n)?(n.center=r,n.radius=o,n):new Su(r,o)}new ee;new ee;new Ye;new ee;new ee;new ee;function rK(t,e){const n=t*e;return 1-Math.exp(-(n*n))}function iK(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return rK(e,n)*r}return 0}function sK(t,e,n){const r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,s=n?i:t.lodMetricValue;if(s===0)return 0;const o=Math.max(t._distanceToCamera,1e-7),{height:a,sseDenominator:c}=e,{viewDistanceScale:h}=r.options;let p=s*a*(h||1)/(o*c);return p-=iK(r,o),p}const Og=new ee,Qb=new ee,Us=new ee,$b=new ee,oK=new ee,Fg=new Ye,Xb=new Ye;function aK(t,e){if(t.lodMetricValue===0||isNaN(t.lodMetricValue))return"DIG";const n=2*NI(t,e);return n<2?"OUT":!t.header.children||n<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}function NI(t,e){const{topDownViewport:n}=e,r=t.header.mbs[1],i=t.header.mbs[0],s=t.header.mbs[2],o=t.header.mbs[3],a=[...t.boundingVolume.center],c=n.unprojectPosition(n.cameraPosition);Cn.WGS84.cartographicToCartesian(c,Og),Qb.copy(Og).subtract(a).normalize(),Cn.WGS84.eastNorthUpToFixedFrame(a,Fg),Xb.copy(Fg).invert(),Us.copy(Og).transform(Xb);const h=Math.sqrt(Us[0]*Us[0]+Us[1]*Us[1]),p=h*h/Us[2];$b.copy([Us[0],Us[1],p]);const v=$b.transform(Fg).subtract(a).normalize(),b=Qb.cross(v).normalize().scale(o).add(a),x=Cn.WGS84.cartesianToCartographic(b),I=n.project([i,r,s]),S=n.project(x);return oK.copy(I).subtract(S).magnitude()}function lK(t){return{assetGltfUpAxis:t.asset&&t.asset.gltfUpAxis||"Y"}}class Yb{constructor(e=0){T(this,"_map",new Map),T(this,"_array",void 0),T(this,"_length",void 0),this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return Ct(e<this._array.length),this._array[e]}set(e,n){Ct(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=n,this._map.set(n,e)}delete(e){const n=this._map.get(e);n>=0&&(this._array.splice(n,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const n=this.length++;this._array[n]=e,this._map.set(e,n)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){Ct(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){Ct(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const cK={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class x0{traversalFinished(e){return!0}constructor(e){T(this,"options",void 0),T(this,"root",void 0),T(this,"requestedTiles",void 0),T(this,"selectedTiles",void 0),T(this,"emptyTiles",void 0),T(this,"lastUpdate",new Date().getTime()),T(this,"updateDebounceTime",1e3),T(this,"_traversalStack",void 0),T(this,"_emptyTraversalStack",void 0),T(this,"_frameNumber",void 0),this.options={...cK,...e},this._traversalStack=new Yb,this._emptyTraversalStack=new Yb,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}traverse(e,n,r){this.root=e,this.options={...this.options,...r},this.reset(),this.updateTile(e,n),this._frameNumber=n.frameNumber,this.executeTraversal(e,n)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,n){const r=this._traversalStack;for(e._selectionDepth=1,r.push(e);r.length>0;){const s=r.pop();let o=!1;this.canTraverse(s,n)&&(this.updateChildTiles(s,n),o=this.updateAndPushChildren(s,n,r,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const a=s.parent,c=Boolean(!a||a._shouldRefine),h=!o;s.hasRenderContent?s.refine===fs.ADD?(this.loadTile(s,n),this.selectTile(s,n)):s.refine===fs.REPLACE&&(this.loadTile(s,n),h&&this.selectTile(s,n)):(this.emptyTiles[s.id]=s,this.loadTile(s,n),h&&this.selectTile(s,n)),this.touchTile(s,n),s._shouldRefine=o&&c}const i=new Date().getTime();(this.traversalFinished(n)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(n))}updateChildTiles(e,n){const r=e.children;for(const i of r)this.updateTile(i,n);return!0}updateAndPushChildren(e,n,r,i){const{loadSiblings:s,skipLevelOfDetail:o}=this.options,a=e.children;a.sort(this.compareDistanceToCamera.bind(this));const c=e.refine===fs.REPLACE&&e.hasRenderContent&&!o;let h=!1,p=!0;for(const m of a)if(m._selectionDepth=i,m.isVisibleAndInRequestVolume?(r.find(m)&&r.delete(m),r.push(m),h=!0):(c||s)&&(this.loadTile(m,n),this.touchTile(m,n)),c){let v;if(m._inRequestVolume?m.hasRenderContent?v=m.contentAvailable:v=this.executeEmptyTraversal(m,n):v=!1,p=p&&v,!p)return!1}return h||(p=!1),p}updateTile(e,n){this.updateTileVisibility(e,n)}selectTile(e,n){this.shouldSelectTile(e)&&(e._selectedFrame=n.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,n){this.shouldLoadTile(e)&&(e._requestedFrame=n.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,n){e.tileset._cache.touch(e),e._touchedFrame=n.frameNumber}canTraverse(e,n,r=!1,i=!1){return e.hasChildren?e.hasTilesetContent?!e.contentExpired:!i&&!e.isVisibleAndInRequestVolume?!1:this.shouldRefine(e,n,r):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,n,r){let i=e._screenSpaceError;return r&&(i=e.getScreenSpaceError(n,!0)),i>this.options.maximumScreenSpaceError}updateTileVisibility(e,n){const r=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===n.viewport.id&&r.push(i);else r.push(n.viewport.id);e.updateVisibility(n,r)}compareDistanceToCamera(e,n){return e._distanceToCamera-n._distanceToCamera}anyChildrenVisible(e,n){let r=!1;for(const i of e.children)i.updateVisibility(n),r=r||i.isVisibleAndInRequestVolume;return r}executeEmptyTraversal(e,n){let r=!0;const i=this._emptyTraversalStack;for(i.push(e);i.length>0&&r;){const s=i.pop();if(this.updateTile(s,n),s.isVisibleAndInRequestVolume||this.loadTile(s,n),this.touchTile(s,n),!s.hasRenderContent&&this.canTraverse(s,n,!1,!0)){const a=s.children;for(const c of a)i.find(c)&&i.delete(c),i.push(c)}else s.contentAvailable||(r=!1)}return r}}const Jb=new ee;function AK(t){return t!=null}class H1{constructor(e,n,r,i=""){T(this,"tileset",void 0),T(this,"header",void 0),T(this,"id",void 0),T(this,"url",void 0),T(this,"parent",void 0),T(this,"refine",void 0),T(this,"type",void 0),T(this,"contentUrl",void 0),T(this,"lodMetricType",void 0),T(this,"lodMetricValue",void 0),T(this,"boundingVolume",void 0),T(this,"content",void 0),T(this,"contentState",void 0),T(this,"gpuMemoryUsageInBytes",void 0),T(this,"children",void 0),T(this,"depth",void 0),T(this,"viewportIds",void 0),T(this,"transform",void 0),T(this,"extensions",void 0),T(this,"userData",void 0),T(this,"computedTransform",void 0),T(this,"hasEmptyContent",void 0),T(this,"hasTilesetContent",void 0),T(this,"traverser",void 0),T(this,"_cacheNode",void 0),T(this,"_frameNumber",void 0),T(this,"_lodJudge",void 0),T(this,"_expireDate",void 0),T(this,"_expiredContent",void 0),T(this,"_shouldRefine",void 0),T(this,"_distanceToCamera",void 0),T(this,"_centerZDepth",void 0),T(this,"_screenSpaceError",void 0),T(this,"_visibilityPlaneMask",void 0),T(this,"_visible",void 0),T(this,"_inRequestVolume",void 0),T(this,"_stackLength",void 0),T(this,"_selectionDepth",void 0),T(this,"_touchedFrame",void 0),T(this,"_visitedFrame",void 0),T(this,"_selectedFrame",void 0),T(this,"_requestedFrame",void 0),T(this,"_priority",void 0),T(this,"_contentBoundingVolume",void 0),T(this,"_viewerRequestVolume",void 0),T(this,"_initialTransform",void 0),this.header=n,this.tileset=e,this.id=i||n.id,this.url=n.url,this.parent=r,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=Br.UNLOADED,this.gpuMemoryUsageInBytes=0,this.children=[],this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.depth=0,this.viewportIds=[],this.userData={},this.extensions=null,this._priority=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._screenSpaceError=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this.traverser=new x0({}),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._initialTransform=new Ye,this.transform=new Ye,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Br.READY||this.hasEmptyContent}get contentAvailable(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Br.UNLOADED}get contentExpired(){return this.contentState===Br.EXPIRED}get contentFailed(){return this.contentState===Br.FAILED}getScreenSpaceError(e,n){switch(this.tileset.type){case ji.I3S:return NI(this,e);case ji.TILES3D:return sK(this,e,n);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:n}=e.options,r=this.refine===fs.ADD||n;if(r&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Br.UNLOADED)return-1;const i=this.parent,o=i&&(!r||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,a=e.root?e.root._screenSpaceError:0;return Math.max(a-o,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Br.LOADING;const n=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!n)return this.contentState=Br.UNLOADED,!1;try{const r=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,s={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await ys(r,i,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Br.READY,this._onContentLoaded(),!0}catch(r){throw this.contentState=Br.FAILED,r}finally{n.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Br.UNLOADED,!0}updateVisibility(e,n){if(this._frameNumber===e.frameNumber)return;const r=this.parent,i=r?r._visibilityPlaneMask:Fr.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=r?r.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==Fr.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=n}visibility(e,n){const{cullingVolume:r}=e,{boundingVolume:i}=this;return r.computeVisibilityWithPlaneMask(i,n)}contentVisibility(){return!0}distanceToTile(e){const n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth({camera:e}){const n=this.boundingVolume;return Jb.subVectors(n.center,e.position),e.direction.dot(Jb)}insideViewerRequestVolume(e){const n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(AK(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=Br.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new Ye(e.transform):new Ye;const n=this.parent,r=this.tileset,i=n&&n.computedTransform?n.computedTransform.clone():r.modelMatrix.clone();this.computedTransform=new Ye(i).multiplyRight(this.transform);const s=n&&n._initialTransform?n._initialTransform.clone():new Ye;this._initialTransform=new Ye(s).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Br.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Fr.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||fs.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()&&(this.hasTilesetContent=!0)}_updateBoundingVolume(e){this.boundingVolume=Rg(e.boundingVolume,this.computedTransform,this.boundingVolume);const n=e.content;!n||(n.boundingVolume&&(this._contentBoundingVolume=Rg(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=Rg(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(e=new Ye){const n=e.clone().multiplyRight(this.transform);n.equals(this.computedTransform)||(this.computedTransform=n,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case"i3s":return{...this.tileset.options.i3s,tile:this.header,tileset:this.tileset.tileset,isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return lK(this.tileset.tileset)}}}class uK extends x0{compareDistanceToCamera(e,n){return n._distanceToCamera===0&&e._distanceToCamera===0?n._centerZDepth-e._centerZDepth:n._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,n){if(super.updateTileVisibility(e,n),!e.isVisibleAndInRequestVolume)return;const r=e.children.length>0;if(e.hasTilesetContent&&r){const o=e.children[0];this.updateTileVisibility(o,n),e._visible=o._visible;return}if(this.meetsScreenSpaceErrorEarly(e,n)){e._visible=!1;return}const i=e.refine===fs.REPLACE,s=e._optimChildrenWithinParent===ZJ.USE_OPTIMIZATION;if(i&&s&&r&&!this.anyChildrenVisible(e,n)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,n){const{parent:r}=e;return!r||r.hasTilesetContent||r.refine!==fs.ADD?!1:!this.shouldRefine(e,n,!0)}}class fK{constructor(){T(this,"frameNumberMap",new Map)}register(e,n){const r=this.frameNumberMap.get(e)||new Map,i=r.get(n)||0;r.set(n,i+1),this.frameNumberMap.set(e,r)}deregister(e,n){const r=this.frameNumberMap.get(e);if(!r)return;const i=r.get(n)||1;r.set(n,i-1)}isZero(e,n){var r;return(((r=this.frameNumberMap.get(e))===null||r===void 0?void 0:r.get(n))||0)===0}}const Dg={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class hK{constructor(){T(this,"_statusMap",void 0),T(this,"pendingTilesRegister",new fK),this._statusMap={}}add(e,n,r,i){if(!this._statusMap[n]){const{frameNumber:s,viewport:{id:o}}=i;this._statusMap[n]={request:e,callback:r,key:n,frameState:i,status:Dg.REQUESTED},this.pendingTilesRegister.register(o,s),e().then(a=>{this._statusMap[n].status=Dg.COMPLETED;const{frameNumber:c,viewport:{id:h}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(h,c),this._statusMap[n].callback(a,i)}).catch(a=>{this._statusMap[n].status=Dg.ERROR;const{frameNumber:c,viewport:{id:h}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(h,c),r(a)})}}update(e,n){if(this._statusMap[e]){const{frameNumber:r,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,r);const{frameNumber:s,viewport:{id:o}}=n;this.pendingTilesRegister.register(o,s),this._statusMap[e].frameState=n}}find(e){return this._statusMap[e]}hasPendingTiles(e,n){return!this.pendingTilesRegister.isZero(e,n)}}class dK extends x0{traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}constructor(e){super(e),T(this,"_tileManager",void 0),this._tileManager=new hK}shouldRefine(e,n){return e._lodJudge=aK(e,n),e._lodJudge==="DIG"}updateChildTiles(e,n){const r=e.header.children||[],i=e.children,s=e.tileset;for(const o of r){const a="".concat(o.id,"-").concat(n.viewport.id),c=i&&i.find(h=>h.id===a);if(c)c&&this.updateTile(c,n);else{let h=()=>this._loadTile(o.id,s);this._tileManager.find(a)?this._tileManager.update(a,n):(s.tileset.nodePages&&(h=()=>s.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(h,a,m=>this._onTileLoad(m,e,a),n))}}return!1}async _loadTile(e,n){const{loader:r}=n,i=n.getTileUrl("".concat(n.url,"/nodes/").concat(e)),s={...n.loadOptions,i3s:{...n.loadOptions.i3s,isTileHeader:!0,loadContent:!1}};return await ys(i,r,s)}_onTileLoad(e,n,r){const i=new H1(n.tileset,e,n,r);n.children.push(i);const s=this._tileManager.find(i.id).frameState;this.updateTile(i,s),this._frameNumber===s.frameNumber&&(this.traversalFinished(s)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,s)}}const pK={description:"",ellipsoid:Cn.WGS84,modelMatrix:new Ye,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},$f="Tiles In Tileset(s)",kg="Tiles In Memory",Kb="Tiles In View",Zb="Tiles To Render",qb="Tiles Loaded",Ng="Tiles Loading",ex="Tiles Unloaded",tx="Failed Tile Loads",nx="Points/Vertices",Ug="Tile Memory Use";class gK{constructor(e,n){T(this,"options",void 0),T(this,"loadOptions",void 0),T(this,"type",void 0),T(this,"tileset",void 0),T(this,"loader",void 0),T(this,"url",void 0),T(this,"basePath",void 0),T(this,"modelMatrix",void 0),T(this,"ellipsoid",void 0),T(this,"lodMetricType",void 0),T(this,"lodMetricValue",void 0),T(this,"refine",void 0),T(this,"root",void 0),T(this,"roots",void 0),T(this,"asset",void 0),T(this,"description",void 0),T(this,"properties",void 0),T(this,"extras",void 0),T(this,"attributions",void 0),T(this,"credits",void 0),T(this,"stats",void 0),T(this,"traverseCounter",void 0),T(this,"geometricError",void 0),T(this,"selectedTiles",void 0),T(this,"updatePromise",null),T(this,"tilesetInitializationPromise",void 0),T(this,"cartographicCenter",void 0),T(this,"cartesianCenter",void 0),T(this,"zoom",void 0),T(this,"boundingVolume",void 0),T(this,"gpuMemoryUsageInBytes",void 0),T(this,"dynamicScreenSpaceErrorComputedDensity",void 0),T(this,"_traverser",void 0),T(this,"_cache",void 0),T(this,"_requestScheduler",void 0),T(this,"_frameNumber",void 0),T(this,"_queryParamsString",void 0),T(this,"_queryParams",void 0),T(this,"_extensionsUsed",void 0),T(this,"_tiles",void 0),T(this,"_pendingCount",void 0),T(this,"lastUpdatedVieports",void 0),T(this,"_requestedTiles",void 0),T(this,"_emptyTiles",void 0),T(this,"frameStateData",void 0),T(this,"maximumMemoryUsage",void 0),Ct(e),this.options={...pK,...n},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||x3(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this.root=null,this.roots={},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.traverseCounter=0,this.geometricError=0,this._traverser=this._initializeTraverser(),this._cache=new VJ,this._requestScheduler=new b3({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this._frameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this.frameStateData={},this.lastUpdatedVieports=null,this._queryParams={},this._queryParamsString="",this.maximumMemoryUsage=this.options.maximumMemoryUsage||32,this.gpuMemoryUsageInBytes=0,this.stats=new pu({id:this.url}),this._initializeStats(),this._extensionsUsed=void 0,this.dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description||"",this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return this._queryParamsString||(this._queryParamsString=mK(this._queryParams)),this._queryParamsString}setProps(e){this.options={...this.options,...e}}setOptions(e){this.options={...this.options,...e}}getTileUrl(e){return e.startsWith("data:")?e:"".concat(e).concat(this.queryParams)}hasExtension(e){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(e)>-1)}update(e=null){this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(e=null){return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(n=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),n(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const n=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;const r=[];for(const i of n){const s=i.id;this._needTraverse(s)?r.push(s):this.traverseCounter--}for(const i of n){const s=i.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!r.includes(s))continue;const o=jJ(i,this._frameNumber);this._traverser.traverse(this.roots[s],o,this.options)}}_needTraverse(e){let n=e;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[e]),n===e}_onTraversalEnd(e){const n=e.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const r=this.frameStateData[n],i=Object.values(this._traverser.selectedTiles),[s,o]=WJ(i,e,this.options.maximumTilesSelected);r.selectedTiles=s;for(const a of o)a.unselect();r._requestedTiles=Object.values(this._traverser.requestedTiles),r._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const n=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,n){if(e.length!==n.length)return!0;const r=new Set(e.map(o=>o.id)),i=new Set(n.map(o=>o.id));let s=e.filter(o=>!i.has(o.id)).length>0;return s=s||n.filter(o=>!r.has(o.id)).length>0,s}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,n)=>e._unloadTile(n))}_updateStats(){let e=0,n=0;for(const r of this.selectedTiles)r.contentAvailable&&r.content&&(e++,r.content.pointCount?n+=r.content.pointCount:n+=r.content.vertexCount);this.stats.get(Kb).count=this.selectedTiles.length,this.stats.get(Zb).count=e,this.stats.get(nx).count=n}async _initializeTileSet(e){this.type===ji.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===ji.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===ji.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var e;const n=this.tileset.fullExtent;if(n){const{xmin:i,xmax:s,ymin:o,ymax:a,zmin:c,zmax:h}=n;this.cartographicCenter=new ee(i+(s-i)/2,o+(a-o)/2,c+(h-c)/2),this.cartesianCenter=Cn.WGS84.cartographicToCartesian(this.cartographicCenter,new ee),this.zoom=DI(n,this.cartographicCenter,this.cartesianCenter);return}const r=(e=this.tileset.store)===null||e===void 0?void 0:e.extent;if(r){const[i,s,o,a]=r;this.cartographicCenter=new ee(i+(o-i)/2,s+(a-s)/2,0),this.cartesianCenter=Cn.WGS84.cartographicToCartesian(this.cartographicCenter,new ee),this.zoom=JJ(r,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new ee,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root;Ct(e);const{center:n}=e.boundingVolume;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new ee,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?this.cartographicCenter=Cn.WGS84.cartesianToCartographic(n,new ee):this.cartographicCenter=new ee(0,0,-Cn.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=YJ(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get($f),this.stats.get(Ng),this.stats.get(kg),this.stats.get(Kb),this.stats.get(Zb),this.stats.get(qb),this.stats.get(ex),this.stats.get(tx),this.stats.get(nx,"memory"),this.stats.get(Ug,"memory")}_initializeTileHeaders(e,n){const r=new H1(this,e.root,n);if(n&&(n.children.push(r),r.depth=n.depth+1),this.type===ji.TILES3D){const i=[];for(i.push(r);i.length>0;){const s=i.pop();this.stats.get($f).incrementCount();const o=s.header.children||[];for(const a of o){const c=new H1(this,a,s);s.children.push(c),c.depth=s.depth+1,i.push(c)}}}return r}_initializeTraverser(){let e;switch(this.type){case ji.TILES3D:e=uK;break;case ji.I3S:e=dK;break;default:e=x0}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let n;try{this._onStartTileLoading(),n=await e.loadContent()}catch(r){this._onTileLoadError(e,r)}finally{this._onEndTileLoading(),this._onTileLoad(e,n)}}_onTileLoadError(e,n){this.stats.get(tx).incrementCount();const r=n.message||n.toString(),i=e.url;console.error("A 3D tile failed to load: ".concat(e.url," ").concat(r)),this.options.onTileError(e,r,i)}_onTileLoad(e,n){if(!!n){if(this.type===ji.I3S){var r,i;const s=((r=this.tileset)===null||r===void 0||(i=r.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get($f).reset(),this.stats.get($f).addCount(s)}e&&e.content&&HJ(e,e.content),this._addTileToCache(e),this.options.onTileLoad(e)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(Ng).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(Ng).decrementCount()}_addTileToCache(e){this._cache.add(this,e,n=>n._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(qb).incrementCount(),this.stats.get(kg).incrementCount(),this.gpuMemoryUsageInBytes+=e.content.byteLength||0,this.stats.get(Ug).count=this.gpuMemoryUsageInBytes}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.content&&e.content.byteLength||0,this.stats.get(kg).decrementCount(),this.stats.get(ex).incrementCount(),this.stats.get(Ug).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const n=e.pop();for(const r of n.children)e.push(r);this._destroyTile(n)}this.root=null}_destroySubtree(e){const n=e,r=[];for(r.push(n);r.length>0;){e=r.pop();for(const i of e.children)r.push(i);e!==n&&this._destroyTile(e)}n.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed,this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}function mK(t){const e=[];for(const n of Object.keys(t))e.push("".concat(n,"=").concat(t[n]));switch(e.length){case 0:return"";case 1:return"?".concat(e[0]);default:return"?".concat(e.join("&"))}}const UI="3.2.9",Nc={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function GI(t,e,n){Ct(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}function yK(t,e=0){const n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}const _K={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},hn={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},gt={..._K,...hn},Gg={[hn.DOUBLE]:Float64Array,[hn.FLOAT]:Float32Array,[hn.UNSIGNED_SHORT]:Uint16Array,[hn.UNSIGNED_INT]:Uint32Array,[hn.UNSIGNED_BYTE]:Uint8Array,[hn.BYTE]:Int8Array,[hn.SHORT]:Int16Array,[hn.INT]:Int32Array},vK={DOUBLE:hn.DOUBLE,FLOAT:hn.FLOAT,UNSIGNED_SHORT:hn.UNSIGNED_SHORT,UNSIGNED_INT:hn.UNSIGNED_INT,UNSIGNED_BYTE:hn.UNSIGNED_BYTE,BYTE:hn.BYTE,SHORT:hn.SHORT,INT:hn.INT},zg="Failed to convert GL type";class Ji{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const n in Gg)if(Gg[n]===e)return n;throw new Error(zg)}static fromName(e){const n=vK[e];if(!n)throw new Error(zg);return n}static getArrayType(e){switch(e){case hn.UNSIGNED_SHORT_5_6_5:case hn.UNSIGNED_SHORT_4_4_4_4:case hn.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const n=Gg[e];if(!n)throw new Error(zg);return n}}static getByteSize(e){return Ji.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return Boolean(Ji.getArrayType(e))}static createTypedArray(e,n,r=0,i){i===void 0&&(i=(n.byteLength-r)/Ji.getByteSize(e));const s=Ji.getArrayType(e);return new s(n,r,i)}}function EK(t,e){if(!t)throw new Error("math.gl assertion failed. ".concat(e))}function wK(t,e=[0,0,0]){const n=t>>11&31,r=t>>5&63,i=t&31;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}new g_;new ee;new g_;new g_;function rx(t,e=255){return On(t,0,e)/e*2-1}function ix(t){return t<0?-1:1}function TK(t,e,n,r){if(EK(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(r.x=rx(t,n),r.y=rx(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const i=r.x;r.x=(1-Math.abs(r.y))*ix(i),r.y=(1-Math.abs(i))*ix(r.y)}return r.normalize()}function bK(t,e,n){return TK(t,e,255,n)}class iv{constructor(e,n){T(this,"json",void 0),T(this,"buffer",void 0),T(this,"featuresLength",0),T(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=n}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return Boolean(this.json[e])}getGlobalProperty(e,n=gt.UNSIGNED_INT,r=1){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(e,n,r,1,i.byteOffset):i}getPropertyArray(e,n,r){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(n=Ji.fromName(i.componentType)),this._getTypedArrayFromBinary(e,n,r,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(e,n,i)}getProperty(e,n,r,i,s){const o=this.json[e];if(!o)return o;const a=this.getPropertyArray(e,n,r);if(r===1)return a[i];for(let c=0;c<r;++c)s[c]=a[r*i+c];return s}_getTypedArrayFromBinary(e,n,r,i,s){const o=this._cachedTypedArrays;let a=o[e];return a||(a=Ji.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+s,i*r),o[e]=a),a}_getTypedArrayFromArray(e,n,r){const i=this._cachedTypedArrays;let s=i[e];return s||(s=Ji.createTypedArray(n,r),i[e]=s),s}}const xK={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},CK={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},SK={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function PK(t,e,n,r){const{componentType:i}=t;Ct(t.componentType);const s=typeof i=="string"?Ji.fromName(i):i,o=xK[t.type],a=CK[t.type],c=SK[t.type];return n+=t.byteOffset,{values:Ji.createTypedArray(s,e,n,o*r),type:s,size:o,unpacker:a,packer:c}}const Yi=t=>t!==void 0;function MK(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?IK(r,n):null}function IK(t,e){let n,r,i;const s=t.instancesLength,o=t.classes;let a=t.classIds,c=t.parentCounts,h=t.parentIds,p=s;Yi(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,i=getBinaryAccessor(a),a=i.createArrayBufferView(e.buffer,e.byteOffset+a.byteOffset,s));let m;if(Yi(c))for(Yi(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,s)),m=new Uint16Array(s),p=0,n=0;n<s;++n)m[n]=p,p+=c[n];Yi(h)&&Yi(h.byteOffset)&&(h.componentType=defaultValue(h.componentType,GL.UNSIGNED_SHORT),h.type=AttributeType.SCALAR,i=getBinaryAccessor(h),h=i.createArrayBufferView(e.buffer,e.byteOffset+h.byteOffset,p));const v=o.length;for(n=0;n<v;++n){const I=o[n].length,S=o[n].instances,P=getBinaryProperties(I,S,e);o[n].instances=combine(P,S)}const E=new Array(v).fill(0),b=new Uint16Array(s);for(n=0;n<s;++n)r=a[n],b[n]=E[r],++E[r];const x={classes:o,classIds:a,classIndexes:b,parentCounts:c,parentIndexes:m,parentIds:h};return RK(x),x}function Uc(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?BK(t,e,n):LK(t,e,n)}function BK(t,e,n){const r=t.classIds,i=t.parentCounts,s=t.parentIds,o=t.parentIndexes,a=r.length,c=scratchVisited;c.length=Math.max(c.length,a);const h=++marker,p=scratchStack;for(p.length=0,p.push(e);p.length>0;){if(e=p.pop(),c[e]===h)continue;c[e]=h;const m=n(t,e);if(Yi(m))return m;const v=i[e],E=o[e];for(let b=0;b<v;++b){const x=s[E+b];x!==e&&p.push(x)}}return null}function LK(t,e,n){let r=!0;for(;r;){const i=n(t,e);if(Yi(i))return i;const s=t.parentIds[e];r=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}function RK(t){const n=t.classIds.length;for(let r=0;r<n;++r)zI(t,r,stack)}function zI(t,e,n){const r=t.parentCounts,i=t.parentIds,s=t.parentIndexes,a=t.classIds.length;if(!Yi(i))return;assert(e<a,"Parent index ".concat(e," exceeds the total number of instances: ").concat(a)),assert(n.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),n.push(e);const c=Yi(r)?r[e]:1,h=Yi(r)?s[e]:e;for(let p=0;p<c;++p){const m=i[h+p];m!==e&&zI(t,m,n)}n.pop(e)}function gr(t){return t!=null}const Xf=(t,e)=>t,OK={HIERARCHY:!0,extensions:!0,extras:!0};class VI{constructor(e,n,r,i={}){var s;T(this,"json",void 0),T(this,"binary",void 0),T(this,"featureCount",void 0),T(this,"_extensions",void 0),T(this,"_properties",void 0),T(this,"_binaryProperties",void 0),T(this,"_hierarchy",void 0),Ct(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=((s=this.json)===null||s===void 0?void 0:s.extensions)||{},this._properties={};for(const o in this.json)OK[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=MK(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,n){if(this._checkBatchId(e),Ct(typeof n=="string",n),this._hierarchy){const r=Uc(this._hierarchy,e,(i,s)=>{const o=i.classIds[s];return i.classes[o].name===n});return gr(r)}return!1}isExactClass(e,n){return Ct(typeof n=="string",n),this.getExactClassName(e)===n}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const n=this._hierarchy.classIds[e];return this._hierarchy.classes[n].name}}hasProperty(e,n){return this._checkBatchId(e),Ct(typeof n=="string",n),gr(this._properties[n])||this._hasPropertyInHierarchy(e,n)}getPropertyNames(e,n){this._checkBatchId(e),n=gr(n)?n:[],n.length=0;const r=Object.keys(this._properties);return n.push(...r),this._hierarchy&&this._getPropertyNamesInHierarchy(e,n),n}getProperty(e,n){if(this._checkBatchId(e),Ct(typeof n=="string",n),this._binaryProperties){const i=this._binaryProperties[n];if(gr(i))return this._getBinaryProperty(i,e)}const r=this._properties[n];if(gr(r))return Xf(r[e]);if(this._hierarchy){const i=this._getHierarchyProperty(e,n);if(gr(i))return i}}setProperty(e,n,r){const i=this.featureCount;if(this._checkBatchId(e),Ct(typeof n=="string",n),this._binaryProperties){const o=this._binaryProperties[n];if(o){this._setBinaryProperty(o,e,r);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,n,r))return;let s=this._properties[n];gr(s)||(this._properties[n]=new Array(i),s=this._properties[n]),s[e]=Xf(r)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,n){return e.unpack(e.typedArray,n)}_setBinaryProperty(e,n,r){e.pack(r,e.typedArray,n)}_initializeBinaryProperties(){let e=null;for(const n in this._properties){const r=this._properties[n],i=this._initializeBinaryProperty(n,r);i&&(e=e||{},e[n]=i)}return e}_initializeBinaryProperty(e,n){if("byteOffset"in n){const r=n;Ct(this.binary,"Property ".concat(e," requires a batch table binary.")),Ct(r.type,"Property ".concat(e," requires a type."));const i=PK(r,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(e,n){if(!this._hierarchy)return!1;const r=Uc(this._hierarchy,e,(i,s)=>{const o=i.classIds[s],a=i.classes[o].instances;return gr(a[n])});return gr(r)}_getPropertyNamesInHierarchy(e,n){Uc(this._hierarchy,e,(r,i)=>{const s=r.classIds[i],o=r.classes[s].instances;for(const a in o)o.hasOwnProperty(a)&&n.indexOf(a)===-1&&n.push(a)})}_getHierarchyProperty(e,n){return Uc(this._hierarchy,e,(r,i)=>{const s=r.classIds[i],o=r.classes[s],a=r.classIndexes[i],c=o.instances[n];return gr(c)?gr(c.typedArray)?this._getBinaryProperty(c,a):Xf(c[a]):null})}_setHierarchyProperty(e,n,r,i){const s=Uc(this._hierarchy,n,(o,a)=>{const c=o.classIds[a],h=o.classes[c],p=o.classIndexes[a],m=h.instances[r];return gr(m)?(Ct(a===n,'Inherited property "'.concat(r,'" is read-only.')),gr(m.typedArray)?this._setBinaryProperty(m,p,i):m[p]=Xf(i),!0):!1});return gr(s)}}const Vg=4;function C0(t,e,n=0){const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=Vg,t.version=r.getUint32(n,!0),n+=Vg,t.byteLength=r.getUint32(n,!0),n+=Vg,t.version!==1)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}const Fa=4,sx="b3dm tile in legacy format.";function sv(t,e,n){const r=new DataView(e);let i;t.header=t.header||{};let s=r.getUint32(n,!0);n+=Fa;let o=r.getUint32(n,!0);n+=Fa;let a=r.getUint32(n,!0);n+=Fa;let c=r.getUint32(n,!0);return n+=Fa,a>=570425344?(n-=Fa*2,i=s,a=o,c=0,s=0,o=0,console.warn(sx)):c>=570425344&&(n-=Fa,i=a,a=s,c=o,s=0,o=0,console.warn(sx)),t.header.featureTableJsonByteLength=s,t.header.featureTableBinaryByteLength=o,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=c,t.header.batchLength=i,n}function ov(t,e,n,r){return n=FK(t,e,n),n=DK(t,e,n),n}function FK(t,e,n,r){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:o}=t.header;if(t.featureTableJson={BATCH_LENGTH:o||0},i>0){const a=GI(e,n,i);t.featureTableJson=JSON.parse(a)}return n+=i,t.featureTableBinary=new Uint8Array(e,n,s),n+=s,n}function DK(t,e,n,r){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=t.header;if(i>0){const o=GI(e,n,i);t.batchTableJson=JSON.parse(o),n+=i,s>0&&(t.batchTableBinary=new Uint8Array(e,n,s),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=s)}return n}function HI(t,e,n){if(!e&&(!t||!t.batchIds||!n))return null;const{batchIds:r,isRGB565:i,pointCount:s}=t;if(r&&n){const o=new Uint8ClampedArray(s*3);for(let a=0;a<s;a++){const c=r[a],p=n.getProperty(c,"dimensions").map(m=>m*255);o[a*3]=p[0],o[a*3+1]=p[1],o[a*3+2]=p[2]}return{type:gt.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(i){const o=new Uint8ClampedArray(s*3);for(let a=0;a<s;a++){const c=wK(e[a]);o[a*3]=c[0],o[a*3+1]=c[1],o[a*3+2]=c[2]}return{type:gt.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}return e&&e.length===s*3?{type:gt.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:gt.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}const ox=new ee;function kK(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(t.pointsLength*3);for(let r=0;r<t.pointsLength;r++)bK(e[r*2],e[r*2+1],ox),ox.toArray(n,r*3);return{type:gt.FLOAT,size:2,value:n}}return{type:gt.FLOAT,size:2,value:e}}function NK(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,UK(t,e)):{type:gt.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function UK(t,e){const n=new ee,r=new Float32Array(t.pointCount*3);for(let i=0;i<t.pointCount;i++)n.set(e[i*3],e[i*3+1],e[i*3+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,i*3);return r}async function GK(t,e,n,r,i){n=C0(t,e,n),n=sv(t,e,n),n=ov(t,e,n),zK(t);const{featureTable:s,batchTable:o}=VK(t);return await $K(t,s,o,r,i),HK(t,s,r),jK(t,s,o),WK(t,s),n}function zK(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function VK(t){const e=new iv(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",gt.FLOAT,3);const r=QK(t,e);return{featureTable:e,batchTable:r}}function HK(t,e,n){if(!t.attributes.positions){if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",gt.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",gt.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=(1<<16)-1,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",gt.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",gt.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=NK(t,r,n)}}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function jK(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",gt.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",gt.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",gt.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=HI(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",gt.UNSIGNED_BYTE,4))}function WK(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",gt.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",gt.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=kK(t,n)}}function QK(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",gt.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=t;n=new VI(i,s,r)}return n}async function $K(t,e,n,r,i){let s,o,a;const c=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];c&&(a=c.properties);const h=e.getExtension("3DTILES_draco_point_compression");if(h){o=h.properties;const m=h.byteOffset,v=h.byteLength;if(!o||!Number.isFinite(m)||!v)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=t.featureTableBinary.slice(m,m+v),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA)}if(!s)return!0;const p={buffer:s,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await XK(t,p,r,i)}async function XK(t,e,n,r){const{parse:i}=r,s={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete s["3d-tiles"];const o=await i(e.buffer,II,s),a=o.attributes.POSITION&&o.attributes.POSITION.value,c=o.attributes.COLOR_0&&o.attributes.COLOR_0.value,h=o.attributes.NORMAL&&o.attributes.NORMAL.value,p=o.attributes.BATCH_ID&&o.attributes.BATCH_ID.value,m=a&&o.attributes.POSITION.value.quantization,v=h&&o.attributes.NORMAL.value.quantization;if(m){const b=o.POSITION.data.quantization,x=b.range;t.quantizedVolumeScale=new ee(x,x,x),t.quantizedVolumeOffset=new ee(b.minValues),t.quantizedRange=(1<<b.quantizationBits)-1,t.isQuantizedDraco=!0}v&&(t.octEncodedRange=(1<<o.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const E={};if(e.batchTableProperties)for(const b of Object.keys(e.batchTableProperties))o.attributes[b]&&o.attributes[b].value&&(E[b.toLowerCase()]=o.attributes[b].value);t.attributes={positions:a,colors:HI(t,c,void 0),normals:h,batchIds:p,...E}}const j1={URI:0,EMBEDDED:1};function jI(t,e,n,r){t.rotateYtoZ=!0;const i=t.byteOffset+t.byteLength-n;if(i===0)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=Ky(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4===0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}async function WI(t,e,n,r){const i=n["3d-tiles"]||{};if(YK(t,e),i.loadGLTF){const{parse:s,fetch:o}=r;t.gltfUrl&&(t.gltfArrayBuffer=await o(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await s(t.gltfArrayBuffer,ru,n,r),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}function YK(t,e,n){switch(e){case j1.URI:const r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),s=new TextDecoder().decode(r);t.gltfUrl=s.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case j1.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function JK(t,e,n,r,i){var s;n=KK(t,e,n,r),await WI(t,j1.EMBEDDED,r,i);const o=t==null||(s=t.gltf)===null||s===void 0?void 0:s.extensions;return o&&o.CESIUM_RTC&&(t.rtcCenter=o.CESIUM_RTC.center),n}function KK(t,e,n,r,i){n=C0(t,e,n),n=sv(t,e,n),n=ov(t,e,n),n=jI(t,e,n,r);const s=new iv(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=s.getGlobalProperty("RTC_CENTER",gt.FLOAT,3),n}async function ZK(t,e,n,r,i){return n=qK(t,e,n,r),await WI(t,t.gltfFormat,r,i),n}function qK(t,e,n,r,i){if(n=C0(t,e,n),t.version!==1)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=sv(t,e,n);const s=new DataView(e);if(t.gltfFormat=s.getUint32(n,!0),n+=4,n=ov(t,e,n),n=jI(t,e,n,r),t.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new iv(t.featureTableJson,t.featureTableBinary),a=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",gt.FLOAT,3);const c=new VI(t.batchTableJson,t.batchTableBinary,a);return eZ(t,o,c,a),n}function eZ(t,e,n,r){const s={instances:new Array(r),batchTable:t._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,o=new ee;new ee,new ee,new ee;const a=new xn,c=new HA,h=new ee,p={},m=new Ye,v=[],E=[],b=new ee,x=new ee;for(let I=0;I<r;I++){let S;if(e.hasProperty("POSITION"))S=e.getProperty("POSITION",gt.FLOAT,3,I,o);else if(e.hasProperty("POSITION_QUANTIZED")){S=e.getProperty("POSITION_QUANTIZED",gt.UNSIGNED_SHORT,3,I,o);const X=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",gt.FLOAT,3,b);if(!X)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const Z=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",gt.FLOAT,3,x);if(!Z)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const Q=65535;for(let k=0;k<3;k++)S[k]=S[k]/Q*Z[k]+X[k]}if(!S)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(o.copy(S),p.translation=o,t.normalUp=e.getProperty("NORMAL_UP",gt.FLOAT,3,I,v),t.normalRight=e.getProperty("NORMAL_RIGHT",gt.FLOAT,3,I,E),t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",gt.UNSIGNED_SHORT,2,v),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",gt.UNSIGNED_SHORT,2,E),t.octNormalUp)throw t.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");t.eastNorthUp?(Cn.WGS84.eastNorthUpToFixedFrame(o,m),m.getRotationMatrix3(a)):a.identity()}c.fromMatrix3(a),p.rotation=c,h.set(1,1,1);const P=e.getProperty("SCALE",gt.FLOAT,1,I);Number.isFinite(P)&&h.multiplyByScalar(P);const M=e.getProperty("SCALE_NON_UNIFORM",gt.FLOAT,3,I,v);M&&h.scale(M),p.scale=h;let O=e.getProperty("BATCH_ID",gt.UNSIGNED_SHORT,1,I);O===void 0&&(O=I);const N=new Ye().fromQuaternion(p.rotation);m.identity(),m.translate(p.translation),m.multiplyRight(N),m.scale(p.scale);const z=m.clone();s[I]={modelMatrix:z,batchId:O}}t.instances=s}async function tZ(t,e,n,r,i,s){n=C0(t,e,n);const o=new DataView(e);for(t.tilesLength=o.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const a={};t.tiles.push(a),n=await s(e,n,r,i,a)}return n}async function nZ(t,e,n,r){t.rotateYtoZ=!0,t.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=r;t.gltf=await i(e,ru,n,r)}async function QI(t,e=0,n,r,i={}){switch(i.byteOffset=e,i.type=yK(t,e),i.type){case Nc.COMPOSITE:return await tZ(i,t,e,n,r,QI);case Nc.BATCHED_3D_MODEL:return await JK(i,t,e,n,r);case Nc.GLTF:return await nZ(i,t,n,r);case Nc.INSTANCED_3D_MODEL:return await ZK(i,t,e,n,r);case Nc.POINT_CLOUD:return await GK(i,t,e,n,r);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}const rZ=1952609651,iZ=1;async function sZ(t){if(new Uint32Array(t.slice(0,4))[0]!==rZ)throw new Error("Wrong subtree file magic number");if(new Uint32Array(t.slice(4,8))[0]!==iZ)throw new Error("Wrong subtree file verson, must be 1");const r=ax(t.slice(8,16)),i=new Uint8Array(t,24,r),o=new TextDecoder("utf8").decode(i),a=JSON.parse(o),c=ax(t.slice(16,24));let h=new ArrayBuffer(0);return c&&(h=t.slice(24+r)),"bufferView"in a.tileAvailability&&(a.tileAvailability.explicitBitstream=await Hg(a,"tileAvailability",h)),"bufferView"in a.contentAvailability&&(a.contentAvailability.explicitBitstream=await Hg(a,"contentAvailability",h)),"bufferView"in a.childSubtreeAvailability&&(a.childSubtreeAvailability.explicitBitstream=await Hg(a,"childSubtreeAvailability",h)),a}async function Hg(t,e,n){const r=t[e].bufferView,i=t.bufferViews[r],s=t.buffers[i.buffer];if(s.uri){const a=await(await qm(s.uri)).arrayBuffer();return new Uint8Array(a,i.byteOffset,i.byteLength)}return new Uint8Array(n,i.byteOffset,i.byteLength)}function ax(t){const e=new DataView(t),n=e.getUint32(0,!0),r=e.getUint32(4,!0);return n+2**32*r}const $I={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:UI,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:sZ,options:{}},oZ=4,aZ=8,lZ={QUADTREE:oZ,OCTREE:aZ};async function XI(t){const{options:e,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:r=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0}}=t;let{subtree:s,level:o=0}=t;const{subdivisionScheme:a,subtreeLevels:c,maximumLevel:h,contentUrlTemplate:p,subtreesUriTemplate:m,basePath:v}=e,E={children:[],lodMetricValue:0,contentUrl:""},b=lZ[a],x=r&1,I=r>>1&1,S=r>>2&1,P=(b**o-1)/(b-1);let M=Lo(n.mortonIndex,r),O=P+M,N=Lo(n.x,x),z=Lo(n.y,I),X=Lo(n.z,S),Z=!1;o+1>c&&(Z=jg(s.childSubtreeAvailability,M));const Q=Lo(i.x,N),k=Lo(i.y,z),D=Lo(i.z,X),ne=o+i.level;if(Z){const Ue="".concat(v,"/").concat(m),le=W1(Ue,ne,Q,k,D);s=await ys(le,$I),i.mortonIndex=M,i.x=N,i.y=z,i.z=X,i.level=o,M=0,O=0,N=0,z=0,X=0,o=0}if(!jg(s.tileAvailability,O)||o>h)return E;jg(s.contentAvailability,O)&&(E.contentUrl=W1(p,ne,Q,k,D));const xe=o+1,Pe={mortonIndex:M,x:N,y:z,z:X};for(let Ue=0;Ue<b;Ue++){const le=await XI({subtree:s,options:e,parentData:Pe,childIndex:Ue,level:xe,globalData:i});if(le.contentUrl||le.children.length){const _e=ne+1,Fe=cZ(le,_e,{childTileX:N,childTileY:z,childTileZ:X},e);E.children.push(Fe)}}return E}function jg(t,e){return"constant"in t?Boolean(t.constant):t.explicitBitstream?fZ(e,t.explicitBitstream):!1}function cZ(t,e,n,r){const{basePath:i,refine:s,getRefine:o,lodMetricType:a,getTileType:c,rootLodMetricValue:h,rootBoundingVolume:p}=r,m=t.contentUrl&&t.contentUrl.replace("".concat(i,"/"),""),v=h/2**e,E=AZ(e,p,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:m},id:t.contentUrl,refine:o(s),type:c(t),lodMetricType:a,lodMetricValue:v,boundingVolume:E}}function AZ(t,e,n){if(e.region){const{childTileX:r,childTileY:i,childTileZ:s}=n,[o,a,c,h,p,m]=e.region,v=2**t,E=(c-o)/v,b=(h-a)/v,x=(m-p)/v,[I,S]=[o+E*r,o+E*(r+1)],[P,M]=[a+b*i,a+b*(i+1)],[O,N]=[p+x*s,p+x*(s+1)];return{region:[I,P,S,M,O,N]}}return console.warn("Unsupported bounding volume type: ",e),null}function Lo(t,e){return parseInt(t.toString(2)+e.toString(2),2)}function W1(t,e,n,r,i){const s=uZ({level:e,x:n,y:r,z:i});return t.replace(/{level}|{x}|{y}|{z}/gi,o=>s[o])}function uZ(t){const e={};for(const n in t)e["{".concat(n,"}")]=t[n];return e}function fZ(t,e){const n=Math.floor(t/8),r=t%8;return(e[n]>>r&1)===1}function av(t){if(!t.contentUrl)return Pl.EMPTY;const n=t.contentUrl.split(".").pop();switch(n){case"pnts":return Pl.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Pl.SCENEGRAPH;default:return n}}function lv(t){switch(t){case"REPLACE":case"replace":return fs.REPLACE;case"ADD":case"add":return fs.ADD;default:return t}}function Q1(t,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const r=new URL(t,"".concat(e,"/"));return decodeURI(r.toString())}else if(t.startsWith("/"))return t;return"".concat(e,"/").concat(t)}function lx(t,e){if(!t)return null;if(t.content){const n=t.content.uri||t.content.url;t.contentUrl=Q1(n,e.basePath)}return t.id=t.contentUrl,t.lodMetricType=b0.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=av(t),t.refine=lv(t.refine),t}function hZ(t){const e=t.basePath,n=lx(t.root,t),r=[];for(r.push(n);r.length>0;){const s=(r.pop()||{}).children||[];for(const o of s)lx(o,{basePath:e}),r.push(o)}return n}async function dZ(t){if(!t.root)return null;const e=t.basePath,n=t.root.extensions["3DTILES_implicit_tiling"],{subdivisionScheme:r,maximumLevel:i,subtreeLevels:s,subtrees:{uri:o}}=n,a=W1(o,0,0,0,0),c=Q1(a,e),h=await ys(c,$I),p=Q1(t.root.content.uri,e),m=t.root.refine,v=t.root.geometricError,E=t.root.boundingVolume,b={contentUrlTemplate:p,subtreesUriTemplate:o,subdivisionScheme:r,subtreeLevels:s,maximumLevel:i,refine:m,basePath:e,lodMetricType:b0.GEOMETRIC_ERROR,rootLodMetricValue:v,rootBoundingVolume:E,getTileType:av,getRefine:lv};return await pZ(t.root,h,b)}async function pZ(t,e,n){if(!t)return null;t.lodMetricType=b0.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform;const{children:r,contentUrl:i}=await XI({subtree:e,options:n});return i&&(t.contentUrl=i,t.content={uri:i.replace("".concat(n.basePath,"/"),"")}),t.refine=lv(t.refine),t.type=av(t),t.children=r,t.id=t.contentUrl,t}const cx="3DTILES_implicit_tiling",YI={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:UI,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:_Z,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function gZ(t){return x3(t.url)}async function mZ(t,e,n){const r={content:{featureIds:null}};return await QI(t,0,e,n,r.content),r.content}async function yZ(t,e,n){var r;const i=JSON.parse(new TextDecoder().decode(t));return i.loader=e.loader||YI,i.url=n.url,i.basePath=gZ(i),i.root=vZ(i)?await dZ(i):hZ(i),i.type=ji.TILES3D,i.lodMetricType=b0.GEOMETRIC_ERROR,i.lodMetricValue=((r=i.root)===null||r===void 0?void 0:r.lodMetricValue)||0,i}async function _Z(t,e,n){const r=e["3d-tiles"]||{};let i;return r.isTileset==="auto"?i=n.url&&n.url.indexOf(".json")!==-1:i=r.isTileset,i?t=await yZ(t,e,n):t=await mZ(t,e,n),t}function vZ(t){var e,n;return(t==null||(e=t.extensionsRequired)===null||e===void 0?void 0:e.includes(cx))&&(t==null||(n=t.extensionsUsed)===null||n===void 0?void 0:n.includes(cx))}const Ax=[0],EZ={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:YI,onTilesetLoad:{type:"function",value:t=>{},compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:(t,e,n)=>{},compare:!1},_getMeshColor:{type:"function",value:t=>[255,255,255],compare:!1}};class JI extends xs{constructor(...e){super(...e),T(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&ze.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){const{tileset3d:e}=this.state;return e!==null&&e.isLoaded()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,oldProps:n,changeFlags:r}){if(e.data&&e.data!==n.data&&this._loadTileset(e.data),r.viewportChanged){const{activeViewports:i}=this.state;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(r.propsChanged){const{layerMap:i}=this.state;for(const s in i)i[s].needsUpdate=!0}}activateViewport(e){const{activeViewports:n,lastUpdatedViewports:r}=this.state;this.internalState.viewport=e,n[e.id]=e;const i=r==null?void 0:r[e.id];(!i||!e.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:e,sourceLayer:n}){const{layerMap:r}=this.state,i=n&&n.id;if(i){const s=i.substring(this.id.length+1),o=s.substring(s.indexOf("-")+1);e.object=r[o]&&r[o].tile}return e}filterSubLayer({layer:e,viewport:n}){const{tile:r}=e.props,{id:i}=n;return r.selected&&r.viewportIds.includes(i)}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}async _loadTileset(e){const{loadOptions:n={}}=this.props;let r=this.props.loader||this.props.loaders;Array.isArray(r)&&(r=r[0]);const i={loadOptions:{...n}};if(r.preload){const a=await r.preload(e,n);a.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:a.headers}),Object.assign(i,a)}const s=await ys(e,r,i.loadOptions),o=new gK(s,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(e){const{lastUpdatedViewports:n}=this.state;this.props.onTileLoad(e),this._updateTileset(n),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;const{tileset3d:n}=this.state,{timeline:r}=this.context,i=Object.keys(e).length;!r||!i||!n||n.selectTiles(Object.values(e)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(e,n){if(!e.content)return null;switch(e.type){case Pl.POINTCLOUD:return this._makePointCloudLayer(e,n);case Pl.SCENEGRAPH:return this._make3DModelLayer(e);case Pl.MESH:return this._makeSimpleMeshLayer(e,n);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}_makePointCloudLayer(e,n){const{attributes:r,pointCount:i,constantRGBA:s,cartographicOrigin:o,modelMatrix:a}=e.content,{positions:c,normals:h,colors:p}=r;if(!c)return null;const m=n&&n.props.data||{header:{vertexCount:i},attributes:{POSITION:c,NORMAL:h,COLOR_0:p}},{pointSize:v,getPointColor:E}=this.props,b=this.getSubLayerClass("pointcloud",D_);return new b({pointSize:v},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),tile:e,data:m,coordinateSystem:$e.METER_OFFSETS,coordinateOrigin:o,modelMatrix:a,getColor:s||E,_offset:0})}_make3DModelLayer(e){const{gltf:n,instances:r,cartographicOrigin:i,modelMatrix:s}=e.content,o=this.getSubLayerClass("scenegraph",nv);return new o({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),tile:e,data:r||Ax,scenegraph:n,coordinateSystem:$e.METER_OFFSETS,coordinateOrigin:i,modelMatrix:s,getTransformMatrix:a=>a.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,n){const r=e.content,{attributes:i,indices:s,modelMatrix:o,cartographicOrigin:a,coordinateSystem:c=$e.METER_OFFSETS,material:h,featureIds:p}=r,{_getMeshColor:m}=this.props,v=n&&n.props.mesh||new Ar({drawMode:4,attributes:wZ(i),indices:s}),E=this.getSubLayerClass("mesh",rv);return new E(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),tile:e,mesh:v,data:Ax,getColor:m(e),pbrMaterial:h,modelMatrix:o,coordinateOrigin:a,coordinateSystem:c,featureIds:p,_offset:0})}renderLayers(){const{tileset3d:e,layerMap:n}=this.state;return e?e.tiles.map(r=>{const i=n[r.id]=n[r.id]||{tile:r};let{layer:s}=i;return r.selected&&(s?i.needsUpdate&&(s=this._getSubLayer(r,s),i.needsUpdate=!1):s=this._getSubLayer(r)),i.layer=s,s}).filter(Boolean):null}}T(JI,"defaultProps",EZ);T(JI,"layerName","Tile3DLayer");function wZ(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}const TZ=new Map([["centerX",Float64Array.BYTES_PER_ELEMENT],["centerY",Float64Array.BYTES_PER_ELEMENT],["centerZ",Float64Array.BYTES_PER_ELEMENT],["minHeight",Float32Array.BYTES_PER_ELEMENT],["maxHeight",Float32Array.BYTES_PER_ELEMENT],["boundingSphereCenterX",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterY",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterZ",Float64Array.BYTES_PER_ELEMENT],["boundingSphereRadius",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointX",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointY",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointZ",Float64Array.BYTES_PER_ELEMENT]]);function Wg(t){return t>>1^-(t&1)}function bZ(t){let e=0;const n={};for(const[r,i]of TZ){const s=i===8?t.getFloat64:t.getFloat32;n[r]=s.call(t,e,!0),e+=i}return{header:n,headerEndPosition:e}}function xZ(t,e){let n=e;const r=3,i=t.getUint32(n,!0),s=new Uint16Array(i*r);n+=Uint32Array.BYTES_PER_ELEMENT;const o=Uint16Array.BYTES_PER_ELEMENT,a=i*o,c=n,h=c+a,p=h+a;let m=0,v=0,E=0;for(let b=0;b<i;b++)m+=Wg(t.getUint16(c+o*b,!0)),v+=Wg(t.getUint16(h+o*b,!0)),E+=Wg(t.getUint16(p+o*b,!0)),s[b]=m,s[b+i]=v,s[b+i*2]=E;return n+=a*3,{vertexData:s,vertexDataEndPosition:n}}function eA(t,e,n,r,i=!0){let s;if(r===2?s=new Uint16Array(t,e,n):s=new Uint32Array(t,e,n),!i)return s;let o=0;for(let a=0;a<s.length;++a){const c=s[a];s[a]=o-c,c===0&&++o}return s}function CZ(t,e,n){let r=n;const i=3,o=e.length/i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;r%o!==0&&(r+=o-r%o);const a=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const c=a*3,h=eA(t.buffer,r,c,o);return r+=c*o,{triangleIndicesEndPosition:r,triangleIndices:h}}function SZ(t,e,n){let r=n;const i=3,o=e.length/i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,a=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const c=eA(t.buffer,r,a,o,!1);r+=a*o;const h=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const p=eA(t.buffer,r,h,o,!1);r+=h*o;const m=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const v=eA(t.buffer,r,m,o,!1);r+=m*o;const E=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const b=eA(t.buffer,r,E,o,!1);return r+=E*o,{edgeIndicesEndPosition:r,westIndices:c,southIndices:p,eastIndices:v,northIndices:b}}function PZ(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function MZ(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}function IZ(t,e){const n={};if(t.byteLength<=e)return{extensions:n,extensionsEndPosition:e};let r=e;for(;r<t.byteLength;){const i=t.getUint8(r,!0);r+=Uint8Array.BYTES_PER_ELEMENT;const s=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const o=new DataView(t.buffer,r,s);switch(i){case 1:{n.vertexNormals=PZ(o);break}case 2:{n.waterMask=MZ(o);break}}r+=s}return{extensions:n,extensionsEndPosition:r}}const fl={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},BZ={maxDecodingStep:fl.extensions};function LZ(t,e){const n=Object.assign({},BZ,e),r=new DataView(t),{header:i,headerEndPosition:s}=bZ(r);if(n.maxDecodingStep<fl.vertices)return{header:i};const{vertexData:o,vertexDataEndPosition:a}=xZ(r,s);if(n.maxDecodingStep<fl.triangleIndices)return{header:i,vertexData:o};const{triangleIndices:c,triangleIndicesEndPosition:h}=CZ(r,o,a);if(n.maxDecodingStep<fl.edgeIndices)return{header:i,vertexData:o,triangleIndices:c};const{westIndices:p,southIndices:m,eastIndices:v,northIndices:E,edgeIndicesEndPosition:b}=SZ(r,o,h);if(n.maxDecodingStep<fl.extensions)return{header:i,vertexData:o,triangleIndices:c,westIndices:p,northIndices:E,eastIndices:v,southIndices:m};const{extensions:x}=IZ(r,b);return{header:i,vertexData:o,triangleIndices:c,westIndices:p,northIndices:E,eastIndices:v,southIndices:m,extensions:x}}function KI(t,e,n,r){const i=r?OZ(r,t.POSITION.value):RZ(e),s=new t.POSITION.value.constructor(i.length*6),o=new t.TEXCOORD_0.value.constructor(i.length*4),a=new e.constructor(i.length*6);for(let h=0;h<i.length;h++){const p=i[h];FZ({edge:p,edgeIndex:h,attributes:t,skirtHeight:n,newPosition:s,newTexcoord0:o,newTriangles:a})}t.POSITION.value=Hp(t.POSITION.value,s),t.TEXCOORD_0.value=Hp(t.TEXCOORD_0.value,o);const c=e instanceof Array?e.concat(a):Hp(e,a);return{attributes:t,triangles:c}}function RZ(t){const e=[];for(let o=0;o<t.length;o+=3)e.push([t[o],t[o+1]]),e.push([t[o+1],t[o+2]]),e.push([t[o+2],t[o]]);e.sort((o,a)=>Math.min(...o)-Math.min(...a)||Math.max(...o)-Math.max(...a));const n=[];let r=0;for(;r<e.length;){var i,s;e[r][0]===((i=e[r+1])===null||i===void 0?void 0:i[1])&&e[r][1]===((s=e[r+1])===null||s===void 0?void 0:s[0])?r+=2:(n.push(e[r]),r++)}return n}function OZ(t,e){t.westIndices.sort((r,i)=>e[3*r+1]-e[3*i+1]),t.eastIndices.sort((r,i)=>e[3*i+1]-e[3*r+1]),t.southIndices.sort((r,i)=>e[3*i]-e[3*r]),t.northIndices.sort((r,i)=>e[3*r]-e[3*i]);const n=[];for(const r in t){const i=t[r];for(let s=0;s<i.length-1;s++)n.push([i[s],i[s+1]])}return n}function FZ({edge:t,edgeIndex:e,attributes:n,skirtHeight:r,newPosition:i,newTexcoord0:s,newTriangles:o}){const a=n.POSITION.value.length,c=e*2,h=e*2+1;i.set(n.POSITION.value.subarray(t[0]*3,t[0]*3+3),c*3),i[c*3+2]=i[c*3+2]-r,i.set(n.POSITION.value.subarray(t[1]*3,t[1]*3+3),h*3),i[h*3+2]=i[h*3+2]-r,s.set(n.TEXCOORD_0.value.subarray(t[0]*2,t[0]*2+2),c*2),s.set(n.TEXCOORD_0.value.subarray(t[1]*2,t[1]*2+2),h*2);const p=e*2*3;o[p]=t[0],o[p+1]=a/3+h,o[p+2]=t[1],o[p+3]=a/3+h,o[p+4]=t[0],o[p+5]=a/3+c}function DZ(t,e,n){const{minHeight:r,maxHeight:i}=e,[s,o,a,c]=n||[0,0,1,1],h=a-s,p=c-o,m=i-r,v=t.length/3,E=new Float32Array(v*3),b=new Float32Array(v*2);for(let x=0;x<v;x++){const I=t[x]/32767,S=t[x+v]/32767,P=t[x+v*2]/32767;E[3*x+0]=I*h+s,E[3*x+1]=S*p+o,E[3*x+2]=P*m+r,b[2*x+0]=I,b[2*x+1]=S}return{POSITION:{value:E,size:3},TEXCOORD_0:{value:b,size:2}}}function kZ(t,e){if(!t)return null;const{bounds:n}=e,{header:r,vertexData:i,triangleIndices:s,westIndices:o,northIndices:a,eastIndices:c,southIndices:h}=LZ(t,fl.triangleIndices);let p=s,m=DZ(i,r,n);const v=Z_(m);if(e.skirtHeight){const{attributes:E,triangles:b}=KI(m,p,e.skirtHeight,{westIndices:o,northIndices:a,eastIndices:c,southIndices:h});m=E,p=b}return{loaderData:{header:{}},header:{vertexCount:p.length,boundingBox:v},mode:4,indices:{value:p,size:1},attributes:m}}function ux(t,e){return kZ(t,e["quantized-mesh"])}class NZ{constructor(e=257){this.gridSize=e;const n=e-1;if(n&n-1)throw new Error(`Expected grid size to be 2^n+1, got ${e}.`);this.numTriangles=n*n*2-2,this.numParentTriangles=this.numTriangles-n*n,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let r=0;r<this.numTriangles;r++){let i=r+2,s=0,o=0,a=0,c=0,h=0,p=0;for(i&1?a=c=h=n:s=o=p=n;(i>>=1)>1;){const v=s+a>>1,E=o+c>>1;i&1?(a=s,c=o,s=h,o=p):(s=a,o=c,a=h,c=p),h=v,p=E}const m=r*4;this.coords[m+0]=s,this.coords[m+1]=o,this.coords[m+2]=a,this.coords[m+3]=c}}createTile(e){return new UZ(e,this)}}class UZ{constructor(e,n){const r=n.gridSize;if(e.length!==r*r)throw new Error(`Expected terrain data of length ${r*r} (${r} x ${r}), got ${e.length}.`);this.terrain=e,this.martini=n,this.errors=new Float32Array(e.length),this.update()}update(){const{numTriangles:e,numParentTriangles:n,coords:r,gridSize:i}=this.martini,{terrain:s,errors:o}=this;for(let a=e-1;a>=0;a--){const c=a*4,h=r[c+0],p=r[c+1],m=r[c+2],v=r[c+3],E=h+m>>1,b=p+v>>1,x=E+b-p,I=b+h-E,S=(s[p*i+h]+s[v*i+m])/2,P=b*i+E,M=Math.abs(S-s[P]);if(o[P]=Math.max(o[P],M),a<n){const O=(p+I>>1)*i+(h+x>>1),N=(v+I>>1)*i+(m+x>>1);o[P]=Math.max(o[P],o[O],o[N])}}}getMesh(e=0){const{gridSize:n,indices:r}=this.martini,{errors:i}=this;let s=0,o=0;const a=n-1;r.fill(0);function c(E,b,x,I,S,P){const M=E+x>>1,O=b+I>>1;Math.abs(E-S)+Math.abs(b-P)>1&&i[O*n+M]>e?(c(S,P,E,b,M,O),c(x,I,S,P,M,O)):(r[b*n+E]=r[b*n+E]||++s,r[I*n+x]=r[I*n+x]||++s,r[P*n+S]=r[P*n+S]||++s,o++)}c(0,0,a,a,a,0),c(a,a,0,0,0,a);const h=new Uint16Array(s*2),p=new Uint32Array(o*3);let m=0;function v(E,b,x,I,S,P){const M=E+x>>1,O=b+I>>1;if(Math.abs(E-S)+Math.abs(b-P)>1&&i[O*n+M]>e)v(S,P,E,b,M,O),v(x,I,S,P,M,O);else{const N=r[b*n+E]-1,z=r[I*n+x]-1,X=r[P*n+S]-1;h[2*N]=E,h[2*N+1]=b,h[2*z]=x,h[2*z+1]=I,h[2*X]=S,h[2*X+1]=P,p[m++]=N,p[m++]=z,p[m++]=X}}return v(0,0,a,a,a,0),v(a,a,0,0,0,a),{vertices:h,triangles:p}}}class GZ{constructor(e,n,r=n){this.data=e,this.width=n,this.height=r,this.coords=[],this.triangles=[],this._halfedges=[],this._candidates=[],this._queueIndices=[],this._queue=[],this._errors=[],this._rms=[],this._pending=[],this._pendingLen=0,this._rmsSum=0;const i=n-1,s=r-1,o=this._addPoint(0,0),a=this._addPoint(i,0),c=this._addPoint(0,s),h=this._addPoint(i,s),p=this._addTriangle(h,o,c,-1,-1,-1);this._addTriangle(o,h,a,p,-1,-1),this._flush()}run(e=1){for(;this.getMaxError()>e;)this.refine()}refine(){this._step(),this._flush()}getMaxError(){return this._errors[0]}getRMSD(){return this._rmsSum>0?Math.sqrt(this._rmsSum/(this.width*this.height)):0}heightAt(e,n){return this.data[this.width*n+e]}_flush(){const e=this.coords;for(let n=0;n<this._pendingLen;n++){const r=this._pending[n],i=2*this.triangles[r*3+0],s=2*this.triangles[r*3+1],o=2*this.triangles[r*3+2];this._findCandidate(e[i],e[i+1],e[s],e[s+1],e[o],e[o+1],r)}this._pendingLen=0}_findCandidate(e,n,r,i,s,o,a){const c=Math.min(e,r,s),h=Math.min(n,i,o),p=Math.max(e,r,s),m=Math.max(n,i,o);let v=Ro(r,i,s,o,c,h),E=Ro(s,o,e,n,c,h),b=Ro(e,n,r,i,c,h);const x=i-n,I=e-r,S=o-i,P=r-s,M=n-o,O=s-e,N=Ro(e,n,r,i,s,o),z=this.heightAt(e,n)/N,X=this.heightAt(r,i)/N,Z=this.heightAt(s,o)/N;let Q=0,k=0,D=0,ne=0;for(let se=h;se<=m;se++){let oe=0;v<0&&S!==0&&(oe=Math.max(oe,Math.floor(-v/S))),E<0&&M!==0&&(oe=Math.max(oe,Math.floor(-E/M))),b<0&&x!==0&&(oe=Math.max(oe,Math.floor(-b/x)));let xe=v+S*oe,Pe=E+M*oe,Ue=b+x*oe,le=!1;for(let _e=c+oe;_e<=p;_e++){if(xe>=0&&Pe>=0&&Ue>=0){le=!0;const Ce=z*xe+X*Pe+Z*Ue,Fe=Math.abs(Ce-this.heightAt(_e,se));ne+=Fe*Fe,Fe>Q&&(Q=Fe,k=_e,D=se)}else if(le)break;xe+=S,Pe+=M,Ue+=x}v+=P,E+=O,b+=I}(k===e&&D===n||k===r&&D===i||k===s&&D===o)&&(Q=0),this._candidates[2*a]=k,this._candidates[2*a+1]=D,this._rms[a]=ne,this._queuePush(a,Q,ne)}_step(){const e=this._queuePop(),n=e*3+0,r=e*3+1,i=e*3+2,s=this.triangles[n],o=this.triangles[r],a=this.triangles[i],c=this.coords[2*s],h=this.coords[2*s+1],p=this.coords[2*o],m=this.coords[2*o+1],v=this.coords[2*a],E=this.coords[2*a+1],b=this._candidates[2*e],x=this._candidates[2*e+1],I=this._addPoint(b,x);if(Ro(c,h,p,m,b,x)===0)this._handleCollinear(I,n);else if(Ro(p,m,v,E,b,x)===0)this._handleCollinear(I,r);else if(Ro(v,E,c,h,b,x)===0)this._handleCollinear(I,i);else{const S=this._halfedges[n],P=this._halfedges[r],M=this._halfedges[i],O=this._addTriangle(s,o,I,S,-1,-1,n),N=this._addTriangle(o,a,I,P,-1,O+1),z=this._addTriangle(a,s,I,M,O+2,N+1);this._legalize(O),this._legalize(N),this._legalize(z)}}_addPoint(e,n){const r=this.coords.length>>1;return this.coords.push(e,n),r}_addTriangle(e,n,r,i,s,o,a=this.triangles.length){const c=a/3;return this.triangles[a+0]=e,this.triangles[a+1]=n,this.triangles[a+2]=r,this._halfedges[a+0]=i,this._halfedges[a+1]=s,this._halfedges[a+2]=o,i>=0&&(this._halfedges[i]=a+0),s>=0&&(this._halfedges[s]=a+1),o>=0&&(this._halfedges[o]=a+2),this._candidates[2*c+0]=0,this._candidates[2*c+1]=0,this._queueIndices[c]=-1,this._rms[c]=0,this._pending[this._pendingLen++]=c,a}_legalize(e){const n=this._halfedges[e];if(n<0)return;const r=e-e%3,i=n-n%3,s=r+(e+1)%3,o=r+(e+2)%3,a=i+(n+2)%3,c=i+(n+1)%3,h=this.triangles[o],p=this.triangles[e],m=this.triangles[s],v=this.triangles[a],E=this.coords;if(!zZ(E[2*h],E[2*h+1],E[2*p],E[2*p+1],E[2*m],E[2*m+1],E[2*v],E[2*v+1]))return;const b=this._halfedges[s],x=this._halfedges[o],I=this._halfedges[a],S=this._halfedges[c];this._queueRemove(r/3),this._queueRemove(i/3);const P=this._addTriangle(h,v,m,-1,I,b,r),M=this._addTriangle(v,h,p,P,x,S,i);this._legalize(P+1),this._legalize(M+2)}_handleCollinear(e,n){const r=n-n%3,i=r+(n+1)%3,s=r+(n+2)%3,o=this.triangles[s],a=this.triangles[n],c=this.triangles[i],h=this._halfedges[i],p=this._halfedges[s],m=this._halfedges[n];if(m<0){const z=this._addTriangle(e,o,a,-1,p,-1,r),X=this._addTriangle(o,e,c,z,-1,h);this._legalize(z+1),this._legalize(X+2);return}const v=m-m%3,E=v+(m+2)%3,b=v+(m+1)%3,x=this.triangles[E],I=this._halfedges[E],S=this._halfedges[b];this._queueRemove(v/3);const P=this._addTriangle(o,a,e,p,-1,-1,r),M=this._addTriangle(a,x,e,S,-1,P+1,v),O=this._addTriangle(x,c,e,I,-1,M+1),N=this._addTriangle(c,o,e,h,P+2,O+1);this._legalize(P),this._legalize(M),this._legalize(O),this._legalize(N)}_queuePush(e,n,r){const i=this._queue.length;this._queueIndices[e]=i,this._queue.push(e),this._errors.push(n),this._rmsSum+=r,this._queueUp(i)}_queuePop(){const e=this._queue.length-1;return this._queueSwap(0,e),this._queueDown(0,e),this._queuePopBack()}_queuePopBack(){const e=this._queue.pop();return this._errors.pop(),this._rmsSum-=this._rms[e],this._queueIndices[e]=-1,e}_queueRemove(e){const n=this._queueIndices[e];if(n<0){const i=this._pending.indexOf(e);if(i!==-1)this._pending[i]=this._pending[--this._pendingLen];else throw new Error("Broken triangulation (something went wrong).");return}const r=this._queue.length-1;r!==n&&(this._queueSwap(n,r),this._queueDown(n,r)||this._queueUp(n)),this._queuePopBack()}_queueLess(e,n){return this._errors[e]>this._errors[n]}_queueSwap(e,n){const r=this._queue[e],i=this._queue[n];this._queue[e]=i,this._queue[n]=r,this._queueIndices[r]=n,this._queueIndices[i]=e;const s=this._errors[e];this._errors[e]=this._errors[n],this._errors[n]=s}_queueUp(e){let n=e;for(;;){const r=n-1>>1;if(r===n||!this._queueLess(n,r))break;this._queueSwap(r,n),n=r}}_queueDown(e,n){let r=e;for(;;){const i=2*r+1;if(i>=n||i<0)break;const s=i+1;let o=i;if(s<n&&this._queueLess(s,i)&&(o=s),!this._queueLess(o,r))break;this._queueSwap(r,o),r=o}return r>e}}function Ro(t,e,n,r,i,s){return(n-i)*(e-s)-(r-s)*(t-i)}function zZ(t,e,n,r,i,s,o,a){const c=t-o,h=e-a,p=n-o,m=r-a,v=i-o,E=s-a,b=c*c+h*h,x=p*p+m*m,I=v*v+E*E;return c*(m*I-x*E)-h*(p*I-x*v)+b*(p*E-m*v)<0}function Yf(t,e,n,r,i){const{rScaler:s,bScaler:o,gScaler:a,offset:c}=r,h=new Float32Array((e+1)*(n+1));for(let p=0,m=0;m<n;m++)for(let v=0;v<e;v++,p++){const E=p*4,b=t[E+0],x=t[E+1],I=t[E+2];h[p+m]=b*s+x*a+I*o+c}if(i==="martini"){for(let p=(e+1)*e,m=0;m<e;m++,p++)h[p]=h[p-e-1];for(let p=n,m=0;m<n+1;m++,p+=n+1)h[p]=h[p-1]}return h}function VZ(t,e,n,r,i){const s=n+1,o=t.length/2,a=new Float32Array(o*3),c=new Float32Array(o*2),[h,p,m,v]=i||[0,0,n,r],E=(m-h)/n,b=(v-p)/r;for(let x=0;x<o;x++){const I=t[x*2],S=t[x*2+1],P=S*s+I;a[3*x+0]=I*E+h,a[3*x+1]=-S*b+v,a[3*x+2]=e[P],c[2*x+0]=I/n,c[2*x+1]=S/r}return{POSITION:{value:a,size:3},TEXCOORD_0:{value:c,size:2}}}function HZ(t,e){if(t===null)return null;const{meshMaxError:n,bounds:r,elevationDecoder:i}=e,{data:s,width:o,height:a}=t;let c,h;switch(e.tesselator){case"martini":c=Yf(s,o,a,i,e.tesselator),h=fx(n,o,c);break;case"delatin":c=Yf(s,o,a,i,e.tesselator),h=hx(n,o,a,c);break;default:o===a&&!(a&o-1)?(c=Yf(s,o,a,i,"martini"),h=fx(n,o,c)):(c=Yf(s,o,a,i,"delatin"),h=hx(n,o,a,c));break}const{vertices:p}=h;let{triangles:m}=h,v=VZ(p,c,o,a,r);const E=Z_(v);if(e.skirtHeight){const{attributes:b,triangles:x}=KI(v,m,e.skirtHeight);v=b,m=x}return{loaderData:{header:{}},header:{vertexCount:m.length,boundingBox:E},mode:4,indices:{value:Uint32Array.from(m),size:1},attributes:v}}function fx(t,e,n){const r=e+1,s=new NZ(r).createTile(n),{vertices:o,triangles:a}=s.getMesh(t);return{vertices:o,triangles:a}}function hx(t,e,n,r){const i=new GZ(r,e+1,n+1);i.run(t);const{coords:s,triangles:o}=i;return{vertices:s,triangles:o}}async function jZ(t,e,n){const r={...e,mimeType:"application/x.image",image:{...e.image,type:"data"}},i=await n.parse(t,r);return HZ(i,e.terrain)}const ZI="3.2.9",qI={name:"Terrain",id:"terrain",module:"terrain",version:ZI,worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}},WZ={name:"Quantized Mesh",id:"quantized-mesh",module:"terrain",version:ZI,worker:!0,extensions:["terrain"],mimeTypes:["application/vnd.quantized-mesh"],options:{"quantized-mesh":{bounds:[0,0,1,1],skirtHeight:null}}};({...qI});({...WZ});const dx=[1],QZ={...Mu.defaultProps,elevationData:k1,texture:{...k1,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0,loaders:[qI]};function px(t){return Array.isArray(t)?t.join(";"):t||""}class eB extends xs{constructor(...e){super(...e),T(this,"state",void 0)}updateState({props:e,oldProps:n}){const r=e.elevationData!==n.elevationData;if(r){const{elevationData:s}=e,o=s&&(Array.isArray(s)||s.includes("{x}")&&s.includes("{y}"));this.setState({isTiled:o})}const i=r||e.meshMaxError!==n.meshMaxError||e.elevationDecoder!==n.elevationDecoder||e.bounds!==n.bounds;if(!this.state.isTiled&&i){const s=this.loadTerrain(e);this.setState({terrain:s})}e.workerUrl&&ze.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:e,bounds:n,elevationDecoder:r,meshMaxError:i,signal:s}){var o;if(!e)return null;let a=this.getLoadOptions();a={...a,terrain:{skirtHeight:this.state.isTiled?i*2:0,...(o=a)===null||o===void 0?void 0:o.terrain,bounds:n,meshMaxError:i,elevationDecoder:r}};const{fetch:c}=this.props;return c(e,{propName:"elevationData",layer:this,loadOptions:a,signal:s})}getTiledTerrainData(e){const{elevationData:n,fetch:r,texture:i,elevationDecoder:s,meshMaxError:o}=this.props,{viewport:a}=this.context,c=Pd(n,e),h=i&&Pd(i,e),{signal:p}=e;let m=[0,0],v=[0,0];if(a.isGeospatial){const I=e.bbox;m=a.projectFlat([I.west,I.south]),v=a.projectFlat([I.east,I.north])}else{const I=e.bbox;m=[I.left,I.bottom],v=[I.right,I.top]}const E=[m[0],m[1],v[0],v[1]],b=this.loadTerrain({elevationData:c,bounds:E,elevationDecoder:s,meshMaxError:o,signal:p}),x=h?r(h,{propName:"texture",layer:this,loaders:[],signal:p}).catch(I=>null):Promise.resolve(null);return Promise.all([b,x])}renderSubLayers(e){const n=this.getSubLayerClass("mesh",tu),{color:r,wireframe:i,material:s}=this.props,{data:o}=e;if(!o)return null;const[a,c]=o;return new n(e,{data:dx,mesh:a,texture:c,_instanced:!1,coordinateSystem:$e.CARTESIAN,getPosition:h=>[0,0,0],getColor:r,wireframe:i,material:s})}onViewportLoad(e){if(!e)return;const{zRange:n}=this.state,r=e.map(o=>o.content).filter(Boolean).map(o=>o[0].header.boundingBox.map(c=>c[2]));if(r.length===0)return;const i=Math.min(...r.map(o=>o[0])),s=Math.max(...r.map(o=>o[1]));(!n||i<n[0]||s>n[1])&&this.setState({zRange:[i,s]})}renderLayers(){const{color:e,material:n,elevationData:r,texture:i,wireframe:s,meshMaxError:o,elevationDecoder:a,tileSize:c,maxZoom:h,minZoom:p,extent:m,maxRequests:v,onTileLoad:E,onTileUnload:b,onTileError:x,maxCacheSize:I,maxCacheByteSize:S,refinementStrategy:P}=this.props;if(this.state.isTiled)return new Mu(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:px(r),texture:px(i),meshMaxError:o,elevationDecoder:a}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:c,maxZoom:h,minZoom:p,extent:m,maxRequests:v,onTileLoad:E,onTileUnload:b,onTileError:x,maxCacheSize:I,maxCacheByteSize:S,refinementStrategy:P});const M=this.getSubLayerClass("mesh",tu);return new M(this.getSubLayerProps({id:"mesh"}),{data:dx,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:O=>[0,0,0],getColor:e,material:n,wireframe:s})}}T(eB,"defaultProps",QZ);T(eB,"layerName","TerrainLayer");function $Z(t,e,n){const r=XZ(t),i=Object.keys(r).filter(s=>r[s]!==Array);return YZ(t,{propArrayTypes:r,...e},{numericPropKeys:n&&n.numericPropKeys||i,PositionDataType:n?n.PositionDataType:Float32Array})}function XZ(t){const e={};for(const n of t)if(n.properties)for(const r in n.properties){const i=n.properties[r];e[r]=tq(i,e[r])}return e}function YZ(t,e,n){const{pointPositionsCount:r,pointFeaturesCount:i,linePositionsCount:s,linePathsCount:o,lineFeaturesCount:a,polygonPositionsCount:c,polygonObjectsCount:h,polygonRingsCount:p,polygonFeaturesCount:m,propArrayTypes:v,coordLength:E}=e,{numericPropKeys:b=[],PositionDataType:x=Float32Array}=n,I=t[0]&&"id"in t[0],S=t.length>65535?Uint32Array:Uint16Array,P={type:"Point",positions:new x(r*E),globalFeatureIds:new S(r),featureIds:i>65535?new Uint32Array(r):new Uint16Array(r),numericProps:{},properties:[],fields:[]},M={type:"LineString",pathIndices:s>65535?new Uint32Array(o+1):new Uint16Array(o+1),positions:new x(s*E),globalFeatureIds:new S(s),featureIds:a>65535?new Uint32Array(s):new Uint16Array(s),numericProps:{},properties:[],fields:[]},O={type:"Polygon",polygonIndices:c>65535?new Uint32Array(h+1):new Uint16Array(h+1),primitivePolygonIndices:c>65535?new Uint32Array(p+1):new Uint16Array(p+1),positions:new x(c*E),triangles:[],globalFeatureIds:new S(c),featureIds:m>65535?new Uint32Array(c):new Uint16Array(c),numericProps:{},properties:[],fields:[]};for(const z of[P,M,O])for(const X of b){const Z=v[X];z.numericProps[X]=new Z(z.positions.length/E)}M.pathIndices[o]=s,O.polygonIndices[h]=c,O.primitivePolygonIndices[p]=c;const N={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const z of t){const X=z.geometry,Z=z.properties||{};switch(X.type){case"Point":JZ(X,P,N,E,Z),P.properties.push($g(Z,b)),I&&P.fields.push({id:z.id}),N.pointFeature++;break;case"LineString":KZ(X,M,N,E,Z),M.properties.push($g(Z,b)),I&&M.fields.push({id:z.id}),N.lineFeature++;break;case"Polygon":ZZ(X,O,N,E,Z),O.properties.push($g(Z,b)),I&&O.fields.push({id:z.id}),N.polygonFeature++;break;default:throw new Error("Invalid geometry type")}N.feature++}return eq(P,M,O,E)}function JZ(t,e,n,r,i){e.positions.set(t.data,n.pointPosition*r);const s=t.data.length/r;cv(e,i,n.pointPosition,s),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+s),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+s),n.pointPosition+=s}function KZ(t,e,n,r,i){e.positions.set(t.data,n.linePosition*r);const s=t.data.length/r;cv(e,i,n.linePosition,s),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+s),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+s);for(let o=0,a=t.indices.length;o<a;++o){const c=t.indices[o],h=o===a-1?t.data.length:t.indices[o+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(h-c)/r}}function ZZ(t,e,n,r,i){e.positions.set(t.data,n.polygonPosition*r);const s=t.data.length/r;cv(e,i,n.polygonPosition,s),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+s),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+s);for(let o=0,a=t.indices.length;o<a;++o){const c=n.polygonPosition;e.polygonIndices[n.polygonObject++]=c;const h=t.areas[o],p=t.indices[o],m=t.indices[o+1];for(let E=0,b=p.length;E<b;++E){const x=p[E],I=E===b-1?m===void 0?t.data.length:m[0]:p[E+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(I-x)/r}const v=n.polygonPosition;qZ(e,h,p,{startPosition:c,endPosition:v,coordLength:r})}}function qZ(t,e,n,{startPosition:r,endPosition:i,coordLength:s}){const o=r*s,a=i*s,c=t.positions.subarray(o,a),h=n[0],p=n.slice(1).map(v=>(v-h)/s),m=Wj(c,p,s,e);for(let v=0,E=m.length;v<E;++v)t.triangles.push(r+m[v])}function Qg(t,e){const n={};for(const r in t)n[r]={value:t[r],size:e};return n}function eq(t,e,n,r){return{points:{...t,positions:{value:t.positions,size:r},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:Qg(t.numericProps,1)},lines:{...e,positions:{value:e.positions,size:r},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:Qg(e.numericProps,1)},polygons:{...n,positions:{value:n.positions,size:r},polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},triangles:{value:new Uint32Array(n.triangles),size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:Qg(n.numericProps,1)}}}function cv(t,e,n,r){for(const i in t.numericProps)if(i in e){const s=e[i];t.numericProps[i].fill(s,n,n+r)}}function $g(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}function tq(t,e){return e===Array||!Number.isFinite(t)?Array:e===Float64Array||Math.fround(t)!==t?Float64Array:Float32Array}function gx(t,e){const n=e==null?void 0:e.globalFeatureId;return n!==void 0?nq(t,n):rq(t,e==null?void 0:e.type)}function nq(t,e){const n=tB(t);for(const r of n){let i=0,s=r.featureIds.value[0];for(let o=0;o<r.featureIds.value.length;o++){const a=r.featureIds.value[o];if(a!==s){if(e===r.globalFeatureIds.value[i])return Rd(r,i,o);i=o,s=a}}if(e===r.globalFeatureIds.value[i])return Rd(r,i,r.featureIds.value.length)}throw new Error("featureId:".concat(e," not found"))}function rq(t,e){const n=tB(t,e);return sq(n)}function iq(t,e,n){switch(t.type){case"Point":return cq(t,e,n);case"LineString":return lq(t,e,n);case"Polygon":return nB(t,e,n);default:const r=t;throw new Error("Unsupported geometry type: ".concat(r==null?void 0:r.type))}}function tB(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||Aq(t),[t];const r=[];return t.points&&(t.points.type="Point",r.push(t.points)),t.lines&&(t.lines.type="LineString",r.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",r.push(t.polygons)),r}function sq(t){const e=[];for(const n of t){if(n.featureIds.value.length===0)continue;let r=0,i=n.featureIds.value[0];for(let s=0;s<n.featureIds.value.length;s++){const o=n.featureIds.value[s];o!==i&&(e.push(Rd(n,r,s)),r=s,i=o)}e.push(Rd(n,r,n.featureIds.value.length))}return e}function Rd(t,e,n){const r=iq(t,e,n),i=aq(t,e),s=oq(t,e);return{type:"Feature",geometry:r,properties:i,...s}}function oq(t,e=0,n){return t.fields&&t.fields[t.featureIds.value[e]]}function aq(t,e=0,n){const r=Object.assign({},t.properties[t.featureIds.value[e]]);for(const i in t.numericProps)r[i]=t.numericProps[i].value[e];return r}function nB(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.polygonIndices.value.filter(c=>c>=e&&c<=n),s=t.primitivePolygonIndices.value.filter(c=>c>=e&&c<=n);if(!(i.length>2)){const c=[];for(let h=0;h<s.length-1;h++){const p=s[h],m=s[h+1],v=Od(r,p,m);c.push(v)}return{type:"Polygon",coordinates:c}}const a=[];for(let c=0;c<i.length-1;c++){const h=i[c],p=i[c+1],m=nB(t,h,p).coordinates;a.push(m)}return{type:"MultiPolygon",coordinates:a}}function lq(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.pathIndices.value.filter(a=>a>=e&&a<=n);if(!(i.length>2)){const a=Od(r,i[0],i[1]);return{type:"LineString",coordinates:a}}const o=[];for(let a=0;a<i.length-1;a++){const c=Od(r,i[a],i[a+1]);o.push(c)}return{type:"MultiLineString",coordinates:o}}function cq(t,e,n){const{positions:r}=t,i=Od(r,e,n);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}function Od(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let i=e;i<n;i++){const s=Array();for(let o=i*t.size;o<(i+1)*t.size;o++)s.push(Number(t.value[o]));r.push(s)}return r}function Aq(t){return t.pathIndices?"LineString":t.polygonIndices?"Polygon":"Point"}var Av={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Av.read=function(t,e,n,r,i){var s,o,a=i*8-r-1,c=(1<<a)-1,h=c>>1,p=-7,m=n?i-1:0,v=n?-1:1,E=t[e+m];for(m+=v,s=E&(1<<-p)-1,E>>=-p,p+=a;p>0;s=s*256+t[e+m],m+=v,p-=8);for(o=s&(1<<-p)-1,s>>=-p,p+=r;p>0;o=o*256+t[e+m],m+=v,p-=8);if(s===0)s=1-h;else{if(s===c)return o?NaN:(E?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-h}return(E?-1:1)*o*Math.pow(2,s-r)};Av.write=function(t,e,n,r,i,s){var o,a,c,h=s*8-i-1,p=(1<<h)-1,m=p>>1,v=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=r?0:s-1,b=r?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=p):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+m>=1?e+=v/c:e+=v*Math.pow(2,1-m),e*c>=2&&(o++,c/=2),o+m>=p?(a=0,o=p):o+m>=1?(a=(e*c-1)*Math.pow(2,i),o=o+m):(a=e*Math.pow(2,m-1)*Math.pow(2,i),o=0));i>=8;t[n+E]=a&255,E+=b,a/=256,i-=8);for(o=o<<i|a,h+=i;h>0;t[n+E]=o&255,E+=b,o/=256,h-=8);t[n+E-b]|=x*128};var rB=Et,Jf=Av;function Et(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Et.Varint=0;Et.Fixed64=1;Et.Bytes=2;Et.Fixed32=5;var $1=(1<<16)*(1<<16),mx=1/$1,uq=12,iB=typeof TextDecoder>"u"?null:new TextDecoder("utf8");Et.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,s=this.pos;this.type=r&7,t(i,e,this),this.pos===s&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Kf(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=_x(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Kf(this.buf,this.pos)+Kf(this.buf,this.pos+4)*$1;return this.pos+=8,t},readSFixed64:function(){var t=Kf(this.buf,this.pos)+_x(this.buf,this.pos+4)*$1;return this.pos+=8,t},readFloat:function(){var t=Jf.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Jf.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,n,r;return r=e[this.pos++],n=r&127,r<128||(r=e[this.pos++],n|=(r&127)<<7,r<128)||(r=e[this.pos++],n|=(r&127)<<14,r<128)||(r=e[this.pos++],n|=(r&127)<<21,r<128)?n:(r=e[this.pos],n|=(r&15)<<28,fq(n,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=uq&&iB?Cq(this.buf,e,t):xq(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Et.Bytes)return t.push(this.readVarint(e));var n=ss(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Et.Bytes)return t.push(this.readSVarint());var e=ss(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Et.Bytes)return t.push(this.readBoolean());var e=ss(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Et.Bytes)return t.push(this.readFloat());var e=ss(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Et.Bytes)return t.push(this.readDouble());var e=ss(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Et.Bytes)return t.push(this.readFixed32());var e=ss(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Et.Bytes)return t.push(this.readSFixed32());var e=ss(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Et.Bytes)return t.push(this.readFixed64());var e=ss(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Et.Bytes)return t.push(this.readSFixed64());var e=ss(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===Et.Varint)for(;this.buf[this.pos++]>127;);else if(e===Et.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Et.Fixed32)this.pos+=4;else if(e===Et.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),ka(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),ka(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),ka(this.buf,t&-1,this.pos),ka(this.buf,Math.floor(t*mx),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),ka(this.buf,t&-1,this.pos),ka(this.buf,Math.floor(t*mx),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){hq(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=Sq(this.buf,t,this.pos);var n=this.pos-e;n>=128&&yx(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Jf.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Jf.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&yx(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,Et.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,gq,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,mq,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,vq,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,yq,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,_q,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Eq,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,wq,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Tq,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,bq,e)},writeBytesField:function(t,e){this.writeTag(t,Et.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Et.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Et.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Et.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Et.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Et.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Et.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Et.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Et.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Et.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};function fq(t,e,n){var r=n.buf,i,s;if(s=r[n.pos++],i=(s&112)>>4,s<128||(s=r[n.pos++],i|=(s&127)<<3,s<128)||(s=r[n.pos++],i|=(s&127)<<10,s<128)||(s=r[n.pos++],i|=(s&127)<<17,s<128)||(s=r[n.pos++],i|=(s&127)<<24,s<128)||(s=r[n.pos++],i|=(s&1)<<31,s<128))return Da(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function ss(t){return t.type===Et.Bytes?t.readVarint()+t.pos:t.pos+1}function Da(t,e,n){return n?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function hq(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(n=~(-t%4294967296),r=~(-t/4294967296),n^4294967295?n=n+1|0:(n=0,r=r+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),dq(n,r,e),pq(r,e)}function dq(t,e,n){n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos]=t&127}function pq(t,e){var n=(t&7)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function yx(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function gq(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function mq(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function yq(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function _q(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function vq(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Eq(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function wq(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Tq(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function bq(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Kf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function ka(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function _x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function xq(t,e,n){for(var r="",i=e;i<n;){var s=t[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a>n)break;var c,h,p;a===1?s<128&&(o=s):a===2?(c=t[i+1],(c&192)===128&&(o=(s&31)<<6|c&63,o<=127&&(o=null))):a===3?(c=t[i+1],h=t[i+2],(c&192)===128&&(h&192)===128&&(o=(s&15)<<12|(c&63)<<6|h&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(c=t[i+1],h=t[i+2],p=t[i+3],(c&192)===128&&(h&192)===128&&(p&192)===128&&(o=(s&15)<<18|(c&63)<<12|(h&63)<<6|p&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,r+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),r+=String.fromCharCode(o),i+=a}return r}function Cq(t,e,n){return iB.decode(t.subarray(e,n))}function Sq(t,e,n){for(var r=0,i,s;r<e.length;r++){if(i=e.charCodeAt(r),i>55295&&i<57344)if(s)if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,s=i;continue}else i=s-55296<<10|i-56320|65536,s=null;else{i>56319||r+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):s=i;continue}else s&&(t[n++]=239,t[n++]=191,t[n++]=189,s=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=i&63|128)}return n}function Pq(t){const e=t.length;if(e<=1)return[t];const n=[];let r,i;for(let s=0;s<e;s++){const o=Mq(t[s]);o!==0&&(i===void 0&&(i=o<0),i===o<0?(r&&n.push(r),r=[t[s]]):r&&r.push(t[s]))}return r&&n.push(r),n}function Mq(t){let e=0;for(let n=0,r=t.length-1,i,s;n<t.length;r=n++)i=t[n],s=t[r],e+=(s[0]-i[0])*(i[1]+s[1]);return e}function Iq(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?Bq(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function Bq(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}class uv{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(e,n,r,i,s){T(this,"properties",void 0),T(this,"extent",void 0),T(this,"type",void 0),T(this,"id",void 0),T(this,"_pbf",void 0),T(this,"_geometry",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=s,e.readFields(Iq,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let r=1,i=0,s=0,o=0;const a=[];let c;for(;e.pos<n;){if(i<=0){const h=e.readVarint();r=h&7,i=h>>3}if(i--,r===1||r===2)s+=e.readSVarint(),o+=e.readSVarint(),r===1&&(c&&a.push(c),c=[]),c&&c.push([s,o]);else if(r===7)c&&c.push(c[0].slice());else throw new Error("unknown command ".concat(r))}return c&&a.push(c),a}bbox(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let r=1,i=0,s=0,o=0,a=1/0,c=-1/0,h=1/0,p=-1/0;for(;e.pos<n;){if(i<=0){const m=e.readVarint();r=m&7,i=m>>3}if(i--,r===1||r===2)s+=e.readSVarint(),o+=e.readSVarint(),s<a&&(a=s),s>c&&(c=s),o<h&&(h=o),o>p&&(p=o);else if(r!==7)throw new Error("unknown command ".concat(r))}return[a,h,c,p]}_toGeoJSON(e){let n=this.loadGeometry(),r=uv.types[this.type],i,s;switch(this.type){case 1:const a=[];for(i=0;i<n.length;i++)a[i]=n[i][0];n=a,e(n,this);break;case 2:for(i=0;i<n.length;i++)e(n[i],this);break;case 3:for(n=Pq(n),i=0;i<n.length;i++)for(s=0;s<n[i].length;s++)e(n[i][s],this);break}n.length===1?n=n[0]:r="Multi".concat(r);const o={type:"Feature",geometry:{type:r,coordinates:n},properties:this.properties};return this.id!==null&&(o.id=this.id),o}toGeoJSON(e){if(typeof e=="function")return this._toGeoJSON(e);const{x:n,y:r,z:i}=e,s=this.extent*Math.pow(2,i),o=this.extent*n,a=this.extent*r;function c(h){for(let p=0;p<h.length;p++){const m=h[p];m[0]=(m[0]+o)*360/s-180;const v=180-(m[1]+a)*360/s;m[1]=360/Math.PI*Math.atan(Math.exp(v*Math.PI/180))-90}}return this._toGeoJSON(c)}}class Lq{constructor(e,n){T(this,"version",void 0),T(this,"name",void 0),T(this,"extent",void 0),T(this,"length",void 0),T(this,"_pbf",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Rq,this,n),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const n=this._pbf.readVarint()+this._pbf.pos;return new uv(this._pbf,n,this.extent,this._keys,this._values)}}function Rq(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(Oq(n)))}function Oq(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=t.readVarint()>>3;e=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null}return e}class Fq{constructor(e,n){T(this,"layers",void 0),this.layers=e.readFields(Dq,{},n)}}function Dq(t,e,n){if(t===3&&n){const r=new Lq(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function kq(t){const e=t.indices.length,n="Polygon";if(e<=1)return{type:n,data:t.data,areas:[[bd(t.data)]],indices:[t.indices]};const r=[],i=[];let s=[],o=[],a,c=0;for(let h,p=0,m;p<e;p++){m=t.indices[p]-c,h=t.indices[p+1]-c||t.data.length;const v=t.data.slice(m,h),E=bd(v);if(E===0){const b=t.data.slice(0,m),x=t.data.slice(h);t.data=b.concat(x),c+=h-m;continue}a===void 0&&(a=E<0),a===E<0?(o.length&&(r.push(s),i.push(o)),o=[m],s=[E]):(s.push(E),o.push(m))}return s&&r.push(s),o.length&&i.push(o),{type:n,areas:r,indices:i,data:t.data}}function Nq(t,e,n,r){for(let i=0,s=t.length;i<s;i+=2){t[i]=(t[i]+e)*360/r-180;const o=180-(t[i+1]+n)*360/r;t[i+1]=360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90}}function Uq(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?Gq(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function Gq(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}let vx,Oo,Xg,Zf,Yg,Jg,Gc;class zq{constructor(e,n,r,i,s,o){T(this,"properties",void 0),T(this,"extent",void 0),T(this,"type",void 0),T(this,"id",void 0),T(this,"_pbf",void 0),T(this,"_geometry",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_geometryInfo",void 0),this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=s,this._geometryInfo=o,e.readFields(Uq,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry,vx=e.readVarint()+e.pos,Oo=1,Zf=0,Yg=0,Jg=0,Gc=0;const n=[],r=[];for(;e.pos<vx;)if(Zf<=0&&(Xg=e.readVarint(),Oo=Xg&7,Zf=Xg>>3),Zf--,Oo===1||Oo===2)Yg+=e.readSVarint(),Jg+=e.readSVarint(),Oo===1&&n.push(Gc),r.push(Yg,Jg),Gc+=2;else if(Oo===7){if(Gc>0){const i=n[n.length-1];r.push(r[i],r[i+1]),Gc+=2}}else throw new Error("unknown command ".concat(Oo));return{data:r,indices:n}}_toBinaryCoordinates(e){const n=this.loadGeometry();let r;e(n.data,this);const i=2;switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=n.indices.length,r={type:"Point",...n};break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=n.indices.length,this._geometryInfo.linePositionsCount+=n.data.length/i,r={type:"LineString",...n};break;case 3:r=kq(n),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=r.indices.length;for(const o of r.indices)this._geometryInfo.polygonRingsCount+=o.length;this._geometryInfo.polygonPositionsCount+=r.data.length/i;break;default:throw new Error("Invalid geometry type: ".concat(this.type))}const s={type:"Feature",geometry:r,properties:this.properties};return this.id!==null&&(s.id=this.id),s}toBinaryCoordinates(e){if(typeof e=="function")return this._toBinaryCoordinates(e);const{x:n,y:r,z:i}=e,s=this.extent*Math.pow(2,i),o=this.extent*n,a=this.extent*r;return this._toBinaryCoordinates(c=>Nq(c,o,a,s))}}class Vq{constructor(e,n){T(this,"version",void 0),T(this,"name",void 0),T(this,"extent",void 0),T(this,"length",void 0),T(this,"_pbf",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Hq,this,n),this.length=this._features.length}feature(e,n){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const r=this._pbf.readVarint()+this._pbf.pos;return new zq(this._pbf,r,this.extent,this._keys,this._values,n)}}function Hq(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(jq(n)))}function jq(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=t.readVarint()>>3;e=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null}return e}class Wq{constructor(e,n){T(this,"layers",void 0),this.layers=e.readFields(Qq,{},n)}}function Qq(t,e,n){if(t===3&&n){const r=new Vq(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function Ex(t,e){var n,r;const i=Xq(e),s=(e==null||(n=e.gis)===null||n===void 0?void 0:n.format)||(e==null||(r=e.mvt)===null||r===void 0?void 0:r.shape);switch(s){case"columnar-table":return{shape:"columnar-table",data:Kg(t,i)};case"geojson-row-table":return{shape:"geojson-row-table",data:wx(t,i)};case"geojson":return wx(t,i);case"binary-geometry":return Kg(t,i);case"binary":return Kg(t,i);default:throw new Error(s)}}function Kg(t,e){const[n,r]=$q(t,e),i=$Z(n,r);return i.byteLength=t.byteLength,i}function $q(t,e){const n=[],r={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength<=0)return[n,r];const i=new Wq(new rB(t));return(e&&Array.isArray(e.layers)?e.layers:Object.keys(i.layers)).forEach(o=>{const a=i.layers[o];if(!!a)for(let c=0;c<a.length;c++){const h=a.feature(c,r),p=Jq(h,e,o);n.push(p)}}),[n,r]}function wx(t,e){if(t.byteLength<=0)return[];const n=[],r=new Fq(new rB(t));return(Array.isArray(e.layers)?e.layers:Object.keys(r.layers)).forEach(s=>{const o=r.layers[s];if(!!o)for(let a=0;a<o.length;a++){const c=o.feature(a),h=Yq(c,e,s);n.push(h)}}),n}function Xq(t){var e;if(!(t!=null&&t.mvt))throw new Error("mvt options required");const n=((e=t.mvt)===null||e===void 0?void 0:e.coordinates)==="wgs84",{tileIndex:r}=t.mvt,i=r&&Number.isFinite(r.x)&&Number.isFinite(r.y)&&Number.isFinite(r.z);if(n&&!i)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return t.mvt}function Yq(t,e,n){const r=t.toGeoJSON(e.coordinates==="wgs84"?e.tileIndex:Kq);return e.layerProperty&&(r.properties[e.layerProperty]=n),r}function Jq(t,e,n){const r=t.toBinaryCoordinates(e.coordinates==="wgs84"?e.tileIndex:Zq);return e.layerProperty&&r.properties&&(r.properties[e.layerProperty]=n),r}function Kq(t,e){const{extent:n}=e;for(let r=0;r<t.length;r++){const i=t[r];i[0]/=n,i[1]/=n}}function Zq(t,e){const{extent:n}=e;for(let r=0,i=t.length;r<i;++r)t[r]/=n}const qq="3.2.9",eee={mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}},sB={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:qq,extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:eee};({...sB});const oB={clipBounds:[0,0,1,1]},aB=`
uniform vec4 clip_bounds;

bool clip_isInBounds(vec2 position) {
  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];
}
`,tee={name:"clip-vs",vs:aB},nee={"vs:#decl":`
varying float clip_isVisible;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));
`,"fs:#decl":`
varying float clip_isVisible;
`,"fs:DECKGL_FILTER_COLOR":`
  if (clip_isVisible < 0.5) discard;
`},ree={name:"clip-fs",fs:aB},iee={"vs:#decl":`
varying vec2 clip_commonPosition;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_commonPosition = geometry.position.xy;
`,"fs:#decl":`
varying vec2 clip_commonPosition;
`,"fs:DECKGL_FILTER_COLOR":`
  if (!clip_isInBounds(clip_commonPosition)) discard;
`};class fv extends TM{getShaders(){let e="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(e=this.props.clipByInstance),this.state.clipByInstance=e,e?{modules:[tee],inject:nee}:{modules:[ree],inject:iee}}draw({uniforms:e}){const{clipBounds:n=oB.clipBounds}=this.props;if(this.state.clipByInstance)e.clip_bounds=n;else{const r=this.projectPosition([n[0],n[1],0]),i=this.projectPosition([n[2],n[3],0]);e.clip_bounds=[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[0],i[0]),Math.max(r[1],i[1])]}}}T(fv,"defaultProps",oB);T(fv,"extensionName","ClipExtension");const see={Point:lB,MultiPoint:oee,LineString:cB,MultiLineString:aee,Polygon:AB,MultiPolygon:lee};function lB([t,e],[n,r],i){const s=Ii(n[0],r[0],t),o=Ii(n[1],r[1],e);return i.unprojectFlat([s,o])}function hv(t,e,n){return t.map(r=>lB(r,e,n))}function oee(t,e,n){return hv(t,e,n)}function cB(t,e,n){return hv(t,e,n)}function aee(t,e,n){return t.map(r=>cB(r,e,n))}function AB(t,e,n){return t.map(r=>hv(r,e,n))}function lee(t,e,n){return t.map(r=>AB(r,e,n))}function cee(t,e,n){const r=n.projectFlat([e.west,e.north]),i=n.projectFlat([e.east,e.south]),s=[r,i];return{...t,coordinates:see[t.type](t.coordinates,s,n)}}const Aee=["points","lines","polygons"];function uee(t,e,n,r){for(const i of Aee){const s=t[i]&&fee(t[i],e,n,r);if(s>=0)return s}return-1}function fee(t,e,n,r){const i=t.featureIds.value;if(!i.length)return-1;let s=0,o=i[i.length-1]+1;if(r){const c=hee(t,r);if(c)s=c[0],o=c[1]+1;else return-1}let a=-1;if(e in t.numericProps){const c=t.numericProps[e].value.findIndex((h,p)=>h===n&&i[p]>=s&&i[p]<o);return c>=0?t.globalFeatureIds.value[c]:-1}else e?a=Tx(t.properties,c=>c[e]===n,s,o):t.fields&&(a=Tx(t.fields,c=>c.id===n,s,o));return a>=0?dee(t,a):-1}function hee(t,e){if(!t.__layers){const n={},{properties:r}=t;for(let i=0;i<r.length;i++){const{layerName:s}=r[i];s&&(n[s]?n[s][1]=i:n[s]=[i,i])}t.__layers=n}return t.__layers[e]}function dee(t,e){if(!t.__ids){const n=[],r=t.featureIds.value,i=t.globalFeatureIds.value;for(let s=0;s<r.length;s++)n[r[s]]=i[s];t.__ids=n}return t.__ids[e]}function Tx(t,e,n,r){for(let i=n;i<r;i++)if(e(t[i],i))return i;return-1}const Zg=512,pee={...Cu.defaultProps,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[sB],binary:!0};class uB extends Mu{initializeState(){super.initializeState();const e=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:e,data:null,tileJSON:null})}get isLoaded(){return this.state&&this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:e,oldProps:n,context:r,changeFlags:i}){var s;i.dataChanged&&this._updateTileData(),(s=this.state)!==null&&s!==void 0&&s.data&&(super.updateState({props:e,oldProps:n,context:r,changeFlags:i}),this._setWGS84PropertyForTiles());const{highlightColor:o}=e;o!==n.highlightColor&&Array.isArray(o)&&this.setState({highlightColor:o})}async _updateTileData(){let e=this.props.data,n=null;if(typeof e=="string"&&!LQ(e)){const{onDataLoad:r,fetch:i}=this.props;this.setState({data:null,tileJSON:null});try{n=await i(e,{propName:"data",layer:this,loaders:[]})}catch(s){this.raiseError(s,"loading TileJSON"),e=null}r&&r(n,{propName:"data",layer:this})}else e.tilejson&&(n=e);n&&(e=n.tiles),this.setState({data:e,tileJSON:n})}_getTilesetOptions(){const e=super._getTilesetOptions(),n=this.state.tileJSON,{minZoom:r,maxZoom:i}=this.props;return n&&(Number.isFinite(n.minzoom)&&n.minzoom>r&&(e.minZoom=n.minzoom),Number.isFinite(n.maxzoom)&&(!Number.isFinite(i)||n.maxzoom<i)&&(e.maxZoom=n.maxzoom)),e}renderLayers(){var e;return(e=this.state)!==null&&e!==void 0&&e.data?super.renderLayers():null}getTileData(e){var n;const{data:r,binary:i}=this.state,{index:s,signal:o}=e,a=Pd(r,e);if(!a)return Promise.reject("Invalid URL");let c=this.getLoadOptions();const{fetch:h}=this.props;return c={...c,mimeType:"application/x-protobuf",mvt:{...(n=c)===null||n===void 0?void 0:n.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:s},gis:i?{format:"binary"}:{}},h(a,{propName:"data",layer:this,loadOptions:c,signal:o})}renderSubLayers(e){const{x:n,y:r,z:i}=e.tile.index,s=Math.pow(2,i),o=Zg/s,a=-o,c=Zg*n/s,h=Zg*(1-r/s),p=new Ye().scale([o,a,1]);e.autoHighlight=!1,this.context.viewport.resolution||(e.modelMatrix=p,e.coordinateOrigin=[c,h,0],e.coordinateSystem=$e.CARTESIAN,e.extensions=[...e.extensions||[],new fv]);const m=super.renderSubLayers(e);return this.state.binary&&!(m instanceof Cu)&&ze.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),m}_updateAutoHighlight(e){const{uniqueIdProperty:n}=this.props,{hoveredFeatureId:r,hoveredFeatureLayerName:i}=this.state,s=e.object;let o,a;s&&(o=qg(s,n),a=bx(s));let{highlightColor:c}=this.props;typeof c=="function"&&(c=c(e)),(r!==o||i!==a)&&this.setState({highlightColor:c,hoveredFeatureId:o,hoveredFeatureLayerName:a})}getPickingInfo(e){const n=super.getPickingInfo(e),r=Boolean(this.context.viewport.resolution);if(this.state.binary&&n.index!==-1){const{data:i}=e.sourceLayer.props;n.object=gx(i,{globalFeatureId:n.index})}return n.object&&!r&&(n.object=Cx(n.object,n.tile.bbox,this.context.viewport)),n}getSubLayerPropsByTile(e){return{highlightedObjectIndex:this.getHighlightedObjectIndex(e),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(e){const{hoveredFeatureId:n,hoveredFeatureLayerName:r,binary:i}=this.state,{uniqueIdProperty:s,highlightedFeatureId:o}=this.props,a=e.content,c=xx(o);if(!(xx(n)||c))return-1;const p=c?o:n;return Array.isArray(a)?a.findIndex(m=>{const v=qg(m,s)===p,E=c||bx(m)===r;return v&&E}):a&&i?uee(a,s,p,c?"":r):-1}_pickObjects(e){const{deck:n,viewport:r}=this.context,i=r.width,s=r.height,o=r.x,a=r.y,c=[this.id];return n.pickObjects({x:o,y:a,width:i,height:s,layerIds:c,maxObjects:e})}getRenderedFeatures(e=null){const n=this._pickObjects(e),r=new Set,i=[];for(const s of n){const o=qg(s.object,this.props.uniqueIdProperty);o===void 0?i.push(s.object):r.has(o)||(r.add(o),i.push(s.object))}return i}_setWGS84PropertyForTiles(){const e="dataInWGS84";this.state.tileset.selectedTiles.forEach(r=>{r.hasOwnProperty(e)||Object.defineProperty(r,e,{get:()=>{if(!r.content)return null;if(this.state.binary&&Array.isArray(r.content)&&!r.content.length)return[];const{bbox:i}=r;if(r._contentWGS84===void 0&&RQ(i)){const s=this.state.binary?gx(r.content):r.content;r._contentWGS84=s.map(o=>Cx(o,i,this.context.viewport))}return r._contentWGS84}})})}}T(uB,"layerName","MVTLayer");T(uB,"defaultProps",pee);function qg(t,e){if(t.properties&&e)return t.properties[e];if("id"in t)return t.id}function bx(t){var e;return((e=t.properties)===null||e===void 0?void 0:e.layerName)||null}function xx(t){return t!=null&&t!==""}function Cx(t,e,n){const r={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(r.geometry,"coordinates",{get:()=>cee(t.geometry,e,n).coordinates}),r}const Sx="0123456789bcdefghjkmnpqrstuvwxyz",fB={};for(let t=0;t<Sx.length;t++)fB[Sx.charAt(t)]=t;const gee=-90,mee=90,yee=-180,_ee=180;function vee(t){let e=!0,n=mee,r=gee,i=_ee,s=yee,o,a=0;for(let c=0,h=t.length;c<h;c++){const p=t[c].toLowerCase();a=fB[p];for(let m=4;m>=0;m--){const v=a>>m&1;e?(o=(i+s)/2,v===1?s=o:i=o):(o=(n+r)/2,v===1?r=o:n=o),e=!e}}return[r,s,n,i]}function Eee(t){const[e,n,r,i]=vee(t);return[i,r,i,e,n,e,n,r,i,r]}const wee={getGeohash:{type:"accessor",value:t=>t.geohash}};class hB extends nc{indexToBounds(){const{data:e,getGeohash:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(r,i)=>Eee(n(r,i))}}}T(hB,"layerName","GeohashLayer");T(hB,"defaultProps",wee);const Tee="pk.eyJ1IjoibWF5cTA0MjIiLCJhIjoiY2phamMwOHV4MjllajMzbnFyeTMwcmZvYiJ9.aFMw4Aws5zY9Y4NwYqFMlQ",bee=new KP({color:[255,255,255],intensity:1}),xee=new c9({color:[255,255,255],intensity:2,position:[-74.05,40.7,8e3]}),Cee=new P_({ambientLight:bee,pointLight:xee}),See={ambient:.1,diffuse:.6,shininess:32,specularColor:[60,64,70]},Pee={buildingColor:[74,80,87],trailColor0:[253,128,93],trailColor1:[23,184,190],material:See,effects:[Cee]},Mee={longitude:104.392,latitude:36.067,zoom:4,pitch:0,bearing:0},Iee="mapbox://styles/mapbox/dark-v10";function Bee(t,e="CN"){t.setFilter("admin-0-boundary-disputed",["all",["==",["get","disputed"],"true"],["==",["get","admin_level"],0],["==",["get","maritime"],"false"],["match",["get","worldview"],["all",e],!0,!1]]),t.setFilter("admin-0-boundary",["all",["==",["get","admin_level"],0],["==",["get","disputed"],"false"],["==",["get","maritime"],"false"],["match",["get","worldview"],["all",e],!0,!1]]),t.setFilter("admin-0-boundary-bg",["all",["==",["get","admin_level"],0],["==",["get","maritime"],"false"],["match",["get","worldview"],["all",e],!0,!1]])}var dB=60,pB=dB*60,gB=pB*24,Lee=gB*7,Wl=1e3,em=dB*Wl,Px=pB*Wl,Ree=gB*Wl,Oee=Lee*Wl,dv="millisecond",hl="second",dl="minute",pl="hour",Hs="day",Oh="week",wi="month",mB="quarter",js="year",gl="date",Fee="YYYY-MM-DDTHH:mm:ssZ",Mx="Invalid Date",Dee=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,kee=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;const Nee={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")};var X1=function(e,n,r){var i=String(e);return!i||i.length>=n?e:""+Array(n+1-i.length).join(r)+e},Uee=function(e){var n=-e.utcOffset(),r=Math.abs(n),i=Math.floor(r/60),s=r%60;return(n<=0?"+":"-")+X1(i,2,"0")+":"+X1(s,2,"0")},Gee=function t(e,n){if(e.date()<n.date())return-t(n,e);var r=(n.year()-e.year())*12+(n.month()-e.month()),i=e.clone().add(r,wi),s=n-i<0,o=e.clone().add(r+(s?-1:1),wi);return+(-(r+(n-i)/(s?i-o:o-i))||0)},zee=function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},Vee=function(e){var n={M:wi,y:js,w:Oh,d:Hs,D:gl,h:pl,m:dl,s:hl,ms:dv,Q:mB};return n[e]||String(e||"").toLowerCase().replace(/s$/,"")},Hee=function(e){return e===void 0};const jee={s:X1,z:Uee,m:Gee,a:zee,p:Vee,u:Hee};var _A="en",Jo={};Jo[_A]=Nee;var pv=function(e){return e instanceof S0},Fd=function t(e,n,r){var i;if(!e)return _A;if(typeof e=="string"){var s=e.toLowerCase();Jo[s]&&(i=s),n&&(Jo[s]=n,i=s);var o=e.split("-");if(!i&&o.length>1)return t(o[0])}else{var a=e.name;Jo[a]=e,i=a}return!r&&i&&(_A=i),i||!r&&_A},gn=function(e,n){if(pv(e))return e.clone();var r=typeof n=="object"?n:{};return r.date=e,r.args=arguments,new S0(r)},Wee=function(e,n){return gn(e,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})},Lt=jee;Lt.l=Fd;Lt.i=pv;Lt.w=Wee;var Qee=function(e){var n=e.date,r=e.utc;if(n===null)return new Date(NaN);if(Lt.u(n))return new Date;if(n instanceof Date)return new Date(n);if(typeof n=="string"&&!/Z$/i.test(n)){var i=n.match(Dee);if(i){var s=i[2]-1||0,o=(i[7]||"0").substring(0,3);return r?new Date(Date.UTC(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)):new Date(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)}}return new Date(n)},S0=function(){function t(n){this.$L=Fd(n.locale,null,!0),this.parse(n)}var e=t.prototype;return e.parse=function(r){this.$d=Qee(r),this.$x=r.x||{},this.init()},e.init=function(){var r=this.$d;this.$y=r.getFullYear(),this.$M=r.getMonth(),this.$D=r.getDate(),this.$W=r.getDay(),this.$H=r.getHours(),this.$m=r.getMinutes(),this.$s=r.getSeconds(),this.$ms=r.getMilliseconds()},e.$utils=function(){return Lt},e.isValid=function(){return this.$d.toString()!==Mx},e.isSame=function(r,i){var s=gn(r);return this.startOf(i)<=s&&s<=this.endOf(i)},e.isAfter=function(r,i){return gn(r)<this.startOf(i)},e.isBefore=function(r,i){return this.endOf(i)<gn(r)},e.$g=function(r,i,s){return Lt.u(r)?this[i]:this.set(s,r)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(r,i){var s=this,o=Lt.u(i)?!0:i,a=Lt.p(r),c=function(S,P){var M=Lt.w(s.$u?Date.UTC(s.$y,P,S):new Date(s.$y,P,S),s);return o?M:M.endOf(Hs)},h=function(S,P){var M=[0,0,0,0],O=[23,59,59,999];return Lt.w(s.toDate()[S].apply(s.toDate("s"),(o?M:O).slice(P)),s)},p=this.$W,m=this.$M,v=this.$D,E="set"+(this.$u?"UTC":"");switch(a){case js:return o?c(1,0):c(31,11);case wi:return o?c(1,m):c(0,m+1);case Oh:{var b=this.$locale().weekStart||0,x=(p<b?p+7:p)-b;return c(o?v-x:v+(6-x),m)}case Hs:case gl:return h(E+"Hours",0);case pl:return h(E+"Minutes",1);case dl:return h(E+"Seconds",2);case hl:return h(E+"Milliseconds",3);default:return this.clone()}},e.endOf=function(r){return this.startOf(r,!1)},e.$set=function(r,i){var s,o=Lt.p(r),a="set"+(this.$u?"UTC":""),c=(s={},s[Hs]=a+"Date",s[gl]=a+"Date",s[wi]=a+"Month",s[js]=a+"FullYear",s[pl]=a+"Hours",s[dl]=a+"Minutes",s[hl]=a+"Seconds",s[dv]=a+"Milliseconds",s)[o],h=o===Hs?this.$D+(i-this.$W):i;if(o===wi||o===js){var p=this.clone().set(gl,1);p.$d[c](h),p.init(),this.$d=p.set(gl,Math.min(this.$D,p.daysInMonth())).$d}else c&&this.$d[c](h);return this.init(),this},e.set=function(r,i){return this.clone().$set(r,i)},e.get=function(r){return this[Lt.p(r)]()},e.add=function(r,i){var s=this,o;r=Number(r);var a=Lt.p(i),c=function(v){var E=gn(s);return Lt.w(E.date(E.date()+Math.round(v*r)),s)};if(a===wi)return this.set(wi,this.$M+r);if(a===js)return this.set(js,this.$y+r);if(a===Hs)return c(1);if(a===Oh)return c(7);var h=(o={},o[dl]=em,o[pl]=Px,o[hl]=Wl,o)[a]||1,p=this.$d.getTime()+r*h;return Lt.w(p,this)},e.subtract=function(r,i){return this.add(r*-1,i)},e.format=function(r){var i=this,s=this.$locale();if(!this.isValid())return s.invalidDate||Mx;var o=r||Fee,a=Lt.z(this),c=this.$H,h=this.$m,p=this.$M,m=s.weekdays,v=s.months,E=s.meridiem,b=function(M,O,N,z){return M&&(M[O]||M(i,o))||N[O].slice(0,z)},x=function(M){return Lt.s(c%12||12,M,"0")},I=E||function(P,M,O){var N=P<12?"AM":"PM";return O?N.toLowerCase():N},S={YY:String(this.$y).slice(-2),YYYY:this.$y,M:p+1,MM:Lt.s(p+1,2,"0"),MMM:b(s.monthsShort,p,v,3),MMMM:b(v,p),D:this.$D,DD:Lt.s(this.$D,2,"0"),d:String(this.$W),dd:b(s.weekdaysMin,this.$W,m,2),ddd:b(s.weekdaysShort,this.$W,m,3),dddd:m[this.$W],H:String(c),HH:Lt.s(c,2,"0"),h:x(1),hh:x(2),a:I(c,h,!0),A:I(c,h,!1),m:String(h),mm:Lt.s(h,2,"0"),s:String(this.$s),ss:Lt.s(this.$s,2,"0"),SSS:Lt.s(this.$ms,3,"0"),Z:a};return o.replace(kee,function(P,M){return M||S[P]||a.replace(":","")})},e.utcOffset=function(){return-Math.round(this.$d.getTimezoneOffset()/15)*15},e.diff=function(r,i,s){var o,a=Lt.p(i),c=gn(r),h=(c.utcOffset()-this.utcOffset())*em,p=this-c,m=Lt.m(this,c);return m=(o={},o[js]=m/12,o[wi]=m,o[mB]=m/3,o[Oh]=(p-h)/Oee,o[Hs]=(p-h)/Ree,o[pl]=p/Px,o[dl]=p/em,o[hl]=p/Wl,o)[a]||p,s?m:Lt.a(m)},e.daysInMonth=function(){return this.endOf(wi).$D},e.$locale=function(){return Jo[this.$L]},e.locale=function(r,i){if(!r)return this.$L;var s=this.clone(),o=Fd(r,i,!0);return o&&(s.$L=o),s},e.clone=function(){return Lt.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},t}(),yB=S0.prototype;gn.prototype=yB;[["$ms",dv],["$s",hl],["$m",dl],["$H",pl],["$W",Hs],["$M",wi],["$y",js],["$D",gl]].forEach(function(t){yB[t[1]]=function(e){return this.$g(e,t[0],t[1])}});gn.extend=function(t,e){return t.$i||(t(e,S0,gn),t.$i=!0),gn};gn.locale=Fd;gn.isDayjs=pv;gn.unix=function(t){return gn(t*1e3)};gn.en=Jo[_A];gn.Ls=Jo;gn.p={};const $ee=gn("2022-07-31T00:00:00.000+08:00"),_B=[165921696e4,165928242e4],Xee=new URLSearchParams(window.location.search),vB={isTimeShifting:!1};vB.isTimeShifting=Xee.has("time-shifting");function Yee(t){return`https://en.m.wikipedia.org/wiki/${t}`}function gv(){let t=gn();return vB.isTimeShifting&&(t=t.subtract(12,"hour")),gn($ee).hour(t.hour()).minute(t.minute()).second(t.second())}function Jee(t,e,n){return n=n.replace(/站$/,""),t.filter(i=>{var a;const s=i.waypoints.findIndex(c=>c.station===n);if(s===-1)return!1;let o=i.waypoints[s];return o.station===((a=i.waypoints[s+1])==null?void 0:a.station)&&(o=i.waypoints[s+1]),!(o.timestamp>gv()||i.waypoints.at(-1).timestamp-o.timestamp<e)})}const Kee={time:_B[0],playing:!1,startingTime:0,timeLength:0,routeList:[],stationMap:{},stationList:[],selectedStation:{},filteredRouteList:[],selectedRoute:[]};function Zee(t,e){switch(e.type!=="setTime"&&console.log(e.type,e.payload),e.type){case"loadData":const{routeList:n,stationMap:r}=e.payload,i=Object.entries(r).map(([o,a])=>(a.stationName=o,{name:o,...a}));return n.forEach(o=>{o.waypoints.forEach(a=>{const c=r[`${a.station}\u7AD9`];c&&(a.coords=c.location)})}),{...t,routeList:n,stationMap:r,stationList:i,playing:!0};case"setTime":return{...t,time:e.payload};case"setTimeLength":return{...t,timeLength:e.payload};case"setSelectedStation":const s=e.payload;return{...t,selectedStation:t.stationMap[s],filteredRouteList:Jee(t.routeList,t.timeLength,s)};case"setSelectedRoute":return{...t,startingTime:+gv(),selectedRoute:e.payload};default:throw new Error}}const mv=K.exports.createContext({});function qee({time:t=_B[0],stationList:e,filteredRouteList:n,selectedRoute:r}){const i=K.exports.useContext(mv),s=K.exports.useRef(),o=K.exports.useRef(new Set),a=r.length!==0,c=K.exports.useCallback(()=>{const E=s.current.getMap();Bee(E)},[]),h=E=>{var x;if(!((x=E.object)!=null&&x.name))return;console.log(E.object.name);const b=E.object.name;i({type:"setSelectedStation",payload:b})},p=E=>{!E.object||(console.log(E.object.trainCode),i({type:"setSelectedRoute",payload:[E.object]}),o.current=new Set(E.object.waypoints.map(b=>b.station+"\u7AD9")))},m=[new oa({id:"selectedRoutePathLayer",data:r,pickable:!0,visible:a,autoHighlight:!0,highlightColor:[255,235,59],widthScale:20,widthMinPixels:1,getPath:E=>E.waypoints.map(b=>b.coords),getColor:[255,235,59],opacity:.05}),new X_({id:"selectedRouteTripsLayer",data:r,visible:a,getPath:E=>E.waypoints.map(b=>b.coords),getTimestamps:E=>E.waypoints.map(b=>b.timestamp),getColor:[255,200,100],opacity:1,widthMinPixels:6,capRounded:!0,jointRounded:!0,fadeTrail:!0,trailLength:5e6,currentTime:t,shadowEnabled:!1}),new oa({id:"filteredRouteListLayer",data:n,pickable:!0,visible:!a,autoHighlight:!0,highlightColor:[255,235,59],widthScale:20,widthMinPixels:2,getPath:E=>E.waypoints.map(b=>b.coords),getColor:[0,187,144],opacity:.3,onClick:p}),new g0({id:"stationLayer",data:e,pickable:!0,autoHighlight:!0,highlightColor:[255,200,100],opacity:.5,stroked:!1,filled:!0,radiusScale:6,radiusMinPixels:2,radiusMaxPixels:10,lineWidthMinPixels:1,getPosition:E=>E.location,getRadius:500,getFillColor:E=>a?o.current.has(E.name)?[255,255,0,200]:[255,140,0,50]:[255,140,0,100],onHover:h})],v=E=>{const{layer:b,object:x}=E;if(!x)return null;const I=b==null?void 0:b.id;if(I==="stationLayer")return x.name;if(I==="filteredRouteListLayer"||I==="selectedRoutePathLayer"){const S=x.waypoints.map(P=>P.station).join(" -> ");return`${x.trainCode}
${S}`}return null};return Ve(SM,{layers:m,effects:Pee.effects,initialViewState:Mee,controller:!0,getTooltip:v,children:Ve(Yy,{reuseMaps:!0,ref:s,onLoad:c,mapStyle:Iee,mapboxAccessToken:Tee})})}function zn(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function ue(){return ue=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ue.apply(this,arguments)}function EB(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=EB(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function qt(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=EB(t))&&(r&&(r+=" "),r+=e);return r}function qf(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function hs(t,e,n={clone:!0}){const r=n.clone?ue({},t):t;return qf(t)&&qf(e)&&Object.keys(e).forEach(i=>{i!=="__proto__"&&(qf(e[i])&&i in t&&qf(t[i])?r[i]=hs(t[i],e[i],n):r[i]=e[i])}),r}function Ql(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function kt(t){if(typeof t!="string")throw new Error(Ql(7));return t.charAt(0).toUpperCase()+t.slice(1)}function Fh(t){return t&&t.ownerDocument||document}function Ix(t,e){typeof t=="function"?t(e):t&&(t.current=e)}const ete=typeof window<"u"?K.exports.useLayoutEffect:K.exports.useEffect,wB=ete;function tte({controlled:t,default:e,name:n,state:r="value"}){const{current:i}=K.exports.useRef(t!==void 0),[s,o]=K.exports.useState(e),a=i?t:s,c=K.exports.useCallback(h=>{i||o(h)},[]);return[a,c]}function Ho(t){const e=K.exports.useRef(t);return wB(()=>{e.current=t}),K.exports.useCallback((...n)=>(0,e.current)(...n),[])}function Ko(t,e){return K.exports.useMemo(()=>t==null&&e==null?null:n=>{Ix(t,n),Ix(e,n)},[t,e])}let P0=!0,Y1=!1,Bx;const nte={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function rte(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&nte[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function ite(t){t.metaKey||t.altKey||t.ctrlKey||(P0=!0)}function tm(){P0=!1}function ste(){this.visibilityState==="hidden"&&Y1&&(P0=!0)}function ote(t){t.addEventListener("keydown",ite,!0),t.addEventListener("mousedown",tm,!0),t.addEventListener("pointerdown",tm,!0),t.addEventListener("touchstart",tm,!0),t.addEventListener("visibilitychange",ste,!0)}function ate(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return P0||rte(e)}function TB(){const t=K.exports.useCallback(i=>{i!=null&&ote(i.ownerDocument)},[]),e=K.exports.useRef(!1);function n(){return e.current?(Y1=!0,window.clearTimeout(Bx),Bx=window.setTimeout(()=>{Y1=!1},100),e.current=!1,!0):!1}function r(i){return ate(i)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}const lte={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:-1,overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},cte=lte;function bB(t,e){const n=ue({},e);return Object.keys(t).forEach(r=>{n[r]===void 0&&(n[r]=t[r])}),n}function yv(t,e,n){const r={};return Object.keys(t).forEach(i=>{r[i]=t[i].reduce((s,o)=>(o&&(s.push(e(o)),n&&n[o]&&s.push(n[o])),s),[]).join(" ")}),r}const Lx=t=>t,Ate=()=>{let t=Lx;return{configure(e){t=e},generate(e){return t(e)},reset(){t=Lx}}},ute=Ate(),fte=ute,hte={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function M0(t,e,n="Mui"){const r=hte[e];return r?`${n}-${r}`:`${fte.generate(t)}-${e}`}function Iu(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=M0(t,i,n)}),r}function vA(t){return typeof t=="string"}function dte(t,e={},n){return vA(t)?e:ue({},e,{ownerState:ue({},e.ownerState,n)})}function pte(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function gte(t,e){return typeof t=="function"?t(e):t}function Rx(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function mte(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:s}=t;if(!e){const E=qt(i==null?void 0:i.className,r==null?void 0:r.className,s,n==null?void 0:n.className),b=ue({},n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),x=ue({},n,i,r);return E.length>0&&(x.className=E),Object.keys(b).length>0&&(x.style=b),{props:x,internalRef:void 0}}const o=pte(ue({},i,r)),a=Rx(r),c=Rx(i),h=e(o),p=qt(h==null?void 0:h.className,n==null?void 0:n.className,s,i==null?void 0:i.className,r==null?void 0:r.className),m=ue({},h==null?void 0:h.style,n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),v=ue({},h,n,c,a);return p.length>0&&(v.className=p),Object.keys(m).length>0&&(v.style=m),{props:v,internalRef:h.ref}}const yte=["elementType","externalSlotProps","ownerState"];function Gs(t){var e;const{elementType:n,externalSlotProps:r,ownerState:i}=t,s=zn(t,yte),o=gte(r,i),{props:a,internalRef:c}=mte(ue({},s,{externalSlotProps:o})),h=Ko(c,Ko(o==null?void 0:o.ref,(e=t.additionalProps)==null?void 0:e.ref));return dte(n,ue({},a,{ref:h}),i)}function tA(t){return M0("MuiSlider",t)}const _te=Iu("MuiSlider",["root","active","focusVisible","disabled","dragging","marked","vertical","trackInverted","trackFalse","rail","track","mark","markActive","markLabel","markLabelActive","thumb","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel"]),Dh=_te,vte=t=>{const{open:e}=t;return{offset:qt(e&&Dh.valueLabelOpen),circle:Dh.valueLabelCircle,label:Dh.valueLabelLabel}};function xB(t){const{children:e,className:n,value:r}=t,i=vte(t);return K.exports.cloneElement(e,{className:qt(e.props.className)},ii(K.exports.Fragment,{children:[e.props.children,Ve("span",{className:qt(i.offset,n),"aria-hidden":!0,children:Ve("span",{className:i.circle,children:Ve("span",{className:i.label,children:r})})})]}))}const Ete=2;function CB(t,e){return t-e}function zc(t,e,n){return t==null?e:Math.min(Math.max(e,t),n)}function Ox(t,e){var n;const{index:r}=(n=t.reduce((i,s,o)=>{const a=Math.abs(e-s);return i===null||a<i.distance||a===i.distance?{distance:a,index:o}:i},null))!=null?n:{};return r}function eh(t,e){if(e.current!==void 0&&t.changedTouches){const n=t;for(let r=0;r<n.changedTouches.length;r+=1){const i=n.changedTouches[r];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function Dd(t,e,n){return(t-e)*100/(n-e)}function wte(t,e,n){return(n-e)*t+e}function Tte(t){if(Math.abs(t)<1){const n=t.toExponential().split("e-"),r=n[0].split(".")[1];return(r?r.length:0)+parseInt(n[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function bte(t,e,n){const r=Math.round((t-n)/e)*e+n;return Number(r.toFixed(Tte(e)))}function Fx({values:t,newValue:e,index:n}){const r=t.slice();return r[n]=e,r.sort(CB)}function th({sliderRef:t,activeIndex:e,setActive:n}){var r,i;const s=Fh(t.current);if(!((r=t.current)!=null&&r.contains(s.activeElement))||Number(s==null||(i=s.activeElement)==null?void 0:i.getAttribute("data-index"))!==e){var o;(o=t.current)==null||o.querySelector(`[type="range"][data-index="${e}"]`).focus()}n&&n(e)}const xte={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},Cte=t=>t;let nh;function nm(){return nh===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?nh=CSS.supports("touch-action","none"):nh=!0),nh}function Ste(t){const{"aria-labelledby":e,defaultValue:n,disabled:r=!1,disableSwap:i=!1,isRtl:s=!1,marks:o=!1,max:a=100,min:c=0,name:h,onChange:p,onChangeCommitted:m,orientation:v="horizontal",ref:E,scale:b=Cte,step:x=1,tabIndex:I,value:S}=t,P=K.exports.useRef(),[M,O]=K.exports.useState(-1),[N,z]=K.exports.useState(-1),[X,Z]=K.exports.useState(!1),Q=K.exports.useRef(0),[k,D]=tte({controlled:S,default:n!=null?n:c,name:"Slider"}),ne=p&&((pe,Oe,Xe)=>{const et=pe.nativeEvent||pe,We=new et.constructor(et.type,et);Object.defineProperty(We,"target",{writable:!0,value:{value:Oe,name:h}}),p(We,Oe,Xe)}),se=Array.isArray(k);let oe=se?k.slice().sort(CB):[k];oe=oe.map(pe=>zc(pe,c,a));const xe=o===!0&&x!==null?[...Array(Math.floor((a-c)/x)+1)].map((pe,Oe)=>({value:c+x*Oe})):o||[],Pe=xe.map(pe=>pe.value),{isFocusVisibleRef:Ue,onBlur:le,onFocus:_e,ref:Ce}=TB(),[Fe,ke]=K.exports.useState(-1),it=K.exports.useRef(),Rt=Ko(Ce,it),Pn=Ko(E,Rt),An=pe=>Oe=>{var Xe;const et=Number(Oe.currentTarget.getAttribute("data-index"));_e(Oe),Ue.current===!0&&ke(et),z(et),pe==null||(Xe=pe.onFocus)==null||Xe.call(pe,Oe)},Tt=pe=>Oe=>{var Xe;le(Oe),Ue.current===!1&&ke(-1),z(-1),pe==null||(Xe=pe.onBlur)==null||Xe.call(pe,Oe)};wB(()=>{if(r&&it.current.contains(document.activeElement)){var pe;(pe=document.activeElement)==null||pe.blur()}},[r]),r&&M!==-1&&O(-1),r&&Fe!==-1&&ke(-1);const Ut=pe=>Oe=>{var Xe;(Xe=pe.onChange)==null||Xe.call(pe,Oe);const et=Number(Oe.currentTarget.getAttribute("data-index")),We=oe[et],lt=Pe.indexOf(We);let Me=Oe.target.valueAsNumber;if(xe&&x==null&&(Me=Me<We?Pe[lt-1]:Pe[lt+1]),Me=zc(Me,c,a),xe&&x==null){const Vt=Pe.indexOf(oe[et]);Me=Me<oe[et]?Pe[Vt-1]:Pe[Vt+1]}if(se){i&&(Me=zc(Me,oe[et-1]||-1/0,oe[et+1]||1/0));const Vt=Me;Me=Fx({values:oe,newValue:Me,index:et});let at=et;i||(at=Me.indexOf(Vt)),th({sliderRef:it,activeIndex:at})}D(Me),ke(et),ne&&ne(Oe,Me,et),m&&m(Oe,Me)},ot=K.exports.useRef();let Gt=v;s&&v==="horizontal"&&(Gt+="-reverse");const zt=({finger:pe,move:Oe=!1})=>{const{current:Xe}=it,{width:et,height:We,bottom:lt,left:Me}=Xe.getBoundingClientRect();let Vt;Gt.indexOf("vertical")===0?Vt=(lt-pe.y)/We:Vt=(pe.x-Me)/et,Gt.indexOf("-reverse")!==-1&&(Vt=1-Vt);let at;if(at=wte(Vt,c,a),x)at=bte(at,x,c);else{const Cs=Ox(Pe,at);at=Pe[Cs]}at=zc(at,c,a);let sr=0;if(se){Oe?sr=ot.current:sr=Ox(oe,at),i&&(at=zc(at,oe[sr-1]||-1/0,oe[sr+1]||1/0));const Cs=at;at=Fx({values:oe,newValue:at,index:sr}),i&&Oe||(sr=at.indexOf(Cs),ot.current=sr)}return{newValue:at,activeIndex:sr}},Mn=Ho(pe=>{const Oe=eh(pe,P);if(!Oe)return;if(Q.current+=1,pe.type==="mousemove"&&pe.buttons===0){In(pe);return}const{newValue:Xe,activeIndex:et}=zt({finger:Oe,move:!0});th({sliderRef:it,activeIndex:et,setActive:O}),D(Xe),!X&&Q.current>Ete&&Z(!0),ne&&Xe!==k&&ne(pe,Xe,et)}),In=Ho(pe=>{const Oe=eh(pe,P);if(Z(!1),!Oe)return;const{newValue:Xe}=zt({finger:Oe,move:!0});O(-1),pe.type==="touchend"&&z(-1),m&&m(pe,Xe),P.current=void 0,kn()}),jn=Ho(pe=>{if(r)return;nm()||pe.preventDefault();const Oe=pe.changedTouches[0];Oe!=null&&(P.current=Oe.identifier);const Xe=eh(pe,P);if(Xe!==!1){const{newValue:We,activeIndex:lt}=zt({finger:Xe});th({sliderRef:it,activeIndex:lt,setActive:O}),D(We),ne&&ne(pe,We,lt)}Q.current=0;const et=Fh(it.current);et.addEventListener("touchmove",Mn),et.addEventListener("touchend",In)}),kn=K.exports.useCallback(()=>{const pe=Fh(it.current);pe.removeEventListener("mousemove",Mn),pe.removeEventListener("mouseup",In),pe.removeEventListener("touchmove",Mn),pe.removeEventListener("touchend",In)},[In,Mn]);K.exports.useEffect(()=>{const{current:pe}=it;return pe.addEventListener("touchstart",jn,{passive:nm()}),()=>{pe.removeEventListener("touchstart",jn,{passive:nm()}),kn()}},[kn,jn]),K.exports.useEffect(()=>{r&&kn()},[r,kn]);const yn=pe=>Oe=>{var Xe;if((Xe=pe.onMouseDown)==null||Xe.call(pe,Oe),r||Oe.defaultPrevented||Oe.button!==0)return;Oe.preventDefault();const et=eh(Oe,P);if(et!==!1){const{newValue:lt,activeIndex:Me}=zt({finger:et});th({sliderRef:it,activeIndex:Me,setActive:O}),D(lt),ne&&ne(Oe,lt,Me)}Q.current=0;const We=Fh(it.current);We.addEventListener("mousemove",Mn),We.addEventListener("mouseup",In)},sn=Dd(se?oe[0]:c,c,a),rr=Dd(oe[oe.length-1],c,a)-sn,$r=(pe={})=>{const Oe={onMouseDown:yn(pe||{})},Xe=ue({},pe,Oe);return ue({ref:Pn},Xe)},ir=pe=>Oe=>{var Xe;(Xe=pe.onMouseOver)==null||Xe.call(pe,Oe);const et=Number(Oe.currentTarget.getAttribute("data-index"));z(et)},_t=pe=>Oe=>{var Xe;(Xe=pe.onMouseLeave)==null||Xe.call(pe,Oe),z(-1)};return{active:M,axis:Gt,axisProps:xte,dragging:X,focusedThumbIndex:Fe,getHiddenInputProps:(pe={})=>{var Oe;const Xe={onChange:Ut(pe||{}),onFocus:An(pe||{}),onBlur:Tt(pe||{})},et=ue({},pe,Xe);return ue({tabIndex:I,"aria-labelledby":e,"aria-orientation":v,"aria-valuemax":b(a),"aria-valuemin":b(c),name:h,type:"range",min:t.min,max:t.max,step:(Oe=t.step)!=null?Oe:void 0,disabled:r},et,{style:ue({},cte,{direction:s?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:$r,getThumbProps:(pe={})=>{const Oe={onMouseOver:ir(pe||{}),onMouseLeave:_t(pe||{})};return ue({},pe,Oe)},marks:xe,open:N,range:se,trackLeap:rr,trackOffset:sn,values:oe}}const Pte=["aria-label","aria-valuetext","className","component","classes","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","scale","step","tabIndex","track","value","valueLabelDisplay","valueLabelFormat","isRtl","components","componentsProps"],Dx=t=>t,Mte=t=>{const{disabled:e,dragging:n,marked:r,orientation:i,track:s,classes:o}=t;return yv({root:["root",e&&"disabled",n&&"dragging",r&&"marked",i==="vertical"&&"vertical",s==="inverted"&&"trackInverted",s===!1&&"trackFalse"],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled"],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]},tA,o)},Ite=({children:t})=>t,Bte=K.exports.forwardRef(function(e,n){var r,i,s,o,a,c,h;const{"aria-label":p,"aria-valuetext":m,className:v,component:E,classes:b,disableSwap:x=!1,disabled:I=!1,getAriaLabel:S,getAriaValueText:P,marks:M=!1,max:O=100,min:N=0,orientation:z="horizontal",scale:X=Dx,step:Z=1,track:Q="normal",valueLabelDisplay:k="off",valueLabelFormat:D=Dx,isRtl:ne=!1,components:se={},componentsProps:oe={}}=e,xe=zn(e,Pte),Pe=ue({},e,{marks:M,classes:b,disabled:I,isRtl:ne,max:O,min:N,orientation:z,scale:X,step:Z,track:Q,valueLabelDisplay:k,valueLabelFormat:D}),{axisProps:Ue,getRootProps:le,getHiddenInputProps:_e,getThumbProps:Ce,open:Fe,active:ke,axis:it,range:Rt,focusedThumbIndex:Pn,dragging:An,marks:Tt,values:Ut,trackOffset:ot,trackLeap:Gt}=Ste(ue({},Pe,{ref:n}));Pe.marked=Tt.length>0&&Tt.some(We=>We.label),Pe.dragging=An,Pe.focusedThumbIndex=Pn;const zt=Mte(Pe),Mn=(r=E!=null?E:se.Root)!=null?r:"span",In=Gs({elementType:Mn,getSlotProps:le,externalSlotProps:oe.root,externalForwardedProps:xe,ownerState:Pe,className:[zt.root,v]}),jn=(i=se.Rail)!=null?i:"span",kn=Gs({elementType:jn,externalSlotProps:oe.rail,ownerState:Pe,className:zt.rail}),yn=(s=se.Track)!=null?s:"span",sn=Gs({elementType:yn,externalSlotProps:oe.track,additionalProps:{style:ue({},Ue[it].offset(ot),Ue[it].leap(Gt))},ownerState:Pe,className:zt.track}),rr=(o=se.Thumb)!=null?o:"span",$r=Gs({elementType:rr,getSlotProps:Ce,externalSlotProps:oe.thumb,ownerState:Pe}),ir=(a=se.ValueLabel)!=null?a:xB,_t=Gs({elementType:ir,externalSlotProps:oe.valueLabel,ownerState:Pe}),Xr=(c=se.Mark)!=null?c:"span",fi=Gs({elementType:Xr,externalSlotProps:oe.mark,ownerState:Pe,className:zt.mark}),pe=(h=se.MarkLabel)!=null?h:"span",Oe=Gs({elementType:pe,externalSlotProps:oe.markLabel,ownerState:Pe}),Xe=se.Input||"input",et=Gs({elementType:Xe,getSlotProps:_e,externalSlotProps:oe.input,ownerState:Pe});return ii(Mn,ue({},In,{children:[Ve(jn,ue({},kn)),Ve(yn,ue({},sn)),Tt.filter(We=>We.value>=N&&We.value<=O).map((We,lt)=>{const Me=Dd(We.value,N,O),Vt=Ue[it].offset(Me);let at;return Q===!1?at=Ut.indexOf(We.value)!==-1:at=Q==="normal"&&(Rt?We.value>=Ut[0]&&We.value<=Ut[Ut.length-1]:We.value<=Ut[0])||Q==="inverted"&&(Rt?We.value<=Ut[0]||We.value>=Ut[Ut.length-1]:We.value>=Ut[0]),ii(K.exports.Fragment,{children:[Ve(Xr,ue({"data-index":lt},fi,!vA(Xr)&&{markActive:at},{style:ue({},Vt,fi.style),className:qt(fi.className,at&&zt.markActive)})),We.label!=null?Ve(pe,ue({"aria-hidden":!0,"data-index":lt},Oe,!vA(pe)&&{markLabelActive:at},{style:ue({},Vt,Oe.style),className:qt(zt.markLabel,Oe.className,at&&zt.markLabelActive),children:We.label})):null]},We.value)}),Ut.map((We,lt)=>{const Me=Dd(We,N,O),Vt=Ue[it].offset(Me),at=k==="off"?Ite:ir;return Ve(K.exports.Fragment,{children:Ve(at,ue({},!vA(at)&&{valueLabelFormat:D,valueLabelDisplay:k,value:typeof D=="function"?D(X(We),lt):D,index:lt,open:Fe===lt||ke===lt||k==="on",disabled:I},_t,{className:qt(zt.valueLabel,_t.className),children:Ve(rr,ue({"data-index":lt,"data-focusvisible":Pn===lt},$r,{className:qt(zt.thumb,$r.className,ke===lt&&zt.active,Pn===lt&&zt.focusVisible),style:ue({},Vt,{pointerEvents:x&&ke!==lt?"none":void 0},$r.style),children:Ve(Xe,ue({"data-index":lt,"aria-label":S?S(lt):p,"aria-valuenow":X(We),"aria-valuetext":P?P(X(We),lt):m,value:Ut[lt]},et))}))}))},lt)})]}))}),Lte=Bte;function SB(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var Rte=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Ote=SB(function(t){return Rte.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function Fte(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Dte(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var kte=function(){function t(n){var r=this;this._insertTag=function(i){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,s),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Dte(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=Fte(i);try{s.insertRule(r,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),Yn="-ms-",kd="-moz-",vt="-webkit-",PB="comm",_v="rule",vv="decl",Nte="@import",MB="@keyframes",Ute=Math.abs,I0=String.fromCharCode,Gte=Object.assign;function zte(t,e){return(((e<<2^mr(t,0))<<2^mr(t,1))<<2^mr(t,2))<<2^mr(t,3)}function IB(t){return t.trim()}function Vte(t,e){return(t=e.exec(t))?t[0]:t}function xt(t,e,n){return t.replace(e,n)}function J1(t,e){return t.indexOf(e)}function mr(t,e){return t.charCodeAt(e)|0}function iu(t,e,n){return t.slice(e,n)}function Wi(t){return t.length}function Ev(t){return t.length}function rh(t,e){return e.push(t),t}function Hte(t,e){return t.map(e).join("")}var B0=1,$l=1,BB=0,br=0,dn=0,sc="";function L0(t,e,n,r,i,s,o){return{value:t,root:e,parent:n,type:r,props:i,children:s,line:B0,column:$l,length:o,return:""}}function Vc(t,e){return Gte(L0("",null,null,"",null,null,0),t,{length:-t.length},e)}function jte(){return dn}function Wte(){return dn=br>0?mr(sc,--br):0,$l--,dn===10&&($l=1,B0--),dn}function Gr(){return dn=br<BB?mr(sc,br++):0,$l++,dn===10&&($l=1,B0++),dn}function qi(){return mr(sc,br)}function kh(){return br}function Bu(t,e){return iu(sc,t,e)}function su(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function LB(t){return B0=$l=1,BB=Wi(sc=t),br=0,[]}function RB(t){return sc="",t}function Nh(t){return IB(Bu(br-1,K1(t===91?t+2:t===40?t+1:t)))}function Qte(t){for(;(dn=qi())&&dn<33;)Gr();return su(t)>2||su(dn)>3?"":" "}function $te(t,e){for(;--e&&Gr()&&!(dn<48||dn>102||dn>57&&dn<65||dn>70&&dn<97););return Bu(t,kh()+(e<6&&qi()==32&&Gr()==32))}function K1(t){for(;Gr();)switch(dn){case t:return br;case 34:case 39:t!==34&&t!==39&&K1(dn);break;case 40:t===41&&K1(t);break;case 92:Gr();break}return br}function Xte(t,e){for(;Gr()&&t+dn!==47+10;)if(t+dn===42+42&&qi()===47)break;return"/*"+Bu(e,br-1)+"*"+I0(t===47?t:Gr())}function Yte(t){for(;!su(qi());)Gr();return Bu(t,br)}function Jte(t){return RB(Uh("",null,null,null,[""],t=LB(t),0,[0],t))}function Uh(t,e,n,r,i,s,o,a,c){for(var h=0,p=0,m=o,v=0,E=0,b=0,x=1,I=1,S=1,P=0,M="",O=i,N=s,z=r,X=M;I;)switch(b=P,P=Gr()){case 40:if(b!=108&&X.charCodeAt(m-1)==58){J1(X+=xt(Nh(P),"&","&\f"),"&\f")!=-1&&(S=-1);break}case 34:case 39:case 91:X+=Nh(P);break;case 9:case 10:case 13:case 32:X+=Qte(b);break;case 92:X+=$te(kh()-1,7);continue;case 47:switch(qi()){case 42:case 47:rh(Kte(Xte(Gr(),kh()),e,n),c);break;default:X+="/"}break;case 123*x:a[h++]=Wi(X)*S;case 125*x:case 59:case 0:switch(P){case 0:case 125:I=0;case 59+p:E>0&&Wi(X)-m&&rh(E>32?Nx(X+";",r,n,m-1):Nx(xt(X," ","")+";",r,n,m-2),c);break;case 59:X+=";";default:if(rh(z=kx(X,e,n,h,p,i,a,M,O=[],N=[],m),s),P===123)if(p===0)Uh(X,e,z,z,O,s,m,a,N);else switch(v){case 100:case 109:case 115:Uh(t,z,z,r&&rh(kx(t,z,z,0,0,i,a,M,i,O=[],m),N),i,N,m,a,r?O:N);break;default:Uh(X,z,z,z,[""],N,0,a,N)}}h=p=E=0,x=S=1,M=X="",m=o;break;case 58:m=1+Wi(X),E=b;default:if(x<1){if(P==123)--x;else if(P==125&&x++==0&&Wte()==125)continue}switch(X+=I0(P),P*x){case 38:S=p>0?1:(X+="\f",-1);break;case 44:a[h++]=(Wi(X)-1)*S,S=1;break;case 64:qi()===45&&(X+=Nh(Gr())),v=qi(),p=m=Wi(M=X+=Yte(kh())),P++;break;case 45:b===45&&Wi(X)==2&&(x=0)}}return s}function kx(t,e,n,r,i,s,o,a,c,h,p){for(var m=i-1,v=i===0?s:[""],E=Ev(v),b=0,x=0,I=0;b<r;++b)for(var S=0,P=iu(t,m+1,m=Ute(x=o[b])),M=t;S<E;++S)(M=IB(x>0?v[S]+" "+P:xt(P,/&\f/g,v[S])))&&(c[I++]=M);return L0(t,e,n,i===0?_v:a,c,h,p)}function Kte(t,e,n){return L0(t,e,n,PB,I0(jte()),iu(t,2,-2),0)}function Nx(t,e,n,r){return L0(t,e,n,vv,iu(t,0,r),iu(t,r+1,-1),r)}function OB(t,e){switch(zte(t,e)){case 5103:return vt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return vt+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return vt+t+kd+t+Yn+t+t;case 6828:case 4268:return vt+t+Yn+t+t;case 6165:return vt+t+Yn+"flex-"+t+t;case 5187:return vt+t+xt(t,/(\w+).+(:[^]+)/,vt+"box-$1$2"+Yn+"flex-$1$2")+t;case 5443:return vt+t+Yn+"flex-item-"+xt(t,/flex-|-self/,"")+t;case 4675:return vt+t+Yn+"flex-line-pack"+xt(t,/align-content|flex-|-self/,"")+t;case 5548:return vt+t+Yn+xt(t,"shrink","negative")+t;case 5292:return vt+t+Yn+xt(t,"basis","preferred-size")+t;case 6060:return vt+"box-"+xt(t,"-grow","")+vt+t+Yn+xt(t,"grow","positive")+t;case 4554:return vt+xt(t,/([^-])(transform)/g,"$1"+vt+"$2")+t;case 6187:return xt(xt(xt(t,/(zoom-|grab)/,vt+"$1"),/(image-set)/,vt+"$1"),t,"")+t;case 5495:case 3959:return xt(t,/(image-set\([^]*)/,vt+"$1$`$1");case 4968:return xt(xt(t,/(.+:)(flex-)?(.*)/,vt+"box-pack:$3"+Yn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+vt+t+t;case 4095:case 3583:case 4068:case 2532:return xt(t,/(.+)-inline(.+)/,vt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Wi(t)-1-e>6)switch(mr(t,e+1)){case 109:if(mr(t,e+4)!==45)break;case 102:return xt(t,/(.+:)(.+)-([^]+)/,"$1"+vt+"$2-$3$1"+kd+(mr(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~J1(t,"stretch")?OB(xt(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(mr(t,e+1)!==115)break;case 6444:switch(mr(t,Wi(t)-3-(~J1(t,"!important")&&10))){case 107:return xt(t,":",":"+vt)+t;case 101:return xt(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+vt+(mr(t,14)===45?"inline-":"")+"box$3$1"+vt+"$2$3$1"+Yn+"$2box$3")+t}break;case 5936:switch(mr(t,e+11)){case 114:return vt+t+Yn+xt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return vt+t+Yn+xt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return vt+t+Yn+xt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return vt+t+Yn+t+t}return t}function Ml(t,e){for(var n="",r=Ev(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function Zte(t,e,n,r){switch(t.type){case Nte:case vv:return t.return=t.return||t.value;case PB:return"";case MB:return t.return=t.value+"{"+Ml(t.children,r)+"}";case _v:t.value=t.props.join(",")}return Wi(n=Ml(t.children,r))?t.return=t.value+"{"+n+"}":""}function qte(t){var e=Ev(t);return function(n,r,i,s){for(var o="",a=0;a<e;a++)o+=t[a](n,r,i,s)||"";return o}}function ene(t){return function(e){e.root||(e=e.return)&&t(e)}}function tne(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case vv:t.return=OB(t.value,t.length);break;case MB:return Ml([Vc(t,{value:xt(t.value,"@","@"+vt)})],r);case _v:if(t.length)return Hte(t.props,function(i){switch(Vte(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ml([Vc(t,{props:[xt(i,/:(read-\w+)/,":"+kd+"$1")]})],r);case"::placeholder":return Ml([Vc(t,{props:[xt(i,/:(plac\w+)/,":"+vt+"input-$1")]}),Vc(t,{props:[xt(i,/:(plac\w+)/,":"+kd+"$1")]}),Vc(t,{props:[xt(i,/:(plac\w+)/,Yn+"input-$1")]})],r)}return""})}}var nne=function(e,n,r){for(var i=0,s=0;i=s,s=qi(),i===38&&s===12&&(n[r]=1),!su(s);)Gr();return Bu(e,br)},rne=function(e,n){var r=-1,i=44;do switch(su(i)){case 0:i===38&&qi()===12&&(n[r]=1),e[r]+=nne(br-1,n,r);break;case 2:e[r]+=Nh(i);break;case 4:if(i===44){e[++r]=qi()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=I0(i)}while(i=Gr());return e},ine=function(e,n){return RB(rne(LB(e),n))},Ux=new WeakMap,sne=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!Ux.get(r))&&!i){Ux.set(e,!0);for(var s=[],o=ine(n,s),a=r.props,c=0,h=0;c<o.length;c++)for(var p=0;p<a.length;p++,h++)e.props[h]=s[c]?o[c].replace(/&\f/g,a[p]):a[p]+" "+o[c]}}},one=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}},ane=[tne],lne=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(x){var I=x.getAttribute("data-emotion");I.indexOf(" ")!==-1&&(document.head.appendChild(x),x.setAttribute("data-s",""))})}var i=e.stylisPlugins||ane,s={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(x){for(var I=x.getAttribute("data-emotion").split(" "),S=1;S<I.length;S++)s[I[S]]=!0;a.push(x)});var c,h=[sne,one];{var p,m=[Zte,ene(function(x){p.insert(x)})],v=qte(h.concat(i,m)),E=function(I){return Ml(Jte(I),v)};c=function(I,S,P,M){p=P,E(I?I+"{"+S.styles+"}":S.styles),M&&(b.inserted[S.name]=!0)}}var b={key:n,sheet:new kte({key:n,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:c};return b.sheet.hydrate(a),b},FB={exports:{}},Mt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dn=typeof Symbol=="function"&&Symbol.for,wv=Dn?Symbol.for("react.element"):60103,Tv=Dn?Symbol.for("react.portal"):60106,R0=Dn?Symbol.for("react.fragment"):60107,O0=Dn?Symbol.for("react.strict_mode"):60108,F0=Dn?Symbol.for("react.profiler"):60114,D0=Dn?Symbol.for("react.provider"):60109,k0=Dn?Symbol.for("react.context"):60110,bv=Dn?Symbol.for("react.async_mode"):60111,N0=Dn?Symbol.for("react.concurrent_mode"):60111,U0=Dn?Symbol.for("react.forward_ref"):60112,G0=Dn?Symbol.for("react.suspense"):60113,cne=Dn?Symbol.for("react.suspense_list"):60120,z0=Dn?Symbol.for("react.memo"):60115,V0=Dn?Symbol.for("react.lazy"):60116,Ane=Dn?Symbol.for("react.block"):60121,une=Dn?Symbol.for("react.fundamental"):60117,fne=Dn?Symbol.for("react.responder"):60118,hne=Dn?Symbol.for("react.scope"):60119;function Wr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case wv:switch(t=t.type,t){case bv:case N0:case R0:case F0:case O0:case G0:return t;default:switch(t=t&&t.$$typeof,t){case k0:case U0:case V0:case z0:case D0:return t;default:return e}}case Tv:return e}}}function DB(t){return Wr(t)===N0}Mt.AsyncMode=bv;Mt.ConcurrentMode=N0;Mt.ContextConsumer=k0;Mt.ContextProvider=D0;Mt.Element=wv;Mt.ForwardRef=U0;Mt.Fragment=R0;Mt.Lazy=V0;Mt.Memo=z0;Mt.Portal=Tv;Mt.Profiler=F0;Mt.StrictMode=O0;Mt.Suspense=G0;Mt.isAsyncMode=function(t){return DB(t)||Wr(t)===bv};Mt.isConcurrentMode=DB;Mt.isContextConsumer=function(t){return Wr(t)===k0};Mt.isContextProvider=function(t){return Wr(t)===D0};Mt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===wv};Mt.isForwardRef=function(t){return Wr(t)===U0};Mt.isFragment=function(t){return Wr(t)===R0};Mt.isLazy=function(t){return Wr(t)===V0};Mt.isMemo=function(t){return Wr(t)===z0};Mt.isPortal=function(t){return Wr(t)===Tv};Mt.isProfiler=function(t){return Wr(t)===F0};Mt.isStrictMode=function(t){return Wr(t)===O0};Mt.isSuspense=function(t){return Wr(t)===G0};Mt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===R0||t===N0||t===F0||t===O0||t===G0||t===cne||typeof t=="object"&&t!==null&&(t.$$typeof===V0||t.$$typeof===z0||t.$$typeof===D0||t.$$typeof===k0||t.$$typeof===U0||t.$$typeof===une||t.$$typeof===fne||t.$$typeof===hne||t.$$typeof===Ane)};Mt.typeOf=Wr;(function(t){t.exports=Mt})(FB);var kB=FB.exports,dne={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},pne={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},NB={};NB[kB.ForwardRef]=dne;NB[kB.Memo]=pne;var gne=!0;function mne(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):r+=i+" "}),r}var UB=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||gne===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},yne=function(e,n,r){UB(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var s=n;do e.insert(n===s?"."+i:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function _ne(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var vne={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Ene=/[A-Z]|^ms/g,wne=/_EMO_([^_]+?)_([^]*?)_EMO_/g,GB=function(e){return e.charCodeAt(1)===45},Gx=function(e){return e!=null&&typeof e!="boolean"},rm=SB(function(t){return GB(t)?t:t.replace(Ene,"-$&").toLowerCase()}),zx=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(wne,function(r,i,s){return Qi={name:i,styles:s,next:Qi},i})}return vne[e]!==1&&!GB(e)&&typeof n=="number"&&n!==0?n+"px":n};function ou(t,e,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Qi={name:n.name,styles:n.styles,next:Qi},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Qi={name:r.name,styles:r.styles,next:Qi},r=r.next;var i=n.styles+";";return i}return Tne(t,e,n)}case"function":{if(t!==void 0){var s=Qi,o=n(t);return Qi=s,ou(t,e,o)}break}}if(e==null)return n;var a=e[n];return a!==void 0?a:n}function Tne(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=ou(t,e,n[i])+";";else for(var s in n){var o=n[s];if(typeof o!="object")e!=null&&e[o]!==void 0?r+=s+"{"+e[o]+"}":Gx(o)&&(r+=rm(s)+":"+zx(s,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var a=0;a<o.length;a++)Gx(o[a])&&(r+=rm(s)+":"+zx(s,o[a])+";");else{var c=ou(t,e,o);switch(s){case"animation":case"animationName":{r+=rm(s)+":"+c+";";break}default:r+=s+"{"+c+"}"}}}return r}var Vx=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Qi,zB=function(e,n,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,s="";Qi=void 0;var o=e[0];o==null||o.raw===void 0?(i=!1,s+=ou(r,n,o)):s+=o[0];for(var a=1;a<e.length;a++)s+=ou(r,n,e[a]),i&&(s+=o[a]);Vx.lastIndex=0;for(var c="",h;(h=Vx.exec(s))!==null;)c+="-"+h[1];var p=_ne(s)+c;return{name:p,styles:s,next:Qi}},bne=function(e){return e()},xne=y2["useInsertionEffect"]?y2["useInsertionEffect"]:!1,Cne=xne||bne,VB=K.exports.createContext(typeof HTMLElement<"u"?lne({key:"css"}):null);VB.Provider;var Sne=function(e){return K.exports.forwardRef(function(n,r){var i=K.exports.useContext(VB);return e(n,i,r)})},Pne=K.exports.createContext({});function Mne(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return zB(e)}var xv=function(){var e=Mne.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Ine=Ote,Bne=function(e){return e!=="theme"},Hx=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Ine:Bne},jx=function(e,n,r){var i;if(n){var s=n.shouldForwardProp;i=e.__emotion_forwardProp&&s?function(o){return e.__emotion_forwardProp(o)&&s(o)}:s}return typeof i!="function"&&r&&(i=e.__emotion_forwardProp),i},Lne=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return UB(n,r,i),Cne(function(){return yne(n,r,i)}),null},Rne=function t(e,n){var r=e.__emotion_real===e,i=r&&e.__emotion_base||e,s,o;n!==void 0&&(s=n.label,o=n.target);var a=jx(e,n,r),c=a||Hx(i),h=!c("as");return function(){var p=arguments,m=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&m.push("label:"+s+";"),p[0]==null||p[0].raw===void 0)m.push.apply(m,p);else{m.push(p[0][0]);for(var v=p.length,E=1;E<v;E++)m.push(p[E],p[0][E])}var b=Sne(function(x,I,S){var P=h&&x.as||i,M="",O=[],N=x;if(x.theme==null){N={};for(var z in x)N[z]=x[z];N.theme=K.exports.useContext(Pne)}typeof x.className=="string"?M=mne(I.registered,O,x.className):x.className!=null&&(M=x.className+" ");var X=zB(m.concat(O),I.registered,N);M+=I.key+"-"+X.name,o!==void 0&&(M+=" "+o);var Z=h&&a===void 0?Hx(P):c,Q={};for(var k in x)h&&k==="as"||Z(k)&&(Q[k]=x[k]);return Q.className=M,Q.ref=S,K.exports.createElement(K.exports.Fragment,null,K.exports.createElement(Lne,{cache:I,serialized:X,isStringTag:typeof P=="string"}),K.exports.createElement(P,Q))});return b.displayName=s!==void 0?s:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",b.defaultProps=e.defaultProps,b.__emotion_real=b,b.__emotion_base=i,b.__emotion_styles=m,b.__emotion_forwardProp=a,Object.defineProperty(b,"toString",{value:function(){return"."+o}}),b.withComponent=function(x,I){return t(x,ue({},n,I,{shouldForwardProp:jx(b,I,!0)})).apply(void 0,m)},b}},One=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Z1=Rne.bind();One.forEach(function(t){Z1[t]=Z1(t)});const Fne=Z1;/** @license MUI v5.10.7
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Dne(t,e){return Fne(t,e)}const kne=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))};function EA(t,e){return e?hs(t,e,{clone:!1}):t}const Cv={xs:0,sm:600,md:900,lg:1200,xl:1536},Wx={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${Cv[t]}px)`};function vo(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const s=r.breakpoints||Wx;return e.reduce((o,a,c)=>(o[s.up(s.keys[c])]=n(e[c]),o),{})}if(typeof e=="object"){const s=r.breakpoints||Wx;return Object.keys(e).reduce((o,a)=>{if(Object.keys(s.values||Cv).indexOf(a)!==-1){const c=s.up(a);o[c]=n(e[a],a)}else{const c=a;o[c]=e[c]}return o},{})}return n(e)}function Nne(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,i)=>{const s=t.up(i);return r[s]={},r},{}))||{}}function Une(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function Sv(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,s)=>i&&i[s]?i[s]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function Qx(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=Sv(t,n)||r,e&&(i=e(i)),i}function Re(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,s=o=>{if(o[e]==null)return null;const a=o[e],c=o.theme,h=Sv(c,r)||{};return vo(o,a,m=>{let v=Qx(h,i,m);return m===v&&typeof m=="string"&&(v=Qx(h,i,`${e}${m==="default"?"":kt(m)}`,m)),n===!1?v:{[n]:v}})};return s.propTypes={},s.filterProps=[e],s}function Eo(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(s=>{r[s]=i}),r),{}),n=r=>Object.keys(r).reduce((i,s)=>e[s]?EA(i,e[s](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Gne(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const zne={m:"margin",p:"padding"},Vne={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},$x={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Hne=Gne(t=>{if(t.length>2)if($x[t])t=$x[t];else return[t];const[e,n]=t.split(""),r=zne[e],i=Vne[n]||"";return Array.isArray(i)?i.map(s=>r+s):[r+i]}),jne=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Wne=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],HB=[...jne,...Wne];function Lu(t,e,n,r){var i;const s=(i=Sv(t,e,!1))!=null?i:n;return typeof s=="number"?o=>typeof o=="string"?o:s*o:Array.isArray(s)?o=>typeof o=="string"?o:s[o]:typeof s=="function"?s:()=>{}}function jB(t){return Lu(t,"spacing",8)}function Ru(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function Qne(t,e){return n=>t.reduce((r,i)=>(r[i]=Ru(e,n),r),{})}function $ne(t,e,n,r){if(e.indexOf(n)===-1)return null;const i=Hne(n),s=Qne(i,r),o=t[n];return vo(t,o,s)}function Xne(t,e){const n=jB(t.theme);return Object.keys(t).map(r=>$ne(t,e,r,n)).reduce(EA,{})}function H0(t){return Xne(t,HB)}H0.propTypes={};H0.filterProps=HB;function Ou(t){return typeof t!="number"?t:`${t}px solid`}const Yne=Re({prop:"border",themeKey:"borders",transform:Ou}),Jne=Re({prop:"borderTop",themeKey:"borders",transform:Ou}),Kne=Re({prop:"borderRight",themeKey:"borders",transform:Ou}),Zne=Re({prop:"borderBottom",themeKey:"borders",transform:Ou}),qne=Re({prop:"borderLeft",themeKey:"borders",transform:Ou}),ere=Re({prop:"borderColor",themeKey:"palette"}),tre=Re({prop:"borderTopColor",themeKey:"palette"}),nre=Re({prop:"borderRightColor",themeKey:"palette"}),rre=Re({prop:"borderBottomColor",themeKey:"palette"}),ire=Re({prop:"borderLeftColor",themeKey:"palette"}),Pv=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=Lu(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Ru(e,r)});return vo(t,t.borderRadius,n)}return null};Pv.propTypes={};Pv.filterProps=["borderRadius"];const sre=Eo(Yne,Jne,Kne,Zne,qne,ere,tre,nre,rre,ire,Pv),WB=sre,ore=Re({prop:"displayPrint",cssProperty:!1,transform:t=>({"@media print":{display:t}})}),are=Re({prop:"display"}),lre=Re({prop:"overflow"}),cre=Re({prop:"textOverflow"}),Are=Re({prop:"visibility"}),ure=Re({prop:"whiteSpace"}),QB=Eo(ore,are,lre,cre,Are,ure),fre=Re({prop:"flexBasis"}),hre=Re({prop:"flexDirection"}),dre=Re({prop:"flexWrap"}),pre=Re({prop:"justifyContent"}),gre=Re({prop:"alignItems"}),mre=Re({prop:"alignContent"}),yre=Re({prop:"order"}),_re=Re({prop:"flex"}),vre=Re({prop:"flexGrow"}),Ere=Re({prop:"flexShrink"}),wre=Re({prop:"alignSelf"}),Tre=Re({prop:"justifyItems"}),bre=Re({prop:"justifySelf"}),xre=Eo(fre,hre,dre,pre,gre,mre,yre,_re,vre,Ere,wre,Tre,bre),$B=xre,Mv=t=>{if(t.gap!==void 0&&t.gap!==null){const e=Lu(t.theme,"spacing",8),n=r=>({gap:Ru(e,r)});return vo(t,t.gap,n)}return null};Mv.propTypes={};Mv.filterProps=["gap"];const Iv=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=Lu(t.theme,"spacing",8),n=r=>({columnGap:Ru(e,r)});return vo(t,t.columnGap,n)}return null};Iv.propTypes={};Iv.filterProps=["columnGap"];const Bv=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=Lu(t.theme,"spacing",8),n=r=>({rowGap:Ru(e,r)});return vo(t,t.rowGap,n)}return null};Bv.propTypes={};Bv.filterProps=["rowGap"];const Cre=Re({prop:"gridColumn"}),Sre=Re({prop:"gridRow"}),Pre=Re({prop:"gridAutoFlow"}),Mre=Re({prop:"gridAutoColumns"}),Ire=Re({prop:"gridAutoRows"}),Bre=Re({prop:"gridTemplateColumns"}),Lre=Re({prop:"gridTemplateRows"}),Rre=Re({prop:"gridTemplateAreas"}),Ore=Re({prop:"gridArea"}),Fre=Eo(Mv,Iv,Bv,Cre,Sre,Pre,Mre,Ire,Bre,Lre,Rre,Ore),XB=Fre,Dre=Re({prop:"color",themeKey:"palette"}),kre=Re({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"}),Nre=Re({prop:"backgroundColor",themeKey:"palette"}),Ure=Eo(Dre,kre,Nre),YB=Ure,Gre=Re({prop:"position"}),zre=Re({prop:"zIndex",themeKey:"zIndex"}),Vre=Re({prop:"top"}),Hre=Re({prop:"right"}),jre=Re({prop:"bottom"}),Wre=Re({prop:"left"}),JB=Eo(Gre,zre,Vre,Hre,jre,Wre),Qre=Re({prop:"boxShadow",themeKey:"shadows"}),KB=Qre;function wo(t){return t<=1&&t!==0?`${t*100}%`:t}const $re=Re({prop:"width",transform:wo}),ZB=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,i,s;return{maxWidth:((r=t.theme)==null||(i=r.breakpoints)==null||(s=i.values)==null?void 0:s[n])||Cv[n]||wo(n)}};return vo(t,t.maxWidth,e)}return null};ZB.filterProps=["maxWidth"];const Xre=Re({prop:"minWidth",transform:wo}),Yre=Re({prop:"height",transform:wo}),Jre=Re({prop:"maxHeight",transform:wo}),Kre=Re({prop:"minHeight",transform:wo});Re({prop:"size",cssProperty:"width",transform:wo});Re({prop:"size",cssProperty:"height",transform:wo});const Zre=Re({prop:"boxSizing"}),qre=Eo($re,ZB,Xre,Yre,Jre,Kre,Zre),qB=qre,eie=Re({prop:"fontFamily",themeKey:"typography"}),tie=Re({prop:"fontSize",themeKey:"typography"}),nie=Re({prop:"fontStyle",themeKey:"typography"}),rie=Re({prop:"fontWeight",themeKey:"typography"}),iie=Re({prop:"letterSpacing"}),sie=Re({prop:"textTransform"}),oie=Re({prop:"lineHeight"}),aie=Re({prop:"textAlign"}),lie=Re({prop:"typography",cssProperty:!1,themeKey:"typography"}),cie=Eo(lie,eie,tie,nie,rie,iie,oie,aie,sie),eL=cie,Xx={borders:WB.filterProps,display:QB.filterProps,flexbox:$B.filterProps,grid:XB.filterProps,positions:JB.filterProps,palette:YB.filterProps,shadows:KB.filterProps,sizing:qB.filterProps,spacing:H0.filterProps,typography:eL.filterProps},tL={borders:WB,display:QB,flexbox:$B,grid:XB,positions:JB,palette:YB,shadows:KB,sizing:qB,spacing:H0,typography:eL};Object.keys(Xx).reduce((t,e)=>(Xx[e].forEach(n=>{t[n]=tL[e]}),t),{});function Aie(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function uie(t,e){return typeof t=="function"?t(e):t}function fie(t=tL){const e=Object.keys(t).reduce((i,s)=>(t[s].filterProps.forEach(o=>{i[o]=t[s]}),i),{});function n(i,s,o){const a={[i]:s,theme:o},c=e[i];return c?c(a):{[i]:s}}function r(i){const{sx:s,theme:o={}}=i||{};if(!s)return null;function a(c){let h=c;if(typeof c=="function")h=c(o);else if(typeof c!="object")return c;if(!h)return null;const p=Nne(o.breakpoints),m=Object.keys(p);let v=p;return Object.keys(h).forEach(E=>{const b=uie(h[E],o);if(b!=null)if(typeof b=="object")if(e[E])v=EA(v,n(E,b,o));else{const x=vo({theme:o},b,I=>({[E]:I}));Aie(x,b)?v[E]=r({sx:b,theme:o}):v=EA(v,x)}else v=EA(v,n(E,b,o))}),Une(m,v)}return Array.isArray(s)?s.map(a):a(s)}return r}const nL=fie();nL.filterProps=["sx"];const hie=nL,die=["values","unit","step"],pie=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>ue({},n,{[r.key]:r.val}),{})};function gie(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=zn(t,die),s=pie(e),o=Object.keys(s);function a(v){return`@media (min-width:${typeof e[v]=="number"?e[v]:v}${n})`}function c(v){return`@media (max-width:${(typeof e[v]=="number"?e[v]:v)-r/100}${n})`}function h(v,E){const b=o.indexOf(E);return`@media (min-width:${typeof e[v]=="number"?e[v]:v}${n}) and (max-width:${(b!==-1&&typeof e[o[b]]=="number"?e[o[b]]:E)-r/100}${n})`}function p(v){return o.indexOf(v)+1<o.length?h(v,o[o.indexOf(v)+1]):a(v)}function m(v){const E=o.indexOf(v);return E===0?a(o[1]):E===o.length-1?c(o[E]):h(v,o[o.indexOf(v)+1]).replace("@media","@media not all and")}return ue({keys:o,values:s,up:a,down:c,between:h,only:p,not:m,unit:n},i)}const mie={borderRadius:4},yie=mie;function _ie(t=8){if(t.mui)return t;const e=jB({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(s=>{const o=e(s);return typeof o=="number"?`${o}px`:o}).join(" ");return n.mui=!0,n}const vie=["breakpoints","palette","spacing","shape"];function Lv(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:s={}}=t,o=zn(t,vie),a=gie(n),c=_ie(i);let h=hs({breakpoints:a,direction:"ltr",components:{},palette:ue({mode:"light"},r),spacing:c,shape:ue({},yie,s)},o);return h=e.reduce((p,m)=>hs(p,m),h),h}const Eie=K.exports.createContext(null),wie=Eie;function Tie(){return K.exports.useContext(wie)}function bie(t){return Object.keys(t).length===0}function xie(t=null){const e=Tie();return!e||bie(e)?t:e}const Cie=Lv();function rL(t=Cie){return xie(t)}const Sie=["variant"];function Yx(t){return t.length===0}function iL(t){const{variant:e}=t,n=zn(t,Sie);let r=e||"";return Object.keys(n).sort().forEach(i=>{i==="color"?r+=Yx(r)?t[i]:kt(t[i]):r+=`${Yx(r)?i:kt(i)}${kt(t[i].toString())}`}),r}const Pie=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],Mie=["theme"],Iie=["theme"];function Hc(t){return Object.keys(t).length===0}function Bie(t){return typeof t=="string"&&t.charCodeAt(0)>96}const Lie=(t,e)=>e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null,Rie=(t,e)=>{let n=[];e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants);const r={};return n.forEach(i=>{const s=iL(i.props);r[s]=i.style}),r},Oie=(t,e,n,r)=>{var i,s;const{ownerState:o={}}=t,a=[],c=n==null||(i=n.components)==null||(s=i[r])==null?void 0:s.variants;return c&&c.forEach(h=>{let p=!0;Object.keys(h.props).forEach(m=>{o[m]!==h.props[m]&&t[m]!==h.props[m]&&(p=!1)}),p&&a.push(e[iL(h.props)])}),a};function wA(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Fie=Lv();function Die(t={}){const{defaultTheme:e=Fie,rootShouldForwardProp:n=wA,slotShouldForwardProp:r=wA,styleFunctionSx:i=hie}=t,s=o=>{const a=Hc(o.theme)?e:o.theme;return i(ue({},o,{theme:a}))};return s.__mui_systemSx=!0,(o,a={})=>{kne(o,O=>O.filter(N=>!(N!=null&&N.__mui_systemSx)));const{name:c,slot:h,skipVariantsResolver:p,skipSx:m,overridesResolver:v}=a,E=zn(a,Pie),b=p!==void 0?p:h&&h!=="Root"||!1,x=m||!1;let I,S=wA;h==="Root"?S=n:h?S=r:Bie(o)&&(S=void 0);const P=Dne(o,ue({shouldForwardProp:S,label:I},E)),M=(O,...N)=>{const z=N?N.map(k=>typeof k=="function"&&k.__emotion_real!==k?D=>{let{theme:ne}=D,se=zn(D,Mie);return k(ue({theme:Hc(ne)?e:ne},se))}:k):[];let X=O;c&&v&&z.push(k=>{const D=Hc(k.theme)?e:k.theme,ne=Lie(c,D);if(ne){const se={};return Object.entries(ne).forEach(([oe,xe])=>{se[oe]=typeof xe=="function"?xe(ue({},k,{theme:D})):xe}),v(k,se)}return null}),c&&!b&&z.push(k=>{const D=Hc(k.theme)?e:k.theme;return Oie(k,Rie(c,D),D,c)}),x||z.push(s);const Z=z.length-N.length;if(Array.isArray(O)&&Z>0){const k=new Array(Z).fill("");X=[...O,...k],X.raw=[...O.raw,...k]}else typeof O=="function"&&O.__emotion_real!==O&&(X=k=>{let{theme:D}=k,ne=zn(k,Iie);return O(ue({theme:Hc(D)?e:D},ne))});return P(X,...z)};return P.withConfig&&(M.withConfig=P.withConfig),M}}function kie(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:bB(e.components[n].defaultProps,r)}function Nie({props:t,name:e,defaultTheme:n}){const r=rL(n);return kie({theme:r,name:e,props:t})}function Rv(t,e=0,n=1){return Math.min(Math.max(e,t),n)}function Uie(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Aa(t){if(t.type)return t;if(t.charAt(0)==="#")return Aa(Uie(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(Ql(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(Ql(10,i))}else r=r.split(",");return r=r.map(s=>parseFloat(s)),{type:n,values:r,colorSpace:i}}function j0(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,s)=>s<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function Gie(t){t=Aa(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,s=r*Math.min(i,1-i),o=(h,p=(h+n/30)%12)=>i-s*Math.max(Math.min(p-3,9-p,1),-1);let a="rgb";const c=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return t.type==="hsla"&&(a+="a",c.push(e[3])),j0({type:a,values:c})}function Jx(t){t=Aa(t);let e=t.type==="hsl"||t.type==="hsla"?Aa(Gie(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function zie(t,e){const n=Jx(t),r=Jx(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function ml(t,e){return t=Aa(t),e=Rv(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,j0(t)}function sL(t,e){if(t=Aa(t),e=Rv(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return j0(t)}function oL(t,e){if(t=Aa(t),e=Rv(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return j0(t)}function Vie(t,e){return ue({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}const Hie={black:"#000",white:"#fff"},au=Hie,jie={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Wie=jie,Qie={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Na=Qie,$ie={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Ua=$ie,Xie={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},jc=Xie,Yie={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Ga=Yie,Jie={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},za=Jie,Kie={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Va=Kie,Zie=["mode","contrastThreshold","tonalOffset"],Kx={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:au.white,default:au.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},im={text:{primary:au.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:au.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function Zx(t,e,n,r){const i=r.light||r,s=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=oL(t.main,i):e==="dark"&&(t.dark=sL(t.main,s)))}function qie(t="light"){return t==="dark"?{main:Ga[200],light:Ga[50],dark:Ga[400]}:{main:Ga[700],light:Ga[400],dark:Ga[800]}}function ese(t="light"){return t==="dark"?{main:Na[200],light:Na[50],dark:Na[400]}:{main:Na[500],light:Na[300],dark:Na[700]}}function tse(t="light"){return t==="dark"?{main:Ua[500],light:Ua[300],dark:Ua[700]}:{main:Ua[700],light:Ua[400],dark:Ua[800]}}function nse(t="light"){return t==="dark"?{main:za[400],light:za[300],dark:za[700]}:{main:za[700],light:za[500],dark:za[900]}}function rse(t="light"){return t==="dark"?{main:Va[400],light:Va[300],dark:Va[700]}:{main:Va[800],light:Va[500],dark:Va[900]}}function ise(t="light"){return t==="dark"?{main:jc[400],light:jc[300],dark:jc[700]}:{main:"#ed6c02",light:jc[500],dark:jc[900]}}function sse(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,i=zn(t,Zie),s=t.primary||qie(e),o=t.secondary||ese(e),a=t.error||tse(e),c=t.info||nse(e),h=t.success||rse(e),p=t.warning||ise(e);function m(x){return zie(x,im.text.primary)>=n?im.text.primary:Kx.text.primary}const v=({color:x,name:I,mainShade:S=500,lightShade:P=300,darkShade:M=700})=>{if(x=ue({},x),!x.main&&x[S]&&(x.main=x[S]),!x.hasOwnProperty("main"))throw new Error(Ql(11,I?` (${I})`:"",S));if(typeof x.main!="string")throw new Error(Ql(12,I?` (${I})`:"",JSON.stringify(x.main)));return Zx(x,"light",P,r),Zx(x,"dark",M,r),x.contrastText||(x.contrastText=m(x.main)),x},E={dark:im,light:Kx};return hs(ue({common:ue({},au),mode:e,primary:v({color:s,name:"primary"}),secondary:v({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:v({color:a,name:"error"}),warning:v({color:p,name:"warning"}),info:v({color:c,name:"info"}),success:v({color:h,name:"success"}),grey:Wie,contrastThreshold:n,getContrastText:m,augmentColor:v,tonalOffset:r},E[e]),i)}const ose=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function ase(t){return Math.round(t*1e5)/1e5}const qx={textTransform:"uppercase"},eC='"Roboto", "Helvetica", "Arial", sans-serif';function lse(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=eC,fontSize:i=14,fontWeightLight:s=300,fontWeightRegular:o=400,fontWeightMedium:a=500,fontWeightBold:c=700,htmlFontSize:h=16,allVariants:p,pxToRem:m}=n,v=zn(n,ose),E=i/14,b=m||(S=>`${S/h*E}rem`),x=(S,P,M,O,N)=>ue({fontFamily:r,fontWeight:S,fontSize:b(P),lineHeight:M},r===eC?{letterSpacing:`${ase(O/P)}em`}:{},N,p),I={h1:x(s,96,1.167,-1.5),h2:x(s,60,1.2,-.5),h3:x(o,48,1.167,0),h4:x(o,34,1.235,.25),h5:x(o,24,1.334,0),h6:x(a,20,1.6,.15),subtitle1:x(o,16,1.75,.15),subtitle2:x(a,14,1.57,.1),body1:x(o,16,1.5,.15),body2:x(o,14,1.43,.15),button:x(a,14,1.75,.4,qx),caption:x(o,12,1.66,.4),overline:x(o,12,2.66,1,qx)};return hs(ue({htmlFontSize:h,pxToRem:b,fontFamily:r,fontSize:i,fontWeightLight:s,fontWeightRegular:o,fontWeightMedium:a,fontWeightBold:c},I),v,{clone:!1})}const cse=.2,Ase=.14,use=.12;function Xt(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${cse})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Ase})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${use})`].join(",")}const fse=["none",Xt(0,2,1,-1,0,1,1,0,0,1,3,0),Xt(0,3,1,-2,0,2,2,0,0,1,5,0),Xt(0,3,3,-2,0,3,4,0,0,1,8,0),Xt(0,2,4,-1,0,4,5,0,0,1,10,0),Xt(0,3,5,-1,0,5,8,0,0,1,14,0),Xt(0,3,5,-1,0,6,10,0,0,1,18,0),Xt(0,4,5,-2,0,7,10,1,0,2,16,1),Xt(0,5,5,-3,0,8,10,1,0,3,14,2),Xt(0,5,6,-3,0,9,12,1,0,3,16,2),Xt(0,6,6,-3,0,10,14,1,0,4,18,3),Xt(0,6,7,-4,0,11,15,1,0,4,20,3),Xt(0,7,8,-4,0,12,17,2,0,5,22,4),Xt(0,7,8,-4,0,13,19,2,0,5,24,4),Xt(0,7,9,-4,0,14,21,2,0,5,26,4),Xt(0,8,9,-5,0,15,22,2,0,6,28,5),Xt(0,8,10,-5,0,16,24,2,0,6,30,5),Xt(0,8,11,-5,0,17,26,2,0,6,32,5),Xt(0,9,11,-5,0,18,28,2,0,7,34,6),Xt(0,9,12,-6,0,19,29,2,0,7,36,6),Xt(0,10,13,-6,0,20,31,3,0,8,38,7),Xt(0,10,13,-6,0,21,33,3,0,8,40,7),Xt(0,10,14,-6,0,22,35,3,0,8,42,7),Xt(0,11,14,-7,0,23,36,3,0,9,44,8),Xt(0,11,15,-7,0,24,38,3,0,9,46,8)],hse=fse,dse=["duration","easing","delay"],pse={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},gse={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function tC(t){return`${Math.round(t)}ms`}function mse(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function yse(t){const e=ue({},pse,t.easing),n=ue({},gse,t.duration);return ue({getAutoHeightDuration:mse,create:(i=["all"],s={})=>{const{duration:o=n.standard,easing:a=e.easeInOut,delay:c=0}=s;return zn(s,dse),(Array.isArray(i)?i:[i]).map(h=>`${h} ${typeof o=="string"?o:tC(o)} ${a} ${typeof c=="string"?c:tC(c)}`).join(",")}},t,{easing:e,duration:n})}const _se={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},vse=_se,Ese=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function wse(t={},...e){const{mixins:n={},palette:r={},transitions:i={},typography:s={}}=t,o=zn(t,Ese);if(t.vars)throw new Error(Ql(18));const a=sse(r),c=Lv(t);let h=hs(c,{mixins:Vie(c.breakpoints,n),palette:a,shadows:hse.slice(),typography:lse(a,s),transitions:yse(i),zIndex:ue({},vse)});return h=hs(h,o),h=e.reduce((p,m)=>hs(p,m),h),h}const Tse=wse(),Ov=Tse;function W0({props:t,name:e}){return Nie({props:t,name:e,defaultTheme:Ov})}const aL=t=>wA(t)&&t!=="classes",lL=wA,bse=Die({defaultTheme:Ov,rootShouldForwardProp:aL}),Qr=bse;function xse(){return rL(Ov)}const Cse=t=>!t||!vA(t),ih=Cse,Sse=["component","components","componentsProps","color","size"],Zs=ue({},Dh,Iu("MuiSlider",["colorPrimary","colorSecondary","thumbColorPrimary","thumbColorSecondary","sizeSmall","thumbSizeSmall"])),Pse=Qr("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${kt(n.color)}`],n.size!=="medium"&&e[`size${kt(n.size)}`],n.marked&&e.marked,n.orientation==="vertical"&&e.vertical,n.track==="inverted"&&e.trackInverted,n.track===!1&&e.trackFalse]}})(({theme:t,ownerState:e})=>ue({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:(t.vars||t).palette[e.color].main,WebkitTapHighlightColor:"transparent"},e.orientation==="horizontal"&&ue({height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}},e.size==="small"&&{height:2},e.marked&&{marginBottom:20}),e.orientation==="vertical"&&ue({height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}},e.size==="small"&&{width:2},e.marked&&{marginRight:44}),{"@media print":{colorAdjust:"exact"},[`&.${Zs.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${Zs.dragging}`]:{[`& .${Zs.thumb}, & .${Zs.track}`]:{transition:"none"}}})),Mse=Qr("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(t,e)=>e.rail})(({ownerState:t})=>ue({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38},t.orientation==="horizontal"&&{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"},t.orientation==="vertical"&&{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"},t.track==="inverted"&&{opacity:1})),Ise=Qr("span",{name:"MuiSlider",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?oL(t.palette[e.color].main,.62):sL(t.palette[e.color].main,.5);return ue({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest})},e.size==="small"&&{border:"none"},e.orientation==="horizontal"&&{height:"inherit",top:"50%",transform:"translateY(-50%)"},e.orientation==="vertical"&&{width:"inherit",left:"50%",transform:"translateX(-50%)"},e.track===!1&&{display:"none"},e.track==="inverted"&&{backgroundColor:t.vars?t.vars.palette.Slider[`${e.color}Track`]:n,borderColor:t.vars?t.vars.palette.Slider[`${e.color}Track`]:n})}),Bse=Qr("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e[`thumbColor${kt(n.color)}`],n.size!=="medium"&&e[`thumbSize${kt(n.size)}`]]}})(({theme:t,ownerState:e})=>ue({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest})},e.size==="small"&&{width:12,height:12},e.orientation==="horizontal"&&{top:"50%",transform:"translate(-50%, -50%)"},e.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 50%)"},{"&:before":ue({position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},e.size==="small"&&{boxShadow:"none"}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&:hover, &.${Zs.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.16)`:ml(t.palette[e.color].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${Zs.active}`]:{boxShadow:`0px 0px 0px 14px ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.16)`:ml(t.palette[e.color].main,.16)}`},[`&.${Zs.disabled}`]:{"&:hover":{boxShadow:"none"}}})),Lse=Qr(xB,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(t,e)=>e.valueLabel})(({theme:t,ownerState:e})=>ue({[`&.${Zs.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"},zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),transform:"translateY(-100%) scale(0)",position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem"},e.orientation==="horizontal"&&{top:"-10px",transformOrigin:"bottom center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"}},e.orientation==="vertical"&&{right:"30px",top:"24px",transformOrigin:"right center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",right:"-20%",top:"25%"}},e.size==="small"&&{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"})),Rse=Qr("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>lL(t)&&t!=="markActive",overridesResolver:(t,e)=>e.mark})(({theme:t,ownerState:e,markActive:n})=>ue({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},e.orientation==="horizontal"&&{top:"50%",transform:"translate(-1px, -50%)"},e.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 1px)"},n&&{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8})),Ose=Qr("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>lL(t)&&t!=="markLabelActive",overridesResolver:(t,e)=>e.markLabel})(({theme:t,ownerState:e,markLabelActive:n})=>ue({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap"},e.orientation==="horizontal"&&{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}},e.orientation==="vertical"&&{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}},n&&{color:(t.vars||t).palette.text.primary})),Fse=t=>{const{color:e,size:n,classes:r={}}=t;return ue({},r,{root:qt(r.root,tA(`color${kt(e)}`),r[`color${kt(e)}`],n&&[tA(`size${kt(n)}`),r[`size${kt(n)}`]]),thumb:qt(r.thumb,tA(`thumbColor${kt(e)}`),r[`thumbColor${kt(e)}`],n&&[tA(`thumbSize${kt(n)}`),r[`thumbSize${kt(n)}`]])})},Dse=K.exports.forwardRef(function(e,n){var r,i,s,o;const a=W0({props:e,name:"MuiSlider"}),h=xse().direction==="rtl",{component:p="span",components:m={},componentsProps:v={},color:E="primary",size:b="medium"}=a,x=zn(a,Sse),I=ue({},a,{color:E,size:b}),S=Fse(I);return Ve(Lte,ue({},x,{isRtl:h,components:ue({Root:Pse,Rail:Mse,Track:Ise,Thumb:Bse,ValueLabel:Lse,Mark:Rse,MarkLabel:Ose},m),componentsProps:ue({},v,{root:ue({},v.root,ih(m.Root)&&{as:p,ownerState:ue({},(r=v.root)==null?void 0:r.ownerState,{color:E,size:b})}),thumb:ue({},v.thumb,ih(m.Thumb)&&{ownerState:ue({},(i=v.thumb)==null?void 0:i.ownerState,{color:E,size:b})}),track:ue({},v.track,ih(m.Track)&&{ownerState:ue({},(s=v.track)==null?void 0:s.ownerState,{color:E,size:b})}),valueLabel:ue({},v.valueLabel,ih(m.ValueLabel)&&{ownerState:ue({},(o=v.valueLabel)==null?void 0:o.ownerState,{color:E,size:b})})}),classes:S,ref:n}))}),kse=Dse;function q1(t,e){return q1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},q1(t,e)}function Nse(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,q1(t,e)}const nC=Nd.createContext(null);function Use(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fv(t,e){var n=function(s){return e&&K.exports.isValidElement(s)?e(s):s},r=Object.create(null);return t&&K.exports.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function Gse(t,e){t=t||{},e=e||{};function n(p){return p in e?e[p]:t[p]}var r=Object.create(null),i=[];for(var s in t)s in e?i.length&&(r[s]=i,i=[]):i.push(s);var o,a={};for(var c in e){if(r[c])for(o=0;o<r[c].length;o++){var h=r[c][o];a[r[c][o]]=n(h)}a[c]=n(c)}for(o=0;o<i.length;o++)a[i[o]]=n(i[o]);return a}function jo(t,e,n){return n[e]!=null?n[e]:t.props[e]}function zse(t,e){return Fv(t.children,function(n){return K.exports.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:jo(n,"appear",t),enter:jo(n,"enter",t),exit:jo(n,"exit",t)})})}function Vse(t,e,n){var r=Fv(t.children),i=Gse(e,r);return Object.keys(i).forEach(function(s){var o=i[s];if(!!K.exports.isValidElement(o)){var a=s in e,c=s in r,h=e[s],p=K.exports.isValidElement(h)&&!h.props.in;c&&(!a||p)?i[s]=K.exports.cloneElement(o,{onExited:n.bind(null,o),in:!0,exit:jo(o,"exit",t),enter:jo(o,"enter",t)}):!c&&a&&!p?i[s]=K.exports.cloneElement(o,{in:!1}):c&&a&&K.exports.isValidElement(h)&&(i[s]=K.exports.cloneElement(o,{onExited:n.bind(null,o),in:h.props.in,exit:jo(o,"exit",t),enter:jo(o,"enter",t)}))}}),i}var Hse=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},jse={component:"div",childFactory:function(e){return e}},Dv=function(t){Nse(e,t);function e(r,i){var s;s=t.call(this,r,i)||this;var o=s.handleExited.bind(Use(s));return s.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},s}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,s){var o=s.children,a=s.handleExited,c=s.firstRender;return{children:c?zse(i,a):Vse(i,o,a),firstRender:!1}},n.handleExited=function(i,s){var o=Fv(this.props.children);i.key in o||(i.props.onExited&&i.props.onExited(s),this.mounted&&this.setState(function(a){var c=ue({},a.children);return delete c[i.key],{children:c}}))},n.render=function(){var i=this.props,s=i.component,o=i.childFactory,a=zn(i,["component","childFactory"]),c=this.state.contextValue,h=Hse(this.state.children).map(o);return delete a.appear,delete a.enter,delete a.exit,s===null?Ve(nC.Provider,{value:c,children:h}):Ve(nC.Provider,{value:c,children:Ve(s,{...a,children:h})})},e}(Nd.Component);Dv.propTypes={};Dv.defaultProps=jse;const Wse=Dv;function Qse(t){const{className:e,classes:n,pulsate:r=!1,rippleX:i,rippleY:s,rippleSize:o,in:a,onExited:c,timeout:h}=t,[p,m]=K.exports.useState(!1),v=qt(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),E={width:o,height:o,top:-(o/2)+s,left:-(o/2)+i},b=qt(n.child,p&&n.childLeaving,r&&n.childPulsate);return!a&&!p&&m(!0),K.exports.useEffect(()=>{if(!a&&c!=null){const x=setTimeout(c,h);return()=>{clearTimeout(x)}}},[c,a,h]),Ve("span",{className:v,style:E,children:Ve("span",{className:b})})}const $se=Iu("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),qr=$se,Xse=["center","classes","className"];let Q0=t=>t,rC,iC,sC,oC;const ey=550,Yse=80,Jse=xv(rC||(rC=Q0`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),Kse=xv(iC||(iC=Q0`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),Zse=xv(sC||(sC=Q0`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),qse=Qr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),eoe=Qr(Qse,{name:"MuiTouchRipple",slot:"Ripple"})(oC||(oC=Q0`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),qr.rippleVisible,Jse,ey,({theme:t})=>t.transitions.easing.easeInOut,qr.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,qr.child,qr.childLeaving,Kse,ey,({theme:t})=>t.transitions.easing.easeInOut,qr.childPulsate,Zse,({theme:t})=>t.transitions.easing.easeInOut),toe=K.exports.forwardRef(function(e,n){const r=W0({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:s={},className:o}=r,a=zn(r,Xse),[c,h]=K.exports.useState([]),p=K.exports.useRef(0),m=K.exports.useRef(null);K.exports.useEffect(()=>{m.current&&(m.current(),m.current=null)},[c]);const v=K.exports.useRef(!1),E=K.exports.useRef(null),b=K.exports.useRef(null),x=K.exports.useRef(null);K.exports.useEffect(()=>()=>{clearTimeout(E.current)},[]);const I=K.exports.useCallback(O=>{const{pulsate:N,rippleX:z,rippleY:X,rippleSize:Z,cb:Q}=O;h(k=>[...k,Ve(eoe,{classes:{ripple:qt(s.ripple,qr.ripple),rippleVisible:qt(s.rippleVisible,qr.rippleVisible),ripplePulsate:qt(s.ripplePulsate,qr.ripplePulsate),child:qt(s.child,qr.child),childLeaving:qt(s.childLeaving,qr.childLeaving),childPulsate:qt(s.childPulsate,qr.childPulsate)},timeout:ey,pulsate:N,rippleX:z,rippleY:X,rippleSize:Z},p.current)]),p.current+=1,m.current=Q},[s]),S=K.exports.useCallback((O={},N={},z)=>{const{pulsate:X=!1,center:Z=i||N.pulsate,fakeElement:Q=!1}=N;if((O==null?void 0:O.type)==="mousedown"&&v.current){v.current=!1;return}(O==null?void 0:O.type)==="touchstart"&&(v.current=!0);const k=Q?null:x.current,D=k?k.getBoundingClientRect():{width:0,height:0,left:0,top:0};let ne,se,oe;if(Z||O===void 0||O.clientX===0&&O.clientY===0||!O.clientX&&!O.touches)ne=Math.round(D.width/2),se=Math.round(D.height/2);else{const{clientX:xe,clientY:Pe}=O.touches&&O.touches.length>0?O.touches[0]:O;ne=Math.round(xe-D.left),se=Math.round(Pe-D.top)}if(Z)oe=Math.sqrt((2*D.width**2+D.height**2)/3),oe%2===0&&(oe+=1);else{const xe=Math.max(Math.abs((k?k.clientWidth:0)-ne),ne)*2+2,Pe=Math.max(Math.abs((k?k.clientHeight:0)-se),se)*2+2;oe=Math.sqrt(xe**2+Pe**2)}O!=null&&O.touches?b.current===null&&(b.current=()=>{I({pulsate:X,rippleX:ne,rippleY:se,rippleSize:oe,cb:z})},E.current=setTimeout(()=>{b.current&&(b.current(),b.current=null)},Yse)):I({pulsate:X,rippleX:ne,rippleY:se,rippleSize:oe,cb:z})},[i,I]),P=K.exports.useCallback(()=>{S({},{pulsate:!0})},[S]),M=K.exports.useCallback((O,N)=>{if(clearTimeout(E.current),(O==null?void 0:O.type)==="touchend"&&b.current){b.current(),b.current=null,E.current=setTimeout(()=>{M(O,N)});return}b.current=null,h(z=>z.length>0?z.slice(1):z),m.current=N},[]);return K.exports.useImperativeHandle(n,()=>({pulsate:P,start:S,stop:M}),[P,S,M]),Ve(qse,ue({className:qt(qr.root,s.root,o),ref:x},a,{children:Ve(Wse,{component:null,exit:!0,children:c})}))}),noe=toe;function roe(t){return M0("MuiButtonBase",t)}const ioe=Iu("MuiButtonBase",["root","disabled","focusVisible"]),soe=ioe,ooe=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],aoe=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:i}=t,o=yv({root:["root",e&&"disabled",n&&"focusVisible"]},roe,i);return n&&r&&(o.root+=` ${r}`),o},loe=Qr("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${soe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),coe=K.exports.forwardRef(function(e,n){const r=W0({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:s=!1,children:o,className:a,component:c="button",disabled:h=!1,disableRipple:p=!1,disableTouchRipple:m=!1,focusRipple:v=!1,LinkComponent:E="a",onBlur:b,onClick:x,onContextMenu:I,onDragLeave:S,onFocus:P,onFocusVisible:M,onKeyDown:O,onKeyUp:N,onMouseDown:z,onMouseLeave:X,onMouseUp:Z,onTouchEnd:Q,onTouchMove:k,onTouchStart:D,tabIndex:ne=0,TouchRippleProps:se,touchRippleRef:oe,type:xe}=r,Pe=zn(r,ooe),Ue=K.exports.useRef(null),le=K.exports.useRef(null),_e=Ko(le,oe),{isFocusVisibleRef:Ce,onFocus:Fe,onBlur:ke,ref:it}=TB(),[Rt,Pn]=K.exports.useState(!1);h&&Rt&&Pn(!1),K.exports.useImperativeHandle(i,()=>({focusVisible:()=>{Pn(!0),Ue.current.focus()}}),[]);const[An,Tt]=K.exports.useState(!1);K.exports.useEffect(()=>{Tt(!0)},[]);const Ut=An&&!p&&!h;K.exports.useEffect(()=>{Rt&&v&&!p&&An&&le.current.pulsate()},[p,v,Rt,An]);function ot(Me,Vt,at=m){return Ho(sr=>(Vt&&Vt(sr),!at&&le.current&&le.current[Me](sr),!0))}const Gt=ot("start",z),zt=ot("stop",I),Mn=ot("stop",S),In=ot("stop",Z),jn=ot("stop",Me=>{Rt&&Me.preventDefault(),X&&X(Me)}),kn=ot("start",D),yn=ot("stop",Q),sn=ot("stop",k),rr=ot("stop",Me=>{ke(Me),Ce.current===!1&&Pn(!1),b&&b(Me)},!1),$r=Ho(Me=>{Ue.current||(Ue.current=Me.currentTarget),Fe(Me),Ce.current===!0&&(Pn(!0),M&&M(Me)),P&&P(Me)}),ir=()=>{const Me=Ue.current;return c&&c!=="button"&&!(Me.tagName==="A"&&Me.href)},_t=K.exports.useRef(!1),Xr=Ho(Me=>{v&&!_t.current&&Rt&&le.current&&Me.key===" "&&(_t.current=!0,le.current.stop(Me,()=>{le.current.start(Me)})),Me.target===Me.currentTarget&&ir()&&Me.key===" "&&Me.preventDefault(),O&&O(Me),Me.target===Me.currentTarget&&ir()&&Me.key==="Enter"&&!h&&(Me.preventDefault(),x&&x(Me))}),fi=Ho(Me=>{v&&Me.key===" "&&le.current&&Rt&&!Me.defaultPrevented&&(_t.current=!1,le.current.stop(Me,()=>{le.current.pulsate(Me)})),N&&N(Me),x&&Me.target===Me.currentTarget&&ir()&&Me.key===" "&&!Me.defaultPrevented&&x(Me)});let pe=c;pe==="button"&&(Pe.href||Pe.to)&&(pe=E);const Oe={};pe==="button"?(Oe.type=xe===void 0?"button":xe,Oe.disabled=h):(!Pe.href&&!Pe.to&&(Oe.role="button"),h&&(Oe["aria-disabled"]=h));const Xe=Ko(it,Ue),et=Ko(n,Xe),We=ue({},r,{centerRipple:s,component:c,disabled:h,disableRipple:p,disableTouchRipple:m,focusRipple:v,tabIndex:ne,focusVisible:Rt}),lt=aoe(We);return ii(loe,ue({as:pe,className:qt(lt.root,a),ownerState:We,onBlur:rr,onClick:x,onContextMenu:zt,onFocus:$r,onKeyDown:Xr,onKeyUp:fi,onMouseDown:Gt,onMouseLeave:jn,onMouseUp:In,onDragLeave:Mn,onTouchEnd:yn,onTouchMove:sn,onTouchStart:kn,ref:et,tabIndex:h?-1:ne,type:xe},Oe,Pe,{children:[o,Ut?Ve(noe,ue({ref:_e,center:s},se)):null]}))}),Aoe=coe;function uoe(t){return M0("MuiButton",t)}const foe=Iu("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),sh=foe,hoe=K.exports.createContext({}),doe=hoe,poe=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],goe=t=>{const{color:e,disableElevation:n,fullWidth:r,size:i,variant:s,classes:o}=t,a={root:["root",s,`${s}${kt(e)}`,`size${kt(i)}`,`${s}Size${kt(i)}`,e==="inherit"&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${kt(i)}`],endIcon:["endIcon",`iconSize${kt(i)}`]},c=yv(a,uoe,o);return ue({},o,c)},cL=t=>ue({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),moe=Qr(Aoe,{shouldForwardProp:t=>aL(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${kt(n.color)}`],e[`size${kt(n.size)}`],e[`${n.variant}Size${kt(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,r;return ue({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":ue({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:ml(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ml(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:ml(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:(t.vars||t).palette.grey.A100,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":ue({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${sh.focusVisible}`]:ue({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${sh.disabled}`]:ue({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="outlined"&&e.color==="secondary"&&{border:`1px solid ${(t.vars||t).palette.action.disabled}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${ml(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(r=t.palette).getContrastText)==null?void 0:n.call(r,t.palette.grey[300]),backgroundColor:(t.vars||t).palette.grey[300],boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${sh.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${sh.disabled}`]:{boxShadow:"none"}}),yoe=Qr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${kt(n.size)}`]]}})(({ownerState:t})=>ue({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},cL(t))),_oe=Qr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${kt(n.size)}`]]}})(({ownerState:t})=>ue({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},cL(t))),voe=K.exports.forwardRef(function(e,n){const r=K.exports.useContext(doe),i=bB(r,e),s=W0({props:i,name:"MuiButton"}),{children:o,color:a="primary",component:c="button",className:h,disabled:p=!1,disableElevation:m=!1,disableFocusRipple:v=!1,endIcon:E,focusVisibleClassName:b,fullWidth:x=!1,size:I="medium",startIcon:S,type:P,variant:M="text"}=s,O=zn(s,poe),N=ue({},s,{color:a,component:c,disabled:p,disableElevation:m,disableFocusRipple:v,fullWidth:x,size:I,type:P,variant:M}),z=goe(N),X=S&&Ve(yoe,{className:z.startIcon,ownerState:N,children:S}),Z=E&&Ve(_oe,{className:z.endIcon,ownerState:N,children:E});return ii(moe,ue({ownerState:N,className:qt(r.className,z.root,h),component:c,disabled:p,focusRipple:!v,focusVisibleClassName:qt(z.focusVisible,b),ref:n,type:P},O,{classes:z,children:[X,o,Z]}))}),Eoe=voe;const woe=()=>{const t=K.exports.useContext(mv),[e,n]=K.exports.useState(1.5);return Ve("div",{className:"start-dialog",children:ii("div",{className:"start-dialog-box",children:[Ve("div",{className:"project-title",children:"\u795E\u6E38"}),Ve("div",{className:"description1",children:"Start a imagined wandering on ...train..."}),Ve("div",{className:"description2",children:"How long would you like the journey to last?"}),ii("div",{className:"time-length",children:[e,Ve("span",{style:{color:"#aaa",fontSize:"1rem"},children:" Hours"})]}),Ve(kse,{min:.5,max:6,step:.1,value:e,onChange:(s,o)=>{n(o)}}),Ve(Eoe,{variant:"outlined",size:"large",style:{marginTop:"3rem"},onClick:()=>{t({type:"setTimeLength",payload:e*3600*1e3})},children:"Select A City"})]})})};const Toe=({time:t=0,startingTime:e=0,timeLength:n=0,selectedStation:r={},filteredRouteList:i=[],selectedRoute:s=[]})=>{var E;const o=i.length!==0,a=s.length!==0,{city:c}=r,h=(E=s[0])==null?void 0:E.trainCode,p=!o&&!a,m=o&&!a,v=a;return ii("div",{className:"info-pane",children:[p&&Ve("div",{style:{padding:"1rem"},children:"pick a city"}),m&&ii("div",{className:"text-info",children:[Ve("div",{className:"text-secondary",children:"Departure City:"}),Ve("div",{className:"text-primary",children:c})]}),v&&ii("div",{className:"text-info",children:[Ve("div",{className:"text-secondary",children:"Train:"}),Ve("div",{className:"text-primary",children:h})]}),ii("div",{style:{height:"100%"},children:[m&&Ve("iframe",{style:{height:"100%",border:0},src:Yee(c)}),v&&Ve("div",{style:{height:"100%",border:0},children:"Route"})]})]})};function boe(){const[t,e]=K.exports.useReducer(Zee,Kee),n=K.exports.useRef(!1),r=K.exports.useRef(0);K.exports.useEffect(()=>{(async()=>{if(n.current)return;n.current=!0;const v=fetch("routes.json").then(I=>I.json()),E=fetch("stations.json").then(I=>I.json()),[b,x]=await Promise.all([v,E]);e({type:"loadData",payload:{routeList:b,stationMap:x}}),n.current=!1})()},[]);const i=()=>{t.playing&&e({type:"setTime",payload:Number(gv())}),r.current=window.requestAnimationFrame(i)};K.exports.useEffect(()=>(r.current=window.requestAnimationFrame(i),()=>{window.cancelAnimationFrame(r.current),r.current=0}),[t.playing]);const{time:s,startingTime:o,timeLength:a,stationList:c,selectedStation:h,filteredRouteList:p,selectedRoute:m}=t;return Ve(mv.Provider,{value:e,children:t.timeLength===0?Ve(woe,{}):ii(oD,{children:[Ve(Toe,{time:s,startingTime:o,timeLength:a,selectedStation:h,filteredRouteList:p,selectedRoute:m}),Ve("div",{className:"map-container",children:Ve(qee,{time:s,stationList:c,filteredRouteList:p,selectedRoute:m})})]})})}sm.createRoot(document.getElementById("root")).render(Ve(Nd.StrictMode,{children:Ve(boe,{})}));export{LR as c};
