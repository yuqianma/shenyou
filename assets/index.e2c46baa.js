function mC(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var $R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function XR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var K={exports:{}},ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mu=Symbol.for("react.element"),YR=Symbol.for("react.portal"),JR=Symbol.for("react.fragment"),KR=Symbol.for("react.strict_mode"),ZR=Symbol.for("react.profiler"),qR=Symbol.for("react.provider"),eO=Symbol.for("react.context"),tO=Symbol.for("react.forward_ref"),nO=Symbol.for("react.suspense"),rO=Symbol.for("react.memo"),iO=Symbol.for("react.lazy"),C2=Symbol.iterator;function sO(t){return t===null||typeof t!="object"?null:(t=C2&&t[C2]||t["@@iterator"],typeof t=="function"?t:null)}var yC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vC=Object.assign,_C={};function ql(t,e,n){this.props=t,this.context=e,this.refs=_C,this.updater=n||yC}ql.prototype.isReactComponent={};ql.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ql.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function EC(){}EC.prototype=ql.prototype;function fy(t,e,n){this.props=t,this.context=e,this.refs=_C,this.updater=n||yC}var hy=fy.prototype=new EC;hy.constructor=fy;vC(hy,ql.prototype);hy.isPureReactComponent=!0;var S2=Array.isArray,wC=Object.prototype.hasOwnProperty,dy={current:null},TC={key:!0,ref:!0,__self:!0,__source:!0};function bC(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)wC.call(e,r)&&!TC.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),h=0;h<a;h++)l[h]=arguments[h+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:mu,type:t,key:s,ref:o,props:i,_owner:dy.current}}function oO(t,e){return{$$typeof:mu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function py(t){return typeof t=="object"&&t!==null&&t.$$typeof===mu}function aO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var P2=/\/+/g;function Ep(t,e){return typeof t=="object"&&t!==null&&t.key!=null?aO(""+t.key):e.toString(36)}function ph(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case mu:case YR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ep(o,0):r,S2(i)?(n="",t!=null&&(n=t.replace(P2,"$&/")+"/"),ph(i,e,n,"",function(h){return h})):i!=null&&(py(i)&&(i=oO(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(P2,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",S2(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Ep(s,a);o+=ph(s,e,n,l,i)}else if(l=sO(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Ep(s,a++),o+=ph(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function lf(t,e,n){if(t==null)return t;var r=[],i=0;return ph(t,r,"","",function(s){return e.call(n,s,i++)}),r}function lO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ur={current:null},gh={transition:null},cO={ReactCurrentDispatcher:ur,ReactCurrentBatchConfig:gh,ReactCurrentOwner:dy};ct.Children={map:lf,forEach:function(t,e,n){lf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return lf(t,function(){e++}),e},toArray:function(t){return lf(t,function(e){return e})||[]},only:function(t){if(!py(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ct.Component=ql;ct.Fragment=JR;ct.Profiler=ZR;ct.PureComponent=fy;ct.StrictMode=KR;ct.Suspense=nO;ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cO;ct.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=vC({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=dy.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)wC.call(e,l)&&!TC.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var h=0;h<l;h++)a[h]=arguments[h+2];r.children=a}return{$$typeof:mu,type:t.type,key:i,ref:s,props:r,_owner:o}};ct.createContext=function(t){return t={$$typeof:eO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:qR,_context:t},t.Consumer=t};ct.createElement=bC;ct.createFactory=function(t){var e=bC.bind(null,t);return e.type=t,e};ct.createRef=function(){return{current:null}};ct.forwardRef=function(t){return{$$typeof:tO,render:t}};ct.isValidElement=py;ct.lazy=function(t){return{$$typeof:iO,_payload:{_status:-1,_result:t},_init:lO}};ct.memo=function(t,e){return{$$typeof:rO,type:t,compare:e===void 0?null:e}};ct.startTransition=function(t){var e=gh.transition;gh.transition={};try{t()}finally{gh.transition=e}};ct.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ct.useCallback=function(t,e){return ur.current.useCallback(t,e)};ct.useContext=function(t){return ur.current.useContext(t)};ct.useDebugValue=function(){};ct.useDeferredValue=function(t){return ur.current.useDeferredValue(t)};ct.useEffect=function(t,e){return ur.current.useEffect(t,e)};ct.useId=function(){return ur.current.useId()};ct.useImperativeHandle=function(t,e,n){return ur.current.useImperativeHandle(t,e,n)};ct.useInsertionEffect=function(t,e){return ur.current.useInsertionEffect(t,e)};ct.useLayoutEffect=function(t,e){return ur.current.useLayoutEffect(t,e)};ct.useMemo=function(t,e){return ur.current.useMemo(t,e)};ct.useReducer=function(t,e,n){return ur.current.useReducer(t,e,n)};ct.useRef=function(t){return ur.current.useRef(t)};ct.useState=function(t){return ur.current.useState(t)};ct.useSyncExternalStore=function(t,e,n){return ur.current.useSyncExternalStore(t,e,n)};ct.useTransition=function(){return ur.current.useTransition()};ct.version="18.2.0";(function(t){t.exports=ct})(K);const Xd=XR(K.exports),M2=mC({__proto__:null,default:Xd},[K.exports]);var dm={},Yd={exports:{}},Hr={},xC={exports:{}},CC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(le,ve){var Ce=le.length;le.push(ve);e:for(;0<Ce;){var Fe=Ce-1>>>1,ke=le[Fe];if(0<i(ke,ve))le[Fe]=ve,le[Ce]=ke,Ce=Fe;else break e}}function n(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var ve=le[0],Ce=le.pop();if(Ce!==ve){le[0]=Ce;e:for(var Fe=0,ke=le.length,it=ke>>>1;Fe<it;){var Rt=2*(Fe+1)-1,Pn=le[Rt],un=Rt+1,Tt=le[un];if(0>i(Pn,Ce))un<ke&&0>i(Tt,Pn)?(le[Fe]=Tt,le[un]=Ce,Fe=un):(le[Fe]=Pn,le[Rt]=Ce,Fe=Rt);else if(un<ke&&0>i(Tt,Ce))le[Fe]=Tt,le[un]=Ce,Fe=un;else break e}}return ve}function i(le,ve){var Ce=le.sortIndex-ve.sortIndex;return Ce!==0?Ce:le.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],h=[],p=1,m=null,_=3,E=!1,b=!1,x=!1,I=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(le){for(var ve=n(h);ve!==null;){if(ve.callback===null)r(h);else if(ve.startTime<=le)r(h),ve.sortIndex=ve.expirationTime,e(l,ve);else break;ve=n(h)}}function O(le){if(x=!1,M(le),!b)if(n(l)!==null)b=!0,Pe(N);else{var ve=n(h);ve!==null&&Ue(O,ve.startTime-le)}}function N(le,ve){b=!1,x&&(x=!1,S(Z),Z=-1),E=!0;var Ce=_;try{for(M(ve),m=n(l);m!==null&&(!(m.expirationTime>ve)||le&&!D());){var Fe=m.callback;if(typeof Fe=="function"){m.callback=null,_=m.priorityLevel;var ke=Fe(m.expirationTime<=ve);ve=t.unstable_now(),typeof ke=="function"?m.callback=ke:m===n(l)&&r(l),M(ve)}else r(l);m=n(l)}if(m!==null)var it=!0;else{var Rt=n(h);Rt!==null&&Ue(O,Rt.startTime-ve),it=!1}return it}finally{m=null,_=Ce,E=!1}}var z=!1,X=null,Z=-1,Q=5,k=-1;function D(){return!(t.unstable_now()-k<Q)}function ne(){if(X!==null){var le=t.unstable_now();k=le;var ve=!0;try{ve=X(!0,le)}finally{ve?se():(z=!1,X=null)}}else z=!1}var se;if(typeof P=="function")se=function(){P(ne)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,xe=oe.port2;oe.port1.onmessage=ne,se=function(){xe.postMessage(null)}}else se=function(){I(ne,0)};function Pe(le){X=le,z||(z=!0,se())}function Ue(le,ve){Z=I(function(){le(t.unstable_now())},ve)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(le){le.callback=null},t.unstable_continueExecution=function(){b||E||(b=!0,Pe(N))},t.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<le?Math.floor(1e3/le):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(le){switch(_){case 1:case 2:case 3:var ve=3;break;default:ve=_}var Ce=_;_=ve;try{return le()}finally{_=Ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(le,ve){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var Ce=_;_=le;try{return ve()}finally{_=Ce}},t.unstable_scheduleCallback=function(le,ve,Ce){var Fe=t.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Fe+Ce:Fe):Ce=Fe,le){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=Ce+ke,le={id:p++,callback:ve,priorityLevel:le,startTime:Ce,expirationTime:ke,sortIndex:-1},Ce>Fe?(le.sortIndex=Ce,e(h,le),n(l)===null&&le===n(h)&&(x?(S(Z),Z=-1):x=!0,Ue(O,Ce-Fe))):(le.sortIndex=ke,e(l,le),b||E||(b=!0,Pe(N))),le},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(le){var ve=_;return function(){var Ce=_;_=ve;try{return le.apply(this,arguments)}finally{_=Ce}}}})(CC);(function(t){t.exports=CC})(xC);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SC=K.exports,zr=xC.exports;function fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PC=new Set,BA={};function da(t,e){Fl(t,e),Fl(t+"Capture",e)}function Fl(t,e){for(BA[t]=e,t=0;t<e.length;t++)PC.add(e[t])}var ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pm=Object.prototype.hasOwnProperty,AO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,I2={},B2={};function uO(t){return pm.call(B2,t)?!0:pm.call(I2,t)?!1:AO.test(t)?B2[t]=!0:(I2[t]=!0,!1)}function fO(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function hO(t,e,n,r){if(e===null||typeof e>"u"||fO(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fr(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Vn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vn[t]=new fr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vn[e]=new fr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vn[t]=new fr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vn[t]=new fr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vn[t]=new fr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vn[t]=new fr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vn[t]=new fr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vn[t]=new fr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vn[t]=new fr(t,5,!1,t.toLowerCase(),null,!1,!1)});var gy=/[\-:]([a-z])/g;function my(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gy,my);Vn[e]=new fr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gy,my);Vn[e]=new fr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gy,my);Vn[e]=new fr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vn[t]=new fr(t,1,!1,t.toLowerCase(),null,!1,!1)});Vn.xlinkHref=new fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vn[t]=new fr(t,1,!1,t.toLowerCase(),null,!0,!0)});function yy(t,e,n,r){var i=Vn.hasOwnProperty(e)?Vn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(hO(e,n,i,r)&&(n=null),r||i===null?uO(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var bs=SC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cf=Symbol.for("react.element"),Ya=Symbol.for("react.portal"),Ja=Symbol.for("react.fragment"),vy=Symbol.for("react.strict_mode"),gm=Symbol.for("react.profiler"),MC=Symbol.for("react.provider"),IC=Symbol.for("react.context"),_y=Symbol.for("react.forward_ref"),mm=Symbol.for("react.suspense"),ym=Symbol.for("react.suspense_list"),Ey=Symbol.for("react.memo"),Hs=Symbol.for("react.lazy"),BC=Symbol.for("react.offscreen"),L2=Symbol.iterator;function bc(t){return t===null||typeof t!="object"?null:(t=L2&&t[L2]||t["@@iterator"],typeof t=="function"?t:null)}var sn=Object.assign,wp;function Zc(t){if(wp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);wp=e&&e[1]||""}return`
`+wp+t}var Tp=!1;function bp(t,e){if(!t||Tp)return"";Tp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(t,[],e)}else{try{e.call()}catch(h){r=h}t.call(e.prototype)}else{try{throw Error()}catch(h){r=h}t()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Tp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Zc(t):""}function dO(t){switch(t.tag){case 5:return Zc(t.type);case 16:return Zc("Lazy");case 13:return Zc("Suspense");case 19:return Zc("SuspenseList");case 0:case 2:case 15:return t=bp(t.type,!1),t;case 11:return t=bp(t.type.render,!1),t;case 1:return t=bp(t.type,!0),t;default:return""}}function vm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ja:return"Fragment";case Ya:return"Portal";case gm:return"Profiler";case vy:return"StrictMode";case mm:return"Suspense";case ym:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case IC:return(t.displayName||"Context")+".Consumer";case MC:return(t._context.displayName||"Context")+".Provider";case _y:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ey:return e=t.displayName||null,e!==null?e:vm(t.type)||"Memo";case Hs:e=t._payload,t=t._init;try{return vm(t(e))}catch{}}return null}function pO(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vm(e);case 8:return e===vy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ao(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function LC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function gO(t){var e=LC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Af(t){t._valueTracker||(t._valueTracker=gO(t))}function RC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=LC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Jh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _m(t,e){var n=e.checked;return sn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:t._wrapperState.initialChecked})}function R2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ao(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function OC(t,e){e=e.checked,e!=null&&yy(t,"checked",e,!1)}function Em(t,e){OC(t,e);var n=Ao(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?wm(t,e.type,n):e.hasOwnProperty("defaultValue")&&wm(t,e.type,Ao(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function O2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function wm(t,e,n){(e!=="number"||Jh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var qc=Array.isArray;function wl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ao(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Tm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fe(91));return sn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function F2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(fe(92));if(qc(n)){if(1<n.length)throw Error(fe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ao(n)}}function FC(t,e){var n=Ao(e.value),r=Ao(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function D2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function DC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?DC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var uf,kC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(uf=uf||document.createElement("div"),uf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=uf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function LA(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var AA={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mO=["Webkit","ms","Moz","O"];Object.keys(AA).forEach(function(t){mO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),AA[e]=AA[t]})});function NC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||AA.hasOwnProperty(t)&&AA[t]?(""+e).trim():e+"px"}function UC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=NC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var yO=sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xm(t,e){if(e){if(yO[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fe(62))}}function Cm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sm=null;function wy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Pm=null,Tl=null,bl=null;function k2(t){if(t=_u(t)){if(typeof Pm!="function")throw Error(fe(280));var e=t.stateNode;e&&(e=e0(e),Pm(t.stateNode,t.type,e))}}function GC(t){Tl?bl?bl.push(t):bl=[t]:Tl=t}function zC(){if(Tl){var t=Tl,e=bl;if(bl=Tl=null,k2(t),e)for(t=0;t<e.length;t++)k2(e[t])}}function VC(t,e){return t(e)}function HC(){}var xp=!1;function jC(t,e,n){if(xp)return t(e,n);xp=!0;try{return VC(t,e,n)}finally{xp=!1,(Tl!==null||bl!==null)&&(HC(),zC())}}function RA(t,e){var n=t.stateNode;if(n===null)return null;var r=e0(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(fe(231,e,typeof n));return n}var Mm=!1;if(ps)try{var xc={};Object.defineProperty(xc,"passive",{get:function(){Mm=!0}}),window.addEventListener("test",xc,xc),window.removeEventListener("test",xc,xc)}catch{Mm=!1}function vO(t,e,n,r,i,s,o,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(n,h)}catch(p){this.onError(p)}}var uA=!1,Kh=null,Zh=!1,Im=null,_O={onError:function(t){uA=!0,Kh=t}};function EO(t,e,n,r,i,s,o,a,l){uA=!1,Kh=null,vO.apply(_O,arguments)}function wO(t,e,n,r,i,s,o,a,l){if(EO.apply(this,arguments),uA){if(uA){var h=Kh;uA=!1,Kh=null}else throw Error(fe(198));Zh||(Zh=!0,Im=h)}}function pa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&4098)!==0&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function WC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function N2(t){if(pa(t)!==t)throw Error(fe(188))}function TO(t){var e=t.alternate;if(!e){if(e=pa(t),e===null)throw Error(fe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return N2(i),t;if(s===r)return N2(i),e;s=s.sibling}throw Error(fe(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(fe(189))}}if(n.alternate!==r)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?t:e}function QC(t){return t=TO(t),t!==null?$C(t):null}function $C(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$C(t);if(e!==null)return e;t=t.sibling}return null}var XC=zr.unstable_scheduleCallback,U2=zr.unstable_cancelCallback,bO=zr.unstable_shouldYield,xO=zr.unstable_requestPaint,An=zr.unstable_now,CO=zr.unstable_getCurrentPriorityLevel,Ty=zr.unstable_ImmediatePriority,YC=zr.unstable_UserBlockingPriority,qh=zr.unstable_NormalPriority,SO=zr.unstable_LowPriority,JC=zr.unstable_IdlePriority,Jd=null,Zi=null;function PO(t){if(Zi&&typeof Zi.onCommitFiberRoot=="function")try{Zi.onCommitFiberRoot(Jd,t,void 0,(t.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:BO,MO=Math.log,IO=Math.LN2;function BO(t){return t>>>=0,t===0?32:31-(MO(t)/IO|0)|0}var ff=64,hf=4194304;function eA(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ed(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=eA(a):(s&=o,s!==0&&(r=eA(s)))}else o=n&~i,o!==0?r=eA(o):s!==0&&(r=eA(s));if(r===0)return 0;if(e!==0&&e!==r&&(e&i)===0&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if((r&4)!==0&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Pi(e),i=1<<n,r|=t[n],e&=~i;return r}function LO(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RO(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Pi(s),a=1<<o,l=i[o];l===-1?((a&n)===0||(a&r)!==0)&&(i[o]=LO(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Bm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KC(){var t=ff;return ff<<=1,(ff&4194240)===0&&(ff=64),t}function Cp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function yu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pi(e),t[e]=n}function OO(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Pi(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function by(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Pi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Pt=0;function ZC(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var qC,xy,eS,tS,nS,Lm=!1,df=[],to=null,no=null,ro=null,OA=new Map,FA=new Map,$s=[],FO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G2(t,e){switch(t){case"focusin":case"focusout":to=null;break;case"dragenter":case"dragleave":no=null;break;case"mouseover":case"mouseout":ro=null;break;case"pointerover":case"pointerout":OA.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":FA.delete(e.pointerId)}}function Cc(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=_u(e),e!==null&&xy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function DO(t,e,n,r,i){switch(e){case"focusin":return to=Cc(to,t,e,n,r,i),!0;case"dragenter":return no=Cc(no,t,e,n,r,i),!0;case"mouseover":return ro=Cc(ro,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return OA.set(s,Cc(OA.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,FA.set(s,Cc(FA.get(s)||null,t,e,n,r,i)),!0}return!1}function rS(t){var e=zo(t.target);if(e!==null){var n=pa(e);if(n!==null){if(e=n.tag,e===13){if(e=WC(n),e!==null){t.blockedOn=e,nS(t.priority,function(){eS(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Rm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Sm=r,n.target.dispatchEvent(r),Sm=null}else return e=_u(n),e!==null&&xy(e),t.blockedOn=n,!1;e.shift()}return!0}function z2(t,e,n){mh(t)&&n.delete(e)}function kO(){Lm=!1,to!==null&&mh(to)&&(to=null),no!==null&&mh(no)&&(no=null),ro!==null&&mh(ro)&&(ro=null),OA.forEach(z2),FA.forEach(z2)}function Sc(t,e){t.blockedOn===e&&(t.blockedOn=null,Lm||(Lm=!0,zr.unstable_scheduleCallback(zr.unstable_NormalPriority,kO)))}function DA(t){function e(i){return Sc(i,t)}if(0<df.length){Sc(df[0],t);for(var n=1;n<df.length;n++){var r=df[n];r.blockedOn===t&&(r.blockedOn=null)}}for(to!==null&&Sc(to,t),no!==null&&Sc(no,t),ro!==null&&Sc(ro,t),OA.forEach(e),FA.forEach(e),n=0;n<$s.length;n++)r=$s[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<$s.length&&(n=$s[0],n.blockedOn===null);)rS(n),n.blockedOn===null&&$s.shift()}var xl=bs.ReactCurrentBatchConfig,td=!0;function NO(t,e,n,r){var i=Pt,s=xl.transition;xl.transition=null;try{Pt=1,Cy(t,e,n,r)}finally{Pt=i,xl.transition=s}}function UO(t,e,n,r){var i=Pt,s=xl.transition;xl.transition=null;try{Pt=4,Cy(t,e,n,r)}finally{Pt=i,xl.transition=s}}function Cy(t,e,n,r){if(td){var i=Rm(t,e,n,r);if(i===null)Dp(t,e,r,nd,n),G2(t,r);else if(DO(i,t,e,n,r))r.stopPropagation();else if(G2(t,r),e&4&&-1<FO.indexOf(t)){for(;i!==null;){var s=_u(i);if(s!==null&&qC(s),s=Rm(t,e,n,r),s===null&&Dp(t,e,r,nd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Dp(t,e,r,null,n)}}var nd=null;function Rm(t,e,n,r){if(nd=null,t=wy(r),t=zo(t),t!==null)if(e=pa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=WC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return nd=t,null}function iS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CO()){case Ty:return 1;case YC:return 4;case qh:case SO:return 16;case JC:return 536870912;default:return 16}default:return 16}}var Js=null,Sy=null,yh=null;function sS(){if(yh)return yh;var t,e=Sy,n=e.length,r,i="value"in Js?Js.value:Js.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return yh=i.slice(t,1<r?1-r:void 0)}function vh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function pf(){return!0}function V2(){return!1}function jr(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?pf:V2,this.isPropagationStopped=V2,this}return sn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=pf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=pf)},persist:function(){},isPersistent:pf}),e}var ec={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Py=jr(ec),vu=sn({},ec,{view:0,detail:0}),GO=jr(vu),Sp,Pp,Pc,Kd=sn({},vu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:My,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pc&&(Pc&&t.type==="mousemove"?(Sp=t.screenX-Pc.screenX,Pp=t.screenY-Pc.screenY):Pp=Sp=0,Pc=t),Sp)},movementY:function(t){return"movementY"in t?t.movementY:Pp}}),H2=jr(Kd),zO=sn({},Kd,{dataTransfer:0}),VO=jr(zO),HO=sn({},vu,{relatedTarget:0}),Mp=jr(HO),jO=sn({},ec,{animationName:0,elapsedTime:0,pseudoElement:0}),WO=jr(jO),QO=sn({},ec,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),$O=jr(QO),XO=sn({},ec,{data:0}),j2=jr(XO),YO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZO(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KO[t])?!!e[t]:!1}function My(){return ZO}var qO=sn({},vu,{key:function(t){if(t.key){var e=YO[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=vh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?JO[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:My,charCode:function(t){return t.type==="keypress"?vh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),eF=jr(qO),tF=sn({},Kd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),W2=jr(tF),nF=sn({},vu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:My}),rF=jr(nF),iF=sn({},ec,{propertyName:0,elapsedTime:0,pseudoElement:0}),sF=jr(iF),oF=sn({},Kd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),aF=jr(oF),lF=[9,13,27,32],Iy=ps&&"CompositionEvent"in window,fA=null;ps&&"documentMode"in document&&(fA=document.documentMode);var cF=ps&&"TextEvent"in window&&!fA,oS=ps&&(!Iy||fA&&8<fA&&11>=fA),Q2=String.fromCharCode(32),$2=!1;function aS(t,e){switch(t){case"keyup":return lF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ka=!1;function AF(t,e){switch(t){case"compositionend":return lS(e);case"keypress":return e.which!==32?null:($2=!0,Q2);case"textInput":return t=e.data,t===Q2&&$2?null:t;default:return null}}function uF(t,e){if(Ka)return t==="compositionend"||!Iy&&aS(t,e)?(t=sS(),yh=Sy=Js=null,Ka=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return oS&&e.locale!=="ko"?null:e.data;default:return null}}var fF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!fF[t.type]:e==="textarea"}function cS(t,e,n,r){GC(r),e=rd(e,"onChange"),0<e.length&&(n=new Py("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var hA=null,kA=null;function hF(t){_S(t,0)}function Zd(t){var e=el(t);if(RC(e))return t}function dF(t,e){if(t==="change")return e}var AS=!1;if(ps){var Ip;if(ps){var Bp="oninput"in document;if(!Bp){var Y2=document.createElement("div");Y2.setAttribute("oninput","return;"),Bp=typeof Y2.oninput=="function"}Ip=Bp}else Ip=!1;AS=Ip&&(!document.documentMode||9<document.documentMode)}function J2(){hA&&(hA.detachEvent("onpropertychange",uS),kA=hA=null)}function uS(t){if(t.propertyName==="value"&&Zd(kA)){var e=[];cS(e,kA,t,wy(t)),jC(hF,e)}}function pF(t,e,n){t==="focusin"?(J2(),hA=e,kA=n,hA.attachEvent("onpropertychange",uS)):t==="focusout"&&J2()}function gF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Zd(kA)}function mF(t,e){if(t==="click")return Zd(e)}function yF(t,e){if(t==="input"||t==="change")return Zd(e)}function vF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Li=typeof Object.is=="function"?Object.is:vF;function NA(t,e){if(Li(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!pm.call(e,i)||!Li(t[i],e[i]))return!1}return!0}function K2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Z2(t,e){var n=K2(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=K2(n)}}function fS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?fS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function hS(){for(var t=window,e=Jh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Jh(t.document)}return e}function By(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function _F(t){var e=hS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&fS(n.ownerDocument.documentElement,n)){if(r!==null&&By(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Z2(n,s);var o=Z2(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EF=ps&&"documentMode"in document&&11>=document.documentMode,Za=null,Om=null,dA=null,Fm=!1;function q2(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Fm||Za==null||Za!==Jh(r)||(r=Za,"selectionStart"in r&&By(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),dA&&NA(dA,r)||(dA=r,r=rd(Om,"onSelect"),0<r.length&&(e=new Py("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Za)))}function gf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var qa={animationend:gf("Animation","AnimationEnd"),animationiteration:gf("Animation","AnimationIteration"),animationstart:gf("Animation","AnimationStart"),transitionend:gf("Transition","TransitionEnd")},Lp={},dS={};ps&&(dS=document.createElement("div").style,"AnimationEvent"in window||(delete qa.animationend.animation,delete qa.animationiteration.animation,delete qa.animationstart.animation),"TransitionEvent"in window||delete qa.transitionend.transition);function qd(t){if(Lp[t])return Lp[t];if(!qa[t])return t;var e=qa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in dS)return Lp[t]=e[n];return t}var pS=qd("animationend"),gS=qd("animationiteration"),mS=qd("animationstart"),yS=qd("transitionend"),vS=new Map,eE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mo(t,e){vS.set(t,e),da(e,[t])}for(var Rp=0;Rp<eE.length;Rp++){var Op=eE[Rp],wF=Op.toLowerCase(),TF=Op[0].toUpperCase()+Op.slice(1);mo(wF,"on"+TF)}mo(pS,"onAnimationEnd");mo(gS,"onAnimationIteration");mo(mS,"onAnimationStart");mo("dblclick","onDoubleClick");mo("focusin","onFocus");mo("focusout","onBlur");mo(yS,"onTransitionEnd");Fl("onMouseEnter",["mouseout","mouseover"]);Fl("onMouseLeave",["mouseout","mouseover"]);Fl("onPointerEnter",["pointerout","pointerover"]);Fl("onPointerLeave",["pointerout","pointerover"]);da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));da("onBeforeInput",["compositionend","keypress","textInput","paste"]);da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tA="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bF=new Set("cancel close invalid load scroll toggle".split(" ").concat(tA));function tE(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,wO(r,e,void 0,t),t.currentTarget=null}function _S(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;tE(i,a,h),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,h=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;tE(i,a,h),s=l}}}if(Zh)throw t=Im,Zh=!1,Im=null,t}function Qt(t,e){var n=e[Gm];n===void 0&&(n=e[Gm]=new Set);var r=t+"__bubble";n.has(r)||(ES(e,t,2,!1),n.add(r))}function Fp(t,e,n){var r=0;e&&(r|=4),ES(n,t,r,e)}var mf="_reactListening"+Math.random().toString(36).slice(2);function UA(t){if(!t[mf]){t[mf]=!0,PC.forEach(function(n){n!=="selectionchange"&&(bF.has(n)||Fp(n,!1,t),Fp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[mf]||(e[mf]=!0,Fp("selectionchange",!1,e))}}function ES(t,e,n,r){switch(iS(e)){case 1:var i=NO;break;case 4:i=UO;break;default:i=Cy}n=i.bind(null,e,n,t),i=void 0,!Mm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Dp(t,e,n,r,i){var s=r;if((e&1)===0&&(e&2)===0&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=zo(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}jC(function(){var h=s,p=wy(n),m=[];e:{var _=vS.get(t);if(_!==void 0){var E=Py,b=t;switch(t){case"keypress":if(vh(n)===0)break e;case"keydown":case"keyup":E=eF;break;case"focusin":b="focus",E=Mp;break;case"focusout":b="blur",E=Mp;break;case"beforeblur":case"afterblur":E=Mp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=H2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=VO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=rF;break;case pS:case gS:case mS:E=WO;break;case yS:E=sF;break;case"scroll":E=GO;break;case"wheel":E=aF;break;case"copy":case"cut":case"paste":E=$O;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=W2}var x=(e&4)!==0,I=!x&&t==="scroll",S=x?_!==null?_+"Capture":null:_;x=[];for(var P=h,M;P!==null;){M=P;var O=M.stateNode;if(M.tag===5&&O!==null&&(M=O,S!==null&&(O=RA(P,S),O!=null&&x.push(GA(P,O,M)))),I)break;P=P.return}0<x.length&&(_=new E(_,b,null,n,p),m.push({event:_,listeners:x}))}}if((e&7)===0){e:{if(_=t==="mouseover"||t==="pointerover",E=t==="mouseout"||t==="pointerout",_&&n!==Sm&&(b=n.relatedTarget||n.fromElement)&&(zo(b)||b[gs]))break e;if((E||_)&&(_=p.window===p?p:(_=p.ownerDocument)?_.defaultView||_.parentWindow:window,E?(b=n.relatedTarget||n.toElement,E=h,b=b?zo(b):null,b!==null&&(I=pa(b),b!==I||b.tag!==5&&b.tag!==6)&&(b=null)):(E=null,b=h),E!==b)){if(x=H2,O="onMouseLeave",S="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(x=W2,O="onPointerLeave",S="onPointerEnter",P="pointer"),I=E==null?_:el(E),M=b==null?_:el(b),_=new x(O,P+"leave",E,n,p),_.target=I,_.relatedTarget=M,O=null,zo(p)===h&&(x=new x(S,P+"enter",b,n,p),x.target=M,x.relatedTarget=I,O=x),I=O,E&&b)t:{for(x=E,S=b,P=0,M=x;M;M=Ma(M))P++;for(M=0,O=S;O;O=Ma(O))M++;for(;0<P-M;)x=Ma(x),P--;for(;0<M-P;)S=Ma(S),M--;for(;P--;){if(x===S||S!==null&&x===S.alternate)break t;x=Ma(x),S=Ma(S)}x=null}else x=null;E!==null&&nE(m,_,E,x,!1),b!==null&&I!==null&&nE(m,I,b,x,!0)}}e:{if(_=h?el(h):window,E=_.nodeName&&_.nodeName.toLowerCase(),E==="select"||E==="input"&&_.type==="file")var N=dF;else if(X2(_))if(AS)N=yF;else{N=gF;var z=pF}else(E=_.nodeName)&&E.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(N=mF);if(N&&(N=N(t,h))){cS(m,N,n,p);break e}z&&z(t,_,h),t==="focusout"&&(z=_._wrapperState)&&z.controlled&&_.type==="number"&&wm(_,"number",_.value)}switch(z=h?el(h):window,t){case"focusin":(X2(z)||z.contentEditable==="true")&&(Za=z,Om=h,dA=null);break;case"focusout":dA=Om=Za=null;break;case"mousedown":Fm=!0;break;case"contextmenu":case"mouseup":case"dragend":Fm=!1,q2(m,n,p);break;case"selectionchange":if(EF)break;case"keydown":case"keyup":q2(m,n,p)}var X;if(Iy)e:{switch(t){case"compositionstart":var Z="onCompositionStart";break e;case"compositionend":Z="onCompositionEnd";break e;case"compositionupdate":Z="onCompositionUpdate";break e}Z=void 0}else Ka?aS(t,n)&&(Z="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(Z="onCompositionStart");Z&&(oS&&n.locale!=="ko"&&(Ka||Z!=="onCompositionStart"?Z==="onCompositionEnd"&&Ka&&(X=sS()):(Js=p,Sy="value"in Js?Js.value:Js.textContent,Ka=!0)),z=rd(h,Z),0<z.length&&(Z=new j2(Z,t,null,n,p),m.push({event:Z,listeners:z}),X?Z.data=X:(X=lS(n),X!==null&&(Z.data=X)))),(X=cF?AF(t,n):uF(t,n))&&(h=rd(h,"onBeforeInput"),0<h.length&&(p=new j2("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:h}),p.data=X))}_S(m,e)})}function GA(t,e,n){return{instance:t,listener:e,currentTarget:n}}function rd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=RA(t,n),s!=null&&r.unshift(GA(t,s,i)),s=RA(t,e),s!=null&&r.push(GA(t,s,i))),t=t.return}return r}function Ma(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function nE(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,h=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&h!==null&&(a=h,i?(l=RA(n,s),l!=null&&o.unshift(GA(n,l,a))):i||(l=RA(n,s),l!=null&&o.push(GA(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var xF=/\r\n?/g,CF=/\u0000|\uFFFD/g;function rE(t){return(typeof t=="string"?t:""+t).replace(xF,`
`).replace(CF,"")}function yf(t,e,n){if(e=rE(e),rE(t)!==e&&n)throw Error(fe(425))}function id(){}var Dm=null,km=null;function Nm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Um=typeof setTimeout=="function"?setTimeout:void 0,SF=typeof clearTimeout=="function"?clearTimeout:void 0,iE=typeof Promise=="function"?Promise:void 0,PF=typeof queueMicrotask=="function"?queueMicrotask:typeof iE<"u"?function(t){return iE.resolve(null).then(t).catch(MF)}:Um;function MF(t){setTimeout(function(){throw t})}function kp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),DA(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);DA(e)}function io(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var tc=Math.random().toString(36).slice(2),Xi="__reactFiber$"+tc,zA="__reactProps$"+tc,gs="__reactContainer$"+tc,Gm="__reactEvents$"+tc,IF="__reactListeners$"+tc,BF="__reactHandles$"+tc;function zo(t){var e=t[Xi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[gs]||n[Xi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=sE(t);t!==null;){if(n=t[Xi])return n;t=sE(t)}return e}t=n,n=t.parentNode}return null}function _u(t){return t=t[Xi]||t[gs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function el(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(fe(33))}function e0(t){return t[zA]||null}var zm=[],tl=-1;function yo(t){return{current:t}}function $t(t){0>tl||(t.current=zm[tl],zm[tl]=null,tl--)}function Nt(t,e){tl++,zm[tl]=t.current,t.current=e}var uo={},er=yo(uo),Er=yo(!1),ta=uo;function Dl(t,e){var n=t.type.contextTypes;if(!n)return uo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function wr(t){return t=t.childContextTypes,t!=null}function sd(){$t(Er),$t(er)}function oE(t,e,n){if(er.current!==uo)throw Error(fe(168));Nt(er,e),Nt(Er,n)}function wS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(fe(108,pO(t)||"Unknown",i));return sn({},n,r)}function od(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||uo,ta=er.current,Nt(er,t),Nt(Er,Er.current),!0}function aE(t,e,n){var r=t.stateNode;if(!r)throw Error(fe(169));n?(t=wS(t,e,ta),r.__reactInternalMemoizedMergedChildContext=t,$t(Er),$t(er),Nt(er,t)):$t(Er),Nt(Er,n)}var ls=null,t0=!1,Np=!1;function TS(t){ls===null?ls=[t]:ls.push(t)}function LF(t){t0=!0,TS(t)}function vo(){if(!Np&&ls!==null){Np=!0;var t=0,e=Pt;try{var n=ls;for(Pt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ls=null,t0=!1}catch(i){throw ls!==null&&(ls=ls.slice(t+1)),XC(Ty,vo),i}finally{Pt=e,Np=!1}}return null}var nl=[],rl=0,ad=null,ld=0,ei=[],ti=0,na=null,As=1,us="";function No(t,e){nl[rl++]=ld,nl[rl++]=ad,ad=t,ld=e}function bS(t,e,n){ei[ti++]=As,ei[ti++]=us,ei[ti++]=na,na=t;var r=As;t=us;var i=32-Pi(r)-1;r&=~(1<<i),n+=1;var s=32-Pi(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,As=1<<32-Pi(e)+i|n<<i|r,us=s+t}else As=1<<s|n<<i|r,us=t}function Ly(t){t.return!==null&&(No(t,1),bS(t,1,0))}function Ry(t){for(;t===ad;)ad=nl[--rl],nl[rl]=null,ld=nl[--rl],nl[rl]=null;for(;t===na;)na=ei[--ti],ei[ti]=null,us=ei[--ti],ei[ti]=null,As=ei[--ti],ei[ti]=null}var kr=null,Or=null,Jt=!1,Ti=null;function xS(t,e){var n=ri(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function lE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,kr=t,Or=io(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,kr=t,Or=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=na!==null?{id:As,overflow:us}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ri(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,kr=t,Or=null,!0):!1;default:return!1}}function Vm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Hm(t){if(Jt){var e=Or;if(e){var n=e;if(!lE(t,e)){if(Vm(t))throw Error(fe(418));e=io(n.nextSibling);var r=kr;e&&lE(t,e)?xS(r,n):(t.flags=t.flags&-4097|2,Jt=!1,kr=t)}}else{if(Vm(t))throw Error(fe(418));t.flags=t.flags&-4097|2,Jt=!1,kr=t}}}function cE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kr=t}function vf(t){if(t!==kr)return!1;if(!Jt)return cE(t),Jt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Nm(t.type,t.memoizedProps)),e&&(e=Or)){if(Vm(t))throw CS(),Error(fe(418));for(;e;)xS(t,e),e=io(e.nextSibling)}if(cE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Or=io(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Or=null}}else Or=kr?io(t.stateNode.nextSibling):null;return!0}function CS(){for(var t=Or;t;)t=io(t.nextSibling)}function kl(){Or=kr=null,Jt=!1}function Oy(t){Ti===null?Ti=[t]:Ti.push(t)}var RF=bs.ReactCurrentBatchConfig;function _i(t,e){if(t&&t.defaultProps){e=sn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var cd=yo(null),Ad=null,il=null,Fy=null;function Dy(){Fy=il=Ad=null}function ky(t){var e=cd.current;$t(cd),t._currentValue=e}function jm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Cl(t,e){Ad=t,Fy=il=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&e)!==0&&(_r=!0),t.firstContext=null)}function ai(t){var e=t._currentValue;if(Fy!==t)if(t={context:t,memoizedValue:e,next:null},il===null){if(Ad===null)throw Error(fe(308));il=t,Ad.dependencies={lanes:0,firstContext:t}}else il=il.next=t;return e}var Vo=null;function Ny(t){Vo===null?Vo=[t]:Vo.push(t)}function SS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ny(e)):(n.next=i.next,i.next=n),e.interleaved=n,ms(t,r)}function ms(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var js=!1;function Uy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function PS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function fs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function so(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,(mt&2)!==0){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ms(t,n)}return i=r.interleaved,i===null?(e.next=e,Ny(r)):(e.next=i.next,i.next=e),r.interleaved=e,ms(t,n)}function _h(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,by(t,n)}}function AE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ud(t,e,n,r){var i=t.updateQueue;js=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,h=l.next;l.next=null,o===null?s=h:o.next=h,o=l;var p=t.alternate;p!==null&&(p=p.updateQueue,a=p.lastBaseUpdate,a!==o&&(a===null?p.firstBaseUpdate=h:a.next=h,p.lastBaseUpdate=l))}if(s!==null){var m=i.baseState;o=0,p=h=l=null,a=s;do{var _=a.lane,E=a.eventTime;if((r&_)===_){p!==null&&(p=p.next={eventTime:E,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,x=a;switch(_=e,E=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){m=b.call(E,m,_);break e}m=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,_=typeof b=="function"?b.call(E,m,_):b,_==null)break e;m=sn({},m,_);break e;case 2:js=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,_=i.effects,_===null?i.effects=[a]:_.push(a))}else E={eventTime:E,lane:_,tag:a.tag,payload:a.payload,callback:a.callback,next:null},p===null?(h=p=E,l=m):p=p.next=E,o|=_;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;_=a,a=_.next,_.next=null,i.lastBaseUpdate=_,i.shared.pending=null}}while(1);if(p===null&&(l=m),i.baseState=l,i.firstBaseUpdate=h,i.lastBaseUpdate=p,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ia|=o,t.lanes=o,t.memoizedState=m}}function uE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(fe(191,i));i.call(r)}}}var MS=new SC.Component().refs;function Wm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:sn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var n0={isMounted:function(t){return(t=t._reactInternals)?pa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=cr(),i=ao(t),s=fs(r,i);s.payload=e,n!=null&&(s.callback=n),e=so(t,s,i),e!==null&&(Mi(e,t,i,r),_h(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=cr(),i=ao(t),s=fs(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=so(t,s,i),e!==null&&(Mi(e,t,i,r),_h(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=cr(),r=ao(t),i=fs(n,r);i.tag=2,e!=null&&(i.callback=e),e=so(t,i,r),e!==null&&(Mi(e,t,r,n),_h(e,t,r))}};function fE(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!NA(n,r)||!NA(i,s):!0}function IS(t,e,n){var r=!1,i=uo,s=e.contextType;return typeof s=="object"&&s!==null?s=ai(s):(i=wr(e)?ta:er.current,r=e.contextTypes,s=(r=r!=null)?Dl(t,i):uo),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=n0,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function hE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&n0.enqueueReplaceState(e,e.state,null)}function Qm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=MS,Uy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=ai(s):(s=wr(e)?ta:er.current,i.context=Dl(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Wm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&n0.enqueueReplaceState(i,i.state,null),ud(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Mc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var r=n.stateNode}if(!r)throw Error(fe(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===MS&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,t))}return t}function _f(t,e){throw t=Object.prototype.toString.call(e),Error(fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function dE(t){var e=t._init;return e(t._payload)}function BS(t){function e(S,P){if(t){var M=S.deletions;M===null?(S.deletions=[P],S.flags|=16):M.push(P)}}function n(S,P){if(!t)return null;for(;P!==null;)e(S,P),P=P.sibling;return null}function r(S,P){for(S=new Map;P!==null;)P.key!==null?S.set(P.key,P):S.set(P.index,P),P=P.sibling;return S}function i(S,P){return S=lo(S,P),S.index=0,S.sibling=null,S}function s(S,P,M){return S.index=M,t?(M=S.alternate,M!==null?(M=M.index,M<P?(S.flags|=2,P):M):(S.flags|=2,P)):(S.flags|=1048576,P)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function a(S,P,M,O){return P===null||P.tag!==6?(P=Wp(M,S.mode,O),P.return=S,P):(P=i(P,M),P.return=S,P)}function l(S,P,M,O){var N=M.type;return N===Ja?p(S,P,M.props.children,O,M.key):P!==null&&(P.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Hs&&dE(N)===P.type)?(O=i(P,M.props),O.ref=Mc(S,P,M),O.return=S,O):(O=Ch(M.type,M.key,M.props,null,S.mode,O),O.ref=Mc(S,P,M),O.return=S,O)}function h(S,P,M,O){return P===null||P.tag!==4||P.stateNode.containerInfo!==M.containerInfo||P.stateNode.implementation!==M.implementation?(P=Qp(M,S.mode,O),P.return=S,P):(P=i(P,M.children||[]),P.return=S,P)}function p(S,P,M,O,N){return P===null||P.tag!==7?(P=Yo(M,S.mode,O,N),P.return=S,P):(P=i(P,M),P.return=S,P)}function m(S,P,M){if(typeof P=="string"&&P!==""||typeof P=="number")return P=Wp(""+P,S.mode,M),P.return=S,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case cf:return M=Ch(P.type,P.key,P.props,null,S.mode,M),M.ref=Mc(S,null,P),M.return=S,M;case Ya:return P=Qp(P,S.mode,M),P.return=S,P;case Hs:var O=P._init;return m(S,O(P._payload),M)}if(qc(P)||bc(P))return P=Yo(P,S.mode,M,null),P.return=S,P;_f(S,P)}return null}function _(S,P,M,O){var N=P!==null?P.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return N!==null?null:a(S,P,""+M,O);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case cf:return M.key===N?l(S,P,M,O):null;case Ya:return M.key===N?h(S,P,M,O):null;case Hs:return N=M._init,_(S,P,N(M._payload),O)}if(qc(M)||bc(M))return N!==null?null:p(S,P,M,O,null);_f(S,M)}return null}function E(S,P,M,O,N){if(typeof O=="string"&&O!==""||typeof O=="number")return S=S.get(M)||null,a(P,S,""+O,N);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case cf:return S=S.get(O.key===null?M:O.key)||null,l(P,S,O,N);case Ya:return S=S.get(O.key===null?M:O.key)||null,h(P,S,O,N);case Hs:var z=O._init;return E(S,P,M,z(O._payload),N)}if(qc(O)||bc(O))return S=S.get(M)||null,p(P,S,O,N,null);_f(P,O)}return null}function b(S,P,M,O){for(var N=null,z=null,X=P,Z=P=0,Q=null;X!==null&&Z<M.length;Z++){X.index>Z?(Q=X,X=null):Q=X.sibling;var k=_(S,X,M[Z],O);if(k===null){X===null&&(X=Q);break}t&&X&&k.alternate===null&&e(S,X),P=s(k,P,Z),z===null?N=k:z.sibling=k,z=k,X=Q}if(Z===M.length)return n(S,X),Jt&&No(S,Z),N;if(X===null){for(;Z<M.length;Z++)X=m(S,M[Z],O),X!==null&&(P=s(X,P,Z),z===null?N=X:z.sibling=X,z=X);return Jt&&No(S,Z),N}for(X=r(S,X);Z<M.length;Z++)Q=E(X,S,Z,M[Z],O),Q!==null&&(t&&Q.alternate!==null&&X.delete(Q.key===null?Z:Q.key),P=s(Q,P,Z),z===null?N=Q:z.sibling=Q,z=Q);return t&&X.forEach(function(D){return e(S,D)}),Jt&&No(S,Z),N}function x(S,P,M,O){var N=bc(M);if(typeof N!="function")throw Error(fe(150));if(M=N.call(M),M==null)throw Error(fe(151));for(var z=N=null,X=P,Z=P=0,Q=null,k=M.next();X!==null&&!k.done;Z++,k=M.next()){X.index>Z?(Q=X,X=null):Q=X.sibling;var D=_(S,X,k.value,O);if(D===null){X===null&&(X=Q);break}t&&X&&D.alternate===null&&e(S,X),P=s(D,P,Z),z===null?N=D:z.sibling=D,z=D,X=Q}if(k.done)return n(S,X),Jt&&No(S,Z),N;if(X===null){for(;!k.done;Z++,k=M.next())k=m(S,k.value,O),k!==null&&(P=s(k,P,Z),z===null?N=k:z.sibling=k,z=k);return Jt&&No(S,Z),N}for(X=r(S,X);!k.done;Z++,k=M.next())k=E(X,S,Z,k.value,O),k!==null&&(t&&k.alternate!==null&&X.delete(k.key===null?Z:k.key),P=s(k,P,Z),z===null?N=k:z.sibling=k,z=k);return t&&X.forEach(function(ne){return e(S,ne)}),Jt&&No(S,Z),N}function I(S,P,M,O){if(typeof M=="object"&&M!==null&&M.type===Ja&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case cf:e:{for(var N=M.key,z=P;z!==null;){if(z.key===N){if(N=M.type,N===Ja){if(z.tag===7){n(S,z.sibling),P=i(z,M.props.children),P.return=S,S=P;break e}}else if(z.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Hs&&dE(N)===z.type){n(S,z.sibling),P=i(z,M.props),P.ref=Mc(S,z,M),P.return=S,S=P;break e}n(S,z);break}else e(S,z);z=z.sibling}M.type===Ja?(P=Yo(M.props.children,S.mode,O,M.key),P.return=S,S=P):(O=Ch(M.type,M.key,M.props,null,S.mode,O),O.ref=Mc(S,P,M),O.return=S,S=O)}return o(S);case Ya:e:{for(z=M.key;P!==null;){if(P.key===z)if(P.tag===4&&P.stateNode.containerInfo===M.containerInfo&&P.stateNode.implementation===M.implementation){n(S,P.sibling),P=i(P,M.children||[]),P.return=S,S=P;break e}else{n(S,P);break}else e(S,P);P=P.sibling}P=Qp(M,S.mode,O),P.return=S,S=P}return o(S);case Hs:return z=M._init,I(S,P,z(M._payload),O)}if(qc(M))return b(S,P,M,O);if(bc(M))return x(S,P,M,O);_f(S,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,P!==null&&P.tag===6?(n(S,P.sibling),P=i(P,M),P.return=S,S=P):(n(S,P),P=Wp(M,S.mode,O),P.return=S,S=P),o(S)):n(S,P)}return I}var Nl=BS(!0),LS=BS(!1),Eu={},qi=yo(Eu),VA=yo(Eu),HA=yo(Eu);function Ho(t){if(t===Eu)throw Error(fe(174));return t}function Gy(t,e){switch(Nt(HA,e),Nt(VA,t),Nt(qi,Eu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:bm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=bm(e,t)}$t(qi),Nt(qi,e)}function Ul(){$t(qi),$t(VA),$t(HA)}function RS(t){Ho(HA.current);var e=Ho(qi.current),n=bm(e,t.type);e!==n&&(Nt(VA,t),Nt(qi,n))}function zy(t){VA.current===t&&($t(qi),$t(VA))}var qt=yo(0);function fd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Up=[];function Vy(){for(var t=0;t<Up.length;t++)Up[t]._workInProgressVersionPrimary=null;Up.length=0}var Eh=bs.ReactCurrentDispatcher,Gp=bs.ReactCurrentBatchConfig,ra=0,rn=null,wn=null,Ln=null,hd=!1,pA=!1,jA=0,OF=0;function Qn(){throw Error(fe(321))}function Hy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Li(t[n],e[n]))return!1;return!0}function jy(t,e,n,r,i,s){if(ra=s,rn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Eh.current=t===null||t.memoizedState===null?NF:UF,t=n(r,i),pA){s=0;do{if(pA=!1,jA=0,25<=s)throw Error(fe(301));s+=1,Ln=wn=null,e.updateQueue=null,Eh.current=GF,t=n(r,i)}while(pA)}if(Eh.current=dd,e=wn!==null&&wn.next!==null,ra=0,Ln=wn=rn=null,hd=!1,e)throw Error(fe(300));return t}function Wy(){var t=jA!==0;return jA=0,t}function Hi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?rn.memoizedState=Ln=t:Ln=Ln.next=t,Ln}function li(){if(wn===null){var t=rn.alternate;t=t!==null?t.memoizedState:null}else t=wn.next;var e=Ln===null?rn.memoizedState:Ln.next;if(e!==null)Ln=e,wn=t;else{if(t===null)throw Error(fe(310));wn=t,t={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},Ln===null?rn.memoizedState=Ln=t:Ln=Ln.next=t}return Ln}function WA(t,e){return typeof e=="function"?e(t):e}function zp(t){var e=li(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=wn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,h=s;do{var p=h.lane;if((ra&p)===p)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:t(r,h.action);else{var m={lane:p,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(a=l=m,o=r):l=l.next=m,rn.lanes|=p,ia|=p}h=h.next}while(h!==null&&h!==s);l===null?o=r:l.next=a,Li(r,e.memoizedState)||(_r=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,rn.lanes|=s,ia|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vp(t){var e=li(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Li(s,e.memoizedState)||(_r=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function OS(){}function FS(t,e){var n=rn,r=li(),i=e(),s=!Li(r.memoizedState,i);if(s&&(r.memoizedState=i,_r=!0),r=r.queue,Qy(NS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ln!==null&&Ln.memoizedState.tag&1){if(n.flags|=2048,QA(9,kS.bind(null,n,r,i,e),void 0,null),Fn===null)throw Error(fe(349));(ra&30)!==0||DS(n,e,i)}return i}function DS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rn.updateQueue,e===null?(e={lastEffect:null,stores:null},rn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function kS(t,e,n,r){e.value=n,e.getSnapshot=r,US(e)&&GS(t)}function NS(t,e,n){return n(function(){US(e)&&GS(t)})}function US(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Li(t,n)}catch{return!0}}function GS(t){var e=ms(t,1);e!==null&&Mi(e,t,1,-1)}function pE(t){var e=Hi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:WA,lastRenderedState:t},e.queue=t,t=t.dispatch=kF.bind(null,rn,t),[e.memoizedState,t]}function QA(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rn.updateQueue,e===null?(e={lastEffect:null,stores:null},rn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function zS(){return li().memoizedState}function wh(t,e,n,r){var i=Hi();rn.flags|=t,i.memoizedState=QA(1|e,n,void 0,r===void 0?null:r)}function r0(t,e,n,r){var i=li();r=r===void 0?null:r;var s=void 0;if(wn!==null){var o=wn.memoizedState;if(s=o.destroy,r!==null&&Hy(r,o.deps)){i.memoizedState=QA(e,n,s,r);return}}rn.flags|=t,i.memoizedState=QA(1|e,n,s,r)}function gE(t,e){return wh(8390656,8,t,e)}function Qy(t,e){return r0(2048,8,t,e)}function VS(t,e){return r0(4,2,t,e)}function HS(t,e){return r0(4,4,t,e)}function jS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function WS(t,e,n){return n=n!=null?n.concat([t]):null,r0(4,4,jS.bind(null,e,t),n)}function $y(){}function QS(t,e){var n=li();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Hy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function $S(t,e){var n=li();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Hy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function XS(t,e,n){return(ra&21)===0?(t.baseState&&(t.baseState=!1,_r=!0),t.memoizedState=n):(Li(n,e)||(n=KC(),rn.lanes|=n,ia|=n,t.baseState=!0),e)}function FF(t,e){var n=Pt;Pt=n!==0&&4>n?n:4,t(!0);var r=Gp.transition;Gp.transition={};try{t(!1),e()}finally{Pt=n,Gp.transition=r}}function YS(){return li().memoizedState}function DF(t,e,n){var r=ao(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},JS(t))KS(e,n);else if(n=SS(t,e,n,r),n!==null){var i=cr();Mi(n,t,r,i),ZS(n,e,r)}}function kF(t,e,n){var r=ao(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(JS(t))KS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Li(a,o)){var l=e.interleaved;l===null?(i.next=i,Ny(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=SS(t,e,i,r),n!==null&&(i=cr(),Mi(n,t,r,i),ZS(n,e,r))}}function JS(t){var e=t.alternate;return t===rn||e!==null&&e===rn}function KS(t,e){pA=hd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ZS(t,e,n){if((n&4194240)!==0){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,by(t,n)}}var dd={readContext:ai,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useInsertionEffect:Qn,useLayoutEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useMutableSource:Qn,useSyncExternalStore:Qn,useId:Qn,unstable_isNewReconciler:!1},NF={readContext:ai,useCallback:function(t,e){return Hi().memoizedState=[t,e===void 0?null:e],t},useContext:ai,useEffect:gE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wh(4194308,4,jS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wh(4194308,4,t,e)},useInsertionEffect:function(t,e){return wh(4,2,t,e)},useMemo:function(t,e){var n=Hi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Hi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=DF.bind(null,rn,t),[r.memoizedState,t]},useRef:function(t){var e=Hi();return t={current:t},e.memoizedState=t},useState:pE,useDebugValue:$y,useDeferredValue:function(t){return Hi().memoizedState=t},useTransition:function(){var t=pE(!1),e=t[0];return t=FF.bind(null,t[1]),Hi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rn,i=Hi();if(Jt){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=e(),Fn===null)throw Error(fe(349));(ra&30)!==0||DS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,gE(NS.bind(null,r,s,t),[t]),r.flags|=2048,QA(9,kS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Hi(),e=Fn.identifierPrefix;if(Jt){var n=us,r=As;n=(r&~(1<<32-Pi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=jA++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OF++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},UF={readContext:ai,useCallback:QS,useContext:ai,useEffect:Qy,useImperativeHandle:WS,useInsertionEffect:VS,useLayoutEffect:HS,useMemo:$S,useReducer:zp,useRef:zS,useState:function(){return zp(WA)},useDebugValue:$y,useDeferredValue:function(t){var e=li();return XS(e,wn.memoizedState,t)},useTransition:function(){var t=zp(WA)[0],e=li().memoizedState;return[t,e]},useMutableSource:OS,useSyncExternalStore:FS,useId:YS,unstable_isNewReconciler:!1},GF={readContext:ai,useCallback:QS,useContext:ai,useEffect:Qy,useImperativeHandle:WS,useInsertionEffect:VS,useLayoutEffect:HS,useMemo:$S,useReducer:Vp,useRef:zS,useState:function(){return Vp(WA)},useDebugValue:$y,useDeferredValue:function(t){var e=li();return wn===null?e.memoizedState=t:XS(e,wn.memoizedState,t)},useTransition:function(){var t=Vp(WA)[0],e=li().memoizedState;return[t,e]},useMutableSource:OS,useSyncExternalStore:FS,useId:YS,unstable_isNewReconciler:!1};function Gl(t,e){try{var n="",r=e;do n+=dO(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Hp(t,e,n){return{value:t,source:null,stack:n!=null?n:null,digest:e!=null?e:null}}function $m(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var zF=typeof WeakMap=="function"?WeakMap:Map;function qS(t,e,n){n=fs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){gd||(gd=!0,r1=r),$m(t,e)},n}function e3(t,e,n){n=fs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){$m(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){$m(t,e),typeof r!="function"&&(oo===null?oo=new Set([this]):oo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function mE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new zF;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=tD.bind(null,t,e,n),e.then(t,t))}function yE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function vE(t,e,n,r,i){return(t.mode&1)===0?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=fs(-1,1),e.tag=2,so(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=i,t)}var VF=bs.ReactCurrentOwner,_r=!1;function ar(t,e,n,r){e.child=t===null?LS(e,null,n,r):Nl(e,t.child,n,r)}function _E(t,e,n,r,i){n=n.render;var s=e.ref;return Cl(e,i),r=jy(t,e,n,r,s,i),n=Wy(),t!==null&&!_r?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ys(t,e,i)):(Jt&&n&&Ly(e),e.flags|=1,ar(t,e,r,i),e.child)}function EE(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!tv(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,t3(t,e,s,r,i)):(t=Ch(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,(t.lanes&i)===0){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:NA,n(o,r)&&t.ref===e.ref)return ys(t,e,i)}return e.flags|=1,t=lo(s,r),t.ref=e.ref,t.return=e,e.child=t}function t3(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(NA(s,r)&&t.ref===e.ref)if(_r=!1,e.pendingProps=r=s,(t.lanes&i)!==0)(t.flags&131072)!==0&&(_r=!0);else return e.lanes=t.lanes,ys(t,e,i)}return Xm(t,e,n,r,i)}function n3(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(ol,Rr),Rr|=n;else{if((n&1073741824)===0)return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Nt(ol,Rr),Rr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Nt(ol,Rr),Rr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Nt(ol,Rr),Rr|=r;return ar(t,e,i,n),e.child}function r3(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Xm(t,e,n,r,i){var s=wr(n)?ta:er.current;return s=Dl(e,s),Cl(e,i),n=jy(t,e,n,r,s,i),r=Wy(),t!==null&&!_r?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ys(t,e,i)):(Jt&&r&&Ly(e),e.flags|=1,ar(t,e,n,i),e.child)}function wE(t,e,n,r,i){if(wr(n)){var s=!0;od(e)}else s=!1;if(Cl(e,i),e.stateNode===null)Th(t,e),IS(e,n,r),Qm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=ai(h):(h=wr(n)?ta:er.current,h=Dl(e,h));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==h)&&hE(e,o,r,h),js=!1;var _=e.memoizedState;o.state=_,ud(e,r,o,i),l=e.memoizedState,a!==r||_!==l||Er.current||js?(typeof p=="function"&&(Wm(e,n,p,r),l=e.memoizedState),(a=js||fE(e,n,a,r,_,l,h))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=h,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,PS(t,e),a=e.memoizedProps,h=e.type===e.elementType?a:_i(e.type,a),o.props=h,m=e.pendingProps,_=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=ai(l):(l=wr(n)?ta:er.current,l=Dl(e,l));var E=n.getDerivedStateFromProps;(p=typeof E=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||_!==l)&&hE(e,o,r,l),js=!1,_=e.memoizedState,o.state=_,ud(e,r,o,i);var b=e.memoizedState;a!==m||_!==b||Er.current||js?(typeof E=="function"&&(Wm(e,n,E,r),b=e.memoizedState),(h=js||fE(e,n,h,r,_,b,l)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),o.props=r,o.state=b,o.context=l,r=h):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&_===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&_===t.memoizedState||(e.flags|=1024),r=!1)}return Ym(t,e,n,r,s,i)}function Ym(t,e,n,r,i,s){r3(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&aE(e,n,!1),ys(t,e,s);r=e.stateNode,VF.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Nl(e,t.child,null,s),e.child=Nl(e,null,a,s)):ar(t,e,a,s),e.memoizedState=r.state,i&&aE(e,n,!0),e.child}function i3(t){var e=t.stateNode;e.pendingContext?oE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&oE(t,e.context,!1),Gy(t,e.containerInfo)}function TE(t,e,n,r,i){return kl(),Oy(i),e.flags|=256,ar(t,e,n,r),e.child}var Jm={dehydrated:null,treeContext:null,retryLane:0};function Km(t){return{baseLanes:t,cachePool:null,transitions:null}}function s3(t,e,n){var r=e.pendingProps,i=qt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Nt(qt,i&1),t===null)return Hm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((e.mode&1)===0?e.lanes=1:t.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},(r&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=o):s=o0(o,r,0,null),t=Yo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Km(n),e.memoizedState=Jm,t):Xy(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return HF(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return(o&1)===0&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=lo(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=lo(a,s):(s=Yo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Km(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Jm,r}return s=t.child,t=s.sibling,r=lo(s,{mode:"visible",children:r.children}),(e.mode&1)===0&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Xy(t,e){return e=o0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ef(t,e,n,r){return r!==null&&Oy(r),Nl(e,t.child,null,n),t=Xy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HF(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Hp(Error(fe(422))),Ef(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=o0({mode:"visible",children:r.children},i,0,null),s=Yo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,(e.mode&1)!==0&&Nl(e,t.child,null,o),e.child.memoizedState=Km(o),e.memoizedState=Jm,s);if((e.mode&1)===0)return Ef(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(fe(419)),r=Hp(s,r,void 0),Ef(t,e,o,r)}if(a=(o&t.childLanes)!==0,_r||a){if(r=Fn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=(i&(r.suspendedLanes|o))!==0?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ms(t,i),Mi(r,t,i,-1))}return ev(),r=Hp(Error(fe(421))),Ef(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=nD.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Or=io(i.nextSibling),kr=e,Jt=!0,Ti=null,t!==null&&(ei[ti++]=As,ei[ti++]=us,ei[ti++]=na,As=t.id,us=t.overflow,na=e),e=Xy(e,r.children),e.flags|=4096,e)}function bE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),jm(t.return,e,n)}function jp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function o3(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ar(t,e,r.children,n),r=qt.current,(r&2)!==0)r=r&1|2,e.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bE(t,n,e);else if(t.tag===19)bE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Nt(qt,r),(e.mode&1)===0)e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&fd(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),jp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&fd(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}jp(e,!0,n,null,s);break;case"together":jp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Th(t,e){(e.mode&1)===0&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ys(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ia|=e.lanes,(n&e.childLanes)===0)return null;if(t!==null&&e.child!==t.child)throw Error(fe(153));if(e.child!==null){for(t=e.child,n=lo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=lo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function jF(t,e,n){switch(e.tag){case 3:i3(e),kl();break;case 5:RS(e);break;case 1:wr(e.type)&&od(e);break;case 4:Gy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Nt(cd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Nt(qt,qt.current&1),e.flags|=128,null):(n&e.child.childLanes)!==0?s3(t,e,n):(Nt(qt,qt.current&1),t=ys(t,e,n),t!==null?t.sibling:null);Nt(qt,qt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,(t.flags&128)!==0){if(r)return o3(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Nt(qt,qt.current),r)break;return null;case 22:case 23:return e.lanes=0,n3(t,e,n)}return ys(t,e,n)}var a3,Zm,l3,c3;a3=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Zm=function(){};l3=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ho(qi.current);var s=null;switch(n){case"input":i=_m(t,i),r=_m(t,r),s=[];break;case"select":i=sn({},i,{value:void 0}),r=sn({},r,{value:void 0}),s=[];break;case"textarea":i=Tm(t,i),r=Tm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=id)}xm(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var a=i[h];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(BA.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var l=r[h];if(a=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&l!==a&&(l!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(h,n)),n=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(BA.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&Qt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(h,l))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};c3=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ic(t,e){if(!Jt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function $n(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function WF(t,e,n){var r=e.pendingProps;switch(Ry(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $n(e),null;case 1:return wr(e.type)&&sd(),$n(e),null;case 3:return r=e.stateNode,Ul(),$t(Er),$t(er),Vy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(vf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,Ti!==null&&(o1(Ti),Ti=null))),Zm(t,e),$n(e),null;case 5:zy(e);var i=Ho(HA.current);if(n=e.type,t!==null&&e.stateNode!=null)l3(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(fe(166));return $n(e),null}if(t=Ho(qi.current),vf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Xi]=e,r[zA]=s,t=(e.mode&1)!==0,n){case"dialog":Qt("cancel",r),Qt("close",r);break;case"iframe":case"object":case"embed":Qt("load",r);break;case"video":case"audio":for(i=0;i<tA.length;i++)Qt(tA[i],r);break;case"source":Qt("error",r);break;case"img":case"image":case"link":Qt("error",r),Qt("load",r);break;case"details":Qt("toggle",r);break;case"input":R2(r,s),Qt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Qt("invalid",r);break;case"textarea":F2(r,s),Qt("invalid",r)}xm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&yf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&yf(r.textContent,a,t),i=["children",""+a]):BA.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Qt("scroll",r)}switch(n){case"input":Af(r),O2(r,s,!0);break;case"textarea":Af(r),D2(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=id)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=DC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Xi]=e,t[zA]=r,a3(t,e,!1,!1),e.stateNode=t;e:{switch(o=Cm(n,r),n){case"dialog":Qt("cancel",t),Qt("close",t),i=r;break;case"iframe":case"object":case"embed":Qt("load",t),i=r;break;case"video":case"audio":for(i=0;i<tA.length;i++)Qt(tA[i],t);i=r;break;case"source":Qt("error",t),i=r;break;case"img":case"image":case"link":Qt("error",t),Qt("load",t),i=r;break;case"details":Qt("toggle",t),i=r;break;case"input":R2(t,r),i=_m(t,r),Qt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=sn({},r,{value:void 0}),Qt("invalid",t);break;case"textarea":F2(t,r),i=Tm(t,r),Qt("invalid",t);break;default:i=r}xm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?UC(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&kC(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&LA(t,l):typeof l=="number"&&LA(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(BA.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Qt("scroll",t):l!=null&&yy(t,s,l,o))}switch(n){case"input":Af(t),O2(t,r,!1);break;case"textarea":Af(t),D2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ao(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?wl(t,!!r.multiple,s,!1):r.defaultValue!=null&&wl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=id)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $n(e),null;case 6:if(t&&e.stateNode!=null)c3(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(fe(166));if(n=Ho(HA.current),Ho(qi.current),vf(e)){if(r=e.stateNode,n=e.memoizedProps,r[Xi]=e,(s=r.nodeValue!==n)&&(t=kr,t!==null))switch(t.tag){case 3:yf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Xi]=e,e.stateNode=r}return $n(e),null;case 13:if($t(qt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Jt&&Or!==null&&(e.mode&1)!==0&&(e.flags&128)===0)CS(),kl(),e.flags|=98560,s=!1;else if(s=vf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(fe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(fe(317));s[Xi]=e}else kl(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;$n(e),s=!1}else Ti!==null&&(o1(Ti),Ti=null),s=!0;if(!s)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,(e.mode&1)!==0&&(t===null||(qt.current&1)!==0?Tn===0&&(Tn=3):ev())),e.updateQueue!==null&&(e.flags|=4),$n(e),null);case 4:return Ul(),Zm(t,e),t===null&&UA(e.stateNode.containerInfo),$n(e),null;case 10:return ky(e.type._context),$n(e),null;case 17:return wr(e.type)&&sd(),$n(e),null;case 19:if($t(qt),s=e.memoizedState,s===null)return $n(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ic(s,!1);else{if(Tn!==0||t!==null&&(t.flags&128)!==0)for(t=e.child;t!==null;){if(o=fd(t),o!==null){for(e.flags|=128,Ic(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Nt(qt,qt.current&1|2),e.child}t=t.sibling}s.tail!==null&&An()>zl&&(e.flags|=128,r=!0,Ic(s,!1),e.lanes=4194304)}else{if(!r)if(t=fd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ic(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Jt)return $n(e),null}else 2*An()-s.renderingStartTime>zl&&n!==1073741824&&(e.flags|=128,r=!0,Ic(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=An(),e.sibling=null,n=qt.current,Nt(qt,r?n&1|2:n&1),e):($n(e),null);case 22:case 23:return qy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&(e.mode&1)!==0?(Rr&1073741824)!==0&&($n(e),e.subtreeFlags&6&&(e.flags|=8192)):$n(e),null;case 24:return null;case 25:return null}throw Error(fe(156,e.tag))}function QF(t,e){switch(Ry(e),e.tag){case 1:return wr(e.type)&&sd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ul(),$t(Er),$t(er),Vy(),t=e.flags,(t&65536)!==0&&(t&128)===0?(e.flags=t&-65537|128,e):null;case 5:return zy(e),null;case 13:if($t(qt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(fe(340));kl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $t(qt),null;case 4:return Ul(),null;case 10:return ky(e.type._context),null;case 22:case 23:return qy(),null;case 24:return null;default:return null}}var wf=!1,Zn=!1,$F=typeof WeakSet=="function"?WeakSet:Set,Be=null;function sl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){cn(t,e,r)}else n.current=null}function qm(t,e,n){try{n()}catch(r){cn(t,e,r)}}var xE=!1;function XF(t,e){if(Dm=td,t=hS(),By(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,h=0,p=0,m=t,_=null;t:for(;;){for(var E;m!==n||i!==0&&m.nodeType!==3||(a=o+i),m!==s||r!==0&&m.nodeType!==3||(l=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(E=m.firstChild)!==null;)_=m,m=E;for(;;){if(m===t)break t;if(_===n&&++h===i&&(a=o),_===s&&++p===r&&(l=o),(E=m.nextSibling)!==null)break;m=_,_=m.parentNode}m=E}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(km={focusedElem:t,selectionRange:n},td=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var b=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,I=b.memoizedState,S=e.stateNode,P=S.getSnapshotBeforeUpdate(e.elementType===e.type?x:_i(e.type,x),I);S.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var M=e.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(O){cn(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return b=xE,xE=!1,b}function gA(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&qm(e,n,s)}i=i.next}while(i!==r)}}function i0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function e1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function A3(t){var e=t.alternate;e!==null&&(t.alternate=null,A3(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Xi],delete e[zA],delete e[Gm],delete e[IF],delete e[BF])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function u3(t){return t.tag===5||t.tag===3||t.tag===4}function CE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||u3(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function t1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=id));else if(r!==4&&(t=t.child,t!==null))for(t1(t,e,n),t=t.sibling;t!==null;)t1(t,e,n),t=t.sibling}function n1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(n1(t,e,n),t=t.sibling;t!==null;)n1(t,e,n),t=t.sibling}var Un=null,Ei=!1;function Os(t,e,n){for(n=n.child;n!==null;)f3(t,e,n),n=n.sibling}function f3(t,e,n){if(Zi&&typeof Zi.onCommitFiberUnmount=="function")try{Zi.onCommitFiberUnmount(Jd,n)}catch{}switch(n.tag){case 5:Zn||sl(n,e);case 6:var r=Un,i=Ei;Un=null,Os(t,e,n),Un=r,Ei=i,Un!==null&&(Ei?(t=Un,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Un.removeChild(n.stateNode));break;case 18:Un!==null&&(Ei?(t=Un,n=n.stateNode,t.nodeType===8?kp(t.parentNode,n):t.nodeType===1&&kp(t,n),DA(t)):kp(Un,n.stateNode));break;case 4:r=Un,i=Ei,Un=n.stateNode.containerInfo,Ei=!0,Os(t,e,n),Un=r,Ei=i;break;case 0:case 11:case 14:case 15:if(!Zn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&((s&2)!==0||(s&4)!==0)&&qm(n,e,o),i=i.next}while(i!==r)}Os(t,e,n);break;case 1:if(!Zn&&(sl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){cn(n,e,a)}Os(t,e,n);break;case 21:Os(t,e,n);break;case 22:n.mode&1?(Zn=(r=Zn)||n.memoizedState!==null,Os(t,e,n),Zn=r):Os(t,e,n);break;default:Os(t,e,n)}}function SE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new $F),e.forEach(function(r){var i=rD.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function yi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Un=a.stateNode,Ei=!1;break e;case 3:Un=a.stateNode.containerInfo,Ei=!0;break e;case 4:Un=a.stateNode.containerInfo,Ei=!0;break e}a=a.return}if(Un===null)throw Error(fe(160));f3(s,o,i),Un=null,Ei=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(h){cn(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)h3(e,t),e=e.sibling}function h3(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yi(e,t),Ni(t),r&4){try{gA(3,t,t.return),i0(3,t)}catch(x){cn(t,t.return,x)}try{gA(5,t,t.return)}catch(x){cn(t,t.return,x)}}break;case 1:yi(e,t),Ni(t),r&512&&n!==null&&sl(n,n.return);break;case 5:if(yi(e,t),Ni(t),r&512&&n!==null&&sl(n,n.return),t.flags&32){var i=t.stateNode;try{LA(i,"")}catch(x){cn(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&OC(i,s),Cm(a,o);var h=Cm(a,s);for(o=0;o<l.length;o+=2){var p=l[o],m=l[o+1];p==="style"?UC(i,m):p==="dangerouslySetInnerHTML"?kC(i,m):p==="children"?LA(i,m):yy(i,p,m,h)}switch(a){case"input":Em(i,s);break;case"textarea":FC(i,s);break;case"select":var _=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var E=s.value;E!=null?wl(i,!!s.multiple,E,!1):_!==!!s.multiple&&(s.defaultValue!=null?wl(i,!!s.multiple,s.defaultValue,!0):wl(i,!!s.multiple,s.multiple?[]:"",!1))}i[zA]=s}catch(x){cn(t,t.return,x)}}break;case 6:if(yi(e,t),Ni(t),r&4){if(t.stateNode===null)throw Error(fe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){cn(t,t.return,x)}}break;case 3:if(yi(e,t),Ni(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{DA(e.containerInfo)}catch(x){cn(t,t.return,x)}break;case 4:yi(e,t),Ni(t);break;case 13:yi(e,t),Ni(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ky=An())),r&4&&SE(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(Zn=(h=Zn)||p,yi(e,t),Zn=h):yi(e,t),Ni(t),r&8192){if(h=t.memoizedState!==null,(t.stateNode.isHidden=h)&&!p&&(t.mode&1)!==0)for(Be=t,p=t.child;p!==null;){for(m=Be=p;Be!==null;){switch(_=Be,E=_.child,_.tag){case 0:case 11:case 14:case 15:gA(4,_,_.return);break;case 1:sl(_,_.return);var b=_.stateNode;if(typeof b.componentWillUnmount=="function"){r=_,n=_.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){cn(r,n,x)}}break;case 5:sl(_,_.return);break;case 22:if(_.memoizedState!==null){ME(m);continue}}E!==null?(E.return=_,Be=E):ME(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{i=m.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,l=m.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=NC("display",o))}catch(x){cn(t,t.return,x)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=h?"":m.memoizedProps}catch(x){cn(t,t.return,x)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:yi(e,t),Ni(t),r&4&&SE(t);break;case 21:break;default:yi(e,t),Ni(t)}}function Ni(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(u3(n)){var r=n;break e}n=n.return}throw Error(fe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(LA(i,""),r.flags&=-33);var s=CE(t);n1(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=CE(t);t1(t,a,o);break;default:throw Error(fe(161))}}catch(l){cn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function YF(t,e,n){Be=t,d3(t)}function d3(t,e,n){for(var r=(t.mode&1)!==0;Be!==null;){var i=Be,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||wf;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Zn;a=wf;var h=Zn;if(wf=o,(Zn=l)&&!h)for(Be=i;Be!==null;)o=Be,l=o.child,o.tag===22&&o.memoizedState!==null?IE(i):l!==null?(l.return=o,Be=l):IE(i);for(;s!==null;)Be=s,d3(s),s=s.sibling;Be=i,wf=a,Zn=h}PE(t)}else(i.subtreeFlags&8772)!==0&&s!==null?(s.return=i,Be=s):PE(t)}}function PE(t){for(;Be!==null;){var e=Be;if((e.flags&8772)!==0){var n=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:Zn||i0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Zn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:_i(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&uE(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}uE(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var p=h.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&DA(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}Zn||e.flags&512&&e1(e)}catch(_){cn(e,e.return,_)}}if(e===t){Be=null;break}if(n=e.sibling,n!==null){n.return=e.return,Be=n;break}Be=e.return}}function ME(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Be=n;break}Be=e.return}}function IE(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{i0(4,e)}catch(l){cn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){cn(e,i,l)}}var s=e.return;try{e1(e)}catch(l){cn(e,s,l)}break;case 5:var o=e.return;try{e1(e)}catch(l){cn(e,o,l)}}}catch(l){cn(e,e.return,l)}if(e===t){Be=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Be=a;break}Be=e.return}}var JF=Math.ceil,pd=bs.ReactCurrentDispatcher,Yy=bs.ReactCurrentOwner,si=bs.ReactCurrentBatchConfig,mt=0,Fn=null,gn=null,Gn=0,Rr=0,ol=yo(0),Tn=0,$A=null,ia=0,s0=0,Jy=0,mA=null,yr=null,Ky=0,zl=1/0,as=null,gd=!1,r1=null,oo=null,Tf=!1,Ks=null,md=0,yA=0,i1=null,bh=-1,xh=0;function cr(){return(mt&6)!==0?An():bh!==-1?bh:bh=An()}function ao(t){return(t.mode&1)===0?1:(mt&2)!==0&&Gn!==0?Gn&-Gn:RF.transition!==null?(xh===0&&(xh=KC()),xh):(t=Pt,t!==0||(t=window.event,t=t===void 0?16:iS(t.type)),t)}function Mi(t,e,n,r){if(50<yA)throw yA=0,i1=null,Error(fe(185));yu(t,n,r),((mt&2)===0||t!==Fn)&&(t===Fn&&((mt&2)===0&&(s0|=n),Tn===4&&Xs(t,Gn)),Tr(t,r),n===1&&mt===0&&(e.mode&1)===0&&(zl=An()+500,t0&&vo()))}function Tr(t,e){var n=t.callbackNode;RO(t,e);var r=ed(t,t===Fn?Gn:0);if(r===0)n!==null&&U2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&U2(n),e===1)t.tag===0?LF(BE.bind(null,t)):TS(BE.bind(null,t)),PF(function(){(mt&6)===0&&vo()}),n=null;else{switch(ZC(r)){case 1:n=Ty;break;case 4:n=YC;break;case 16:n=qh;break;case 536870912:n=JC;break;default:n=qh}n=w3(n,p3.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function p3(t,e){if(bh=-1,xh=0,(mt&6)!==0)throw Error(fe(327));var n=t.callbackNode;if(Sl()&&t.callbackNode!==n)return null;var r=ed(t,t===Fn?Gn:0);if(r===0)return null;if((r&30)!==0||(r&t.expiredLanes)!==0||e)e=yd(t,r);else{e=r;var i=mt;mt|=2;var s=m3();(Fn!==t||Gn!==e)&&(as=null,zl=An()+500,Xo(t,e));do try{qF();break}catch(a){g3(t,a)}while(1);Dy(),pd.current=s,mt=i,gn!==null?e=0:(Fn=null,Gn=0,e=Tn)}if(e!==0){if(e===2&&(i=Bm(t),i!==0&&(r=i,e=s1(t,i))),e===1)throw n=$A,Xo(t,0),Xs(t,r),Tr(t,An()),n;if(e===6)Xs(t,r);else{if(i=t.current.alternate,(r&30)===0&&!KF(i)&&(e=yd(t,r),e===2&&(s=Bm(t),s!==0&&(r=s,e=s1(t,s))),e===1))throw n=$A,Xo(t,0),Xs(t,r),Tr(t,An()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(fe(345));case 2:Uo(t,yr,as);break;case 3:if(Xs(t,r),(r&130023424)===r&&(e=Ky+500-An(),10<e)){if(ed(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){cr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Um(Uo.bind(null,t,yr,as),e);break}Uo(t,yr,as);break;case 4:if(Xs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Pi(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=An()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*JF(r/1960))-r,10<r){t.timeoutHandle=Um(Uo.bind(null,t,yr,as),r);break}Uo(t,yr,as);break;case 5:Uo(t,yr,as);break;default:throw Error(fe(329))}}}return Tr(t,An()),t.callbackNode===n?p3.bind(null,t):null}function s1(t,e){var n=mA;return t.current.memoizedState.isDehydrated&&(Xo(t,e).flags|=256),t=yd(t,e),t!==2&&(e=yr,yr=n,e!==null&&o1(e)),t}function o1(t){yr===null?yr=t:yr.push.apply(yr,t)}function KF(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Li(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xs(t,e){for(e&=~Jy,e&=~s0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pi(e),r=1<<n;t[n]=-1,e&=~r}}function BE(t){if((mt&6)!==0)throw Error(fe(327));Sl();var e=ed(t,0);if((e&1)===0)return Tr(t,An()),null;var n=yd(t,e);if(t.tag!==0&&n===2){var r=Bm(t);r!==0&&(e=r,n=s1(t,r))}if(n===1)throw n=$A,Xo(t,0),Xs(t,e),Tr(t,An()),n;if(n===6)throw Error(fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Uo(t,yr,as),Tr(t,An()),null}function Zy(t,e){var n=mt;mt|=1;try{return t(e)}finally{mt=n,mt===0&&(zl=An()+500,t0&&vo())}}function sa(t){Ks!==null&&Ks.tag===0&&(mt&6)===0&&Sl();var e=mt;mt|=1;var n=si.transition,r=Pt;try{if(si.transition=null,Pt=1,t)return t()}finally{Pt=r,si.transition=n,mt=e,(mt&6)===0&&vo()}}function qy(){Rr=ol.current,$t(ol)}function Xo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,SF(n)),gn!==null)for(n=gn.return;n!==null;){var r=n;switch(Ry(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sd();break;case 3:Ul(),$t(Er),$t(er),Vy();break;case 5:zy(r);break;case 4:Ul();break;case 13:$t(qt);break;case 19:$t(qt);break;case 10:ky(r.type._context);break;case 22:case 23:qy()}n=n.return}if(Fn=t,gn=t=lo(t.current,null),Gn=Rr=e,Tn=0,$A=null,Jy=s0=ia=0,yr=mA=null,Vo!==null){for(e=0;e<Vo.length;e++)if(n=Vo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Vo=null}return t}function g3(t,e){do{var n=gn;try{if(Dy(),Eh.current=dd,hd){for(var r=rn.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}hd=!1}if(ra=0,Ln=wn=rn=null,pA=!1,jA=0,Yy.current=null,n===null||n.return===null){Tn=1,$A=e,gn=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Gn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,p=a,m=p.tag;if((p.mode&1)===0&&(m===0||m===11||m===15)){var _=p.alternate;_?(p.updateQueue=_.updateQueue,p.memoizedState=_.memoizedState,p.lanes=_.lanes):(p.updateQueue=null,p.memoizedState=null)}var E=yE(o);if(E!==null){E.flags&=-257,vE(E,o,a,s,e),E.mode&1&&mE(s,h,e),e=E,l=h;var b=e.updateQueue;if(b===null){var x=new Set;x.add(l),e.updateQueue=x}else b.add(l);break e}else{if((e&1)===0){mE(s,h,e),ev();break e}l=Error(fe(426))}}else if(Jt&&a.mode&1){var I=yE(o);if(I!==null){(I.flags&65536)===0&&(I.flags|=256),vE(I,o,a,s,e),Oy(Gl(l,a));break e}}s=l=Gl(l,a),Tn!==4&&(Tn=2),mA===null?mA=[s]:mA.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=qS(s,l,e);AE(s,S);break e;case 1:a=l;var P=s.type,M=s.stateNode;if((s.flags&128)===0&&(typeof P.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(oo===null||!oo.has(M)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=e3(s,a,e);AE(s,O);break e}}s=s.return}while(s!==null)}v3(n)}catch(N){e=N,gn===n&&n!==null&&(gn=n=n.return);continue}break}while(1)}function m3(){var t=pd.current;return pd.current=dd,t===null?dd:t}function ev(){(Tn===0||Tn===3||Tn===2)&&(Tn=4),Fn===null||(ia&268435455)===0&&(s0&268435455)===0||Xs(Fn,Gn)}function yd(t,e){var n=mt;mt|=2;var r=m3();(Fn!==t||Gn!==e)&&(as=null,Xo(t,e));do try{ZF();break}catch(i){g3(t,i)}while(1);if(Dy(),mt=n,pd.current=r,gn!==null)throw Error(fe(261));return Fn=null,Gn=0,Tn}function ZF(){for(;gn!==null;)y3(gn)}function qF(){for(;gn!==null&&!bO();)y3(gn)}function y3(t){var e=E3(t.alternate,t,Rr);t.memoizedProps=t.pendingProps,e===null?v3(t):gn=e,Yy.current=null}function v3(t){var e=t;do{var n=e.alternate;if(t=e.return,(e.flags&32768)===0){if(n=WF(n,e,Rr),n!==null){gn=n;return}}else{if(n=QF(n,e),n!==null){n.flags&=32767,gn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tn=6,gn=null;return}}if(e=e.sibling,e!==null){gn=e;return}gn=e=t}while(e!==null);Tn===0&&(Tn=5)}function Uo(t,e,n){var r=Pt,i=si.transition;try{si.transition=null,Pt=1,eD(t,e,n,r)}finally{si.transition=i,Pt=r}return null}function eD(t,e,n,r){do Sl();while(Ks!==null);if((mt&6)!==0)throw Error(fe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(fe(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(OO(t,s),t===Fn&&(gn=Fn=null,Gn=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Tf||(Tf=!0,w3(qh,function(){return Sl(),null})),s=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||s){s=si.transition,si.transition=null;var o=Pt;Pt=1;var a=mt;mt|=4,Yy.current=null,XF(t,n),h3(n,t),_F(km),td=!!Dm,km=Dm=null,t.current=n,YF(n),xO(),mt=a,Pt=o,si.transition=s}else t.current=n;if(Tf&&(Tf=!1,Ks=t,md=i),s=t.pendingLanes,s===0&&(oo=null),PO(n.stateNode),Tr(t,An()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(gd)throw gd=!1,t=r1,r1=null,t;return(md&1)!==0&&t.tag!==0&&Sl(),s=t.pendingLanes,(s&1)!==0?t===i1?yA++:(yA=0,i1=t):yA=0,vo(),null}function Sl(){if(Ks!==null){var t=ZC(md),e=si.transition,n=Pt;try{if(si.transition=null,Pt=16>t?16:t,Ks===null)var r=!1;else{if(t=Ks,Ks=null,md=0,(mt&6)!==0)throw Error(fe(331));var i=mt;for(mt|=4,Be=t.current;Be!==null;){var s=Be,o=s.child;if((Be.flags&16)!==0){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var h=a[l];for(Be=h;Be!==null;){var p=Be;switch(p.tag){case 0:case 11:case 15:gA(8,p,s)}var m=p.child;if(m!==null)m.return=p,Be=m;else for(;Be!==null;){p=Be;var _=p.sibling,E=p.return;if(A3(p),p===h){Be=null;break}if(_!==null){_.return=E,Be=_;break}Be=E}}}var b=s.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var I=x.sibling;x.sibling=null,x=I}while(x!==null)}}Be=s}}if((s.subtreeFlags&2064)!==0&&o!==null)o.return=s,Be=o;else e:for(;Be!==null;){if(s=Be,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:gA(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,Be=S;break e}Be=s.return}}var P=t.current;for(Be=P;Be!==null;){o=Be;var M=o.child;if((o.subtreeFlags&2064)!==0&&M!==null)M.return=o,Be=M;else e:for(o=P;Be!==null;){if(a=Be,(a.flags&2048)!==0)try{switch(a.tag){case 0:case 11:case 15:i0(9,a)}}catch(N){cn(a,a.return,N)}if(a===o){Be=null;break e}var O=a.sibling;if(O!==null){O.return=a.return,Be=O;break e}Be=a.return}}if(mt=i,vo(),Zi&&typeof Zi.onPostCommitFiberRoot=="function")try{Zi.onPostCommitFiberRoot(Jd,t)}catch{}r=!0}return r}finally{Pt=n,si.transition=e}}return!1}function LE(t,e,n){e=Gl(n,e),e=qS(t,e,1),t=so(t,e,1),e=cr(),t!==null&&(yu(t,1,e),Tr(t,e))}function cn(t,e,n){if(t.tag===3)LE(t,t,n);else for(;e!==null;){if(e.tag===3){LE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(oo===null||!oo.has(r))){t=Gl(n,t),t=e3(e,t,1),e=so(e,t,1),t=cr(),e!==null&&(yu(e,1,t),Tr(e,t));break}}e=e.return}}function tD(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=cr(),t.pingedLanes|=t.suspendedLanes&n,Fn===t&&(Gn&n)===n&&(Tn===4||Tn===3&&(Gn&130023424)===Gn&&500>An()-Ky?Xo(t,0):Jy|=n),Tr(t,e)}function _3(t,e){e===0&&((t.mode&1)===0?e=1:(e=hf,hf<<=1,(hf&130023424)===0&&(hf=4194304)));var n=cr();t=ms(t,e),t!==null&&(yu(t,e,n),Tr(t,n))}function nD(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),_3(t,n)}function rD(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(fe(314))}r!==null&&r.delete(e),_3(t,n)}var E3;E3=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Er.current)_r=!0;else{if((t.lanes&n)===0&&(e.flags&128)===0)return _r=!1,jF(t,e,n);_r=(t.flags&131072)!==0}else _r=!1,Jt&&(e.flags&1048576)!==0&&bS(e,ld,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Th(t,e),t=e.pendingProps;var i=Dl(e,er.current);Cl(e,n),i=jy(null,e,r,t,i,n);var s=Wy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wr(r)?(s=!0,od(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Uy(e),i.updater=n0,e.stateNode=i,i._reactInternals=e,Qm(e,r,t,n),e=Ym(null,e,r,!0,s,n)):(e.tag=0,Jt&&s&&Ly(e),ar(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Th(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=sD(r),t=_i(r,t),i){case 0:e=Xm(null,e,r,t,n);break e;case 1:e=wE(null,e,r,t,n);break e;case 11:e=_E(null,e,r,t,n);break e;case 14:e=EE(null,e,r,_i(r.type,t),n);break e}throw Error(fe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),Xm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),wE(t,e,r,i,n);case 3:e:{if(i3(e),t===null)throw Error(fe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,PS(t,e),ud(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Gl(Error(fe(423)),e),e=TE(t,e,r,n,i);break e}else if(r!==i){i=Gl(Error(fe(424)),e),e=TE(t,e,r,n,i);break e}else for(Or=io(e.stateNode.containerInfo.firstChild),kr=e,Jt=!0,Ti=null,n=LS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(kl(),r===i){e=ys(t,e,n);break e}ar(t,e,r,n)}e=e.child}return e;case 5:return RS(e),t===null&&Hm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Nm(r,i)?o=null:s!==null&&Nm(r,s)&&(e.flags|=32),r3(t,e),ar(t,e,o,n),e.child;case 6:return t===null&&Hm(e),null;case 13:return s3(t,e,n);case 4:return Gy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Nl(e,null,r,n):ar(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),_E(t,e,r,i,n);case 7:return ar(t,e,e.pendingProps,n),e.child;case 8:return ar(t,e,e.pendingProps.children,n),e.child;case 12:return ar(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Nt(cd,r._currentValue),r._currentValue=o,s!==null)if(Li(s.value,o)){if(s.children===i.children&&!Er.current){e=ys(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=fs(-1,n&-n),l.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var p=h.pending;p===null?l.next=l:(l.next=p.next,p.next=l),h.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),jm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(fe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),jm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ar(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Cl(e,n),i=ai(i),r=r(i),e.flags|=1,ar(t,e,r,n),e.child;case 14:return r=e.type,i=_i(r,e.pendingProps),i=_i(r.type,i),EE(t,e,r,i,n);case 15:return t3(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_i(r,i),Th(t,e),e.tag=1,wr(r)?(t=!0,od(e)):t=!1,Cl(e,n),IS(e,r,i),Qm(e,r,i,n),Ym(null,e,r,!0,t,n);case 19:return o3(t,e,n);case 22:return n3(t,e,n)}throw Error(fe(156,e.tag))};function w3(t,e){return XC(t,e)}function iD(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ri(t,e,n,r){return new iD(t,e,n,r)}function tv(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sD(t){if(typeof t=="function")return tv(t)?1:0;if(t!=null){if(t=t.$$typeof,t===_y)return 11;if(t===Ey)return 14}return 2}function lo(t,e){var n=t.alternate;return n===null?(n=ri(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ch(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")tv(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ja:return Yo(n.children,i,s,e);case vy:o=8,i|=8;break;case gm:return t=ri(12,n,e,i|2),t.elementType=gm,t.lanes=s,t;case mm:return t=ri(13,n,e,i),t.elementType=mm,t.lanes=s,t;case ym:return t=ri(19,n,e,i),t.elementType=ym,t.lanes=s,t;case BC:return o0(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case MC:o=10;break e;case IC:o=9;break e;case _y:o=11;break e;case Ey:o=14;break e;case Hs:o=16,r=null;break e}throw Error(fe(130,t==null?t:typeof t,""))}return e=ri(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Yo(t,e,n,r){return t=ri(7,t,r,e),t.lanes=n,t}function o0(t,e,n,r){return t=ri(22,t,r,e),t.elementType=BC,t.lanes=n,t.stateNode={isHidden:!1},t}function Wp(t,e,n){return t=ri(6,t,null,e),t.lanes=n,t}function Qp(t,e,n){return e=ri(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function oD(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cp(0),this.expirationTimes=Cp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function nv(t,e,n,r,i,s,o,a,l){return t=new oD(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ri(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uy(s),t}function aD(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ya,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function T3(t){if(!t)return uo;t=t._reactInternals;e:{if(pa(t)!==t||t.tag!==1)throw Error(fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fe(171))}if(t.tag===1){var n=t.type;if(wr(n))return wS(t,n,e)}return e}function b3(t,e,n,r,i,s,o,a,l){return t=nv(n,r,!0,t,i,s,o,a,l),t.context=T3(null),n=t.current,r=cr(),i=ao(n),s=fs(r,i),s.callback=e!=null?e:null,so(n,s,i),t.current.lanes=i,yu(t,i,r),Tr(t,r),t}function a0(t,e,n,r){var i=e.current,s=cr(),o=ao(i);return n=T3(n),e.context===null?e.context=n:e.pendingContext=n,e=fs(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=so(i,e,o),t!==null&&(Mi(t,i,o,s),_h(t,i,o)),o}function vd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function RE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function rv(t,e){RE(t,e),(t=t.alternate)&&RE(t,e)}function lD(){return null}var x3=typeof reportError=="function"?reportError:function(t){console.error(t)};function iv(t){this._internalRoot=t}l0.prototype.render=iv.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(fe(409));a0(t,e,null,null)};l0.prototype.unmount=iv.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;sa(function(){a0(null,t,null,null)}),e[gs]=null}};function l0(t){this._internalRoot=t}l0.prototype.unstable_scheduleHydration=function(t){if(t){var e=tS();t={blockedOn:null,target:t,priority:e};for(var n=0;n<$s.length&&e!==0&&e<$s[n].priority;n++);$s.splice(n,0,t),n===0&&rS(t)}};function sv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function c0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function OE(){}function cD(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=vd(o);s.call(h)}}var o=b3(e,r,t,0,null,!1,!1,"",OE);return t._reactRootContainer=o,t[gs]=o.current,UA(t.nodeType===8?t.parentNode:t),sa(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var h=vd(l);a.call(h)}}var l=nv(t,0,!1,null,null,!1,!1,"",OE);return t._reactRootContainer=l,t[gs]=l.current,UA(t.nodeType===8?t.parentNode:t),sa(function(){a0(e,l,n,r)}),l}function A0(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=vd(o);a.call(l)}}a0(e,o,t,i)}else o=cD(n,e,t,i,r);return vd(o)}qC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=eA(e.pendingLanes);n!==0&&(by(e,n|1),Tr(e,An()),(mt&6)===0&&(zl=An()+500,vo()))}break;case 13:sa(function(){var r=ms(t,1);if(r!==null){var i=cr();Mi(r,t,1,i)}}),rv(t,1)}};xy=function(t){if(t.tag===13){var e=ms(t,134217728);if(e!==null){var n=cr();Mi(e,t,134217728,n)}rv(t,134217728)}};eS=function(t){if(t.tag===13){var e=ao(t),n=ms(t,e);if(n!==null){var r=cr();Mi(n,t,e,r)}rv(t,e)}};tS=function(){return Pt};nS=function(t,e){var n=Pt;try{return Pt=t,e()}finally{Pt=n}};Pm=function(t,e,n){switch(e){case"input":if(Em(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=e0(r);if(!i)throw Error(fe(90));RC(r),Em(r,i)}}}break;case"textarea":FC(t,n);break;case"select":e=n.value,e!=null&&wl(t,!!n.multiple,e,!1)}};VC=Zy;HC=sa;var AD={usingClientEntryPoint:!1,Events:[_u,el,e0,GC,zC,Zy]},Bc={findFiberByHostInstance:zo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},uD={bundleType:Bc.bundleType,version:Bc.version,rendererPackageName:Bc.rendererPackageName,rendererConfig:Bc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=QC(t),t===null?null:t.stateNode},findFiberByHostInstance:Bc.findFiberByHostInstance||lD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bf.isDisabled&&bf.supportsFiber)try{Jd=bf.inject(uD),Zi=bf}catch{}}Hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AD;Hr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sv(e))throw Error(fe(200));return aD(t,e,null,n)};Hr.createRoot=function(t,e){if(!sv(t))throw Error(fe(299));var n=!1,r="",i=x3;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=nv(t,1,!1,null,null,n,!1,r,i),t[gs]=e.current,UA(t.nodeType===8?t.parentNode:t),new iv(e)};Hr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(fe(188)):(t=Object.keys(t).join(","),Error(fe(268,t)));return t=QC(e),t=t===null?null:t.stateNode,t};Hr.flushSync=function(t){return sa(t)};Hr.hydrate=function(t,e,n){if(!c0(e))throw Error(fe(200));return A0(null,t,e,!0,n)};Hr.hydrateRoot=function(t,e,n){if(!sv(t))throw Error(fe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=x3;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=b3(e,null,t,1,n!=null?n:null,i,!1,s,o),t[gs]=e.current,UA(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new l0(e)};Hr.render=function(t,e,n){if(!c0(e))throw Error(fe(200));return A0(null,t,e,!1,n)};Hr.unmountComponentAtNode=function(t){if(!c0(t))throw Error(fe(40));return t._reactRootContainer?(sa(function(){A0(null,null,t,!1,function(){t._reactRootContainer=null,t[gs]=null})}),!0):!1};Hr.unstable_batchedUpdates=Zy;Hr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!c0(n))throw Error(fe(200));if(t==null||t._reactInternals===void 0)throw Error(fe(38));return A0(t,e,n,!1,r)};Hr.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=Hr})(Yd);var FE=Yd.exports;dm.createRoot=FE.createRoot,dm.hydrateRoot=FE.hydrateRoot;const fD="modulepreload",hD=function(t,e){return new URL(t,e).href},DE={},dD=function(e,n,r){return!n||n.length===0?e():Promise.all(n.map(i=>{if(i=hD(i,r),i in DE)return;DE[i]=!0;const s=i.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${o}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":fD,s||(a.as="script",a.crossOrigin=""),a.href=i,document.head.appendChild(a),s)return new Promise((l,h)=>{a.addEventListener("load",l),a.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};var u0={exports:{}},f0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pD=K.exports,gD=Symbol.for("react.element"),mD=Symbol.for("react.fragment"),yD=Object.prototype.hasOwnProperty,vD=pD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_D={key:!0,ref:!0,__self:!0,__source:!0};function C3(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)yD.call(e,r)&&!_D.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:gD,type:t,key:s,ref:o,props:i,_owner:vD.current}}f0.Fragment=mD;f0.jsx=C3;f0.jsxs=C3;(function(t){t.exports=f0})(u0);const ED=u0.exports.Fragment,ze=u0.exports.jsx,ii=u0.exports.jsxs,wD=K.exports.createContext(null);function TD(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function kE(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function NE(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const bD=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function UE(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{const i=e[r.ref];let s=null;if("interactive"in r&&(s={...r},delete s.interactive),i){s=s||{...r},delete s.ref;for(const o of bD)o in i&&(s[o]=i[o])}return s||r});return{...t,layers:n}}function xD(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function Ys(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Ys(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!Ys(t[i],e[i]))return!1;return!0}return!1}const GE={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},$p={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},zE={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},CD=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],SD=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Vl{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[zE[i.type]];s&&s(i)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[GE[i.type]];if(s){if(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"){const o=this._hoveredFeatures||this._map.queryRenderedFeatures(i.point,{layers:this.props.interactiveLayerIds});i.features=o}s(i),delete i.features}},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[$p[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Vl.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n,r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:o}=e;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),r}_initialize(e){const{props:n}=this,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||PD()||null,container:e,style:UE(n.mapStyle)},i=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),n.gl){const h=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=h,n.gl)}const s=new this._MapClass(r);i.padding&&s.setPadding(i.padding),n.cursor&&(s.getCanvas().style.cursor=n.cursor),this._createShadowTransform(s);const o=s._render;s._render=h=>{this._inRender=!0,o.call(s,h),this._inRender=!1};const a=s._renderTaskQueue.run;s._renderTaskQueue.run=h=>{a.call(s._renderTaskQueue,h),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const l=s.fire;s.fire=this._fireEvent.bind(this,l),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>this._updateStyleComponents(this.props,{})),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const h in GE)s.on(h,this._onPointerEvent);for(const h in $p)s.on(h,this._onCameraEvent);for(const h in zE)s.on(h,this._onEvent);this._map=s}recycle(){Vl.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=TD(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,l=r.isMoving();l&&(i.cameraElevationReference="sea");const h=NE(i,{...kE(r.transform),...e});if(l&&(i.cameraElevationReference="ground"),h&&n){const p=this._deferredEvents;p.move=!0,p.zoom||(p.zoom=s!==i.zoom),p.rotate||(p.rotate=a!==i.bearing),p.pitch||(p.pitch=o!==i.pitch)}return l||NE(r.transform,e),h}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of CD)s in e&&!Ys(e[s],n[s])&&(i=!0,r[`set${s[0].toUpperCase()}${s.slice(1)}`](e[s]));return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==n.mapStyle){const r={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(UE(e.mapStyle),r),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.style.loaded()&&("light"in e&&!Ys(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&!Ys(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&!Ys(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){const r=this._map;let i=!1;for(const s of SD){const o=e[s];Ys(o,n[s])||(i=!0,o?r[s].enable(o):r[s].disable())}return i}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0;let a;if(s==="mousemove")try{a=this._map.queryRenderedFeatures(e.point,{layers:r.interactiveLayerIds})}catch{a=[]}else a=[];const l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in $p&&(typeof n=="object"&&(n.viewState=kE(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=n}}}Vl.savedMaps=[];function PD(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||process.env.MapboxAccessToken}catch{}try{t=t||process.env.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const MD=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function ID(t,e){if(!t)return null;const n=t.map,r={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>t.transform.locationPoint(e.LngLat.convert(i)),unproject:i=>t.transform.pointLocation(e.Point.convert(i)),queryTerrainElevation:(i,s)=>{const o=n.transform;n.transform=t.transform;const a=n.queryTerrainElevation(i,s);return n.transform=o,a}};for(const i of BD(n))!(i in r)&&!MD.includes(i)&&(r[i]=n[i].bind(n));return r}function BD(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const LD=typeof document<"u"?K.exports.useLayoutEffect:K.exports.useEffect,RD=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function OD(t,e){for(const n of RD)n in e&&(t[n]=e[n]);e.RTLTextPlugin&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(e.RTLTextPlugin,n=>{n&&console.error(n)},!1)}const h0=K.exports.createContext(null),FD={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:t=>console.error(t.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},ov=K.exports.forwardRef((t,e)=>{const n=K.exports.useContext(wD),[r,i]=K.exports.useState(null),s=K.exports.useRef(),{current:o}=K.exports.useRef({mapLib:null,map:null});K.exports.useEffect(()=>{const l=t.mapLib;let h=!0,p;return Promise.resolve(l||dD(()=>import("./mapbox-gl.5840b341.js").then(m=>m.m),[],import.meta.url)).then(m=>{if(!!h){if(m.Map||(m=m.default),!m||!m.Map)throw new Error("Invalid mapLib");if(m.supported(t))OD(m,t),t.reuseMaps&&(p=Vl.reuse(t,s.current)),p||(p=new Vl(m.Map,t,s.current)),o.map=ID(p,m),o.mapLib=m,i(p),n==null||n.onMapMount(o.map,t.id);else throw new Error("Map is not supported by this browser")}}).catch(m=>{t.onError({type:"error",target:null,originalEvent:null,error:m})}),()=>{h=!1,p&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?p.recycle():p.destroy())}},[]),LD(()=>{r&&r.setProps(t)}),K.exports.useImperativeHandle(e,()=>o.map,[r]);const a=K.exports.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]);return ze("div",{id:t.id,ref:s,style:a,children:r&&ze(h0.Provider,{value:o,children:t.children})})});ov.displayName="Map";ov.defaultProps=FD;const DD=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ga(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!DD.test(r)?n[r]=`${i}px`:n[r]=i}}const kD={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function S3(t){const{map:e,mapLib:n}=K.exports.useContext(h0),r=K.exports.useRef({props:t});r.current.props=t;const i=K.exports.useMemo(()=>{let s=!1;K.exports.Children.forEach(t.children,l=>{l&&(s=!0)});const o={...t,element:s?document.createElement("div"):null},a=new n.Marker(o).setLngLat([t.longitude,t.latitude]);return a.getElement().addEventListener("click",l=>{var h,p;(p=(h=r.current.props).onClick)===null||p===void 0||p.call(h,{type:"click",target:a,originalEvent:l})}),a.on("dragstart",l=>{var h,p;const m=l;m.lngLat=i.getLngLat(),(p=(h=r.current.props).onDragStart)===null||p===void 0||p.call(h,m)}),a.on("drag",l=>{var h,p;const m=l;m.lngLat=i.getLngLat(),(p=(h=r.current.props).onDrag)===null||p===void 0||p.call(h,m)}),a.on("dragend",l=>{var h,p;const m=l;m.lngLat=i.getLngLat(),(p=(h=r.current.props).onDragEnd)===null||p===void 0||p.call(h,m)}),a},[]);return K.exports.useEffect(()=>(i.addTo(e.getMap()),()=>{i.remove()}),[]),K.exports.useEffect(()=>{ga(i.getElement(),t.style)},[t.style]),(i.getLngLat().lng!==t.longitude||i.getLngLat().lat!==t.latitude)&&i.setLngLat([t.longitude,t.latitude]),t.offset&&!xD(i.getOffset(),t.offset)&&i.setOffset(t.offset),i.isDraggable()!==t.draggable&&i.setDraggable(t.draggable),i.getRotation()!==t.rotation&&i.setRotation(t.rotation),i.getRotationAlignment()!==t.rotationAlignment&&i.setRotationAlignment(t.rotationAlignment),i.getPitchAlignment()!==t.pitchAlignment&&i.setPitchAlignment(t.pitchAlignment),i.getPopup()!==t.popup&&i.setPopup(t.popup),Yd.exports.createPortal(t.children,i.getElement())}S3.defaultProps=kD;K.exports.memo(S3);function VE(t){return new Set(t?t.trim().split(/\s+/):[])}function ND(t){const{map:e,mapLib:n}=K.exports.useContext(h0),r=K.exports.useMemo(()=>document.createElement("div"),[]),i=K.exports.useRef({props:t});i.current.props=t;const s=K.exports.useMemo(()=>{const o={...t},a=new n.Popup(o).setLngLat([t.longitude,t.latitude]);return a.once("open",l=>{var h,p;(p=(h=i.current.props).onOpen)===null||p===void 0||p.call(h,l)}),a},[]);if(K.exports.useEffect(()=>{const o=a=>{var l,h;(h=(l=i.current.props).onClose)===null||h===void 0||h.call(l,a)};return s.on("close",o),s.setDOMContent(r).addTo(e.getMap()),()=>{s.off("close",o),s.isOpen()&&s.remove()}},[]),K.exports.useEffect(()=>{ga(s.getElement(),t.style)},[t.style]),s.isOpen()&&((s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!Ys(s.options.offset,t.offset)&&s.setOffset(t.offset),(s.options.anchor!==t.anchor||s.options.maxWidth!==t.maxWidth)&&(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth)),s.options.className!==t.className)){const o=VE(s.options.className),a=VE(t.className);for(const l of o)a.has(l)||s.removeClassName(l);for(const l of a)o.has(l)||s.addClassName(l);s.options.className=t.className}return Yd.exports.createPortal(t.children,r)}K.exports.memo(ND);function wu(t,e,n,r){const i=K.exports.useContext(h0),s=K.exports.useMemo(()=>t(i),[]);return K.exports.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,l=typeof n=="function"?n:typeof e=="function"?e:null,{map:h}=i;return h.hasControl(s)||(h.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{l&&l(i),h.hasControl(s)&&h.removeControl(s)}},[]),s}function UD(t){const e=wu(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return K.exports.useEffect(()=>{ga(e._container,t.style)},[t.style]),null}K.exports.memo(UD);function GD(t){const e=wu(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return K.exports.useEffect(()=>{ga(e._controlContainer,t.style)},[t.style]),null}K.exports.memo(GD);const P3=K.exports.forwardRef((t,e)=>{const n=K.exports.useRef({props:t}),r=wu(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,h;(h=(l=n.current.props).onGeolocate)===null||h===void 0||h.call(l,a)}),s.on("error",a=>{var l,h;(h=(l=n.current.props).onError)===null||h===void 0||h.call(l,a)}),s.on("outofmaxbounds",a=>{var l,h;(h=(l=n.current.props).onOutOfMaxBounds)===null||h===void 0||h.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,h;(h=(l=n.current.props).onTrackUserLocationStart)===null||h===void 0||h.call(l,a)}),s.on("trackuserlocationend",a=>{var l,h;(h=(l=n.current.props).onTrackUserLocationEnd)===null||h===void 0||h.call(l,a)}),s},{position:t.position});return n.current.props=t,K.exports.useImperativeHandle(e,()=>({trigger:()=>r.trigger()}),[]),K.exports.useEffect(()=>{ga(r._container,t.style)},[t.style]),null});P3.displayName="GeolocateControl";K.exports.memo(P3);function zD(t){const e=wu(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return K.exports.useEffect(()=>{ga(e._container,t.style)},[t.style]),null}K.exports.memo(zD);const VD={unit:"metric",maxWidth:100};function M3(t){const e=wu(({mapLib:n})=>new n.ScaleControl(t),{position:t.position});return(e.options.unit!==t.unit||e.options.maxWidth!==t.maxWidth)&&(e.options.maxWidth=t.maxWidth,e.setUnit(t.unit)),K.exports.useEffect(()=>{ga(e._container,t.style)},[t.style]),null}M3.defaultProps=VD;K.exports.memo(M3);function Ct(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Hl=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),HE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);HE&&parseFloat(HE[1]);const HD="3.2.9";function ts(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Xp={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},jD=Xp.global||Xp.self||Xp.window||{},Jo=typeof process!="object"||String(process)!=="[object process]"||process.browser,av=typeof importScripts=="function",WD=typeof window<"u"&&typeof window.orientation<"u",jE=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);jE&&parseFloat(jE[1]);function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class QD{constructor(e,n){T(this,"name",void 0),T(this,"workerThread",void 0),T(this,"isRunning",!0),T(this,"result",void 0),T(this,"_resolve",()=>{}),T(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){ts(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ts(this.isRunning),this.isRunning=!1,this._reject(e)}}class Yp{}const Jp=new Map;function $D(t){ts(t.source&&!t.url||!t.source&&t.url);let e=Jp.get(t.source||t.url);return e||(t.url&&(e=XD(t.url),Jp.set(t.url,e)),t.source&&(e=I3(t.source),Jp.set(t.source,e))),ts(e),e}function XD(t){if(!t.startsWith("http"))return t;const e=YD(t);return I3(e)}function I3(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function YD(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function B3(t,e=!0,n){const r=n||new Set;if(t){if(WE(t))r.add(t);else if(WE(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)B3(t[i],e,r)}}return n===void 0?Array.from(r):[]}function WE(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Kp=()=>{};class a1{static isSupported(){return typeof Worker<"u"&&Jo||typeof Yp<"u"&&!Jo}constructor(e){T(this,"name",void 0),T(this,"source",void 0),T(this,"url",void 0),T(this,"terminated",!1),T(this,"worker",void 0),T(this,"onMessage",void 0),T(this,"onError",void 0),T(this,"_loadableURL","");const{name:n,source:r,url:i}=e;ts(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=Kp,this.onError=s=>console.log(s),this.worker=Jo?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Kp,this.onError=Kp,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,n){n=n||B3(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=$D({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Yp(r,{eval:!1})}else if(this.source)e=new Yp(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class JD{static isSupported(){return a1.isSupported()}constructor(e){T(this,"name","unnamed"),T(this,"source",void 0),T(this,"url",void 0),T(this,"maxConcurrency",1),T(this,"maxMobileConcurrency",1),T(this,"onDebug",()=>{}),T(this,"reuseWorkers",!0),T(this,"props",{}),T(this,"jobQueue",[]),T(this,"idleQueue",[]),T(this,"count",0),T(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new QD(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new a1({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return WD?this.maxMobileConcurrency:this.maxConcurrency}}const KD={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class cs{static isSupported(){return a1.isSupported()}static getWorkerFarm(e={}){return cs._workerFarm=cs._workerFarm||new cs({}),cs._workerFarm.setProps(e),cs._workerFarm}constructor(e){T(this,"props",void 0),T(this,"workerPools",new Map),this.props={...KD},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new JD({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}T(cs,"_workerFarm",void 0);const ZD="latest";function qD(t,e={}){const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=ZD);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return ts(i),i}function e4(t,e=HD){ts(t,"no worker provided");const n=t.version;return!(!e||!n)}const t4={},n4=Object.freeze(Object.defineProperty({__proto__:null,default:t4},Symbol.toStringTag,{value:"Module"})),r4="3.2.9",Zp={};async function Ko(t,e=null,n={}){return e&&(t=i4(t,e,n)),Zp[t]=Zp[t]||s4(t),await Zp[t]}function i4(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:Jo?n.CDN?(ts(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(r4,"/dist/libs/").concat(t)):av?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}async function s4(t){if(t.endsWith("wasm"))return await(await fetch(t)).arrayBuffer();if(!Jo)try{return n4&&void 0}catch{return null}if(av)return importScripts(t);const n=await(await fetch(t)).text();return o4(n,t)}function o4(t,e){if(!Jo)return;if(av)return eval.call(jD,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}function a4(t,e){return!cs.isSupported()||!Jo&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function l4(t,e,n,r,i){const s=t.id,o=qD(t,n),l=cs.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const h=await l.startJob("process-on-worker",c4.bind(null,i));return h.postMessage("process",{input:e,options:n,context:r}),await(await h.result).result}async function c4(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function A4(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?QE(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?QE(t,0,e):""}function QE(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}function u4(t){try{return JSON.parse(t)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(A4(t),'"'))}}function L3(t){return t&&typeof t=="object"&&t.isBuffer}function f4(t){return L3(t)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t}function R3(t){if(L3(t))return f4(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function h4(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function d4(...t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}function qp(...t){const e=t,n=e&&e.length>1&&e[0].constructor||null;if(!n)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');const r=e.reduce((o,a)=>o+a.length,0),i=new n(r);let s=0;for(const o of e)i.set(o,s),s+=o.length;return i}function lv(t,e,n){const r=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function Tu(t,e){return Ct(t>=0),Ct(e>0),t+(e-1)&~(e-1)}function p4(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const i=t.byteOffset,s=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,i,s)}return e.set(r,n),n+Tu(r.byteLength,4)}async function g4(t){const e=[];for await(const n of t)e.push(n);return d4(...e)}function $E(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class XE{constructor(e,n){T(this,"name",void 0),T(this,"type",void 0),T(this,"sampleSize",1),T(this,"time",void 0),T(this,"count",void 0),T(this,"samples",void 0),T(this,"lastTiming",void 0),T(this,"lastSampleTime",void 0),T(this,"lastSampleCount",void 0),T(this,"_count",0),T(this,"_time",0),T(this,"_samples",0),T(this,"_startTime",0),T(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=$E(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime($E()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class bu{constructor(e){T(this,"id",void 0),T(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof XE?this.stats[n]=e:this.stats[n]=new XE(n,r)),this.stats[n]}}const m4="Queued Requests",y4="Active Requests",v4="Cancelled Requests",_4="Queued Requests Ever",E4="Active Requests Ever",w4={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class O3{constructor(e={}){T(this,"props",void 0),T(this,"stats",void 0),T(this,"activeRequestCount",0),T(this,"requestQueue",[]),T(this,"requestMap",new Map),T(this,"deferredUpdate",null),this.props={...w4,...e},this.stats=new bu({id:this.props.id}),this.stats.get(m4),this.stats.get(y4),this.stats.get(v4),this.stats.get(_4),this.stats.get(E4)}scheduleRequest(e,n=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let T4="";const YE={};function b4(t){for(const e in YE)if(t.startsWith(e)){const n=YE[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(T4).concat(t)),t}function x4(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}function F3(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}const C4=t=>typeof t=="boolean",vA=t=>typeof t=="function",xu=t=>t!==null&&typeof t=="object",JE=t=>xu(t)&&t.constructor==={}.constructor,S4=t=>t&&typeof t[Symbol.iterator]=="function",P4=t=>t&&typeof t[Symbol.asyncIterator]=="function",nc=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,rc=t=>typeof Blob<"u"&&t instanceof Blob,M4=t=>t&&typeof t=="object"&&t.isBuffer,I4=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||xu(t)&&vA(t.tee)&&vA(t.cancel)&&vA(t.getReader),B4=t=>xu(t)&&vA(t.read)&&vA(t.pipe)&&C4(t.readable),D3=t=>I4(t)||B4(t),L4=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,R4=/^([-\w.]+\/[-\w.+]+)/;function O4(t){const e=R4.exec(t);return e?e[1]:t}function KE(t){const e=L4.exec(t);return e?e[1]:""}const F4=/\?.*/;function d0(t){if(nc(t)){const e=eg(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:O4(n)||KE(e)}}return rc(t)?{url:eg(t.name||""),type:t.type||""}:typeof t=="string"?{url:eg(t),type:KE(t)}:{url:"",type:""}}function D4(t){return nc(t)?t.headers["content-length"]||-1:rc(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function eg(t){return t.replace(F4,"")}async function k3(t){if(nc(t))return t;const e={},n=D4(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=d0(t);i&&(e["content-type"]=i);const s=await U4(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function k4(t){if(!t.ok){const e=await N4(t);throw new Error(e)}}async function N4(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function U4(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=G4(n);return"data:base64,".concat(r)}return null}function G4(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function l1(t,e){if(typeof t=="string"){t=b4(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await k3(t)}function N3(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&Boolean(process.versions.electron))return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function xs(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||N3()}const Sh={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},xf=Sh.window||Sh.self||Sh.global,Lc=Sh.process||{},U3=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";xs();const tg=globalThis;function G3(t){if(!t&&!xs())return"Node";if(N3(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":tg.chrome?"Chrome":tg.safari?"Safari":tg.mozInnerScreenX?"Firefox":"Unknown"}function z4(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class V4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";T(this,"storage",void 0),T(this,"id",void 0),T(this,"config",{}),this.storage=z4(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}return this}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function H4(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function j4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function ng(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let _d;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(_d||(_d={}));function ZE(t){return typeof t=="string"?_d[t.toUpperCase()]||_d.WHITE:t}function W4(t,e,n){return!xs&&typeof t=="string"&&(e&&(e=ZE(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=ZE(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function Q4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function Ed(t,e){if(!t)throw new Error(e||"Assertion failed")}function Ia(){let t;if(xs&&"performance"in xf){var e,n;t=xf==null||(e=xf.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Lc){var r;const i=Lc==null||(r=Lc.hrtime)===null||r===void 0?void 0:r.call(Lc);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Ba={debug:xs&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},$4={enabled:!0,level:0};function Zr(){}const qE={},ew={once:!0};class Cu{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};T(this,"id",void 0),T(this,"VERSION",U3),T(this,"_startTs",Ia()),T(this,"_deltaTs",Ia()),T(this,"_storage",void 0),T(this,"userData",{}),T(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this._storage=new V4("__probe-".concat(this.id,"__"),$4),this.userData={},this.timeStamp("".concat(this.id," started")),Q4(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ia()-this._startTs).toPrecision(10))}getDelta(){return Number((Ia()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:e}),this}setLevel(e){return this._storage.updateConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.updateConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Ed(e,n)}warn(e){return this._getLogFunction(0,e,Ba.warn,arguments,ew)}error(e){return this._getLogFunction(0,e,Ba.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Ba.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Ba.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Ba.debug||Ba.info,arguments,ew)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Zr,r&&[r],{tag:K4(n)}):Zr}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?xs?J4({image:i,message:s,scale:o}):Y4({image:i,message:s,scale:o}):Zr}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Zr)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=tw({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Zr)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=z3(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=tw({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Ed(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Ia();const o=s.tag||s.message;if(s.once)if(!qE[o])qE[o]=Ia();else return Zr;return n=X4(this.id,s.message,s),r.bind(console,n,...s.args)}return Zr}}T(Cu,"VERSION",U3);function z3(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Ed(Number.isFinite(e)&&e>=0),e}function tw(t){const{logLevel:e,message:n}=t;t.logLevel=z3(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Ed(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function X4(t,e,n){if(typeof e=="string"){const r=n.time?j4(H4(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=W4(e,n.color,n.background)}return e}function Y4(t){let{image:e,message:n="",scale:r=1}=t;return(void 0)({image:e,message:n,scale:r}),Zr}function J4(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=ng(s,n,r);console.log(...o)},s.src=e,Zr}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...ng(e,n,r)),Zr;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...ng(s,n,r)),s.src=e.toDataURL(),Zr}return Zr}function K4(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const nw=new Cu({id:"loaders.gl"});class Z4{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class q4{constructor(){T(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const V3={fetch:null,mimeType:void 0,nothrow:!1,log:new q4,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Hl,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},ek={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function H3(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const j3=()=>{const t=H3();return t.globalOptions=t.globalOptions||{...V3},t.globalOptions};function tk(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],nk(t,n),ik(e,t,r)}function W3(t,e){const n=j3(),r=t||n;return typeof r.fetch=="function"?r.fetch:xu(r.fetch)?i=>l1(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:l1}function nk(t,e){rw(t,null,V3,ek,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};rw(r,n.id,i,s,e)}}function rw(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const l=!e&&xu(t[a]),h=a==="baseUri"&&!e,p=a==="workerUrl"&&e;if(!(a in n)&&!h&&!p){if(a in r)nw.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const m=rk(a,i);nw.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(m))()}}}}function rk(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function ik(t,e,n){const i={...t.options||{}};return sk(i,n),i.log===null&&(i.log=new Z4),iw(i,j3()),iw(i,e),i}function iw(t,e){for(const n in e)if(n in e){const r=e[n];JE(r)&&JE(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function sk(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function cv(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function Av(t){var e,n;Ct(t,"null loader"),Ct(cv(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Q3=()=>{const t=H3();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function ok(t){const e=Q3();t=Array.isArray(t)?t:[t];for(const n of t){const r=Av(n);e.find(i=>r===i)||e.unshift(r)}}function ak(){return Q3()}const lk=new Cu({id:"loaders.gl"}),ck=/\.([^.]+)$/;async function Ak(t,e=[],n,r){if(!$3(t))return null;let i=sw(t,e,{...n,nothrow:!0},r);if(i)return i;if(rc(t)&&(t=await t.slice(0,10).arrayBuffer(),i=sw(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(X3(t));return i}function sw(t,e=[],n,r){if(!$3(t))return null;if(e&&!Array.isArray(e))return Av(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...ak()),fk(i);const s=uk(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(X3(t));return s}function uk(t,e,n,r){const{url:i,type:s}=d0(t),o=i||(r==null?void 0:r.url);let a=null,l="";if(n!=null&&n.mimeType&&(a=rg(e,n==null?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||hk(e,o),l=l||(a?"matched url ".concat(o):""),a=a||rg(e,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||pk(e,t),l=l||(a?"matched initial data ".concat(Y3(t)):""),a=a||rg(e,n==null?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l){var h;lk.log(1,"selectLoader selected ".concat((h=a)===null||h===void 0?void 0:h.name,": ").concat(l,"."))}return a}function $3(t){return!(t instanceof Response&&t.status===204)}function X3(t){const{url:e,type:n}=d0(t);let r="No valid loader found (";r+=e?"".concat(x4(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?Y3(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function fk(t){for(const e of t)Av(e)}function hk(t,e){const n=e&&ck.exec(e),r=n&&n[1];return r?dk(t,r):null}function dk(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function rg(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function pk(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(gk(e,n))return n}else if(ArrayBuffer.isView(e)){if(ow(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&ow(e,0,n))return n;return null}function gk(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function ow(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>mk(t,e,n,i))}function mk(t,e,n,r){if(r instanceof ArrayBuffer)return h4(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=c1(t,e,r.length);return r===i;default:return!1}}function Y3(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?c1(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?c1(t,0,e):""}function c1(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const yk=256*1024;function*vk(t,e){const n=(e==null?void 0:e.chunkSize)||yk;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const _k=256*1024;function*Ek(t,e={}){const{chunkSize:n=_k}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const wk=1024*1024;async function*Tk(t,e){const n=(e==null?void 0:e.chunkSize)||wk;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function aw(t,e){return Hl?bk(t,e):xk(t)}async function*bk(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield R3(o)}}catch{n.releaseLock()}}async function*xk(t,e){for await(const n of t)yield R3(n)}function Ck(t,e){if(typeof t=="string")return vk(t,e);if(t instanceof ArrayBuffer)return Ek(t,e);if(rc(t))return Tk(t,e);if(D3(t))return aw(t,e);if(nc(t))return aw(t.body,e);throw new Error("makeIterator")}const J3="Cannot convert supplied data type";function Sk(t,e,n){if(e.text&&typeof t=="string")return t;if(M4(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(J3)}async function Pk(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return Sk(t,e);if(rc(t)&&(t=await k3(t)),nc(t)){const i=t;return await k4(i),e.binary?await i.arrayBuffer():await i.text()}if(D3(t)&&(t=Ck(t,n)),S4(t)||P4(t))return g4(t);throw new Error(J3)}function Mk(t,e,n=null){if(n)return n;const r={fetch:W3(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function Ik(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function uv(t,e,n,r){ts(!r||typeof r=="object"),e&&!Array.isArray(e)&&!cv(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=d0(t),o=Ik(e,r),a=await Ak(t,o,n);return a?(n=tk(n,a,o,i),r=Mk({url:i,parse:uv,loaders:o},n,r),await Bk(a,t,n,r)):null}async function Bk(t,e,n,r){if(e4(t),nc(e)){const i=e,{ok:s,redirected:o,status:a,statusText:l,type:h,url:p}=i,m=Object.fromEntries(i.headers.entries());r.response={headers:m,ok:s,redirected:o,status:a,statusText:l,type:h,url:p}}if(e=await Pk(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(a4(t,n))return await l4(t,e,n,r,uv);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw ts(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function vs(t,e,n,r){!Array.isArray(e)&&!cv(e)&&(n=e,e=void 0);const i=W3(n);let s=t;return typeof t=="string"&&(s=await i(t)),rc(t)&&(s=await i(t)),await uv(s,e,n)}const Lk="3.2.9",{_parseImageNode:Rk}=globalThis,A1=typeof Image<"u",u1=typeof ImageBitmap<"u",Ok=Boolean(Rk),f1=Hl?!0:Ok;function Fk(t){switch(t){case"auto":return u1||A1||f1;case"imagebitmap":return u1;case"image":return A1;case"data":return f1;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function Dk(){if(u1)return"imagebitmap";if(A1)return"image";if(f1)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function kk(t){const e=Uk(t);if(!e)throw new Error("Not an image");return e}function Nk(t){switch(kk(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Uk(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const Gk=/^data:image\/svg\+xml/,zk=/\.svg((\?|#).*)?$/;function fv(t){return t&&(Gk.test(t)||zk.test(t))}function Vk(t,e){if(fv(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return K3(t,e)}function K3(t,e){if(fv(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Z3(t,e,n){const r=Vk(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Hk(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Hk(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const jk={};let lw=!0;async function Wk(t,e,n){let r;fv(n)?r=await Z3(t,e,n):r=K3(t,n);const i=e&&e.imagebitmap;return await Qk(r,i)}async function Qk(t,e=null){if(($k(e)||!lw)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),lw=!1}return await createImageBitmap(t)}function $k(t){for(const e in t||jk)return!1;return!0}const Yi=!1,_A=!0;function hv(t){const e=Su(t);return Xk(e)||Kk(e)||Yk(e)||Jk(e)}function Xk(t){const e=Su(t);return e.byteLength>=24&&e.getUint32(0,Yi)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Yi),height:e.getUint32(20,Yi)}:null}function Yk(t){const e=Su(t);return e.byteLength>=10&&e.getUint32(0,Yi)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,_A),height:e.getUint16(8,_A)}:null}function Jk(t){const e=Su(t);return e.byteLength>=14&&e.getUint16(0,Yi)===16973&&e.getUint32(2,_A)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,_A),height:e.getUint32(22,_A)}:null}function Kk(t){const e=Su(t);if(!(e.byteLength>=3&&e.getUint16(0,Yi)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=Zk();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Yi);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Yi),width:e.getUint16(s+7,Yi)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,Yi)}return null}function Zk(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Su(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function qk(t,e){const{mimeType:n}=hv(t)||{},r=globalThis._parseImageNode;return Ct(r),await r(t,n)}async function eN(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=tN(i);let a;switch(o){case"imagebitmap":a=await Wk(t,e,s);break;case"image":a=await Z3(t,e,s);break;case"data":a=await qk(t);break;default:Ct(!1)}return i==="data"&&(a=Nk(a)),a}function tN(t){switch(t){case"auto":case"data":return Dk();default:return Fk(t),t}}const nN=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],rN=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],iN={image:{type:"auto",decode:!0}},dv={id:"image",module:"images",name:"Images",version:Lk,mimeTypes:rN,extensions:nN,parse:eN,tests:[t=>Boolean(hv(new DataView(t)))],options:iN},sN=["image/png","image/jpeg","image/gif"],ig={};function oN(t){return ig[t]===void 0&&(ig[t]=aN(t)),ig[t]}function aN(t){switch(t){case"image/webp":return lN();case"image/svg":return Hl;default:if(!Hl){const{_parseImageNode:e}=globalThis;return Boolean(e)&&sN.includes(t)}return!0}}function lN(){if(!Hl)return!1;try{return document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")===0}catch{return!1}}const Ve=new Cu({id:"deck"});let h1={};function cN(t){h1=t}function Jn(t,e,n,r){Ve.level>0&&h1[t]&&h1[t].call(null,e,n,r)}function AN(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const uN={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:AN,parseTextSync:JSON.parse},EA="8.8.11",Ph=globalThis.deck&&globalThis.deck.VERSION;if(Ph&&Ph!==EA)throw new Error("deck.gl - multiple versions detected: ".concat(Ph," vs ").concat(EA));Ph||(Ve.log(1,"deck.gl ".concat(EA))(),globalThis.deck={...globalThis.deck,VERSION:EA,version:EA,log:Ve,_registerLoggers:cN},ok([uN,[dv,{imagebitmap:{premultiplyAlpha:"none"}}]]));const fN=globalThis.deck,Le=new Cu({id:"luma.gl"});function lr(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const hN="Invalid WebGLRenderingContext",dN="Requires WebGL2";function p0(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&Number.isFinite(t._version))}function nt(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function pN(t){return nt(t)?t:null}function g0(t){return lr(p0(t),hN),t}function qn(t){return lr(nt(t),dN),t}const nA={};function gN(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function mN(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function yN(t,e){nA[t]=!0,e!==void 0&&gN(e)}function vN(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(nA[r]=!0);while(r!==0);for(r in nA)if(nA[r])return delete nA[r],parseInt(r,10);return 0}}const Pu=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Pu.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Pu.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const ma=function(e){const n=this;this.gl=e,vN(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,h,p){const m=n.currentVertexArrayObject;m.maxAttrib=Math.max(m.maxAttrib,s);const _=m.attribs[s];return _.buffer=n.currentArrayBuffer,_.size=o,_.type=a,_.normalized=l,_.stride=h,_.offset=p,_.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{mN("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};ma.prototype.VERTEX_ARRAY_BINDING_OES=34229;ma.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Pu(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};ma.prototype.createVertexArrayOES=function(){const e=new Pu(this);return this.vertexArrayObjects.push(e),e};ma.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};ma.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Pu&&e.hasBeenBound&&e.ext===this)};ma.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){yN(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const h=s.attribs[l],p=i?i.attribs[l]:null;if((!i||h.enabled!==p.enabled)&&(h.enabled?r.enableVertexAttribArray.call(n,l):r.disableVertexAttribArray.call(n,l)),h.enabled){let m=!1;(!i||h.buffer!==p.buffer)&&(o!==h.buffer&&(r.bindBuffer.call(n,34962,h.buffer),o=h.buffer),m=!0),(m||h.cached!==p.cached)&&r.vertexAttribPointer.call(n,l,h.size,h.type,h.normalized,h.stride,h.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function _N(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new ma(this)),this.__OESVertexArrayObject))}}const cw="OES_element_index",Aw="WEBGL_draw_buffers",EN="EXT_disjoint_timer_query",wN="EXT_disjoint_timer_query_webgl2",TN="EXT_texture_filter_anisotropic",uw="WEBGL_debug_renderer_info",bN=35723,xN=4352,CN=36795,SN=34047,PN=37445,MN=37446,Dt=t=>nt(t)?void 0:0,IN={[3074]:t=>nt(t)?void 0:36064,[bN]:t=>nt(t)?void 0:xN,[35977]:Dt,[32937]:Dt,[CN]:(t,e)=>{const n=nt(t)?t.getExtension(wN):t.getExtension(EN);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[PN]:(t,e)=>{const n=t.getExtension(uw);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[MN]:(t,e)=>{const n=t.getExtension(uw);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[SN]:(t,e)=>{const n=t.luma.extensions[TN];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:Dt,[35071]:Dt,[37447]:Dt,[36063]:(t,e)=>{if(!nt(t)){const n=t.getExtension(Aw);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:Dt,[35374]:Dt,[35377]:Dt,[34852]:t=>{if(!nt(t)){const e=t.getExtension(Aw);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(cw)?2147483647:65535,[33001]:t=>t.getExtension(cw)?16777216:65535,[33e3]:t=>16777216,[37157]:Dt,[35373]:Dt,[35657]:Dt,[36183]:Dt,[37137]:Dt,[34045]:Dt,[35978]:Dt,[35979]:Dt,[35968]:Dt,[35376]:Dt,[35375]:Dt,[35659]:Dt,[37154]:Dt,[35371]:Dt,[35658]:Dt,[35076]:Dt,[35077]:Dt,[35380]:Dt};function BN(t,e,n){const r=IN[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const LN="OES_vertex_array_object",q3="ANGLE_instanced_arrays",RN="WEBGL_draw_buffers",ON="EXT_disjoint_timer_query",FN="EXT_texture_filter_anisotropic",DN="VertexArray requires WebGL2 or OES_vertex_array_object extension";function kN(t,e){return{webgl2:nt(t),ext:t.getExtension(e)}}const eP={[LN]:{meta:{suffix:"OES"},createVertexArray:()=>{lr(!1,DN)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[q3]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){lr(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[RN]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{lr(!1)}},[ON]:{meta:{suffix:"EXT"},createQuery:()=>{lr(!1)},deleteQuery:()=>{lr(!1)},beginQuery:()=>{lr(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},sg={readBuffer:(t,e,n)=>{nt(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=kN(t,q3);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!nt(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!nt(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[FN];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:BN,hint(t,e,n,r){return e(n,r)}};function NN(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(_N(t),UN(t),zN(t,eP),GN(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=NN;function UN(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function GN(t,e){let{target:n,target2:r}=e;Object.keys(sg).forEach(i=>{if(typeof sg[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=sg[i].bind(null,t,s);n[i]=o,r[i]=o}})}function zN(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&VN(t,{extension:n,target:t.luma,target2:t})}function VN(t,e){let{extension:n,target:r,target2:i}=e;const s=eP[n];lr(s);const{meta:o={}}=s,{suffix:a=""}=o,l=t.getExtension(n);for(const h of Object.keys(s)){const p="".concat(h).concat(a);let m=null;h==="meta"||typeof t[h]=="function"||(l&&typeof l[p]=="function"?m=function(){return l[p](...arguments)}:typeof s[h]=="function"&&(m=s[h].bind(r))),m&&(r[h]=m,i[h]=m)}}const pv={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},Fs=(t,e,n)=>e?t.enable(n):t.disable(n),fw=(t,e,n)=>t.hint(n,e),Pr=(t,e,n)=>t.pixelStorei(n,e),HN=(t,e)=>{const n=nt(t)?36009:36160;return t.bindFramebuffer(n,e)},jN=(t,e)=>t.bindFramebuffer(36008,e);function Rc(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const WN={[3042]:Fs,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:Fs,[2885]:(t,e)=>t.cullFace(e),[2929]:Fs,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:Fs,[35723]:fw,[36006]:HN,[2886]:(t,e)=>t.frontFace(e),[33170]:fw,[2849]:(t,e)=>t.lineWidth(e),[32823]:Fs,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:Fs,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:Fs,[3088]:(t,e)=>t.scissor(...e),[2960]:Fs,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:Pr,[3317]:Pr,[37440]:Pr,[37441]:Pr,[37443]:Pr,[3330]:Pr,[3332]:Pr,[3331]:Pr,[36010]:jN,[3314]:Pr,[32878]:Pr,[3316]:Pr,[3315]:Pr,[32877]:Pr,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Rc(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Rc(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Rc(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Rc(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Rc(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function ln(t,e,n){return e[t]!==void 0?e[t]:n[t]}const QN={blendEquation:(t,e,n)=>t.blendEquationSeparate(ln(32777,e,n),ln(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(ln(32969,e,n),ln(32968,e,n),ln(32971,e,n),ln(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(ln(32824,e,n),ln(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(ln(32938,e,n),ln(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,ln(2962,e,n),ln(2967,e,n),ln(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,ln(34816,e,n),ln(36003,e,n),ln(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,ln(2964,e,n),ln(2965,e,n),ln(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,ln(34817,e,n),ln(34818,e,n),ln(34819,e,n))},hw={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},Ui=(t,e)=>t.isEnabled(e),dw={[3042]:Ui,[2884]:Ui,[2929]:Ui,[3024]:Ui,[32823]:Ui,[32926]:Ui,[32928]:Ui,[3089]:Ui,[2960]:Ui,[35977]:Ui};function tP(t){for(const e in t)return!1;return!0}function $N(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function pw(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function XN(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:l,oldValue:h}=n(t.state._updateCache,...o);return l&&r(...o),h},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function YN(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class JN{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?ZN(e):Object.assign({},pv),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){lr(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];_s(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){lr(s!==void 0);const o=e[s],a=this.cache[s];$N(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function nP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(lr(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new JN(t,{copyState:r}),YN(t);for(const s in hw){const o=hw[s];XN(t,s,o)}pw(t,"getParameter"),pw(t,"isEnabled")}return t.state.enable=n,t}function KN(t){t.state||nP(t,{copyState:!1}),t.state.push()}function gw(t){lr(t.state),t.state.pop()}function _s(t,e){if(lr(p0(t),"setParameters requires a WebGL context"),tP(e))return;const n={};for(const i in e){const s=Number(i),o=WN[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=QN[i];s(t,e,r)}}function ZN(t,e){if(e=e||pv,typeof e=="number"){const i=e,s=dw[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=dw[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function qN(t){_s(t,pv)}function oi(t,e,n){if(tP(e))return n(t);const{nocatch:r=!0}=e;KN(t),_s(t,e);let i;if(r)i=n(t),gw(t);else try{i=n(t)}finally{gw(t)}return i}function jl(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function og(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=jl(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return t8(e,r,i,s,n)}function e8(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function t8(t,e,n,r,i){const s=mw(t[0],e,n);let o=yw(t[1],e,r,i),a=mw(t[0]+1,e,n);const l=a===n-1?a:a-1;a=yw(t[1]+1,e,r,i);let h;return i?(a=a===0?a:a+1,h=o,o=a):h=a===r-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(h-o+1,1)}}function mw(t,e,n){return Math.min(Math.round(t*e),n-1)}function yw(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const gv=xs(),n8=gv&&typeof document<"u",rP={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function iP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lr(gv,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},rP,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=o8({canvas:s,width:e,height:n,onError:r});return i=s8(o,t),i?(i=mv(i,t),a8(i),i):null}function mv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||l8(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},rP,e);const{manageState:n,debug:r}=e;return n&&nP(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Le.log(1,...s)()}}),gv&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Le.level=Math.max(Le.level,1)):Le.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function r8(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function i8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=e8(e.useDevicePixels);c8(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function s8(t,e){const{onError:n}=e;let r=null;const i=l=>r=l.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function o8(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(n8&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function a8(t){const e=nt(t)?"WebGL2":"WebGL1",n=r8(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";Le.info(1,"".concat(e).concat(i," context ").concat(r))()}function l8(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function c8(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(Le.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);t.canvas.width=a,t.canvas.height=l,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==l)&&(Le.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const wA="8.5.16",A8="set luma.log.level=1 (or higher) to trace rendering";class sP{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new bu({id:e})),this.stats.get(e)}}const jo=new sP;if(globalThis.luma&&globalThis.luma.VERSION!==wA)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(wA));globalThis.luma||(xs()&&Le.log(1,"luma.gl ".concat(wA," - ").concat(A8))(),globalThis.luma=globalThis.luma||{VERSION:wA,version:wA,log:Le,stats:jo,globals:{modules:{},nodeIO:{}}});function u8(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function f8(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function _e(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function ag(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return _e(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function co(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const lg={};function Ri(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";lg[t]=lg[t]||1;const e=lg[t]++;return"".concat(t,"-").concat(e)}function vw(t){return _e(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function Wl(t){let e=!0;for(const n in t){e=!1;break}return e}function oP(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw Le.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const La="Resource subclass must define virtual methods";class Cs{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};g0(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Ri(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._initStats(),this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=ag(this.gl,e),_e(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=nt(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,l="webgl2"in i?i.webgl2:i.webgl1;return s?l:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=nt(this.gl),o={},a=n||Object.keys(i);for(const l of a){const h=i[l];if(h&&(!("webgl2"in h)||s)&&(!("extension"in h)||this.gl.getExtension(h.extension))){const m=r?co(this.gl,l):l;o[m]=this.getParameter(l,e),r&&h.type==="GLenum"&&(o[m]=co(this.gl,o[m]))}}return o}setParameter(e,n){e=ag(this.gl,e),_e(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=nt(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=ag(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return oP(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(La)}_deleteHandle(){throw new Error(La)}_bindHandle(e){throw new Error(La)}_getOptsFromHandle(){throw new Error(La)}_getParameter(e,n){throw new Error(La)}_setParameter(e,n){throw new Error(La)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_initStats(){this.gl.stats=this.gl.stats||new sP}_addStats(){const e=this[Symbol.toStringTag],n=jo.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];jo.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._doTrackAllocatedMemory(e,n),this._doTrackAllocatedMemory(e,n,this.gl.stats.get("Memory Usage"))}_doTrackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:jo.get("Memory Usage");r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e),this.byteLength=e}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._doTrackDeallocatedMemory(e),this._doTrackDeallocatedMemory(e,this.gl.stats.get("Memory Usage"))}_doTrackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jo.get("Memory Usage");n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(e," Memory")).subtractCount(this.byteLength),this.byteLength=0}}const h8="Failed to deduce GL constant from typed array";function d1(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(h8)}}function XA(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function d8(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const l=a*o,h=(r-a-1)*o;s.set(e.subarray(l,l+o)),e.copyWithin(l,h,h+o),e.set(s,h)}}function p8(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let l=0;l<i;l++)for(let h=0;h<4;h++)o[(a*i+l)*4+h]=e[(a*2*n+l*2)*4+h];return{data:o,width:i,height:s}}function p1(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const h=r[a]?"".concat(t,".").concat(r[a]):"N/A";Le.removed("".concat(t,".").concat(a),h)()}for(const a in i)if(a in e){const l=i[a];Le.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))()}let o=null;for(const a in s)if(a in e){const l=s[a];Le.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const g8={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},m8={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class vr{static getBytesPerElement(e){return XA(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return _e(e.size),XA(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new vr(g8,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return vr.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return vr.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=p1("Accessor",e,m8),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const _w=10,aP={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},y8={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:aP},v8={removedProps:aP};class St extends Cs{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/vr.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/vr.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=p1("Buffer",e,y8),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=p1("Buffer",e,v8),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new vr(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;_e(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(qn(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return qn(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};qn(this.gl);const s=XA(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let l,h;e?(h=e.length,l=h-a):(l=Math.min(o,i||o),h=a+l);const p=Math.min(o,l);return i=i||p,_e(i<=p),e=e||new s(h),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(_e(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(_w,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;_e(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,_w),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=d1(e);return _e(s),this.setAccessor(new vr(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;_e(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=XA(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new vr(this.accessor,{type:d1(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Le.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Le.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Le.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Le.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new vr(this.accessor,e),this}}const yv={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},lP={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},cP={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function _8(t,e){const n=yv[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=nt(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function E8(t,e){const n=yv[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const w8=[9729,9728],Ew=globalThis.WebGLBuffer||function(){};class oa extends Cs{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&_8(e,r),s=s&&(!i||E8(e,r))),s}constructor(e,n){const{id:r=Ri("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(P=>this.initialize(Object.assign({},e,{pixels:P,data:P}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:h={},textureUnit:p=void 0}=e;n||(n=i);let{width:m,height:_,dataFormat:E,type:b,compressed:x=!1,mipmaps:I=!0}=e;const{depth:S=0}=e;return{width:m,height:_,compressed:x,dataFormat:E,type:b}=this._deduceParameters({format:s,type:b,dataFormat:E,compressed:x,data:n,width:m,height:_}),this.width=m,this.height=_,this.depth=S,this.format=s,this.type=b,this.dataFormat=E,this.border=o,this.textureUnit=p,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),I&&this._isNPOT()&&(Le.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),I=!1,this._updateForNPOT(l)),this.mipmaps=I,this.setImageData({data:n,width:m,height:_,depth:S,format:s,type:b,dataFormat:E,border:o,mipmaps:I,parameters:h,compressed:x}),I&&this.generateMipmap(),this.setParameters(l),a&&(this.data=n),r&&(this._video={video:n,parameters:l,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Le.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),oi(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:h=null,type:p=this.type,width:m=this.width,height:_=this.height,dataFormat:E=this.dataFormat,compressed:b=!1}=e;h||(h=r),{type:p,dataFormat:E,compressed:b,width:m,height:_}=this._deduceParameters({format:s,type:p,dataFormat:E,compressed:b,data:h,width:m,height:_});const{gl:x}=this;x.bindTexture(this.target,this.handle);let I=null;({data:h,dataType:I}=this._getDataType({data:h,compressed:b}));let S,P=0;if(oi(this.gl,l,()=>{switch(I){case"null":x.texImage2D(n,i,s,m,_,o,E,p,h);break;case"typed-array":x.texImage2D(n,i,s,m,_,o,E,p,h,a);break;case"buffer":S=qn(x),S.bindBuffer(35052,h.handle||h),S.texImage2D(n,i,s,m,_,o,E,p,a),S.bindBuffer(35052,null);break;case"browser-object":nt(x)?x.texImage2D(n,i,s,m,_,o,E,p,h):x.texImage2D(n,i,s,E,p,h);break;case"compressed":for(const[M,O]of h.entries())x.compressedTexImage2D(n,M,O.format,O.width,O.height,o,O.data),P+=O.levelSize;break;default:_e(!1,"Unknown image data type")}}),I==="compressed")this._trackAllocatedMemory(P,"Texture");else if(h&&h.byteLength)this._trackAllocatedMemory(h.byteLength,"Texture");else{const M=lP[this.dataFormat]||4,O=cP[this.type]||1;this._trackAllocatedMemory(this.width*this.height*M*O,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:h=0,format:p=this.format,type:m=this.type,dataFormat:_=this.dataFormat,compressed:E=!1,offset:b=0,border:x=this.border,parameters:I={}}=e;if({type:m,dataFormat:_,compressed:E,width:a,height:l}=this._deduceParameters({format:p,type:m,dataFormat:_,compressed:E,data:i,width:a,height:l}),_e(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const S=i;i=S.data,a=S.shape[0],l=S.shape[1]}i instanceof St&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),oi(this.gl,I,()=>{if(E)this.gl.compressedTexSubImage2D(n,h,s,o,a,l,p,i);else if(i===null)this.gl.texSubImage2D(n,h,s,o,a,l,_,m,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,h,s,o,a,l,_,m,i,b);else if(i instanceof Ew){const S=qn(this.gl);S.bindBuffer(35052,i),S.texSubImage2D(n,h,s,o,a,l,_,m,b),S.bindBuffer(35052,null)}else nt(this.gl)?qn(this.gl).texSubImage2D(n,h,s,o,a,l,_,m,i):this.gl.texSubImage2D(n,h,s,o,_,m,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Le.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof St?{data:n.handle,dataType:"buffer"}:n instanceof Ew?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:l}=e;const h=yv[n];return o=o||h&&h.dataFormat,a=a||h&&h.types[0],l=l||h&&h.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:l,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},_e(i,"Could not deduced texture size"),_e(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),_e(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:_e(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return nt(this.gl)||!this.width||!this.height?!1:!vw(this.width)||!vw(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:w8.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let T8="";function b8(t,e){return _e(typeof t=="string"),t=T8+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class Hn extends oa{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return oa.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};g0(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:b8(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const g1=[34069,34070,34071,34072,34073,34074];class AP extends oa{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};g0(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:l=5121}=e;const{gl:h}=this,p=i||s,m=await Promise.all(g1.map(_=>{const E=p[_];return Promise.all(Array.isArray(E)?E:[E])}));this.bind(),g1.forEach((_,E)=>{m[E].length>1&&this.opts.mipmaps!==!1&&Le.warn("".concat(this.id," has mipmap and multiple LODs."))(),m[E].forEach((b,x)=>{n&&r?h.texImage2D(_,x,a,n,r,o,a,l,b):h.texImage2D(_,x,a,a,l,b)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:l=6408,type:h=5121}=e,{gl:p}=this,m=s||o;return this.bind(),m instanceof Promise?m.then(_=>this.setImageDataForFace(Object.assign({},e,{face:n,data:_,pixels:_}))):this.width||this.height?p.texImage2D(n,0,l,r,i,a,l,h,m):p.texImage2D(n,0,l,l,h,m),this}}AP.FACES=g1;class x8 extends oa{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return nt(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qn(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:l,type:h=5121,offset:p=0,data:m,parameters:_={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),oi(this.gl,_,()=>{ArrayBuffer.isView(m)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,l,h,m),m instanceof St&&(this.gl.bindBuffer(35052,m.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,l,h,p))}),m&&m.byteLength)this._trackAllocatedMemory(m.byteLength,"Texture");else{const E=lP[this.dataFormat]||4,b=cP[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*E*b,"Texture")}return this.loaded=!0,this}}const Bo="EXT_color_buffer_float",ww={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:Bo,bpp:2},[33327]:{gl2:Bo,bpp:4},[34842]:{gl2:Bo,bpp:8},[33326]:{gl2:Bo,bpp:4},[33328]:{gl2:Bo,bpp:8},[34836]:{gl2:Bo,bpp:16},[35898]:{gl2:Bo,bpp:4}};function C8(t,e,n){const r=n[e];if(!r)return!1;const i=nt(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class al extends Cs{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||C8(e,n,ww)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return _e(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&nt(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*ww[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const S8=256,P8=1024,M8=16384,Tw=6144,bw=6145,xw=6146,Cw=34041,uP="clear: bad arguments";function vv(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=M8,n!==!0&&(s.clearColor=n)),r&&(o|=S8,r!==!0&&(s.clearDepth=r)),i&&(o|=P8,r!==!0&&(s.clearStencil=r)),_e(o!==0,uP),oi(t,s,()=>{t.clear(o)})}function I8(t){let{framebuffer:e=null,buffer:n=Tw,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qn(t),oi(t,{framebuffer:e},()=>{switch(n){case Tw:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case bw:t.clearBufferfv(bw,0,[i]);break;case xw:t.clearBufferiv(xw,0,[i]);break;case Cw:const[s,o]=i;t.clearBufferfi(Cw,0,s,o);break;default:_e(!1,uP)}})}function B8(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return _e(!1),0}}function m0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:h}=e;const{framebuffer:p,deleteFramebuffer:m}=fP(t);_e(p);const{gl:_,handle:E,attachments:b}=p;a=a||p.width,l=l||p.height,s===36064&&E===null&&(s=1028),_e(b[s]),h=h||b[s].type,o=R8(o,h,i,a,l),h=h||d1(o);const x=_.bindFramebuffer(36160,E);return _.readPixels(n,r,a,l,i,h,o),_.bindFramebuffer(36160,x||null),m&&p.delete(),o}function Sw(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=m0(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=p8({data:r,width:i,height:s}));d8({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),l=a.createImageData(i,s);return l.data.set(r),a.putImageData(l,0,0),o.toDataURL()}function L8(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=n;let{targetX:a,targetY:l,targetZ:h,width:p,height:m}=n;const{framebuffer:_,deleteFramebuffer:E}=fP(t);_e(_);const{gl:b,handle:x}=_,I=typeof a<"u"||typeof l<"u"||typeof h<"u";a=a||0,l=l||0,h=h||0;const S=b.bindFramebuffer(36160,x);_e(e);let P=null;if(e instanceof oa&&(P=e,p=Number.isFinite(p)?p:P.width,m=Number.isFinite(m)?m:P.height,P.bind(0),e=P.target),!I)b.copyTexImage2D(e,s,o,r,i,p,m,0);else switch(e){case 3553:case 34067:b.copyTexSubImage2D(e,s,a,l,r,i,p,m);break;case 35866:case 32879:qn(b).copyTexSubImage3D(e,s,a,l,h,r,i,p,m);break}return P&&P.unbind(),b.bindFramebuffer(36160,S||null),E&&_.delete(),P}function fP(t){return t instanceof mn?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:V8(t),deleteFramebuffer:!0}}function R8(t,e,n,r,i){if(t)return t;e=e||5121;const s=XA(e,{clamped:!1}),o=B8(n);return new s(r*i*o)}const Bt={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function O8(t){const e=new Hn(t,{format:6408,type:5126,dataFormat:6408}),n=new mn(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const hP={[Bt.WEBGL2]:[!1,!0],[Bt.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Bt.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Bt.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Bt.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Bt.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Bt.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Bt.FLOAT_BLEND]:["EXT_float_blend"],[Bt.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Bt.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Bt.TEXTURE_FLOAT]:["OES_texture_float",!0],[Bt.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Bt.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Bt.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Bt.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Bt.COLOR_ATTACHMENT_RGBA32F]:[O8,"EXT_color_buffer_float"],[Bt.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Bt.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Bt.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Bt.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Bt.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Bt.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},F8=2;function y0(t,e){return _v(t,e)}function _v(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>dP(t,n))}function D8(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in hP)t.luma.caps[e]===void 0&&(t.luma.caps[e]=dP(t,e));return t.luma.caps}function dP(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=k8(t,e)),t.luma.caps[e]||Le.log(F8,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function k8(t,e){const n=hP[e];_e(n,e);let r;const i=nt(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&Boolean(t.getExtension(s))}else typeof i=="string"?r=Boolean(t.getExtension(i)):typeof i=="boolean"?r=i:_e(!1);return r}const Pw="Multiple render targets not supported";class mn extends Cs{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new mn(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=qn(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=qn(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:l=!0,readBuffer:h=void 0,drawBuffers:p=void 0}=e;if(_e(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const m in i){const _=i[m];(Array.isArray(_)?_[0]:_).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:h,drawBuffers:p}),i&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,l=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,l||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return _e(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&Le.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){_e(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),l=i[a];let h=l;if(!h)this._unattach(a);else if(h instanceof al)this._attachRenderbuffer({attachment:a,renderbuffer:h});else if(Array.isArray(l)){const[p,m=0,_=0]=l;h=p,this._attachTexture({attachment:a,texture:p,layer:m,level:_})}else this._attachTexture({attachment:a,texture:h,layer:0,level:0});r&&h&&h.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(U8(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&vv(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,l)=>{I8(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return Le.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Le.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Le.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Le.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Le.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Le.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=qn(this.gl),l=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,l),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=co(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?co(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?co(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(Sw(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Le.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=Sw(this,{targetMaxHeight:100});return Le.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new Hn(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new al(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new al(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&_e(!1),o}_unattach(e){const n=this.attachments[e];!n||(n instanceof al?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:qn(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const l=N8(i);o.framebufferTexture2D(36160,n,l,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:_e(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=pN(this.gl);n?n.readBuffer(e):_e(e===36064||e===1029,Pw),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=qn(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):_e(e.length===1&&(e[0]===36064||e[0]===1029),Pw)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=D8(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function N8(t){return t<34069?t+34069:t}function U8(t){return(mn.STATUS||{})[t]||"Framebuffer error ".concat(t)}const G8=[36049,36048,33296,33298,33299,33300,33301,33302,33303];mn.ATTACHMENT_PARAMETERS=G8;function z8(t,e){_e(t instanceof Hn||t instanceof AP||t instanceof x8);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:l,border:h,mipmaps:p}=t,m=Object.assign({width:i,height:s,format:o,type:a,dataFormat:l,border:h,mipmaps:p},e);return new n(r,m)}function V8(t,e){const{gl:n,width:r,height:i,id:s}=t;return new mn(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function Mh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const H8=35632,j8=35633;function W8(t){switch(t){case H8:return"fragment";case j8:return"vertex";default:return"unknown type"}}function Q8(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||Mh(e)||"(unnamed)",l="".concat(W8(n)," shader ").concat(a);for(let p=0;p<i.length;p++){const m=i[p];if(m.length<=1)continue;const _=m.split(":"),E=_[0],b=parseInt(_[2],10);if(isNaN(b))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));E!=="WARNING"?s[b]=m:o[b]=m}const h=$8(e);return{shaderName:l,errors:Mw(s,h),warnings:Mw(o,h)}}function Mw(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0,h=s.substring(o.join(":").length+1).trim();n+=pP("^^^ ".concat(a,": ").concat(h,`

`),l)}}return n}function $8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),l=a.length;return pP(a,i-l)+n+s})}function pP(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function gP(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const X8="Shader: GLSL source code must be a JavaScript string";class YA extends Cs{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return _e(!1),"unknown"}}constructor(e,n){g0(e),_e(typeof n.source=="string",X8);const r=Mh(n.source,null)||n.id||Ri("unnamed ".concat(YA.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=Mh(n,null);r&&(this.id=Ri(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(YA.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Mh(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=Q8(r,this.source,this.shaderType,this.id);throw Le.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),Le.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class cg extends YA{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Ag extends YA{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Y8={[5126]:Wt.bind(null,"uniform1fv",Mr,1,Xn),[35664]:Wt.bind(null,"uniform2fv",Mr,2,Xn),[35665]:Wt.bind(null,"uniform3fv",Mr,3,Xn),[35666]:Wt.bind(null,"uniform4fv",Mr,4,Xn),[5124]:Wt.bind(null,"uniform1iv",Ds,1,Xn),[35667]:Wt.bind(null,"uniform2iv",Ds,2,Xn),[35668]:Wt.bind(null,"uniform3iv",Ds,3,Xn),[35669]:Wt.bind(null,"uniform4iv",Ds,4,Xn),[35670]:Wt.bind(null,"uniform1iv",Ds,1,Xn),[35671]:Wt.bind(null,"uniform2iv",Ds,2,Xn),[35672]:Wt.bind(null,"uniform3iv",Ds,3,Xn),[35673]:Wt.bind(null,"uniform4iv",Ds,4,Xn),[35674]:Wt.bind(null,"uniformMatrix2fv",Mr,4,is),[35675]:Wt.bind(null,"uniformMatrix3fv",Mr,9,is),[35676]:Wt.bind(null,"uniformMatrix4fv",Mr,16,is),[35678]:Nn,[35680]:Nn,[5125]:Wt.bind(null,"uniform1uiv",Cf,1,Xn),[36294]:Wt.bind(null,"uniform2uiv",Cf,2,Xn),[36295]:Wt.bind(null,"uniform3uiv",Cf,3,Xn),[36296]:Wt.bind(null,"uniform4uiv",Cf,4,Xn),[35685]:Wt.bind(null,"uniformMatrix2x3fv",Mr,6,is),[35686]:Wt.bind(null,"uniformMatrix2x4fv",Mr,8,is),[35687]:Wt.bind(null,"uniformMatrix3x2fv",Mr,6,is),[35688]:Wt.bind(null,"uniformMatrix3x4fv",Mr,12,is),[35689]:Wt.bind(null,"uniformMatrix4x2fv",Mr,8,is),[35690]:Wt.bind(null,"uniformMatrix4x3fv",Mr,12,is),[35678]:Nn,[35680]:Nn,[35679]:Nn,[35682]:Nn,[36289]:Nn,[36292]:Nn,[36293]:Nn,[36298]:Nn,[36299]:Nn,[36300]:Nn,[36303]:Nn,[36306]:Nn,[36307]:Nn,[36308]:Nn,[36311]:Nn},J8={},K8={},Z8={},Iw=[0];function Ev(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(Iw[0]=t,t=Iw);const i=t.length;if(i%e&&Le.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function Mr(t,e){return Ev(t,e,Float32Array,J8)}function Ds(t,e){return Ev(t,e,Int32Array,K8)}function Cf(t,e){return Ev(t,e,Uint32Array,Z8)}function Bw(t,e,n){const r=Y8[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function q8(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:Boolean(n[2])}}function e6(t,e,n){for(const r in t){const i=t[r];if((!n||Boolean(n[r]))&&!t6(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function t6(t){return Array.isArray(t)||ArrayBuffer.isView(t)?r6(t):isFinite(t)||t===!0||t===!1||t instanceof oa||t instanceof al?!0:t instanceof mn?Boolean(t.texture):!1}function n6(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function r6(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Nn(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Wt(t,e,n,r){let i=null,s=null;return(o,a,l)=>{const h=e(l,n),p=h.length;let m=!1;if(i===null)i=new Float32Array(p),s=p,m=!0;else{_e(s===p,"Uniform length cannot change.");for(let _=0;_<p;++_)if(h[_]!==i[_]){m=!0;break}}return m&&(r(o,t,a,h),i.set(h)),m}}function Xn(t,e,n,r){t[e](n,r)}function is(t,e,n,r){t[e](n,!1,r)}const i6=5120,s6=5121,o6=5122,a6=5123,Lw=0,Sf=1,l6=2,c6=3,Pf=4,A6=5,u6=6,En=5126,f6=35664,h6=35665,d6=35666,Oc=5124,p6=35667,g6=35668,m6=35669,Fc=5125,y6=36294,v6=36295,_6=36296,E6=35670,w6=35671,T6=35672,b6=35673,x6=35674,C6=35675,S6=35676,P6=35685,M6=35686,I6=35687,B6=35688,L6=35689,R6=35690,m1={[En]:[En,1,"float"],[f6]:[En,2,"vec2"],[h6]:[En,3,"vec3"],[d6]:[En,4,"vec4"],[Oc]:[Oc,1,"int"],[p6]:[Oc,2,"ivec2"],[g6]:[Oc,3,"ivec3"],[m6]:[Oc,4,"ivec4"],[Fc]:[Fc,1,"uint"],[y6]:[Fc,2,"uvec2"],[v6]:[Fc,3,"uvec3"],[_6]:[Fc,4,"uvec4"],[E6]:[En,1,"bool"],[w6]:[En,2,"bvec2"],[T6]:[En,3,"bvec3"],[b6]:[En,4,"bvec4"],[x6]:[En,8,"mat2"],[P6]:[En,8,"mat2x3"],[M6]:[En,8,"mat2x4"],[C6]:[En,12,"mat3"],[I6]:[En,12,"mat3x2"],[B6]:[En,12,"mat3x4"],[S6]:[En,16,"mat4"],[L6]:[En,16,"mat4x2"],[R6]:[En,16,"mat4x3"]};function O6(t){switch(t){case Lw:return Lw;case Sf:return Sf;case c6:return Sf;case l6:return Sf;case Pf:return Pf;case A6:return Pf;case u6:return Pf;default:return _e(!1),0}}function Rw(t){const e=m1[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function mP(t,e){switch(t){case i6:case s6:case o6:case a6:t=En;break}for(const n in m1){const[r,i,s]=m1[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class F6{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),l=n.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!nt(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=Rw(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const l={location:e,name:n,accessor:new vr(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=Rw(r),a=new vr({type:s,size:i*o}),l={location:e,name:n,accessor:a};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const Ow=4,D6=35981,k6=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class yP extends Cs{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",k6),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=D6}=e;return this.hash=n||"",this.vs=typeof r=="string"?new cg(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new Ag(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,_e(this.vs instanceof cg),_e(this.fs instanceof Ag),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(qn(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new F6(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:l=!1,indexType:h=5123,instanceCount:p=0,isInstanced:m=p>0,vertexArray:_=null,transformFeedback:E,framebuffer:b,parameters:x={},uniforms:I,samplers:S}=e;if((I||S)&&(Le.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(I||{})),Le.priority>=n){const P=b?b.id:"default",M="mode=".concat(co(this.gl,r)," verts=").concat(i," ")+"instances=".concat(p," indexType=").concat(co(this.gl,h)," ")+"isInstanced=".concat(m," isIndexed=").concat(l," ")+"Framebuffer=".concat(P);Le.log(n,M)()}return _e(_),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||m&&p===0?!1:(_.bindForDraw(i,p,()=>{if(b!==void 0&&(x=Object.assign({},x,{framebuffer:b})),E){const P=O6(r);E.begin(P)}this._bindTextures(),oi(this.gl,x,()=>{l&&m?this.gl2.drawElementsInstanced(r,i,h,s,p):l&&nt(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,h,s):l?this.gl.drawElements(r,i,h,s):m?this.gl2.drawArraysInstanced(r,s,i,p):this.gl.drawArrays(r,s,i)}),E&&E.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Le.priority>=2&&e6(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof mn&&(s=s.texture),s instanceof oa)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=i;a.bind(l),s=l,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&n6(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new cg({handle:i});break;case 35632:r.fs=new Ag({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Ri(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Le.time(Ow,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Le.timeEnd(Ow,"linkProgram for ".concat(this._getName()))(),e.debug||Le.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=q8(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=Bw(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=Bw(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const N6=34918,U6=34919,G6=35007,z6=36795,V6=35976,H6=35887,j6=36202;class wd extends Cs{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=nt(e),i=_v(e,Bt.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:_e(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(G6)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?j6:H6)}beginTransformFeedbackQuery(){return this.begin(V6)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,U6);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(z6)}getResult(){return this.gl2.getQueryParameter(this.handle,N6)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return wd.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class vP extends Cs{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return nt(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};qn(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Wl(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,Le.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof St?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Mf=null;function W6(t){return(!Mf||Mf.byteLength<t)&&(Mf=new ArrayBuffer(t)),Mf}function Q6(t,e){const n=W6(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function $6(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const X6="elements must be GL.ELEMENT_ARRAY_BUFFER";class Lr extends Cs{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?nt(e)||G3()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Lr(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Lr.MAX_ATTRIBUTES=Lr.MAX_ATTRIBUTES||e.getParameter(34921),Lr.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Lr._setConstantFloatArray(e,n,r);break;case Int32Array:Lr._setConstantIntArray(e,n,r);break;case Uint32Array:Lr._setConstantUintArray(e,n,r);break;default:_e(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Lr.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return _e(!e||e.target===34963,X6),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:l,integer:h,divisor:p}=r,{gl:m,gl2:_}=this;return e=Number(e),this.bind(()=>{m.bindBuffer(34962,n.handle),h?(_e(nt(m)),_.vertexAttribIPointer(e,i,s,o,a)):m.vertexAttribPointer(e,i,s,l,o,a),m.enableVertexAttribArray(e),_.vertexAttribDivisor(e,p||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Lr.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new St(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=Q6(n.constructor,s);$6({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:_e(!1)}}static _setConstantIntArray(e,n,r){switch(_e(nt(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:_e(!1)}}static _setConstantUintArray(e,n,r){switch(_e(nt(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:_e(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return _e(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const Y6="VertexArray: attributes must be Buffers or constants (i.e. typed array)",J6=/^(.+)__LOCATION_([0-9]+)$/,K6=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Z6{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Lr(e),oP(this,"VertexArray","v6.0",K6),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new St(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof St&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof St&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,Le.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const h=this.accessors[o]||{},p=vr.resolve(l.accessor,h,r,i),{size:m,type:_}=p;return _e(Number.isFinite(m)&&Number.isFinite(_)),{location:o,accessor:p}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=J6.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof St)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof St){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof St){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Y6)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Lr.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Lr.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof St){const a=r;if(o){const l=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Le.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function q6(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=JA(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function JA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return q6(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function Fw(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;_e(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,l={},h=Object.keys(a).sort();let p=0;for(const E of h)!E.match(s)&&!E.match(o)&&ug({table:l,header:e,uniforms:r,uniformName:E,undefinedOnly:i})&&p++;for(const E of h)E.match(o)&&ug({table:l,header:e,uniforms:r,uniformName:E,undefinedOnly:i})&&p++;for(const E of h)l[E]||ug({table:l,header:e,uniforms:r,uniformName:E,undefinedOnly:i})&&p++;let m=0;const _={};if(!i)for(const E in r){const b=r[E];l[E]||(m++,_[E]={Type:"NOT USED: ".concat(b),[e]:JA(b)})}return{table:l,count:p,unusedTable:_,unusedCount:m}}function ug(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=e5(o);return!s||!a?(e[i]={[n]:a?JA(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function e5(t){return t!=null}function t5(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=Dw(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const l=e.accessors[o.location];l&&(a="".concat(s,": ").concat(n5(o.name,l))),r[a]=Dw(e,i[s],l,n)}}return r}function Dw(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,l=0,h,p,m;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),h=s.indexOf("nt")!==-1),e instanceof St){const _=e,{data:E,changed:b}=_.getDebugData();p=b?"*":"",m=E,l=_.byteLength,a=l/E.BYTES_PER_ELEMENT/o;let x;if(n){const I=n.divisor>0;x="".concat(I?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(l," bytes ").concat(co(i,s),")")}else h=!0,x="".concat(l," bytes");return{[r]:"".concat(p).concat(JA(m,{size:o,isInteger:h})),"Format ":x}}return m=e,o=e.length,s=String(e.constructor.name).replace("Array",""),h=s.indexOf("nt")!==-1,{[r]:"".concat(JA(m,{size:o,isInteger:h})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function n5(t,e){const{type:n,size:r}=e,i=mP(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function r5(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=kw(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=kw(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function kw(t){const{type:e,size:n}=t.accessor,r=mP(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const Nw=xs()&&typeof document<"u";let i5=0;class s5{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=I=>iP(I),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:l=null,glOptions:h={},debug:p=!1,createFramebuffer:m=!1,autoResizeViewport:_=!0,autoResizeDrawingBuffer:E=!0,stats:b=jo.get("animation-loop-".concat(i5++))}=e;let{useDevicePixels:x=!0}=e;"useDevicePixelRatio"in e&&(Le.deprecated("useDevicePixelRatio","useDevicePixels")(),x=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:h,debug:p,createFramebuffer:m},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=b,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:_,autoResizeDrawingBuffer:E,useDevicePixels:x}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return _e(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=wd.isSupported(this.gl,["timers"])?new wd(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return Le.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Nw?new Promise((e,n)=>{if(Nw&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):f8(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):u8(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?mv(this.props.gl,e):this.onCreateContext(e),!p0(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");qN(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&i8(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new mn(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Mu="vs",wv="fs";function Nr(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const fg={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function o5(t){const e={};for(const n in t){const r=t[n],i=a5(r);e[n]=i}return e}function a5(t){let e=Uw(t);return e==="object"?t?"type"in t?Object.assign({},t,fg[t.type]):"value"in t?(e=Uw(t.value),Object.assign({type:e},t,fg[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},fg[e])}function Uw(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const l5="vs",c5="fs";class Gw{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:l=[],defines:h={},inject:p={},vertexShader:m,fragmentShader:_}=e;Nr(typeof n=="string"),this.name=n,this.vs=r||m,this.fs=i||_,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=h,this.injections=A5(p),o&&(this.uniforms=o5(o))}getModuleSource(e){let n;switch(e){case l5:n=this.vs||"";break;case c5:n=this.fs||"";break;default:Nr(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Nr(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function A5(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function u5(t){return f5(EP(t))}function f5(t){const e={},n={};return _P({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function _P(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&_P({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function EP(t,e){return t.map(n=>(n instanceof Gw||(Nr(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Nr(n.name,"shader module has no name"),n=new Gw(n),n.dependencies=EP(n.dependencies)),n))}function h5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const d5=7936,p5=7937,g5=7938,m5=35724,Tv={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Go={};Object.keys(Tv).forEach(t=>{Go[t]=t});function y5(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function v5(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||d5),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||p5);return{gpuVendor:_5(n,r),vendor:n,renderer:r,version:t.getParameter(g5),shadingLanguageVersion:t.getParameter(m5)}}function _5(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const hg={};function zw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=Tv[e];if(Nr(r,e),!h5(n))return!0;if(e in hg)return hg[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),hg[e]=l,l}function E5(t,e){const n=Tv[e];Nr(n,e);const r=y5(t)&&n[1]||n[0],i=typeof r=="string"?Boolean(t.getExtension(r)):r;return Nr(i===!1||i===!0),i}function If(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>E5(t,n))}function w5(t){switch(v5(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function T5(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return If(t,Go.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),If(t,Go.GLSL_DERIVATIVES)&&zw(t,Go.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),If(t,Go.GLSL_FRAG_DATA)&&zw(t,Go.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),If(t,Go.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const b5=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,x5=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,C5={[Mu]:b5,[wv]:x5},Ih="__LUMA_INJECT_DECLARATIONS__",Vw=/void\s+main\s*\([^)]*\)\s*\{\n?/,Hw=/}\n?[^{}]*$/,dg=[];function jw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Mu;for(const s in n){const o=n[s];o.sort((l,h)=>l.order-h.order),dg.length=o.length;for(let l=0,h=o.length;l<h;++l)dg[l]=o[l].injection;const a="".concat(dg.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(Ih,a));break;case"vs:#main-start":i&&(t=t.replace(Vw,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(Hw,l=>a+l));break;case"fs:#decl":i||(t=t.replace(Ih,a));break;case"fs:#main-start":i||(t=t.replace(Vw,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(Hw,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(Ih,""),r&&(t=t.replace(/\}\s*$/,s=>s+C5[e])),t}function y1(t){const e={};return Nr(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function Ql(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const wP=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],S5=[...wP,[Ql("attribute"),"in $1"],[Ql("varying"),"out $1"]],P5=[...wP,[Ql("varying"),"in $1"]],TP=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],M5=[...TP,[Ql("in"),"attribute $1"],[Ql("out"),"varying $1"]],I5=[...TP,[Ql("in"),"varying $1"]],v1="gl_FragColor",_1=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,B5=/void\s+main\s*\([^)]*\)\s*\{\n?/;function L5(t,e,n){switch(e){case 300:return n?Td(t,S5):R5(t);case 100:return n?Td(t,M5):O5(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Td(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function R5(t){t=Td(t,P5);const e=t.match(_1);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(v1,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(B5,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(v1,"\\b"),"g"),n)}return t}function O5(t){t=Td(t,I5);const e=t.match(_1);if(e){const n=e[1];t=t.replace(_1,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),v1)}return t}const F5=`

`.concat(Ih,`

`),bP={[Mu]:"vertex",[wv]:"fragment"},D5=`precision highp float;

`;function k5(t,e){const{vs:n,fs:r}=e,i=u5(e.modules||[]);return{gl:t,vs:Ww(t,Object.assign({},e,{source:n,type:Mu,modules:i})),fs:Ww(t,Object.assign({},e,{source:r,type:wv,modules:i})),getUniforms:N5(i)}}function Ww(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:h=!1,prologue:p=!0,log:m}=e;Nr(typeof r=="string","shader source must be a string");const _=i===Mu,E=r.split(`
`);let b=100,x="",I=r;E[0].indexOf("#version ")===0?(b=300,x=E[0],I=E.slice(1).join(`
`)):x="#version ".concat(b);const S={};s.forEach(X=>{Object.assign(S,X.getDefines())}),Object.assign(S,o);let P=p?"".concat(x,`
`).concat(G5({id:n,source:r,type:i}),`
`).concat(U5({type:i}),`
`).concat(w5(t),`
`).concat(T5(t),`
`).concat(z5(S),`
`).concat(_?"":D5,`
`):"".concat(x,`
`);const M=H5(a),O={},N={},z={};for(const X in l){const Z=typeof l[X]=="string"?{injection:l[X],order:0}:l[X],Q=X.match(/^(v|f)s:(#)?([\w-]+)$/);if(Q){const k=Q[2],D=Q[3];k?D==="decl"?N[X]=[Z]:z[X]=[Z]:O[X]=[Z]}else z[X]=[Z]}for(const X of s){m&&X.checkDeprecations(I,m),P+=X.getModuleSource(i,b);const Q=X.injections[i];for(const k in Q){const D=k.match(/^(v|f)s:#([\w-]+)$/);if(D){const se=D[2]==="decl"?N:z;se[k]=se[k]||[],se[k].push(Q[k])}else O[k]=O[k]||[],O[k].push(Q[k])}}return P+=F5,P=jw(P,i,N),P+=V5(M[i],O),P+=I,P=jw(P,i,z),P=L5(P,h?100:b,_),P}function N5(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function U5(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(bP[e].toUpperCase(),`
`)}function G5(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(bP[r],`

`):""}function z5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function V5(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function H5(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const j5="void main() {gl_FragColor = vec4(0);}",xP=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,W5=`#version 300 es
`.concat(xP);function CP(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function SP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?W5:e>300?"#version ".concat(e,`
`).concat(xP):j5;const s=X5(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function Q5(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Nr(!1),null}}function $5(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Nr(!1),null}}function X5(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Nr(!1),null}}const Y5=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,J5={name:"fp32",vs:Y5,fs:null};function bi(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const K5=1/Math.PI*180,Z5=1/180*Math.PI,bn={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function q5(t,{precision:e=bn.precision}={}){return t=rU(t),"".concat(parseFloat(t.toPrecision(e)))}function fo(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function eU(t){return nU(t)}function tU(t){return rA(t)}function nU(t,e){return bv(t,n=>n*Z5,e)}function rA(t,e){return bv(t,n=>n*K5,e)}function On(t,e,n){return bv(t,r=>Math.max(e,Math.min(n,r)))}function Ii(t,e,n){return fo(t)?t.map((r,i)=>Ii(r,e[i],n)):n*e+(1-n)*t}function Ur(t,e,n){const r=bn.EPSILON;n&&(bn.EPSILON=n);try{if(t===e)return!0;if(fo(t)&&fo(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Ur(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=bn.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{bn.EPSILON=r}}function rU(t){return Math.round(t/bn.EPSILON)*bn.EPSILON}function iU(t){return t.clone?t.clone():new Array(t.length)}function bv(t,e,n){if(fo(t)){const r=t;n=n||iU(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function sU(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class xv extends sU(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:fo(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(bn)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+q5(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Ur(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(bn.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function oU(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function wt(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function TA(t,e,n=""){if(bn.debug&&!oU(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class Cv extends xv{get x(){return this[0]}set x(e){this[0]=wt(e)}get y(){return this[1]}set y(e){this[1]=wt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return wt(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return wt(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return bi(e>=0&&e<this.ELEMENTS,"index is out of range"),wt(this[e])}setComponent(e,n){return bi(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var bA=1e-6,Oi=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function aU(){var t=new Oi(2);return Oi!=Float32Array&&(t[0]=0,t[1]=0),t}function bd(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function PP(t,e){return t[0]=-e[0],t[1]=-e[1],t}function MP(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function lU(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function cU(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function IP(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function BP(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=aU();return function(e,n,r,i,s,o){var a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function LP(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function RP(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function AU(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function uU(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function OP(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}class Sv extends Cv{constructor(e=0,n=0){super(2),fo(e)&&arguments.length===1?this.copy(e):(bn.debug&&(wt(e),wt(n)),this[0]=e,this[1]=n)}set(e,n){return this[0]=e,this[1]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return bn.debug&&(wt(e.x),wt(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return BP(this,this,e),this.check()}transformAsVector(e){return LP(this,this,e),this.check()}transformByMatrix3(e){return IP(this,this,e),this.check()}transformByMatrix2x3(e){return cU(this,this,e),this.check()}transformByMatrix2(e){return lU(this,this,e),this.check()}}function FP(){var t=new Oi(3);return Oi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function DP(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Qw(t,e,n){var r=new Oi(3);return r[0]=t,r[1]=e,r[2]=n,r}function fU(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function hU(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function dU(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function pU(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function Pv(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Bh(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function gU(t,e,n,r){var i=e[0],s=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t}function Mv(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function kP(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function NP(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],h=e[2],p=i*h-s*l,m=s*a-r*h,_=r*l-i*a,E=i*_-s*m,b=s*p-r*_,x=r*m-i*p,I=o*2;return p*=I,m*=I,_*=I,E*=2,b*=2,x*=2,t[0]=a+p+E,t[1]=l+m+b,t[2]=h+_+x,t}function mU(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function yU(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function vU(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function _U(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt(n*n+r*r+i*i),h=Math.sqrt(s*s+o*o+a*a),p=l*h,m=p&&Pv(t,e)/p;return Math.acos(Math.min(Math.max(m,-1),1))}var UP=fU,GP=DP,pg=hU;(function(){var t=FP();return function(e,n,r,i,s,o){var a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const gg=[0,0,0];let Bf;class ee extends Cv{static get ZERO(){return Bf||(Bf=new ee(0,0,0),Object.freeze(Bf)),Bf}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&fo(e)?this.copy(e):(bn.debug&&(wt(e),wt(n),wt(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return bn.debug&&(wt(e.x),wt(e.y),wt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=wt(e)}angle(e){return _U(this,e)}cross(e){return Bh(this,this,e),this.check()}rotateX({radians:e,origin:n=gg}){return mU(this,this,n,e),this.check()}rotateY({radians:e,origin:n=gg}){return yU(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=gg}){return vU(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Mv(this,this,e),this.check()}transformAsVector(e){return RP(this,this,e),this.check()}transformByMatrix3(e){return kP(this,this,e),this.check()}transformByMatrix2(e){return AU(this,this,e),this.check()}transformByQuaternion(e){return NP(this,this,e),this.check()}}let Lf;class Iv extends Cv{static get ZERO(){return Lf||(Lf=new Iv(0,0,0,0),Object.freeze(Lf)),Lf}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),fo(e)&&arguments.length===1?this.copy(e):(bn.debug&&(wt(e),wt(n),wt(r),wt(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return bn.debug&&(wt(e.x),wt(e.y),wt(e.z),wt(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=wt(e)}get w(){return this[3]}set w(e){this[3]=wt(e)}transform(e){return Mv(this,this,e),this.check()}transformByMatrix3(e){return OP(this,this,e),this.check()}transformByMatrix2(e){return uU(this,this,e),this.check()}transformByQuaternion(e){return NP(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class zP extends xv{toString(){let e="[";if(bn.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=wt(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function EU(){var t=new Oi(9);return Oi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function wU(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function TU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],p=e[8],m=p*o-a*h,_=-p*s+a*l,E=h*s-o*l,b=n*m+r*_+i*E;return b?(b=1/b,t[0]=m*b,t[1]=(-p*r+i*h)*b,t[2]=(a*r-i*o)*b,t[3]=_*b,t[4]=(p*n-i*l)*b,t[5]=(-a*n+i*s)*b,t[6]=E*b,t[7]=(-h*n+r*l)*b,t[8]=(o*n-r*s)*b,t):null}function bU(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],h=t[8];return e*(h*s-o*l)+n*(-h*i+o*a)+r*(l*i-s*a)}function $w(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],m=e[8],_=n[0],E=n[1],b=n[2],x=n[3],I=n[4],S=n[5],P=n[6],M=n[7],O=n[8];return t[0]=_*r+E*o+b*h,t[1]=_*i+E*a+b*p,t[2]=_*s+E*l+b*m,t[3]=x*r+I*o+S*h,t[4]=x*i+I*a+S*p,t[5]=x*s+I*l+S*m,t[6]=P*r+M*o+O*h,t[7]=P*i+M*a+O*p,t[8]=P*s+M*l+O*m,t}function xU(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],m=e[8],_=n[0],E=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=l,t[6]=_*r+E*o+h,t[7]=_*i+E*a+p,t[8]=_*s+E*l+m,t}function CU(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],m=e[8],_=Math.sin(n),E=Math.cos(n);return t[0]=E*r+_*o,t[1]=E*i+_*a,t[2]=E*s+_*l,t[3]=E*o-_*r,t[4]=E*a-_*i,t[5]=E*l-_*s,t[6]=h,t[7]=p,t[8]=m,t}function Xw(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function SU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,h=n*o,p=r*o,m=r*a,_=i*o,E=i*a,b=i*l,x=s*o,I=s*a,S=s*l;return t[0]=1-m-b,t[3]=p-S,t[6]=_+I,t[1]=p+S,t[4]=1-h-b,t[7]=E-x,t[2]=_-I,t[5]=E+x,t[8]=1-h-m,t}var E1;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(E1||(E1={}));const PU=Object.freeze([1,0,0,0,1,0,0,0,1]);class xn extends zP{static get IDENTITY(){return IU()}static get ZERO(){return MU()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return E1}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(PU)}fromObject(e){return this.check()}fromQuaternion(e){return SU(this,e),this.check()}set(e,n,r,i,s,o,a,l,h){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=h,this.check()}setRowMajor(e,n,r,i,s,o,a,l,h){return this[0]=e,this[1]=i,this[2]=a,this[3]=n,this[4]=s,this[5]=l,this[6]=r,this[7]=o,this[8]=h,this.check()}determinant(){return bU(this)}transpose(){return wU(this,this),this.check()}invert(){return TU(this,this),this.check()}multiplyLeft(e){return $w(this,e,this),this.check()}multiplyRight(e){return $w(this,this,e),this.check()}rotate(e){return CU(this,this,e),this.check()}scale(e){return Array.isArray(e)?Xw(this,this,e):Xw(this,this,[e,e]),this.check()}translate(e){return xU(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=IP(n||[-0,-0],e,this);break;case 3:r=kP(n||[-0,-0,-0],e,this);break;case 4:r=OP(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return TA(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let Rf,Of;function MU(){return Rf||(Rf=new xn([0,0,0,0,0,0,0,0,0]),Object.freeze(Rf)),Rf}function IU(){return Of||(Of=new xn,Object.freeze(Of)),Of}function BU(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function LU(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function w1(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],p=e[8],m=e[9],_=e[10],E=e[11],b=e[12],x=e[13],I=e[14],S=e[15],P=n*a-r*o,M=n*l-i*o,O=n*h-s*o,N=r*l-i*a,z=r*h-s*a,X=i*h-s*l,Z=p*x-m*b,Q=p*I-_*b,k=p*S-E*b,D=m*I-_*x,ne=m*S-E*x,se=_*S-E*I,oe=P*se-M*ne+O*D+N*k-z*Q+X*Z;return oe?(oe=1/oe,t[0]=(a*se-l*ne+h*D)*oe,t[1]=(i*ne-r*se-s*D)*oe,t[2]=(x*X-I*z+S*N)*oe,t[3]=(_*z-m*X-E*N)*oe,t[4]=(l*k-o*se-h*Q)*oe,t[5]=(n*se-i*k+s*Q)*oe,t[6]=(I*O-b*X-S*M)*oe,t[7]=(p*X-_*O+E*M)*oe,t[8]=(o*ne-a*k+h*Z)*oe,t[9]=(r*k-n*ne-s*Z)*oe,t[10]=(b*z-x*O+S*P)*oe,t[11]=(m*O-p*z-E*P)*oe,t[12]=(a*Q-o*D-l*Z)*oe,t[13]=(n*D-r*Q+i*Z)*oe,t[14]=(x*M-b*N-I*P)*oe,t[15]=(p*N-m*M+_*P)*oe,t):null}function RU(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],h=t[8],p=t[9],m=t[10],_=t[11],E=t[12],b=t[13],x=t[14],I=t[15],S=e*o-n*s,P=e*a-r*s,M=e*l-i*s,O=n*a-r*o,N=n*l-i*o,z=r*l-i*a,X=h*b-p*E,Z=h*x-m*E,Q=h*I-_*E,k=p*x-m*b,D=p*I-_*b,ne=m*I-_*x;return S*ne-P*D+M*k+O*Q-N*Z+z*X}function Zo(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],h=e[6],p=e[7],m=e[8],_=e[9],E=e[10],b=e[11],x=e[12],I=e[13],S=e[14],P=e[15],M=n[0],O=n[1],N=n[2],z=n[3];return t[0]=M*r+O*a+N*m+z*x,t[1]=M*i+O*l+N*_+z*I,t[2]=M*s+O*h+N*E+z*S,t[3]=M*o+O*p+N*b+z*P,M=n[4],O=n[5],N=n[6],z=n[7],t[4]=M*r+O*a+N*m+z*x,t[5]=M*i+O*l+N*_+z*I,t[6]=M*s+O*h+N*E+z*S,t[7]=M*o+O*p+N*b+z*P,M=n[8],O=n[9],N=n[10],z=n[11],t[8]=M*r+O*a+N*m+z*x,t[9]=M*i+O*l+N*_+z*I,t[10]=M*s+O*h+N*E+z*S,t[11]=M*o+O*p+N*b+z*P,M=n[12],O=n[13],N=n[14],z=n[15],t[12]=M*r+O*a+N*m+z*x,t[13]=M*i+O*l+N*_+z*I,t[14]=M*s+O*h+N*E+z*S,t[15]=M*o+O*p+N*b+z*P,t}function xd(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,l,h,p,m,_,E,b,x,I,S;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],h=e[3],p=e[4],m=e[5],_=e[6],E=e[7],b=e[8],x=e[9],I=e[10],S=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=h,t[4]=p,t[5]=m,t[6]=_,t[7]=E,t[8]=b,t[9]=x,t[10]=I,t[11]=S,t[12]=o*r+p*i+b*s+e[12],t[13]=a*r+m*i+x*s+e[13],t[14]=l*r+_*i+I*s+e[14],t[15]=h*r+E*i+S*s+e[15]),t}function Bv(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function OU(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),l,h,p,m,_,E,b,x,I,S,P,M,O,N,z,X,Z,Q,k,D,ne,se,oe,xe;return a<bA?null:(a=1/a,i*=a,s*=a,o*=a,l=Math.sin(n),h=Math.cos(n),p=1-h,m=e[0],_=e[1],E=e[2],b=e[3],x=e[4],I=e[5],S=e[6],P=e[7],M=e[8],O=e[9],N=e[10],z=e[11],X=i*i*p+h,Z=s*i*p+o*l,Q=o*i*p-s*l,k=i*s*p-o*l,D=s*s*p+h,ne=o*s*p+i*l,se=i*o*p+s*l,oe=s*o*p-i*l,xe=o*o*p+h,t[0]=m*X+x*Z+M*Q,t[1]=_*X+I*Z+O*Q,t[2]=E*X+S*Z+N*Q,t[3]=b*X+P*Z+z*Q,t[4]=m*k+x*D+M*ne,t[5]=_*k+I*D+O*ne,t[6]=E*k+S*D+N*ne,t[7]=b*k+P*D+z*ne,t[8]=m*se+x*oe+M*xe,t[9]=_*se+I*oe+O*xe,t[10]=E*se+S*oe+N*xe,t[11]=b*se+P*oe+z*xe,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function VP(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],h=e[8],p=e[9],m=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+h*r,t[5]=o*i+p*r,t[6]=a*i+m*r,t[7]=l*i+_*r,t[8]=h*i-s*r,t[9]=p*i-o*r,t[10]=m*i-a*r,t[11]=_*i-l*r,t}function FU(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],h=e[8],p=e[9],m=e[10],_=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-h*r,t[1]=o*i-p*r,t[2]=a*i-m*r,t[3]=l*i-_*r,t[8]=s*r+h*i,t[9]=o*r+p*i,t[10]=a*r+m*i,t[11]=l*r+_*i,t}function HP(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],h=e[4],p=e[5],m=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+h*r,t[1]=o*i+p*r,t[2]=a*i+m*r,t[3]=l*i+_*r,t[4]=h*i-s*r,t[5]=p*i-o*r,t[6]=m*i-a*r,t[7]=_*i-l*r,t}function DU(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],l=e[8],h=e[9],p=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,o,a),t[2]=Math.hypot(l,h,p),t}function kU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,h=n*o,p=r*o,m=r*a,_=i*o,E=i*a,b=i*l,x=s*o,I=s*a,S=s*l;return t[0]=1-m-b,t[1]=p+S,t[2]=_-I,t[3]=0,t[4]=p-S,t[5]=1-h-b,t[6]=E+x,t[7]=0,t[8]=_+I,t[9]=E-x,t[10]=1-h-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function NU(t,e,n,r,i,s,o){var a=1/(n-e),l=1/(i-r),h=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*h,t[15]=0,t}function UU(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var GU=UU;function zU(t,e,n,r,i,s,o){var a=1/(e-n),l=1/(r-i),h=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*h,t[15]=1,t}var VU=zU;function HU(t,e,n,r){var i,s,o,a,l,h,p,m,_,E,b=e[0],x=e[1],I=e[2],S=r[0],P=r[1],M=r[2],O=n[0],N=n[1],z=n[2];return Math.abs(b-O)<bA&&Math.abs(x-N)<bA&&Math.abs(I-z)<bA?BU(t):(p=b-O,m=x-N,_=I-z,E=1/Math.hypot(p,m,_),p*=E,m*=E,_*=E,i=P*_-M*m,s=M*p-S*_,o=S*m-P*p,E=Math.hypot(i,s,o),E?(E=1/E,i*=E,s*=E,o*=E):(i=0,s=0,o=0),a=m*o-_*s,l=_*i-p*o,h=p*s-m*i,E=Math.hypot(a,l,h),E?(E=1/E,a*=E,l*=E,h*=E):(a=0,l=0,h=0),t[0]=i,t[1]=a,t[2]=p,t[3]=0,t[4]=s,t[5]=l,t[6]=m,t[7]=0,t[8]=o,t[9]=h,t[10]=_,t[11]=0,t[12]=-(i*b+s*x+o*I),t[13]=-(a*b+l*x+h*I),t[14]=-(p*b+m*x+_*I),t[15]=1,t)}function jU(){var t=new Oi(4);return Oi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function WU(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Lv(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function QU(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function $U(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function XU(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t}function YU(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function JU(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a),t}function ic(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}function KU(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2],h=n[3],p=h*r+a*s-l*i,m=h*i+l*r-o*s,_=h*s+o*i-a*r,E=-o*r-a*i-l*s;return t[0]=p*h+E*-o+m*-l-_*-a,t[1]=m*h+E*-a+_*-o-p*-l,t[2]=_*h+E*-l+p*-a-m*-o,t[3]=e[3],t}(function(){var t=jU();return function(e,n,r,i,s,o){var a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var T1;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(T1||(T1={}));const ZU=45*Math.PI/180,qU=1,mg=.1,yg=500,eG=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ye extends zP{static get IDENTITY(){return nG()}static get ZERO(){return tG()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return T1}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,h,p,m,_,E,b,x,I){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=h,this[9]=p,this[10]=m,this[11]=_,this[12]=E,this[13]=b,this[14]=x,this[15]=I,this.check()}setRowMajor(e,n,r,i,s,o,a,l,h,p,m,_,E,b,x,I){return this[0]=e,this[1]=s,this[2]=h,this[3]=E,this[4]=n,this[5]=o,this[6]=p,this[7]=b,this[8]=r,this[9]=a,this[10]=m,this[11]=x,this[12]=i,this[13]=l,this[14]=_,this[15]=I,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(eG)}fromObject(e){return this.check()}fromQuaternion(e){return kU(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=mg,far:a=yg}=e;return a===1/0?rG(this,n,r,i,s,o):NU(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return HU(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=mg,far:a=yg}=e;return VU(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=ZU,aspect:r=qU,focalDistance:i=1,near:s=mg,far:o=yg}=e;Yw(n);const a=n/2,l=i*Math.tan(a),h=l*r;return this.ortho({left:-h,right:h,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return Yw(n),GU(this,n,r,i,s),this.check()}determinant(){return RU(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return LU(this,this),this.check()}invert(){return w1(this,this),this.check()}multiplyLeft(e){return Zo(this,e,this),this.check()}multiplyRight(e){return Zo(this,this,e),this.check()}rotateX(e){return VP(this,this,e),this.check()}rotateY(e){return FU(this,this,e),this.check()}rotateZ(e){return HP(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return OU(this,this,e,n),this.check()}scale(e){return Bv(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return xd(this,this,e),this.check()}transform(e,n){return e.length===4?(n=ic(n||[-0,-0,-0,-0],e,this),TA(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=BP(n||[-0,-0],e,this);break;case 3:i=Mv(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return TA(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=LP(n||[-0,-0],e,this);break;case 3:r=RP(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return TA(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Ff,Df;function tG(){return Ff||(Ff=new Ye([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Ff)),Ff}function nG(){return Df||(Df=new Ye,Object.freeze(Df)),Df}function Yw(t){if(t>Math.PI*2)throw Error("expected radians")}function rG(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),h=(i+r)/(i-r),p=-1,m=-1,_=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=h,t[10]=p,t[11]=m,t[12]=0,t[13]=0,t[14]=_,t[15]=0,t}function Jw(){var t=new Oi(4);return Oi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function iG(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function jP(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Kw(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=n[0],l=n[1],h=n[2],p=n[3];return t[0]=r*p+o*a+i*h-s*l,t[1]=i*p+o*l+s*a-r*h,t[2]=s*p+o*h+r*l-i*a,t[3]=o*p-r*a-i*l-s*h,t}function sG(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+o*a,t[1]=i*l+s*a,t[2]=s*l-i*a,t[3]=o*l-r*a,t}function oG(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l-s*a,t[1]=i*l+o*a,t[2]=s*l+r*a,t[3]=o*l-i*a,t}function aG(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),l=Math.cos(n);return t[0]=r*l+i*a,t[1]=i*l-r*a,t[2]=s*l+o*a,t[3]=o*l-s*a,t}function lG(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Lh(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3],l=n[0],h=n[1],p=n[2],m=n[3],_,E,b,x,I;return E=i*l+s*h+o*p+a*m,E<0&&(E=-E,l=-l,h=-h,p=-p,m=-m),1-E>bA?(_=Math.acos(E),b=Math.sin(_),x=Math.sin((1-r)*_)/b,I=Math.sin(r*_)/b):(x=1-r,I=r),t[0]=x*i+I*l,t[1]=x*s+I*h,t[2]=x*o+I*p,t[3]=x*a+I*m,t}function cG(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=s*a,t}function AG(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function WP(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[o*3+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+o]-e[o*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[o]=(e[o*3+i]+e[i*3+o])*r}return t}var uG=WU,fG=Lv,hG=YU,dG=JU,pG=QU,gG=$U,QP=XU,mG=function(){var t=FP(),e=Qw(1,0,0),n=Qw(0,1,0);return function(r,i,s){var o=Pv(i,s);return o<-.999999?(Bh(t,e,i),GP(t)<1e-6&&Bh(t,n,i),pU(t,t),jP(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Bh(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,QP(r,r))}}();(function(){var t=Jw(),e=Jw();return function(n,r,i,s,o,a){return Lh(t,r,o,a),Lh(e,i,s,a),Lh(n,t,e,2*a*(1-a)),n}})();(function(){var t=EU();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],QP(e,WP(e,t))}})();const yG=[0,0,0,1];class KA extends xv{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return WP(this,e),this.check()}fromAxisRotation(e,n){return jP(this,e,n),this.check()}identity(){return iG(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=wt(e)}get y(){return this[1]}set y(e){this[1]=wt(e)}get z(){return this[2]}set z(e){this[2]=wt(e)}get w(){return this[3]}set w(e){this[3]=wt(e)}len(){return pG(this)}lengthSquared(){return gG(this)}dot(e){return hG(this,e)}rotationTo(e,n){return mG(this,e,n),this.check()}add(e){return uG(this,this,e),this.check()}calculateW(){return lG(this,this),this.check()}conjugate(){return AG(this,this),this.check()}invert(){return cG(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(dG(this,e,n,r),this.check())}multiplyRight(e){return Kw(this,this,e),this.check()}multiplyLeft(e){return Kw(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return sG(this,this,e),this.check()}rotateY(e){return oG(this,this,e),this.check()}rotateZ(e){return aG(this,this,e),this.check()}scale(e){return fG(this,this,e),this.check()}slerp(e,n,r){let i,s,o;switch(arguments.length){case 1:({start:i=yG,target:s,ratio:o}=e);break;case 2:i=this,s=e,o=n;break;default:i=e,s=n,o=r}return Lh(this,i,s,o),this.check()}transformVector4(e,n=new Iv){return KU(n,e,this),TA(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const ZA={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},Zw=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,vG={lightSources:{}};function vg(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function _G(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=vg(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,o)=>{i["lighting_uPointLight[".concat(o,"].color")]=vg(s),i["lighting_uPointLight[".concat(o,"].position")]=s.position,i["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,o)=>{i["lighting_uDirectionalLight[".concat(o,"].color")]=vg(s),i["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function $P(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vG;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},_G({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return $P({lightSources:e})}return{}}const Rv={name:"lights",vs:Zw,fs:Zw,getUniforms:$P,defines:{MAX_LIGHTS:3}},EG=new Uint8Array([0,255,255,255]),wG={pickingSelectedColor:null,pickingHighlightColor:EG,pickingActive:!1,pickingAttribute:!1};function TG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wG;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}const bG=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,xG=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,CG={name:"picking",vs:bG,fs:xG,getUniforms:TG},XP=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,SG={};function PG(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function YP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:SG;if(!("material"in t))return{};const{material:e}=t;return e?PG(e):{lighting_uEnabled:!1}}const Ov={name:"gouraud-lighting",dependencies:[Rv],vs:XP,defines:{LIGHTING_VERTEX:1},getUniforms:YP},JP={name:"phong-lighting",dependencies:[Rv],fs:XP,defines:{LIGHTING_FRAGMENT:1},getUniforms:YP},MG=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,IG=`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,Fv={name:"pbr",vs:MG,fs:IG,defines:{LIGHTING_FRAGMENT:1},dependencies:[Rv]},BG=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,LG={name:"transform",vs:BG,fs:null};class Iu{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Iu(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,h=this._getModuleList(e.modules),p=this._getHash(n),m=this._getHash(r),_=h.map(M=>this._getHash(M.name)).sort(),E=o.map(M=>this._getHash(M)),b=Object.keys(i).sort(),x=Object.keys(s).sort(),I=[],S=[];for(const M of b)I.push(this._getHash(M)),I.push(this._getHash(i[M]));for(const M of x)S.push(this._getHash(M)),S.push(this._getHash(s[M]));const P="".concat(p,"/").concat(m,"D").concat(I.join("/"),"M").concat(_.join("/"),"I").concat(S.join("/"),"V").concat(E.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[P]){const M=k5(this.gl,{vs:n,fs:r,modules:h,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[P]=new yP(this.gl,{hash:P,vs:M.vs,fs:M.fs,varyings:o,bufferMode:a}),this._getUniforms[P]=M.getUniforms||(O=>{}),this._useCounts[P]=0}return this._useCounts[P]++,this._programCache[P]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,n}}const RG={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function OG(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=FG(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const l=o.value,h={...o};delete h.value,r[a]=[new St(t,l),h],DG(s,h)}}if(i){const s=i.value||i;_e(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new St(t,{data:s,target:34963}),o]}return r}function FG(t,e){const{attributeMap:n=RG}=e||{};return n&&n[t]||t}function DG(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}_e(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Ra=2,kG=1e4,NG="Model needs drawMode and vertexCount",qw=()=>{},UG={};class tr{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Ri("model")}=n;_e(p0(e)),this.id=r,this.gl=e,this.id=n.id||Ri("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Iu.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:h,transpileToGLSL100:p}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:h,transpileToGLSL100:p},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},_e(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),NG)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:h,transpileToGLSL100:p}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:h,transpileToGLSL100:p},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return _e(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return _e(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=OG(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Wl(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return vv(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let h;Le.priority>=Ra&&(h=this._logDrawCallStart(Ra));const p=this.vertexArray.getDrawParams(),{isIndexed:m=p.isIndexed,indexType:_=p.indexType,indexOffset:E=p.indexOffset,vertexArrayInstanced:b=p.isInstanced}=this.props;b&&!this.isInstanced&&Le.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:x,instanceCount:I}=this,{onBeforeRender:S=qw,onAfterRender:P=qw}=this.props;S(),this.program.setUniforms(this.uniforms);const M=this.program.draw(Object.assign(UG,e,{logPriority:h,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:m,indexType:_,isInstanced:x,instanceCount:I,offset:m?E:0}));return P(),Le.priority>=Ra&&this._logDrawCallEnd(h,l,r),M}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Le.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:h,transpileToGLSL100:p}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:h,transpileToGLSL100:p}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}_e(n instanceof yP,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Z6(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof St&&n.delete()}}_setAnimationProps(e){this.animated&&_e(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Wl(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new vP(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:kG;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Le.group(Ra,">>> DRAWING MODEL ".concat(this.id),{collapsed:Le.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=t5({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=Fw({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:h,count:p}=Fw({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});p>0&&Le.log("MISSING UNIFORMS",Object.keys(h))(),l>0&&Le.log("UNUSED UNIFORMS",Object.keys(a))();const m=r5(this.vertexArray.configuration);Le.table(e,s)(),Le.table(e,o)(),Le.table(e+1,m)(),i&&i.log({logLevel:Ra,message:"Rendered to ".concat(i.id)}),Le.groupEnd(Ra)()}}class GG{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof St?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&_e(nt(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:l,accessor:h}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:l,accessor:h})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new vP(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],_e(r[s]instanceof St)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new St(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const zG="transform_uSampler_",Cd="transform_uSize_",eT="transform_position";function VG(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const l={};let h=e,p={};if(o>0||r){const m=h.split(`
`),_=m.slice();if(m.forEach((E,b,x)=>{if(o>0){const I=$G(E,n);if(I){const{updatedLine:S,inject:P}=I;_[b]=S,p=y1([p,P]),Object.assign(l,I.samplerTextureMap),o--}}r&&!a&&(a=QG(E,r))}),r){_e(i);const E="".concat(Cd).concat(r),b="uniform vec2 ".concat(E,`;
`),x="     vec2 ".concat(eT," = transform_getPos(").concat(E,`);
     gl_Position = vec4(`).concat(eT,`, 0, 1.);
`);p=y1([p,{"vs:#decl":b,"vs:#main-start":x}])}h=_.join(`
`)}return{vs:h,targetTextureType:a,inject:p,samplerTextureMap:l}}function HG(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(Cd).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(Cd).concat(a)]=[s,o];return i}function jG(t){return CP(t,["attribute","in"])}function WG(t){const e="".concat(zG).concat(t),n="".concat(Cd).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function QG(t,e){const n=CP(t,["varying","out"]);return n&&n.name===e?n.type:null}function $G(t,e){const n={},r=jG(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:l,uniformDeclerations:h}=WG(s),p=Q5(i),m="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(l,").").concat(p,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":h,"vs:#main-start":m},samplerTextureMap:n}}return null}const XG={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},YG="transform_output";class JG{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let h=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const m in this.samplerTextureMap){const _=this.samplerTextureMap[m];a[m]=r[_]}this._setSourceTextureParameters();const p=HG({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,p)}return this.hasTargetTexture&&(h=!1,l.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:h,parameters:l}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=m0(n);if(!e)return r;const i=r.constructor,s=$5(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let l=0;l<r.length;l+=4)for(let h=0;h<s;h++)o[a++]=r[l+h];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Hn)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new St(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{[36064]:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new mn(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{[36064]:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(XG)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=z8(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=VG({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),h=y1([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=l;const p=e._fs||SP({version:gP(i),input:this.targetTextureVarying,inputType:o,output:YG}),m=this.hasSourceTextures||this.targetTextureVarying?[LG].concat(e.modules||[]):e.modules;return{vs:i,fs:p,modules:m,uniforms:s,inject:h}}}class Dv{static isSupported(e){return nt(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();_e(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new tr(n,Object.assign({},e,{fs:e.fs||SP({version:gP(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){KG(n)&&(this.bufferTransform=new GG(e,n)),ZG(n)&&(this.textureTransform=new JG(e,n)),_e(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function KG(t){return!!(!Wl(t.feedbackBuffers)||!Wl(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function ZG(t){return!!(!Wl(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const tT={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Ar{static get DRAW_MODE(){return tT}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ri("geometry"),drawMode:r=tT.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,_e(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(_e(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(r=Math.min(r,o.length/a))}return _e(Number.isFinite(r)),r}}const qG=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ez=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),tz=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),nz=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),rz={POSITION:{size:3,value:new Float32Array(ez)},NORMAL:{size:3,value:new Float32Array(tz)},TEXCOORD_0:{size:2,value:new Float32Array(nz)}};class iz extends Ar{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ri("cube-geometry")}=e;super({...e,id:n,indices:{size:1,value:new Uint16Array(qG)},attributes:{...rz,...e.attributes}})}}let sz=1,oz=1;class KP{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=sz++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=oz++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const ZP="#define SMOOTH_EDGE_RADIUS 0.5",az=`
`.concat(ZP,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),lz=`
`.concat(ZP,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),cz={name:"geometry",vs:az,fs:lz},$e={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty($e,"IDENTITY",{get:()=>(Ve.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const xi={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Vr={common:0,meters:1,pixels:2},nT={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Bu={DRAW:"draw",MASK:"mask"},Az=Object.keys($e).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat($e[t],";")).join(""),uz=Object.keys(xi).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(xi[t],";")).join(""),fz=Object.keys(Vr).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Vr[t],";")).join(""),hz="".concat(Az,`
`).concat(uz,`
`).concat(fz,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0; // meters
const float GLOBE_RADIUS = 256.0;

// returns an adjustment factor for uCommonUnitsPerMeter
float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {

    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear
    // Adjust by 1 / cos(latitude)
    // If geometry.position (vertex in common space) is populated, use it
    // Otherwise use geometry.worldPosition (anchor in world space)
    
    if (geometry.position.w == 0.0) {
      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);
      return 1.0 / cos(radians(y));
    }

    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)
    // Taylor series of 1 / cos(latitude)
    // Max error < 0.003
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}
//
// Scaling offsets - scales meters to "world distance"
// Note the scalar version of project_size is for scaling the z component only
//
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}

// Get rotation matrix that aligns the z axis with the given up vector
// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  // Tangent on XY plane
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}

//
// Projecting normal - transform deltas from current coordinate system to
// normals in the worldspace
//
vec3 project_normal(vec3 vector) {
  // Apply model matrix
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

//
// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]
//
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

//
// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)
//
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;

  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size(position_world.z),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        // Too far from the projection center for offset mode to be accurate
        // Only use high parts
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.
    position_world.xyz -= project_uCoordinateOrigin;
  }

  // Translation is already added to the high parts
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}

//
// Projects from common space coordinates to clip space.
// Uses project_uViewProjectionMatrix
//
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}

// Returns a clip space offset that corresponds to a given number of screen pixels
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  // UNIT_PIXELS
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function dz(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Lu(t){let e={},n;return r=>{for(const i in r)if(!dz(r[i],e[i])){n=t(r),e=r;break}return n}}const rT=[0,0,0,0],pz=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],qP=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],gz=[0,0,0],eM=[0,0,0],mz=Lu(_z);function tM(t,e,n=eM){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===$e.LNGLAT_OFFSETS||e===$e.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case xi.WEB_MERCATOR:(e===$e.LNGLAT||e===$e.CARTESIAN)&&(i=[0,0,0],s=!1);break;case xi.WEB_MERCATOR_AUTO_OFFSET:e===$e.LNGLAT?r=i:e===$e.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case xi.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case xi.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function yz(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=rT,l=rT,h=t.cameraPosition;const{geospatialOrigin:p,shaderCoordinateOrigin:m,offsetMode:_}=tM(t,e,n);return _&&(l=t.projectPosition(p||m),h=[h[0]-l[0],h[1]-l[1],h[2]-l[2]],l[3]=1,a=ic([],l,o),s=r||s,o=Zo([],i,s),o=Zo([],o,pz)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:h,shaderCoordinateOrigin:m,geospatialOrigin:p}}function vz({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=$e.DEFAULT,coordinateOrigin:i=eM,autoWrapLongitude:s=!1}){r===$e.DEFAULT&&(r=t.isGeospatial?$e.LNGLAT:$e.CARTESIAN);const o=mz({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||qP,o}function _z({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:h}=yz(t,n,r),p=t.getDistanceScales(),m=[t.width*e,t.height*e],_=ic([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,E={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:m,project_uDevicePixelRatio:e,project_uFocalDistance:_,project_uCommonUnitsPerMeter:p.unitsPerMeter,project_uCommonUnitsPerWorldUnit:p.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:gz,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:qP,project_uCameraPosition:a};if(h){const b=t.getDistanceScales(h);switch(n){case $e.METER_OFFSETS:E.project_uCommonUnitsPerWorldUnit=b.unitsPerMeter,E.project_uCommonUnitsPerWorldUnit2=b.unitsPerMeter2;break;case $e.LNGLAT:case $e.LNGLAT_OFFSETS:t._pseudoMeters||(E.project_uCommonUnitsPerMeter=b.unitsPerMeter),E.project_uCommonUnitsPerWorldUnit=b.unitsPerDegree,E.project_uCommonUnitsPerWorldUnit2=b.unitsPerDegree2;break;case $e.CARTESIAN:E.project_uCommonUnitsPerWorldUnit=[1,1,b.unitsPerMeter[2]],E.project_uCommonUnitsPerWorldUnit2=[0,0,b.unitsPerMeter2[2]];break}}return E}const Ez={};function wz(t=Ez){return"viewport"in t?vz(t):{}}const kv={name:"project",dependencies:[J5,cz],vs:hz,getUniforms:wz},Tz=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,ci={name:"project32",dependencies:[kv],vs:Tz};function bz(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Pl(t,e){const n=ic([],e,t);return Lv(n,n,1/n[3]),n}function iT(t,e){const n=t%e;return n<0?e+n:n}function b1(t,e,n){return t<e?e:t>n?n:t}function xz(t){return Math.log(t)*Math.LOG2E}const Nv=Math.log2||xz;function Es(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Ci=Math.PI,nM=Ci/4,Bi=Ci/180,x1=180/Ci,qA=512,C1=4003e4,kf=85.051129,Cz=1.5;function Sz(t){return Nv(t)}function ho(t){const[e,n]=t;Es(Number.isFinite(e)),Es(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Bi,i=n*Bi,s=qA*(r+Ci)/(2*Ci),o=qA*(Ci+Math.log(Math.tan(nM+i*.5)))/(2*Ci);return[s,o]}function po(t){const[e,n]=t,r=e/qA*(2*Ci)-Ci,i=2*(Math.atan(Math.exp(n/qA*(2*Ci)-Ci))-nM);return[r*x1,i*x1]}function Pz(t){const{latitude:e}=t;Es(Number.isFinite(e));const n=Math.cos(e*Bi);return Sz(C1*n)-9}function S1(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Es(Number.isFinite(e)&&Number.isFinite(n));const i=qA,s=Math.cos(e*Bi),o=i/360,a=o/s,l=i/C1/s,h={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const p=Bi*Math.tan(e*Bi)/s,m=o*p/2,_=i/C1*p,E=_/a*l;h.unitsPerDegree2=[0,m,_],h.unitsPerMeter2=[E,0,E]}return h}function rM(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:h}=S1({longitude:n,latitude:r,highPrecision:!0}),p=ho(t);p[0]+=s*(l[0]+h[0]*o),p[1]+=o*(l[1]+h[1]*o);const m=po(p),_=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[m[0],m[1],_]:m}function Mz(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=bz();xd(a,a,[0,0,-i]),VP(a,a,-n*Bi),HP(a,a,r*Bi);const l=s/e;return Bv(a,a,[l,l,l]),o&&xd(a,a,dU([],o)),a}function Iz(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:h=1}=t;let{fovy:p=Sd(Cz)}=t;r!==void 0&&(p=Sd(r));const m=p*Bi,_=i*Bi,E=iM(p);let b=E;o&&(b+=o[2]*a/Math.cos(_)/n);const x=m*(.5+(s?s[1]:0)/n),I=Math.sin(x)*b/Math.sin(b1(Math.PI/2-_-x,.01,Math.PI-.01)),S=Math.sin(_)*I+b,P=b*10,M=Math.min(S*h,P);return{fov:m,aspect:e/n,focalDistance:E,near:l,far:M}}function Sd(t){return 2*Math.atan(.5/t)*x1}function iM(t){return .5/Math.tan(.5*t*Bi)}function sM(t,e){const[n,r,i=0]=t;return Es(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Pl(e,[n,r,i,1])}function v0(t,e,n=0){const[r,i,s]=t;if(Es(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Pl(e,[r,i,s,1]);const o=Pl(e,[r,i,0,1]),a=Pl(e,[r,i,1,1]),l=o[2],h=a[2],p=l===h?0:((n||0)-l)/(h-l);return MP([],o,a,p)}function oM(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[h,p]]=r,m=Bz(t.padding),_=ho([a,b1(p,-kf,kf)]),E=ho([h,b1(l,-kf,kf)]),b=[Math.max(Math.abs(E[0]-_[0]),i),Math.max(Math.abs(E[1]-_[1]),i)],x=[e-m.left-m.right-Math.abs(o[0])*2,n-m.top-m.bottom-Math.abs(o[1])*2];Es(x[0]>0&&x[1]>0);const I=x[0]/b[0],S=x[1]/b[1],P=(m.right-m.left)/2/I,M=(m.top-m.bottom)/2/S,O=[(E[0]+_[0])/2+P,(E[1]+_[1])/2+M],N=po(O),z=Math.min(s,Nv(Math.abs(Math.min(I,S))));return Es(Number.isFinite(z)),{longitude:N[0],latitude:N[1],zoom:z}}function Bz(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Es(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const sT=Math.PI/180;function Lz(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,h;const p=t.fovy?.5*t.fovy*sT:Math.atan(.5/t.altitude),m=(90-t.pitch)*sT;return p>m-.01?(l=oT(t,0,e),h=oT(t,n,e)):(l=i([0,0],s),h=i([n,0],s)),[o,a,h,l]}function oT(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Pl(r,[e,0,1,1]),s=Pl(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=MP([],i,s,a),h=po(l);return h.push(n),h}const aT=512;function Rz(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=iT(i+180,360)-180),(a<-180||a>180)&&(a=iT(a+180,360)-180);const l=Nv(n/aT);if(o<=l)o=l,s=0;else{const h=n/2/Math.pow(2,o),p=po([0,h])[1];if(s<p)s=p;else{const m=po([0,aT-h])[1];s>m&&(s=m)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const Oz=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,Fz=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,Dz=Lu(zz),kz=Lu(Vz),Nz=[0,0,0,1],Uz=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function Gz(t,e){const[n,r,i]=t,s=v0([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function zz({viewport:t,center:e}){return new Ye(t.viewProjectionMatrix).invert().transform(e)}function Vz({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>Gz(o,r));for(const o of e){const a=o.clone().translate(new ee(t.center).negate()),l=s.map(p=>a.transform(p)),h=new Ye().ortho({left:Math.min(...l.map(p=>p[0])),right:Math.max(...l.map(p=>p[0])),bottom:Math.min(...l.map(p=>p[1])),top:Math.max(...l.map(p=>p[1])),near:Math.min(...l.map(p=>-p[2])),far:Math.max(...l.map(p=>-p[2]))});n.push(h.multiplyRight(o))}return n}function Hz(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||Nz,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=Dz({viewport:t.viewport,center:e.project_uCenter}),s=[],o=kz({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],h=l.clone().translate(new ee(t.viewport.center).negate());e.project_uCoordinateSystem===$e.LNGLAT&&e.project_uProjectionMode===xi.WEB_MERCATOR?(o[a]=h,s[a]=i):(o[a]=l.clone().multiplyRight(Uz),s[a]=h.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const _g={name:"shadow",dependencies:[kv],vs:Oz,fs:Fz,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?Hz(t,e):{}},Ai={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...CG},jz=[kv],Wz=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Qz(t){const e=Iu.getDefaultProgramManager(t);for(const n of jz)e.addDefaultModule(n);for(const n of Wz)e.addShaderHook(n);return e}const $z=[255,255,255],Xz=1;let Yz=0;class aM{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","ambient");const{color:n=$z}=e,{intensity:r=Xz}=e;this.id=e.id||"ambient-".concat(Yz++),this.color=n,this.intensity=r}}const Jz=[255,255,255],Kz=1,Zz=[0,0,-1];let qz=0;class lT{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","directional"),T(this,"direction",void 0),T(this,"shadow",void 0);const{color:n=Jz}=e,{intensity:r=Kz}=e,{direction:i=Zz}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(qz++),this.color=n,this.intensity=r,this.type="directional",this.direction=new ee(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class e9{constructor(e,n={id:"pass"}){T(this,"id",void 0),T(this,"gl",void 0),T(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class _0 extends e9{constructor(...e){super(...e),T(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return _s(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const h=this.gl;l&&n9(h),a&&(this._lastRenderIndex=-1);const p=[];for(const m of i){const _=s&&s[m.id];o(m);const E=this._getDrawLayerParams(m,e),b=m.subViewports||[m];for(const x of b){const I=this._drawLayersInViewport(h,{target:n,moduleParameters:r,viewport:x,view:_,pass:e.pass,layers:e.layers},E);p.push(I)}}return p}_getDrawLayerParams(e,{layers:n,pass:r,layerFilter:i,cullRect:s,effects:o,moduleParameters:a}){const l=[],h=lM(this._lastRenderIndex+1),p={layer:n[0],viewport:e,isPicking:r.startsWith("picking"),renderPass:r,cullRect:s},m={};for(let _=0;_<n.length;_++){const E=n[_],b=this._shouldDrawLayer(E,p,i,m),x={shouldDrawLayer:b};b&&(x.layerRenderIndex=h(E,b),x.moduleParameters=this._getModuleParameters(E,o,r,a),x.layerParameters=this.getLayerParameters(E,_,e)),l[_]=x}return l}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const h=t9(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const m=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;oi(e,{scissorTest:!0,scissor:h},()=>vv(e,m))}const p={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};_s(e,{viewport:h});for(let m=0;m<n.length;m++){const _=n[m],{shouldDrawLayer:E,layerRenderIndex:b,moduleParameters:x,layerParameters:I}=l[m];if(E&&_.props.pickable&&p.pickableCount++,_.isComposite)p.compositeCount++;else if(E){p.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,b),x.viewport=o;try{_._drawLayer({moduleParameters:x,uniforms:{layerIndex:b},parameters:I})}catch(S){_.raiseError(S,"drawing ".concat(_," to ").concat(i))}}}return p}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:jl(this.gl)});if(n)for(const l of n){var a;Object.assign(o,(a=l.getModuleParameters)===null||a===void 0?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function lM(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let h;if(l&&!(l in e)&&r(i.parent,!1),l in n){const p=n[l]=n[l]||lM(e[l],e);h=p(i,s),n[a]=p}else Number.isFinite(o)?(h=o+(e[l]||0),n[a]=null):h=t;return s&&h>=t&&(t=h+1),e[a]=h,h};return r}function t9(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||jl(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function n9(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;_s(t,{viewport:[0,0,e,n]}),t.clear(16640)}class r9 extends _0{constructor(e,n){super(e,n),T(this,"shadowMap",void 0),T(this,"depthBuffer",void 0),T(this,"fbo",void 0),this.shadowMap=new Hn(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new al(e,{format:33189,width:1,height:1}),this.fbo=new mn(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;oi(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=jl(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const i9={color:[255,255,255],intensity:1},cT=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],s9=[0,0,0,200/255];class Uv{constructor(e={}){T(this,"id","lighting-effect"),T(this,"props",null),T(this,"shadowColor",s9),T(this,"shadow",void 0),T(this,"ambientLight",null),T(this,"directionalLights",[]),T(this,"pointLights",[]),T(this,"shadowPasses",[]),T(this,"shadowMaps",[]),T(this,"dummyShadowMap",null),T(this,"programManager",void 0),T(this,"shadowMatrices",void 0);for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow)}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(!!this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Iu.getDefaultProgramManager(e),_g&&this.programManager.addDefaultModule(_g)),this.dummyShadowMap||(this.dummyShadowMap=new Hn(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(_g),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Ye().lookAt({eye:new ee(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new r9(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new aM(i9),this.directionalLights.push(new lT(cT[0]),new lT(cT[1])))}}class o9{constructor(e={}){T(this,"_pool",[]),T(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const h=i||e&&e.constructor||Float32Array,p=n*r+s;if(ArrayBuffer.isView(e)){if(p<=e.length)return e;if(p*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new h(e.buffer,0,p)}let m=1/0;l&&(m=l*r+s);const _=this._allocate(h,p,a,m);return e&&o?_.set(e):a||_.fill(0,0,4),this._release(e),_}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(h=>h.byteLength>=a);if(l>=0){const h=new e(o.splice(l,1)[0],0,s);return r&&h.fill(0),h}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const $l=new o9;function iA(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function a9(t,e){const n=t%e;return n<0?e+n:n}function l9(t){return[t[12],t[13],t[14]]}function c9(t){return{left:Oa(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Oa(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Oa(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Oa(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Oa(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Oa(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const AT=new ee;function Oa(t,e,n,r){AT.set(t,e,n);const i=AT.len();return{distance:r/i,normal:new ee(-t/i,-e/i,-n/i)}}function A9(t){return t-Math.fround(t)}let Dc;function Eg(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Dc=$l.allocate(Dc,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const h=t[o++];Dc[a+l]=h,Dc[a+l+n]=A9(h)}a+=n*2}return Dc.subarray(0,s*n*2)}const u9=Math.PI/180,f9=iA(),uT=[0,0,0],h9={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function d9({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,h=n?new Ye().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new Ye().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:p=0,right:m=0,top:_=0,bottom:E=0}=s,b=On((p+t-m)/2,0,t)-t/2,x=On((_+e-E)/2,0,e)-e/2;h[8]-=b*2/t,h[9]+=x*2/e}return h}class _o{constructor(e={}){T(this,"id",void 0),T(this,"x",void 0),T(this,"y",void 0),T(this,"width",void 0),T(this,"height",void 0),T(this,"isGeospatial",void 0),T(this,"zoom",void 0),T(this,"focalDistance",void 0),T(this,"position",void 0),T(this,"modelMatrix",void 0),T(this,"distanceScales",void 0),T(this,"scale",void 0),T(this,"center",void 0),T(this,"cameraPosition",void 0),T(this,"projectionMatrix",void 0),T(this,"viewMatrix",void 0),T(this,"viewMatrixUncentered",void 0),T(this,"viewMatrixInverse",void 0),T(this,"viewProjectionMatrix",void 0),T(this,"pixelProjectionMatrix",void 0),T(this,"pixelUnprojectionMatrix",void 0),T(this,"resolution",void 0),T(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.distanceScales=e.distanceScales||h9,this.focalDistance=e.focalDistance||1,this.position=e.position||uT,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?xi.WEB_MERCATOR:xi.WEB_MERCATOR_AUTO_OFFSET:xi.IDENTITY}equals(e){return e instanceof _o?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ur(e.projectionMatrix,this.projectionMatrix)&&Ur(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=sM(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],h=v0([i,a,o],this.pixelUnprojectionMatrix,l),[p,m,_]=this.unprojectPosition(h);return Number.isFinite(o)?[p,m,_]:Number.isFinite(r)?[p,m,r]:[p,m]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=ho(e);return n[1]=On(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?po(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?S1({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,c9(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Pz({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||S1({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=uT;if(s&&(a=o?new Ye(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new ee(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=f9,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:h=null,focalDistance:p=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Ye().multiplyRight(n).translate(new ee(this.center).negate()),this.projectionMatrix=r||d9({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*u9,focalDistance:p,padding:h,near:a,far:l});const m=iA();Zo(m,m,this.projectionMatrix),Zo(m,m,this.viewMatrix),this.viewProjectionMatrix=m,this.viewMatrixInverse=w1([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=l9(this.viewMatrixInverse);const _=iA(),E=iA();Bv(_,_,[this.width/2,-this.height/2,1]),xd(_,_,[1,-1,0]),Zo(E,_,this.viewProjectionMatrix),this.pixelProjectionMatrix=E,this.pixelUnprojectionMatrix=w1(iA(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ve.warn("Pixel project matrix not invertible")()}}T(_o,"displayName","Viewport");const p9=512,g9=4003e4,m9=Math.PI/180;function fT(t){const e=Math.cos(t*m9);return p9/g9/e}class ns extends _o{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,orthographic:h=!1,projectionMatrix:p,repeat:m=!1,worldOffset:_=0,legacyMeterSizes:E=!1}=e;let{width:b,height:x,altitude:I=1.5}=e;const S=Math.pow(2,i);b=b||1,x=x||1;let P,M=null;p?(I=p[5]/2,P=Sd(I)):(e.fovy?(P=e.fovy,I=iM(P)):P=Sd(I),M=Iz({width:b,height:x,pitch:s,fovy:P,nearZMultiplier:a,farZMultiplier:l}));let O=Mz({height:x,pitch:s,bearing:o,scale:S,altitude:I});_&&(O=new Ye().translate([512*_,0,0]).multiplyLeft(O)),super({...e,width:b,height:x,viewMatrix:O,longitude:r,latitude:n,zoom:i,...M,fovy:P,focalDistance:I}),T(this,"longitude",void 0),T(this,"latitude",void 0),T(this,"pitch",void 0),T(this,"bearing",void 0),T(this,"altitude",void 0),T(this,"fovy",void 0),T(this,"orthographic",void 0),T(this,"_subViewports",void 0),T(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=I,this.fovy=P,this.orthographic=h,this._subViewports=m?[]:null,this._pseudoMeters=E,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new ns({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*fT(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/fT(r);return[n,r,i]}addMetersToLngLat(e,n){return rM(e,n)}panByPosition(e,n){const r=v0(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=bd([],i,PP([],r)),o=bd([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=Lz(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=oM({width:r,height:i,bounds:e,...n});return new ns({width:r,height:i,longitude:s,latitude:o,zoom:a})}}T(ns,"displayName","WebMercatorViewport");function wg(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof ns){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function y9(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===$e.DEFAULT&&(i=e.isGeospatial?$e.LNGLAT:$e.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function cM(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=ic([],[o,a,l,1],n)),r){case $e.LNGLAT:return wg([o,a,l],e,s);case $e.LNGLAT_OFFSETS:return wg([o+i[0],a+i[1],l+(i[2]||0)],e,s);case $e.METER_OFFSETS:return wg(rM(i,[o,a,l]),e,s);case $e.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function AM(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=y9(e),{geospatialOrigin:l,shaderCoordinateOrigin:h,offsetMode:p}=tM(n,r,i),m=cM(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:p});if(p){const _=n.projectPosition(l||h);UP(m,m,_)}return m}const v9=[255,255,255],_9=1,E9=[0,0,1],w9=[0,0,1];let T9=0;class b9{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","point"),T(this,"position",void 0),T(this,"attenuation",void 0),T(this,"projectedLight",void 0);const{color:n=v9}=e,{intensity:r=_9}=e,{position:i=w9}=e;this.id=e.id||"point-".concat(T9++),this.color=n,this.intensity=r,this.type="point",this.position=i,this.attenuation=x9(e),this.projectedLight={...this}}getProjectedLight({layer:e}){const{projectedLight:n}=this,r=e.context.viewport,{coordinateSystem:i,coordinateOrigin:s}=e.props,o=AM(this.position,{viewport:r,coordinateSystem:i,coordinateOrigin:s,fromCoordinateSystem:r.isGeospatial?$e.LNGLAT:$e.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=o,n}}function x9(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:E9}const $a={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Pd=Symbol.for("component"),Ml=Symbol.for("asyncPropDefaults"),aa=Symbol.for("asyncPropOriginal"),Zs=Symbol.for("asyncPropResolved");function E0(t,e=()=>!0){return Array.isArray(t)?uM(t,e,[]):e(t)?[t]:[]}function uM(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?uM(i,e,n):e(i)&&n.push(i)}return n}function C9({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class S9{constructor(e,n,r){T(this,"id",void 0),T(this,"context",void 0),T(this,"isLoaded",void 0),T(this,"persistent",void 0),T(this,"_loadCount",0),T(this,"_subscribers",new Set),T(this,"_data",void 0),T(this,"_loader",void 0),T(this,"_error",void 0),T(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=vs(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class P9{constructor({gl:e,protocol:n}){T(this,"protocol",void 0),T(this,"_context",void 0),T(this,"_resources",void 0),T(this,"_consumers",void 0),T(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new S9(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},l=a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const M9="layerManager.setLayers",I9="layerManager.activateViewport";class B9{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){T(this,"layers",void 0),T(this,"context",void 0),T(this,"resourceManager",void 0),T(this,"_lastRenderedLayers",[]),T(this,"_needsRedraw",!1),T(this,"_needsUpdate",!1),T(this,"_nextLayers",null),T(this,"_debug",!1),T(this,"activateViewport",o=>{Jn(I9,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new P9({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&Qz(e),stats:r||new bu({id:"deck.gl"}),viewport:i||new _o({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new KP,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Jn(M9,this,n,e),this._lastRenderedLayers=e;const r=E0(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?Ve.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&Ve.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=$a.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=$a.MATCHED,n!==e&&(e.lifecycle=$a.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=$a.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=$a.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function ya(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const r=t[n],i=e[n];if(!(r===i||Array.isArray(r)&&Array.isArray(i)&&ya(r,i)))return!1}return!0}class L9{constructor(e){T(this,"width",void 0),T(this,"height",void 0),T(this,"views",void 0),T(this,"viewState",void 0),T(this,"controllers",void 0),T(this,"timeline",void 0),T(this,"_viewports",void 0),T(this,"_viewportMap",void 0),T(this,"_isUpdating",void 0),T(this,"_needsRedraw",void 0),T(this,"_needsUpdate",void 0),T(this,"_eventManager",void 0),T(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=E0(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!ya(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Ve.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return i||(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const h=Boolean(s.controller);h&&!l&&(r=!0),(r||!h)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const R9=/([0-9]+\.?[0-9]*)(%|px)/;function ks(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=R9.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Ns(t,e){return t.relative?Math.round(t.position*e):t.position}function Rn(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class la{constructor(e){T(this,"id",void 0),T(this,"viewportInstance",void 0),T(this,"_x",void 0),T(this,"_y",void 0),T(this,"_width",void 0),T(this,"_height",void 0),T(this,"_padding",void 0),T(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:l}=e||{};Rn(!l||l instanceof _o),this.viewportInstance=l,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=ks(r),this._y=ks(i),this._width=ks(s),this._height=ks(o),this._padding=a&&{left:ks(a.left||0),right:ks(a.right||0),top:ks(a.top||0),bottom:ks(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&ya(this.props,e.props)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Ns(this._x,e),y:Ns(this._y,n),width:Ns(this._width,e),height:Ns(this._height,n)};return this._padding&&(r.padding={left:Ns(this._padding.left,e),top:Ns(this._padding.top,n),right:Ns(this._padding.right,e),bottom:Ns(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Ru{constructor(e){T(this,"_inProgress",void 0),T(this,"_handle",void 0),T(this,"_timeline",void 0),T(this,"time",void 0),T(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const hT=()=>{},P1={BREAK:1,SNAP_TO_END:2,IGNORE:3},O9=t=>t,F9=P1.BREAK;class D9{constructor(e){T(this,"getControllerState",void 0),T(this,"props",void 0),T(this,"propsInTransition",void 0),T(this,"transition",void 0),T(this,"onViewStateChange",void 0),T(this,"onStateChange",void 0),T(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,h=l(r/a),p=i.interpolateProps(s,o,h);this.propsInTransition=this.getControllerState({...this.props,...p}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Ru(e.timeline),this.onViewStateChange=e.onViewStateChange||hT,this.onStateChange=e.onStateChange||hT}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===P1.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&Boolean(r)}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===P1.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||O9,interpolator:s,interruption:n.transitionInterruption||F9,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class k9{constructor(e){T(this,"_propsToCompare",void 0),T(this,"_propsToExtract",void 0),T(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Ur(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(n=>{const r=e[n];Rn(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const N9=["longitude","latitude","zoom","bearing","pitch"],U9=["longitude","latitude","zoom"];class Gv extends k9{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:N9,required:U9},super(r.transitionProps),T(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Ii(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Ii(e.around,n.around,r)))}return i}}const Us={transitionDuration:0},G9=300,Nf=t=>1-(1-t)*(1-t),Fa={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Lo={};class fM{constructor(e){T(this,"props",void 0),T(this,"state",{}),T(this,"transitionManager",void 0),T(this,"eventManager",void 0),T(this,"onViewStateChange",void 0),T(this,"onStateChange",void 0),T(this,"makeViewport",void 0),T(this,"_controllerState",void 0),T(this,"_events",{}),T(this,"_interactionState",{isDragging:!1}),T(this,"_customEvents",[]),T(this,"_eventStartBlocked",null),T(this,"_panMove",!1),T(this,"invertPan",!1),T(this,"dragMode","rotate"),T(this,"inertia",0),T(this,"scrollZoom",!0),T(this,"dragPan",!0),T(this,"dragRotate",!0),T(this,"doubleClickZoom",!0),T(this,"touchZoom",!0),T(this,"touchRotate",!1),T(this,"keyboard",!0),this.transitionManager=new D9({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return Boolean(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?G9:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:h=!0}=e,p=Boolean(this.onViewStateChange);this.toggleEvents(Fa.WHEEL,p&&r),this.toggleEvents(Fa.PAN,p&&(i||s)),this.toggleEvents(Fa.PINCH,p&&(a||l)),this.toggleEvents(Fa.TRIPLE_PAN,p&&l),this.toggleEvents(Fa.DOUBLE_TAP,p&&o),this.toggleEvents(Fa.KEYBOARD,p&&h),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=h}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Us,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Us,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Nf},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Us,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Nf},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Us,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Us,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Nf},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Lo._startPinchRotation=e.rotation,Lo._lastPinchEvent=e,this.updateViewport(r,Us,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Lo._startPinchRotation-r})}return this.updateViewport(n,Us,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Lo._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Lo;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Nf},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Lo._startPinchRotation=null,Lo._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const h={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),h.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),h.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),h.isRotating=!0):(l=a.moveLeft(i),h.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),h.isRotating=!0):(l=a.moveRight(i),h.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),h.isRotating=!0):(l=a.moveUp(i),h.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),h.isRotating=!0):(l=a.moveDown(i),h.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),h),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Us:e?{...n,transitionInterpolator:new Gv({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class hM{constructor(e,n){T(this,"_viewportProps",void 0),T(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const dT=5,z9=1.2;class V9 extends hM{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:h=1.5,position:p=[0,0,0],maxZoom:m=20,minZoom:_=0,maxPitch:E=60,minPitch:b=0,startPanLngLat:x,startZoomLngLat:I,startRotatePos:S,startBearing:P,startPitch:M,startZoom:O,normalize:N=!0}=e;Rn(Number.isFinite(s)),Rn(Number.isFinite(i)),Rn(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:h,maxZoom:m,minZoom:_,maxPitch:E,minPitch:b,normalize:N,position:p},{startPanLngLat:x,startZoomLngLat:I,startRotatePos:S,startBearing:P,startPitch:M,startZoom:O}),T(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=On(l,a,o);const h=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...h.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=On(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=On(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,Rz(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:h,height:p}=this.getViewportProps(),m=s/h;let _=0;o>0?Math.abs(p-l)>dT&&(_=o/(l-p)*z9):o<0&&l>dT&&(_=1-a/l),_=On(_,-1,1);const{minPitch:E,maxPitch:b}=this.getViewportProps(),x=i+180*m;let I=r;return _>0?I=r+_*(b-r):_<0&&(I=r-_*(E-r)),{pitch:I,bearing:x}}}class H9 extends fM{constructor(...e){super(...e),T(this,"ControllerState",V9),T(this,"transition",{transitionDuration:300,transitionInterpolator:new Gv({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),T(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class dM extends la{get ViewportType(){return ns}get ControllerType(){return H9}}T(dM,"displayName","MapView");class j9 extends _0{constructor(e,n){super(e,n),T(this,"maskMap",void 0),T(this,"fbo",void 0);const{mapSize:r=2048}=n;this.maskMap=new Hn(e,{width:r,height:r,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.fbo=new mn(e,{id:"maskmap",width:r,height:r,attachments:{[36064]:this.maskMap}})}render(e){const n=this.gl,r=[!1,!1,!1,!1];return r[e.channel]=!0,oi(n,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:r,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return e.props.operation===Bu.MASK}delete(){this.fbo.delete(),this.maskMap.delete()}}const W9=new Ye().lookAt({eye:[0,0,1]});function Q9({width:t,height:e,near:n,far:r,padding:i}){let s=-t/2,o=t/2,a=-e/2,l=e/2;if(i){const{left:h=0,right:p=0,top:m=0,bottom:_=0}=i,E=On((h+t-p)/2,0,t)-t/2,b=On((m+e-_)/2,0,e)-e/2;s-=E,o-=E,a+=b,l+=b}return new Ye().ortho({left:s,right:o,bottom:a,top:l,near:n,far:r})}class $9 extends _o{constructor(e){const{width:n,height:r,near:i=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:l=null,flipY:h=!0}=e,p=Array.isArray(o)?o[0]:o,m=Array.isArray(o)?o[1]:o,_=Math.min(p,m),E=Math.pow(2,_);let b;if(p!==m){const x=Math.pow(2,p),I=Math.pow(2,m);b={unitsPerMeter:[x/E,I/E,1],metersPerUnit:[E/x,E/I,1]}}super({...e,longitude:void 0,position:a,viewMatrix:W9.clone().scale([E,E*(h?-1:1),E]),projectionMatrix:Q9({width:n||1,height:r||1,padding:l,near:i,far:s}),zoom:_,distanceScales:b})}projectFlat([e,n]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],n*r[1]]}unprojectFlat([e,n]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],n*r[1]]}panByPosition(e,n){const r=v0(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=bd([],i,PP([],r)),o=bd([],this.center,s);return{target:this.unprojectFlat(o)}}}class X9 extends hM{constructor(e){const{width:n,height:r,rotationX:i=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:l=-90,maxRotationX:h=90,minZoom:p=-1/0,maxZoom:m=1/0,startPanPosition:_,startRotatePos:E,startRotationX:b,startRotationOrbit:x,startZoomPosition:I,startZoom:S}=e;super({width:n,height:r,rotationX:i,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:h,minZoom:p,maxZoom:m},{startPanPosition:_,startRotatePos:E,startRotationX:b,startRotationOrbit:x,startZoomPosition:I,startZoom:S}),T(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:n}){const r=this.getState().startPanPosition||n;if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:l}=this.getViewportProps();if(!i||s===void 0||o===void 0)return this;let h;if(e){let p=(e[0]-i[0])/a;const m=(e[1]-i[1])/l;(s<-90||s>90)&&(p*=-1),h={rotationX:s+m*180,rotationOrbit:o+p*180}}else h={rotationX:s+r,rotationOrbit:o+n};return this._getUpdatedState(h)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:i}=r;return Math.abs(i-n.rotationOrbit)>180&&(r.rotationOrbit=i<0?i+360:i-360),r}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomPosition:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:r,startZoom:i}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);const s=n+Math.log2(e);return On(s,i,r)}_panFromCenter(e){const{width:n,height:r,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(i)?[On(i[0],r,n),On(i[1],r,n)]:On(i,r,n),e.rotationX=On(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=a9(a+180,360)-180),e}}class Y9 extends X9{constructor(e){super(e),T(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(n)){let[o,a]=n;switch(this.zoomAxis){case"X":o=On(o+s,i,r);break;case"Y":a=On(a+s,i,r);break;default:let l=Math.min(o+s,a+s);l<i&&(s+=i-l),l=Math.max(o+s,a+s),l>r&&(s+=r-l),o+=s,a+=s}return[o,a]}return On(n+s,i,r)}}class J9 extends fM{constructor(...e){super(...e),T(this,"ControllerState",Y9),T(this,"transition",{transitionDuration:300,transitionInterpolator:new Gv(["target","zoom"])}),T(this,"dragMode","pan")}_onPanRotate(){return!1}}class pM extends la{get ViewportType(){return $9}get ControllerType(){return J9}}T(pM,"displayName","OrthographicView");function K9({layers:t,viewport:e}){let n=null;for(const s of t){const o=s.getBounds();o&&(n?(n[0]=Math.min(n[0],o[0][0]),n[1]=Math.min(n[1],o[0][1]),n[2]=Math.max(n[2],o[1][0]),n[3]=Math.max(n[3],o[1][1])):n=[o[0][0],o[0][1],o[1][0],o[1][1]])}const r=e.getBounds();if(!n)return r;const i=q9(r);return n[2]-n[0]<i[2]-i[0]||n[3]-n[1]<i[3]-i[1]||(n[0]=Math.max(n[0],i[0]),n[1]=Math.max(n[1],i[1]),n[2]=Math.min(n[2],i[2]),n[3]=Math.min(n[3],i[3])),n}function Z9({bounds:t,viewport:e,width:n,height:r}){if(t[2]<=t[0]||t[3]<=t[1])return null;const i=1;if(n-=i*2,r-=i*2,e instanceof ns){const{longitude:a,latitude:l,zoom:h}=oM({width:n,height:r,bounds:[[t[0],t[1]],[t[2],t[3]]],maxZoom:20});return new ns({longitude:a,latitude:l,zoom:h,x:i,y:i,width:n,height:r})}const s=[(t[0]+t[2])/2,(t[1]+t[3])/2,0],o=Math.min(20,n/(t[2]-t[0]),r/(t[3]-t[1]));return new pM({x:i,y:i}).makeViewport({width:n,height:r,viewState:{target:s,zoom:Math.log2(o)}})}function q9(t){const e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}class eV{constructor(){T(this,"id","mask-effect"),T(this,"props",null),T(this,"useInPicking",!0),T(this,"dummyMaskMap",void 0),T(this,"channels",[]),T(this,"masks",null),T(this,"maskPass",void 0),T(this,"maskMap",void 0),T(this,"lastViewport",void 0)}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new Hn(e,{width:1,height:1}));const a=n.filter(m=>m.props.visible&&m.props.operation===Bu.MASK);if(a.length===0){this.masks=null,this.channels.length=0;return}this.masks={},this.maskPass||(this.maskPass=new j9(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const l=this._sortMaskChannels(a),h=i[0],p=!this.lastViewport||!this.lastViewport.equals(h);for(const m in l)this._renderChannel(l[m],{layerFilter:r,onViewportActive:s,views:o,viewport:h,viewportChanged:p})}_renderChannel(e,{layerFilter:n,onViewportActive:r,views:i,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const l=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((h,p)=>h!==a.layerBounds[p]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(l||o)&&(this.lastViewport=s,e.bounds=K9({layers:e.layers,viewport:s}),l||!Ur(e.bounds,a.bounds))){const{maskPass:h,maskMap:p}=this,m=Z9({bounds:e.bounds,viewport:s,width:p.width,height:p.height});e.maskBounds=m?m.getBounds():[0,0,1,1],h.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:n,viewports:m?[m]:[],onViewportActive:r,views:i,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const n={};let r=0;for(const i of e){const{id:s}=i.root;let o=n[s];if(!o){if(++r>4){Ve.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>(a==null?void 0:a.id)===s),layers:[],layerBounds:[],coordinateOrigin:i.root.props.coordinateOrigin,coordinateSystem:i.root.props.coordinateSystem},n[s]=o}o.layers.push(i),o.layerBounds.push(i.getBounds())}for(let i=0;i<4;i++){const s=this.channels[i];(!s||!(s.id in n))&&(this.channels[i]=null)}for(const i in n){const s=n[i];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return n}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const tV=new Uv;class nV{constructor(){T(this,"effects",void 0),T(this,"_internalEffects",void 0),T(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!ya(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new eV),e.some(n=>n instanceof Uv)||this._internalEffects.push(tV)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class rV extends _0{shouldDrawLayer(e){return e.props.operation===Bu.DRAW}}const pT={blendFunc:[1,0,32771,0],blendEquation:32774};class gM extends _0{constructor(...e){super(...e),T(this,"pickZ",void 0),T(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:h,height:p},cullRect:m,effects:_,pass:E="picking",pickZ:b}){const x=this.gl;this.pickZ=b;const I=b?null:{byLayer:new Map,byAlpha:[]};this._colors=I;const S=oi(x,{scissorTest:!0,scissor:[a,l,h,p],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...pT,blend:!b},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:m,effects:_==null?void 0:_.filter(M=>M.useInPicking),pass:E}));return this._colors=null,{decodePickingColor:I&&sV.bind(null,I),stats:S}}shouldDrawLayer(e){return e.props.pickable&&e.props.operation===Bu.DRAW}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters};return this._colors?(Object.assign(i,pT),i.blend=!0,i.blendColor=iV(this._colors,e,r)):i.blend=!1,i}}function iV(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(Ve.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function sV(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const oV="deckRenderer.renderLayers";class aV{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new rV(e),this.pickLayersPass=new gM(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||mn.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const r=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,i=n.render({...e,target:r});this._postRender(e.effects,e),this.renderCount++,Jn(oV,this,i,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){let r=null;for(const i of e)i.preRender(this.gl,n),i.postRender&&(r=i);r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new mn(this.gl),new mn(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const lV={pickedColor:null,pickedObjectIndex:-1};function cV({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:h}=s;let p=i*i,m=-1,_=0;for(let E=0;E<h;E++){const b=E+a-r,x=b*b;if(x>p)_+=4*l;else for(let I=0;I<l;I++){if(t[_+3]-1>=0){const P=I+o-n,M=P*P+x;M<=p&&(p=M,m=_)}_+=4}}if(m>=0){const E=t.slice(m,m+4),b=e(E);if(b){const x=Math.floor(m/4/l),I=m/4-x*l;return{...b,pickedColor:E,pickedX:o+I,pickedY:a+x}}Ve.error("Picked non-existent layer. Is picking buffer corrupt?")()}return lV}function AV({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):Ve.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function mM({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=fV((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function uV(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const m=n.index,_=n.layerId,E=o?o.props.id:null;if(E!==_||a!==m){if(E!==_){const b=i.find(x=>x.props.id===_);b&&l.unshift(b)}n.layerId=E,n.index=a,n.info=null}}const h=mM(t),p=new Map;return p.set(null,h),l.forEach(m=>{let _={...h};m===o&&(_.color=s,_.index=a,_.picked=!0),_=yM({layer:m,info:_,mode:r});const E=_.layer;m===o&&r==="hover"&&(n.info=_),p.set(E.id,_),r==="hover"&&E.updateAutoHighlight(_)}),p}function yM({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function fV(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class hV{constructor(e){T(this,"gl",void 0),T(this,"pickingFBO",void 0),T(this,"depthFBO",void 0),T(this,"pickLayersPass",void 0),T(this,"layerFilter",void 0),T(this,"lastPickedInfo",void 0),T(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new gM(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(_=>_.id===o):null,h=a&&i.find(_=>_.id===a)||i[0],p=h&&h.unproject([e-h.x,n-h.y]);return{...s,...{x:e,y:n,viewport:h,coordinate:p,layer:l}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new mn(r),mn.isSupported(r,{colorBufferFloat:!0}))){const i=new mn(r);i.attach({[36064]:new Hn(r,{format:nt(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>r.isPickable()&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:h,onViewportActive:p,effects:m}){const _=this._getPickable(e),E=jl(this.gl);if(!_)return{result:[],emptyInfo:mM({viewports:r,x:i,y:s,pixelRatio:E})};this._resizeBuffer();const b=og(this.gl,[i,s],!0),x=[b.x+Math.floor(b.width/2),b.y+Math.floor(b.height/2)],I=Math.round(o*E),{width:S,height:P}=this.pickingFBO,M=this._getPickingRect({deviceX:x[0],deviceY:x[1],deviceRadius:I,deviceWidth:S,deviceHeight:P}),O={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let N;const z=[],X=new Set;for(let Z=0;Z<a;Z++){let Q;if(M){const D=this._drawAndSample({layers:_,views:n,viewports:r,onViewportActive:p,deviceRect:M,cullRect:O,effects:m,pass:"picking:".concat(l)});Q=cV({...D,deviceX:x[0],deviceY:x[1],deviceRadius:I,deviceRect:M})}else Q={pickedColor:null,pickedObjectIndex:-1};let k;Q.pickedLayer&&h&&this.depthFBO&&(k=this._drawAndSample({layers:[Q.pickedLayer],views:n,viewports:r,onViewportActive:p,deviceRect:{x:Q.pickedX,y:Q.pickedY,width:1,height:1},cullRect:O,effects:m,pass:"picking:".concat(l,":z")},!0).pickedColors[0]),Q.pickedLayer&&Z+1<a&&(X.add(Q.pickedLayer),Q.pickedLayer.disablePickingIndex(Q.pickedObjectIndex)),N=uV({pickInfo:Q,lastPickedInfo:this.lastPickedInfo,mode:l,layers:_,viewports:r,x:i,y:s,z:k,pixelRatio:E});for(const D of N.values())D.layer&&z.push(D);if(!Q.pickedColor)break}for(const Z of X)Z.restorePickingColors();return{result:z,emptyInfo:N.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:h=null,onViewportActive:p,effects:m}){const _=this._getPickable(e);if(!_)return[];this._resizeBuffer();const E=jl(this.gl),b=og(this.gl,[i,s],!0),x=b.x,I=b.y+b.height,S=og(this.gl,[i+o,s+a],!0),P=S.x+S.width,M=S.y,O={x,y:M,width:P-x,height:I-M},N=this._drawAndSample({layers:_,views:n,viewports:r,onViewportActive:p,deviceRect:O,cullRect:{x:i,y:s,width:o,height:a},effects:m,pass:"picking:".concat(l)}),z=AV(N),X=new Map,Z=Number.isFinite(h);for(let Q=0;Q<z.length&&!(Z&&h&&X.size>=h);Q++){const k=z[Q];let D={color:k.pickedColor,layer:null,index:k.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:E};D=yM({layer:k.pickedLayer,info:D,mode:l}),X.has(D.object)||X.set(D.object,D)}return Array.from(X.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},h=!1){const p=h?this.depthFBO:this.pickingFBO,{decodePickingColor:m}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:p,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:h}),{x:_,y:E,width:b,height:x}=s,I=new(h?Float32Array:Uint8Array)(b*x*4);return m0(p,{sourceX:_,sourceY:E,sourceWidth:b,sourceHeight:x,target:I}),{pickedColors:I,decodePickingColor:m}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,h=Math.min(s,n+r+1)-a;return l<=0||h<=0?null:{x:o,y:a,width:l,height:h}}}const dV={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class pV{constructor(e){T(this,"el",null),T(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,dV),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(!!i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var sc={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,h=Math.abs,p=Date.now;function m(R,F,H){return setTimeout(M(R,H),F)}function _(R,F,H){return Array.isArray(R)?(E(R,H[F],H),!0):!1}function E(R,F,H){var q;if(!!R)if(R.forEach)R.forEach(F,H);else if(R.length!==i)for(q=0;q<R.length;)F.call(H,R[q],q,R),q++;else for(q in R)R.hasOwnProperty(q)&&F.call(H,R[q],q,R)}function b(R,F,H){var q="DEPRECATED METHOD: "+F+`
`+H+` AT 
`;return function(){var ce=new Error("get-stack-trace"),Se=ce&&ce.stack?ce.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",rt=e.console&&(e.console.warn||e.console.log);return rt&&rt.call(e.console,q,Se),R.apply(this,arguments)}}var x;typeof Object.assign!="function"?x=function(F){if(F===i||F===null)throw new TypeError("Cannot convert undefined or null to object");for(var H=Object(F),q=1;q<arguments.length;q++){var ce=arguments[q];if(ce!==i&&ce!==null)for(var Se in ce)ce.hasOwnProperty(Se)&&(H[Se]=ce[Se])}return H}:x=Object.assign;var I=b(function(F,H,q){for(var ce=Object.keys(H),Se=0;Se<ce.length;)(!q||q&&F[ce[Se]]===i)&&(F[ce[Se]]=H[ce[Se]]),Se++;return F},"extend","Use `assign`."),S=b(function(F,H){return I(F,H,!0)},"merge","Use `assign`.");function P(R,F,H){var q=F.prototype,ce;ce=R.prototype=Object.create(q),ce.constructor=R,ce._super=q,H&&x(ce,H)}function M(R,F){return function(){return R.apply(F,arguments)}}function O(R,F){return typeof R==a?R.apply(F&&F[0]||i,F):R}function N(R,F){return R===i?F:R}function z(R,F,H){E(k(F),function(q){R.addEventListener(q,H,!1)})}function X(R,F,H){E(k(F),function(q){R.removeEventListener(q,H,!1)})}function Z(R,F){for(;R;){if(R==F)return!0;R=R.parentNode}return!1}function Q(R,F){return R.indexOf(F)>-1}function k(R){return R.trim().split(/\s+/g)}function D(R,F,H){if(R.indexOf&&!H)return R.indexOf(F);for(var q=0;q<R.length;){if(H&&R[q][H]==F||!H&&R[q]===F)return q;q++}return-1}function ne(R){return Array.prototype.slice.call(R,0)}function se(R,F,H){for(var q=[],ce=[],Se=0;Se<R.length;){var rt=F?R[Se][F]:R[Se];D(ce,rt)<0&&q.push(R[Se]),ce[Se]=rt,Se++}return H&&(F?q=q.sort(function(Je,vn){return Je[F]>vn[F]}):q=q.sort()),q}function oe(R,F){for(var H,q,ce=F[0].toUpperCase()+F.slice(1),Se=0;Se<s.length;){if(H=s[Se],q=H?H+ce:F,q in R)return q;Se++}return i}var xe=1;function Pe(){return xe++}function Ue(R){var F=R.ownerDocument||R;return F.defaultView||F.parentWindow||e}var le=/mobile|tablet|ip(ad|hone|od)|android/i,ve="ontouchstart"in e,Ce=oe(e,"PointerEvent")!==i,Fe=ve&&le.test(navigator.userAgent),ke="touch",it="pen",Rt="mouse",Pn="kinect",un=25,Tt=1,Ut=2,ot=4,Gt=8,zt=1,Mn=2,In=4,jn=8,kn=16,yn=Mn|In,on=jn|kn,rr=yn|on,$r=["x","y"],ir=["clientX","clientY"];function vt(R,F){var H=this;this.manager=R,this.callback=F,this.element=R.element,this.target=R.options.inputTarget,this.domHandler=function(q){O(R.options.enable,[R])&&H.handler(q)},this.init()}vt.prototype={handler:function(){},init:function(){this.evEl&&z(this.element,this.evEl,this.domHandler),this.evTarget&&z(this.target,this.evTarget,this.domHandler),this.evWin&&z(Ue(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&X(this.element,this.evEl,this.domHandler),this.evTarget&&X(this.target,this.evTarget,this.domHandler),this.evWin&&X(Ue(this.element),this.evWin,this.domHandler)}};function Xr(R){var F,H=R.options.inputClass;return H?F=H:Ce?F=ge:Fe?F=xo:ve?F=J:F=va,new F(R,fi)}function fi(R,F,H){var q=H.pointers.length,ce=H.changedPointers.length,Se=F&Tt&&q-ce===0,rt=F&(ot|Gt)&&q-ce===0;H.isFirst=!!Se,H.isFinal=!!rt,Se&&(R.session={}),H.eventType=F,pe(R,H),R.emit("hammer.input",H),R.recognize(H),R.session.prevInput=H}function pe(R,F){var H=R.session,q=F.pointers,ce=q.length;H.firstInput||(H.firstInput=et(F)),ce>1&&!H.firstMultiple?H.firstMultiple=et(F):ce===1&&(H.firstMultiple=!1);var Se=H.firstInput,rt=H.firstMultiple,fn=rt?rt.center:Se.center,Je=F.center=We(q);F.timeStamp=p(),F.deltaTime=F.timeStamp-Se.timeStamp,F.angle=at(fn,Je),F.distance=Vt(fn,Je),Oe(H,F),F.offsetDirection=Me(F.deltaX,F.deltaY);var vn=lt(F.deltaTime,F.deltaX,F.deltaY);F.overallVelocityX=vn.x,F.overallVelocityY=vn.y,F.overallVelocity=h(vn.x)>h(vn.y)?vn.x:vn.y,F.scale=rt?Ps(rt.pointers,q):1,F.rotation=rt?sr(rt.pointers,q):0,F.maxPointers=H.prevInput?F.pointers.length>H.prevInput.maxPointers?F.pointers.length:H.prevInput.maxPointers:F.pointers.length,Xe(H,F);var Sr=R.element;Z(F.srcEvent.target,Sr)&&(Sr=F.srcEvent.target),F.target=Sr}function Oe(R,F){var H=F.center,q=R.offsetDelta||{},ce=R.prevDelta||{},Se=R.prevInput||{};(F.eventType===Tt||Se.eventType===ot)&&(ce=R.prevDelta={x:Se.deltaX||0,y:Se.deltaY||0},q=R.offsetDelta={x:H.x,y:H.y}),F.deltaX=ce.x+(H.x-q.x),F.deltaY=ce.y+(H.y-q.y)}function Xe(R,F){var H=R.lastInterval||F,q=F.timeStamp-H.timeStamp,ce,Se,rt,fn;if(F.eventType!=Gt&&(q>un||H.velocity===i)){var Je=F.deltaX-H.deltaX,vn=F.deltaY-H.deltaY,Sr=lt(q,Je,vn);Se=Sr.x,rt=Sr.y,ce=h(Sr.x)>h(Sr.y)?Sr.x:Sr.y,fn=Me(Je,vn),R.lastInterval=F}else ce=H.velocity,Se=H.velocityX,rt=H.velocityY,fn=H.direction;F.velocity=ce,F.velocityX=Se,F.velocityY=rt,F.direction=fn}function et(R){for(var F=[],H=0;H<R.pointers.length;)F[H]={clientX:l(R.pointers[H].clientX),clientY:l(R.pointers[H].clientY)},H++;return{timeStamp:p(),pointers:F,center:We(F),deltaX:R.deltaX,deltaY:R.deltaY}}function We(R){var F=R.length;if(F===1)return{x:l(R[0].clientX),y:l(R[0].clientY)};for(var H=0,q=0,ce=0;ce<F;)H+=R[ce].clientX,q+=R[ce].clientY,ce++;return{x:l(H/F),y:l(q/F)}}function lt(R,F,H){return{x:F/R||0,y:H/R||0}}function Me(R,F){return R===F?zt:h(R)>=h(F)?R<0?Mn:In:F<0?jn:kn}function Vt(R,F,H){H||(H=$r);var q=F[H[0]]-R[H[0]],ce=F[H[1]]-R[H[1]];return Math.sqrt(q*q+ce*ce)}function at(R,F,H){H||(H=$r);var q=F[H[0]]-R[H[0]],ce=F[H[1]]-R[H[1]];return Math.atan2(ce,q)*180/Math.PI}function sr(R,F){return at(F[1],F[0],ir)+at(R[1],R[0],ir)}function Ps(R,F){return Vt(F[0],F[1],ir)/Vt(R[0],R[1],ir)}var rp={mousedown:Tt,mousemove:Ut,mouseup:ot},ju="mousedown",ip="mousemove mouseup";function va(){this.evEl=ju,this.evWin=ip,this.pressed=!1,vt.apply(this,arguments)}P(va,vt,{handler:function(F){var H=rp[F.type];H&Tt&&F.button===0&&(this.pressed=!0),H&Ut&&F.which!==1&&(H=ot),this.pressed&&(H&ot&&(this.pressed=!1),this.callback(this.manager,H,{pointers:[F],changedPointers:[F],pointerType:Rt,srcEvent:F}))}});var sp={pointerdown:Tt,pointermove:Ut,pointerup:ot,pointercancel:Gt,pointerout:Gt},uc={2:ke,3:it,4:Rt,5:Pn},Wu="pointerdown",Qu="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Wu="MSPointerDown",Qu="MSPointerMove MSPointerUp MSPointerCancel");function ge(){this.evEl=Wu,this.evWin=Qu,vt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}P(ge,vt,{handler:function(F){var H=this.store,q=!1,ce=F.type.toLowerCase().replace("ms",""),Se=sp[ce],rt=uc[F.pointerType]||F.pointerType,fn=rt==ke,Je=D(H,F.pointerId,"pointerId");Se&Tt&&(F.button===0||fn)?Je<0&&(H.push(F),Je=H.length-1):Se&(ot|Gt)&&(q=!0),!(Je<0)&&(H[Je]=F,this.callback(this.manager,Se,{pointers:H,changedPointers:[F],pointerType:rt,srcEvent:F}),q&&H.splice(Je,1))}});var op={touchstart:Tt,touchmove:Ut,touchend:ot,touchcancel:Gt},$u="touchstart",ap="touchstart touchmove touchend touchcancel";function Xu(){this.evTarget=$u,this.evWin=ap,this.started=!1,vt.apply(this,arguments)}P(Xu,vt,{handler:function(F){var H=op[F.type];if(H===Tt&&(this.started=!0),!!this.started){var q=fc.call(this,F,H);H&(ot|Gt)&&q[0].length-q[1].length===0&&(this.started=!1),this.callback(this.manager,H,{pointers:q[0],changedPointers:q[1],pointerType:ke,srcEvent:F})}}});function fc(R,F){var H=ne(R.touches),q=ne(R.changedTouches);return F&(ot|Gt)&&(H=se(H.concat(q),"identifier",!0)),[H,q]}var Yu={touchstart:Tt,touchmove:Ut,touchend:ot,touchcancel:Gt},Ju="touchstart touchmove touchend touchcancel";function xo(){this.evTarget=Ju,this.targetIds={},vt.apply(this,arguments)}P(xo,vt,{handler:function(F){var H=Yu[F.type],q=_a.call(this,F,H);!q||this.callback(this.manager,H,{pointers:q[0],changedPointers:q[1],pointerType:ke,srcEvent:F})}});function _a(R,F){var H=ne(R.touches),q=this.targetIds;if(F&(Tt|Ut)&&H.length===1)return q[H[0].identifier]=!0,[H,H];var ce,Se,rt=ne(R.changedTouches),fn=[],Je=this.target;if(Se=H.filter(function(vn){return Z(vn.target,Je)}),F===Tt)for(ce=0;ce<Se.length;)q[Se[ce].identifier]=!0,ce++;for(ce=0;ce<rt.length;)q[rt[ce].identifier]&&fn.push(rt[ce]),F&(ot|Gt)&&delete q[rt[ce].identifier],ce++;if(!!fn.length)return[se(Se.concat(fn),"identifier",!0),fn]}var hc=2500,Fi=25;function J(){vt.apply(this,arguments);var R=M(this.handler,this);this.touch=new xo(this.manager,R),this.mouse=new va(this.manager,R),this.primaryTouch=null,this.lastTouches=[]}P(J,vt,{handler:function(F,H,q){var ce=q.pointerType==ke,Se=q.pointerType==Rt;if(!(Se&&q.sourceCapabilities&&q.sourceCapabilities.firesTouchEvents)){if(ce)ae.call(this,H,q);else if(Se&&Ge.call(this,q))return;this.callback(F,H,q)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ae(R,F){R&Tt?(this.primaryTouch=F.changedPointers[0].identifier,me.call(this,F)):R&(ot|Gt)&&me.call(this,F)}function me(R){var F=R.changedPointers[0];if(F.identifier===this.primaryTouch){var H={x:F.clientX,y:F.clientY};this.lastTouches.push(H);var q=this.lastTouches,ce=function(){var Se=q.indexOf(H);Se>-1&&q.splice(Se,1)};setTimeout(ce,hc)}}function Ge(R){for(var F=R.srcEvent.clientX,H=R.srcEvent.clientY,q=0;q<this.lastTouches.length;q++){var ce=this.lastTouches[q],Se=Math.abs(F-ce.x),rt=Math.abs(H-ce.y);if(Se<=Fi&&rt<=Fi)return!0}return!1}var u=oe(o.style,"touchAction"),G=u!==i,At="compute",ht="auto",Ze="manipulation",tt="none",Ht="pan-x",ut="pan-y",st=Ea();function an(R,F){this.manager=R,this.set(F)}an.prototype={set:function(R){R==At&&(R=this.compute()),G&&this.manager.element.style&&st[R]&&(this.manager.element.style[u]=R),this.actions=R.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var R=[];return E(this.manager.recognizers,function(F){O(F.options.enable,[F])&&(R=R.concat(F.getTouchAction()))}),Di(R.join(" "))},preventDefaults:function(R){var F=R.srcEvent,H=R.offsetDirection;if(this.manager.session.prevented){F.preventDefault();return}var q=this.actions,ce=Q(q,tt)&&!st[tt],Se=Q(q,ut)&&!st[ut],rt=Q(q,Ht)&&!st[Ht];if(ce){var fn=R.pointers.length===1,Je=R.distance<2,vn=R.deltaTime<250;if(fn&&Je&&vn)return}if(!(rt&&Se)&&(ce||Se&&H&yn||rt&&H&on))return this.preventSrc(F)},preventSrc:function(R){this.manager.session.prevented=!0,R.preventDefault()}};function Di(R){if(Q(R,tt))return tt;var F=Q(R,Ht),H=Q(R,ut);return F&&H?tt:F||H?F?Ht:ut:Q(R,Ze)?Ze:ht}function Ea(){if(!G)return!1;var R={},F=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(H){R[H]=F?e.CSS.supports("touch-action",H):!0}),R}var Ms=1,jt=2,hi=4,Bn=8,di=Bn,xr=16,De=32;function j(R){this.options=x({},this.defaults,R||{}),this.id=Pe(),this.manager=null,this.options.enable=N(this.options.enable,!0),this.state=Ms,this.simultaneous={},this.requireFail=[]}j.prototype={defaults:{},set:function(R){return x(this.options,R),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(R){if(_(R,"recognizeWith",this))return this;var F=this.simultaneous;return R=wa(R,this),F[R.id]||(F[R.id]=R,R.recognizeWith(this)),this},dropRecognizeWith:function(R){return _(R,"dropRecognizeWith",this)?this:(R=wa(R,this),delete this.simultaneous[R.id],this)},requireFailure:function(R){if(_(R,"requireFailure",this))return this;var F=this.requireFail;return R=wa(R,this),D(F,R)===-1&&(F.push(R),R.requireFailure(this)),this},dropRequireFailure:function(R){if(_(R,"dropRequireFailure",this))return this;R=wa(R,this);var F=D(this.requireFail,R);return F>-1&&this.requireFail.splice(F,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(R){return!!this.simultaneous[R.id]},emit:function(R){var F=this,H=this.state;function q(ce){F.manager.emit(ce,R)}H<Bn&&q(F.options.event+dt(H)),q(F.options.event),R.additionalEvent&&q(R.additionalEvent),H>=Bn&&q(F.options.event+dt(H))},tryEmit:function(R){if(this.canEmit())return this.emit(R);this.state=De},canEmit:function(){for(var R=0;R<this.requireFail.length;){if(!(this.requireFail[R].state&(De|Ms)))return!1;R++}return!0},recognize:function(R){var F=x({},R);if(!O(this.options.enable,[this,F])){this.reset(),this.state=De;return}this.state&(di|xr|De)&&(this.state=Ms),this.state=this.process(F),this.state&(jt|hi|Bn|xr)&&this.tryEmit(F)},process:function(R){},getTouchAction:function(){},reset:function(){}};function dt(R){return R&xr?"cancel":R&Bn?"end":R&hi?"move":R&jt?"start":""}function dc(R){return R==kn?"down":R==jn?"up":R==Mn?"left":R==In?"right":""}function wa(R,F){var H=F.manager;return H?H.get(R):R}function Cr(){j.apply(this,arguments)}P(Cr,j,{defaults:{pointers:1},attrTest:function(R){var F=this.options.pointers;return F===0||R.pointers.length===F},process:function(R){var F=this.state,H=R.eventType,q=F&(jt|hi),ce=this.attrTest(R);return q&&(H&Gt||!ce)?F|xr:q||ce?H&ot?F|Bn:F&jt?F|hi:jt:De}});function Ta(){Cr.apply(this,arguments),this.pX=null,this.pY=null}P(Ta,Cr,{defaults:{event:"pan",threshold:10,pointers:1,direction:rr},getTouchAction:function(){var R=this.options.direction,F=[];return R&yn&&F.push(ut),R&on&&F.push(Ht),F},directionTest:function(R){var F=this.options,H=!0,q=R.distance,ce=R.direction,Se=R.deltaX,rt=R.deltaY;return ce&F.direction||(F.direction&yn?(ce=Se===0?zt:Se<0?Mn:In,H=Se!=this.pX,q=Math.abs(R.deltaX)):(ce=rt===0?zt:rt<0?jn:kn,H=rt!=this.pY,q=Math.abs(R.deltaY))),R.direction=ce,H&&q>F.threshold&&ce&F.direction},attrTest:function(R){return Cr.prototype.attrTest.call(this,R)&&(this.state&jt||!(this.state&jt)&&this.directionTest(R))},emit:function(R){this.pX=R.deltaX,this.pY=R.deltaY;var F=dc(R.direction);F&&(R.additionalEvent=this.options.event+F),this._super.emit.call(this,R)}});function pc(){Cr.apply(this,arguments)}P(pc,Cr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(R){return this._super.attrTest.call(this,R)&&(Math.abs(R.scale-1)>this.options.threshold||this.state&jt)},emit:function(R){if(R.scale!==1){var F=R.scale<1?"in":"out";R.additionalEvent=this.options.event+F}this._super.emit.call(this,R)}});function U(){j.apply(this,arguments),this._timer=null,this._input=null}P(U,j,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ht]},process:function(R){var F=this.options,H=R.pointers.length===F.pointers,q=R.distance<F.threshold,ce=R.deltaTime>F.time;if(this._input=R,!q||!H||R.eventType&(ot|Gt)&&!ce)this.reset();else if(R.eventType&Tt)this.reset(),this._timer=m(function(){this.state=di,this.tryEmit()},F.time,this);else if(R.eventType&ot)return di;return De},reset:function(){clearTimeout(this._timer)},emit:function(R){this.state===di&&(R&&R.eventType&ot?this.manager.emit(this.options.event+"up",R):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function gc(){Cr.apply(this,arguments)}P(gc,Cr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(R){return this._super.attrTest.call(this,R)&&(Math.abs(R.rotation)>this.options.threshold||this.state&jt)}});function mc(){Cr.apply(this,arguments)}P(mc,Cr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:yn|on,pointers:1},getTouchAction:function(){return Ta.prototype.getTouchAction.call(this)},attrTest:function(R){var F=this.options.direction,H;return F&(yn|on)?H=R.overallVelocity:F&yn?H=R.overallVelocityX:F&on&&(H=R.overallVelocityY),this._super.attrTest.call(this,R)&&F&R.offsetDirection&&R.distance>this.options.threshold&&R.maxPointers==this.options.pointers&&h(H)>this.options.velocity&&R.eventType&ot},emit:function(R){var F=dc(R.offsetDirection);F&&this.manager.emit(this.options.event+F,R),this.manager.emit(this.options.event,R)}});function ba(){j.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}P(ba,j,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ze]},process:function(R){var F=this.options,H=R.pointers.length===F.pointers,q=R.distance<F.threshold,ce=R.deltaTime<F.time;if(this.reset(),R.eventType&Tt&&this.count===0)return this.failTimeout();if(q&&ce&&H){if(R.eventType!=ot)return this.failTimeout();var Se=this.pTime?R.timeStamp-this.pTime<F.interval:!0,rt=!this.pCenter||Vt(this.pCenter,R.center)<F.posThreshold;this.pTime=R.timeStamp,this.pCenter=R.center,!rt||!Se?this.count=1:this.count+=1,this._input=R;var fn=this.count%F.taps;if(fn===0)return this.hasRequireFailures()?(this._timer=m(function(){this.state=di,this.tryEmit()},F.interval,this),jt):di}return De},failTimeout:function(){return this._timer=m(function(){this.state=De},this.options.interval,this),De},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==di&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function pi(R,F){return F=F||{},F.recognizers=N(F.recognizers,pi.defaults.preset),new xa(R,F)}pi.VERSION="2.0.7",pi.defaults={domEvents:!1,touchAction:At,enable:!0,inputTarget:null,inputClass:null,preset:[[gc,{enable:!1}],[pc,{enable:!1},["rotate"]],[mc,{direction:yn}],[Ta,{direction:yn},["swipe"]],[ba],[ba,{event:"doubletap",taps:2},["tap"]],[U]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lp=1,Ku=2;function xa(R,F){this.options=x({},pi.defaults,F||{}),this.options.inputTarget=this.options.inputTarget||R,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=R,this.input=Xr(this),this.touchAction=new an(this,this.options.touchAction),Zu(this,!0),E(this.options.recognizers,function(H){var q=this.add(new H[0](H[1]));H[2]&&q.recognizeWith(H[2]),H[3]&&q.requireFailure(H[3])},this)}xa.prototype={set:function(R){return x(this.options,R),R.touchAction&&this.touchAction.update(),R.inputTarget&&(this.input.destroy(),this.input.target=R.inputTarget,this.input.init()),this},stop:function(R){this.session.stopped=R?Ku:lp},recognize:function(R){var F=this.session;if(!F.stopped){this.touchAction.preventDefaults(R);var H,q=this.recognizers,ce=F.curRecognizer;(!ce||ce&&ce.state&di)&&(ce=F.curRecognizer=null);for(var Se=0;Se<q.length;)H=q[Se],F.stopped!==Ku&&(!ce||H==ce||H.canRecognizeWith(ce))?H.recognize(R):H.reset(),!ce&&H.state&(jt|hi|Bn)&&(ce=F.curRecognizer=H),Se++}},get:function(R){if(R instanceof j)return R;for(var F=this.recognizers,H=0;H<F.length;H++)if(F[H].options.event==R)return F[H];return null},add:function(R){if(_(R,"add",this))return this;var F=this.get(R.options.event);return F&&this.remove(F),this.recognizers.push(R),R.manager=this,this.touchAction.update(),R},remove:function(R){if(_(R,"remove",this))return this;if(R=this.get(R),R){var F=this.recognizers,H=D(F,R);H!==-1&&(F.splice(H,1),this.touchAction.update())}return this},on:function(R,F){if(R!==i&&F!==i){var H=this.handlers;return E(k(R),function(q){H[q]=H[q]||[],H[q].push(F)}),this}},off:function(R,F){if(R!==i){var H=this.handlers;return E(k(R),function(q){F?H[q]&&H[q].splice(D(H[q],F),1):delete H[q]}),this}},emit:function(R,F){this.options.domEvents&&yc(R,F);var H=this.handlers[R]&&this.handlers[R].slice();if(!(!H||!H.length)){F.type=R,F.preventDefault=function(){F.srcEvent.preventDefault()};for(var q=0;q<H.length;)H[q](F),q++}},destroy:function(){this.element&&Zu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Zu(R,F){var H=R.element;if(!!H.style){var q;E(R.options.cssProps,function(ce,Se){q=oe(H.style,Se),F?(R.oldCssProps[q]=H.style[q],H.style[q]=ce):H.style[q]=R.oldCssProps[q]||""}),F||(R.oldCssProps={})}}function yc(R,F){var H=n.createEvent("Event");H.initEvent(R,!0,!0),H.gesture=F,F.target.dispatchEvent(H)}x(pi,{INPUT_START:Tt,INPUT_MOVE:Ut,INPUT_END:ot,INPUT_CANCEL:Gt,STATE_POSSIBLE:Ms,STATE_BEGAN:jt,STATE_CHANGED:hi,STATE_ENDED:Bn,STATE_RECOGNIZED:di,STATE_CANCELLED:xr,STATE_FAILED:De,DIRECTION_NONE:zt,DIRECTION_LEFT:Mn,DIRECTION_RIGHT:In,DIRECTION_UP:jn,DIRECTION_DOWN:kn,DIRECTION_HORIZONTAL:yn,DIRECTION_VERTICAL:on,DIRECTION_ALL:rr,Manager:xa,Input:vt,TouchAction:an,TouchInput:xo,MouseInput:va,PointerEventInput:ge,TouchMouseInput:J,SingleTouchInput:Xu,Recognizer:j,AttrRecognizer:Cr,Tap:ba,Pan:Ta,Swipe:mc,Pinch:pc,Rotate:gc,Press:U,on:z,off:X,each:E,merge:S,extend:I,assign:x,inherit:P,bindFn:M,prefixed:oe});var Yr=typeof e<"u"?e:typeof self<"u"?self:{};Yr.Hammer=pi,typeof i=="function"&&i.amd?i(function(){return pi}):t.exports?t.exports=pi:e[r]=pi})(window,document,"Hammer")})(sc);const gV=sc.exports,Gi=mC({__proto__:null,default:gV},[sc.exports]),vM=1,_M=2,M1=4,mV={mousedown:vM,mousemove:_M,mouseup:M1};function yV(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function vV(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(yV(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function _V(t){t.prototype.handler=function(n){let r=mV[n.type];r&vM&&n.button>=0&&(this.pressed=!0),r&_M&&n.which===0&&(r=M1),this.pressed&&(r&M1&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}vV(sc.exports.PointerEventInput);_V(sc.exports.MouseInput);const EV=sc.exports.Manager;class w0{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const wV=Gi?[[Gi.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Gi.Rotate,{enable:!1}],[Gi.Pinch,{enable:!1}],[Gi.Swipe,{enable:!1}],[Gi.Pan,{threshold:0,enable:!1}],[Gi.Press,{enable:!1}],[Gi.Tap,{event:"doubletap",taps:2,enable:!1}],[Gi.Tap,{event:"anytap",enable:!1}],[Gi.Tap,{enable:!1}]]:null,gT={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},TV={doubletap:["tap"]},bV={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},zv={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},xV={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},mT={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},CV=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ll=typeof window<"u"?window:global;let I1=!1;try{const t={get passive(){return I1=!0,!0}};ll.addEventListener("test",null,t),ll.removeEventListener("test",null)}catch{I1=!1}const SV=CV.indexOf("firefox")!==-1,{WHEEL_EVENTS:PV}=zv,yT="wheel",vT=4.000244140625,MV=40,IV=.25;class BV extends w0{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;ll.WheelEvent&&(SV&&i.deltaMode===ll.WheelEvent.DOM_DELTA_PIXEL&&(s/=ll.devicePixelRatio),i.deltaMode===ll.WheelEvent.DOM_DELTA_LINE&&(s*=MV)),s!==0&&s%vT===0&&(s=Math.floor(s/vT)),i.shiftKey&&s&&(s=s*IV),this.callback({type:yT,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(PV),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,I1?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===yT&&(this.options.enable=n)}}const{MOUSE_EVENTS:LV}=zv,_T="pointermove",ET="pointerover",wT="pointerout",TT="pointerenter",bT="pointerleave";class RV extends w0{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(LV),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===_T&&(this.enableMoveEvent=n),e===ET&&(this.enableOverEvent=n),e===wT&&(this.enableOutEvent=n),e===TT&&(this.enableEnterEvent=n),e===bT&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(ET,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(wT,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(TT,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(bT,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(_T,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:OV}=zv,xT="keydown",CT="keyup";class FV extends w0{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:xT,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:CT,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(OV),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===xT&&(this.enableDownEvent=n),e===CT&&(this.enableUpEvent=n)}}const ST="contextmenu";class DV extends w0{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{!this.options.enable||this.callback({type:ST,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===ST&&(this.options.enable=n)}}const B1=1,Md=2,L1=4,kV={pointerdown:B1,pointermove:Md,pointerup:L1,mousedown:B1,mousemove:Md,mouseup:L1},NV=1,UV=2,GV=3,zV=0,VV=1,HV=2,jV=1,WV=2,QV=4;function $V(t){const e=kV[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return e===L1||e===Md&&!Number.isFinite(n)?(s=i===NV,o=i===UV,a=i===GV):e===Md?(s=Boolean(n&jV),o=Boolean(n&QV),a=Boolean(n&WV)):e===B1&&(s=r===zV,o=r===VV,a=r===HV),{leftButton:s,middleButton:o,rightButton:a}}function XV(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Tg={srcElement:"root",priority:0};class YV{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Tg;typeof r=="string"||r&&r.addEventListener?l={...Tg,srcElement:r}:r&&(l={...Tg,...r});let h=a.get(l.srcElement);h||(h=[],a.set(l.srcElement,h));const p={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(p.once=!0),s&&(p.passive=!0),o.push(p),this._active=this._active||!p.passive;let m=h.length-1;for(;m>=0&&!(h[m].priority>=p.priority);)m--;h.splice(m+1,0,p)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:h,handler:p,once:m}=r[l];if(p({...e,type:h,stopPropagation:s,stopImmediatePropagation:o}),m&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:h,handler:p}=a[l];this.remove(h,p)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...$V(e),...XV(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const JV={events:null,recognizers:null,recognizerOptions:{},Manager:EV,touchAction:"none",tabIndex:0};class KV{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=bV[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...JV,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||wV}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(gT).forEach(i=>{const s=this.manager.get(i);s&&gT[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new BV(e,this._onOtherEvent,{enable:!1}),this.moveInput=new RV(e,this._onOtherEvent,{enable:!1}),this.keyInput=new FV(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new DV(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=TV[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const p in e)this._addEventHandler(p,e[p],r,i,s);return}const{manager:o,events:a}=this,l=mT[e]||e;let h=a.get(l);h||(h=new YV(this),a.set(l,h),h.recognizerName=xV[l]||l,o&&o.on(l,h.handleEvent)),h.add(e,n,r,i,s),h.isEmpty()||this._toggleRecognizer(h.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=mT[e]||e,s=r.get(i);if(!!s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function Ro(){}const ZV=({isDragging:t})=>t?"grabbing":"grab",EM={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Ro,onResize:Ro,onViewStateChange:Ro,onInteractionStateChange:Ro,onBeforeRender:Ro,onAfterRender:Ro,onLoad:Ro,onError:t=>Ve.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:ZV,getTooltip:null,debug:!1,drawPickingColors:!1};class T0{constructor(e){T(this,"props",void 0),T(this,"width",0),T(this,"height",0),T(this,"userData",{}),T(this,"canvas",null),T(this,"viewManager",null),T(this,"layerManager",null),T(this,"effectManager",null),T(this,"deckRenderer",null),T(this,"deckPicker",null),T(this,"eventManager",null),T(this,"tooltip",null),T(this,"metrics",void 0),T(this,"animationLoop",void 0),T(this,"stats",void 0),T(this,"viewState",void 0),T(this,"cursorState",void 0),T(this,"_needsRedraw",void 0),T(this,"_pickRequest",void 0),T(this,"_lastPointerDownInfo",null),T(this,"_metricsCounter",void 0),T(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),T(this,"_onEvent",n=>{const r=nT[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,l=a&&(a[r.handler]||a.props[r.handler]),h=this.props[r.handler];let p=!1;l&&(p=l.call(a,o,n)),!p&&h&&h(o,n)}),T(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...EM,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Ve.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),G3()==="IE"&&Ve.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new bu({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&$l.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(i=this.deckRenderer)===null||i===void 0||i.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(a=this.tooltip)===null||a===void 0||a.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var l;(l=this.canvas.parentElement)===null||l===void 0||l.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Ve.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Ve.removed("onLayerClick","onClick")(),e.initialViewState&&!ya(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Rn(this.viewManager),this.viewManager.views}getViewports(e){return Rn(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_pick(e,n,r){Rn(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Rn(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth||e.width,r=e.clientHeight||e.height;if(n!==this.width||r!==this.height){var i;this.width=n,this.height=r,(i=this.viewManager)===null||i===void 0||i.setProps({width:n,height:r}),this.props.onResize({width:n,height:r})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:h,useDevicePixels:p}=e;return new s5({width:n,height:r,useDevicePixels:p,autoResizeViewport:!1,gl:i,onCreateContext:m=>iP({...s,...m,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:m=>this._setGLContext(m.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:h,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new dM({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,mv(e,{enable:!0,copyState:!0})),this.tooltip=new pV(this.canvas),_s(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new KP;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new KV(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in nT)this.eventManager.on(i,this._onEvent);this.viewManager=new L9({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new B9(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new nV,this.deckRenderer=new aV(e),this.deckPicker=new hV(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;_s(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Ve.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=jo.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}T(T0,"defaultProps",EM);T(T0,"VERSION",fN.VERSION);class bg{constructor(e,n){T(this,"opts",void 0),T(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function qV(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Rh(t){return t.stride||t.size*t.bytesPerElement}function wM(t,e){e.offset&&Ve.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Rh(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function eH(t,e){const n=wM(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class tH{constructor(e,n,r){T(this,"gl",void 0),T(this,"id",void 0),T(this,"size",void 0),T(this,"settings",void 0),T(this,"value",void 0),T(this,"doublePrecision",void 0),T(this,"_buffer",void 0),T(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&y0(e,Bt.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let l=qV(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new St(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Rh(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),$l.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=eH(this.getAccessor(),n||{});return r[e]=new bg(this,s.high),r["".concat(e,"64Low")]=i?new bg(this,s.low):new Float32Array(this.size),r}if(n){const r=wM(this.getAccessor(),n);return{[e]:new bg(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let h=0;h<i;h++){const p=n[l++];p<o[h]&&(o[h]=p),p>a[h]&&(a[h]=p)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof St?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=Rh(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=Rh(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Eg(s,i));const l=s.byteLength+a+i.stride*2;o.byteLength<l&&o.reallocate(l),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Eg(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=$l.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?Eg(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Ve.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e)return n[r]=i[0],n;switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const PT=[],MT=[];function Eo(t,e=0,n=1/0){let r=PT;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(MT.length=t.length,r=MT):r=PT,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function TM(t){return t&&t[Symbol.asyncIterator]}function bM(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,h=i?i/a:0,p=Math.floor((t.length-h)/l);return(m,{index:_,target:E})=>{if(!s){const S=_*l+h;for(let P=0;P<n;P++)E[P]=t[S+P];return E}const b=s[_],x=s[_+1]||p;let I;if(o){I=new Array(x-b);for(let S=b;S<x;S++){const P=S*l+h;E=new Array(n);for(let M=0;M<n;M++)E[M]=t[P+M];I[S-b]=E}}else if(l===n)I=t.subarray(b*n+h,x*n+h);else{I=new t.constructor((x-b)*n);let S=0;for(let P=b;P<x;P++){const M=P*l+h;for(let O=0;O<n;O++)I[S++]=t[M+O]}}return I}}const nH=[],Oh=[[0,1/0]];function rH(t,e){if(t===Oh||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function xg(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let h=a;for(;h<l;){const p=s(h,e);for(let m=0;m<i;m++)n[r+h]=p[m]||0,h++}}function iH({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return xg({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((p,m)=>r(p+a,m)),h=Math.min(i.length,s.length);for(let p=1;p<h;p++){const m=i[p]*n,_=s[p]*n;xg({source:t.subarray(o,m),target:e,start:a,end:_,size:n,getData:l}),o=m,a=_}return a<e.length&&xg({source:[],target:e,start:a,size:n,getData:l}),e}const sH={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function xM(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...sH[n],...e,...t,type:n}}function CM(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function SM(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function PM(t){t.push(t.shift())}function Vv(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function MM({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,l=n.byteOffset,h=n.startIndices,p=i&&h,m=Vv(n,e),_=n.isConstant;if(!p&&r>=m)return;const E=_?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!_){const S=s;s=(P,M)=>n.normalizeConstant(S(P,M))}const b=_?(S,P)=>s(E,P):(S,P)=>s(E.subarray(S,S+a),P),x=t.getData({length:r}),I=new Float32Array(m);iH({source:x,target:I,sourceStartIndices:i,targetStartIndices:h,size:a,getData:b}),t.byteLength<I.byteLength+l&&t.reallocate(I.byteLength+l),t.subData({data:I,offset:l})}class Hv extends tH{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Oh}),T(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return xM(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=rH(this.state.updateRanges,[r,i])}else this.state.updateRanges=Oh}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=nH}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Oh),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[h,p]of s)o.call(i,this,{data:n,startRow:h,endRow:p,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[h,p]of s){const m=Number.isFinite(h)?this.getVertexOffset(h):0,_=Number.isFinite(p)?this.getVertexOffset(p):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:m,endOffset:_})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Rn(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=Boolean(o.size)&&o.size!==this.size;return r.binaryAccessor=bM(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?n[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:h,size:p,startIndices:m}=e,{accessor:_,transform:E}=a,b=l.binaryAccessor||(typeof _=="function"?_:s[_]);Rn(typeof b=="function",'accessor "'.concat(_,'" is not a function'));let x=e.getVertexOffset(r);const{iterable:I,objectInfo:S}=Eo(n,r,i);for(const P of I){S.index++;let M=b(P,S);if(E&&(M=E.call(this,M)),m){const O=(S.index<m.length-1?m[S.index+1]:o)-m[S.index];if(M&&Array.isArray(M[0])){let N=x;for(const z of M)e._normalizeValue(z,h,N),N+=p}else M&&M.length>p?h.set(M,x):(e._normalizeValue(M,S.target,0),C9({target:h,source:S.target,start:x,count:O}));x+=O*p}else e._normalizeValue(M,h,x),x+=p}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class oH{constructor({gl:e,attribute:n,timeline:r}){T(this,"gl",void 0),T(this,"type","interpolation"),T(this,"attributeInTransition",void 0),T(this,"settings",void 0),T(this,"attribute",void 0),T(this,"transition",void 0),T(this,"currentStartIndices",void 0),T(this,"currentLength",void 0),T(this,"transform",void 0),T(this,"buffers",void 0),this.gl=e,this.transition=new Ru(r),this.attribute=n,this.attributeInTransition=new Hv(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=lH(e,n);const i={byteLength:0,usage:35050};this.buffers=[new St(e,i),new St(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;PM(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)MM({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=Vv(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:CM(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const aH=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function lH(t,e){const n=SM(e.size);return new Dv(t,{vs:aH,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class cH{constructor({gl:e,attribute:n,timeline:r}){T(this,"gl",void 0),T(this,"type","spring"),T(this,"attributeInTransition",void 0),T(this,"settings",void 0),T(this,"attribute",void 0),T(this,"transition",void 0),T(this,"currentStartIndices",void 0),T(this,"currentLength",void 0),T(this,"texture",void 0),T(this,"framebuffer",void 0),T(this,"transform",void 0),T(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Ru(r),this.attribute=n,this.attributeInTransition=new Hv(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=uH(e),this.framebuffer=fH(e,this.texture),this.transform=AH(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new St(e,i),new St(e,i),new St(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)MM({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=Vv(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:CM(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),PM(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),m0(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function AH(t,e,n){const r=SM(e.size);return new Dv(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function uH(t){return new Hn(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function fH(t,e){return new mn(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const hH={interpolation:oH,spring:cH};class dH{constructor(e,{id:n,timeline:r}){T(this,"id",void 0),T(this,"isSupported",void 0),T(this,"gl",void 0),T(this,"timeline",void 0),T(this,"transitions",void 0),T(this,"needsRedraw",void 0),T(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Dv.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);!o||this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){Ve.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=hH[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(Ve.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const IT="attributeManager.invalidate",pH="attributeManager.updateStart",gH="attributeManager.updateEnd",mH="attribute.updateStart",yH="attribute.allocate",vH="attribute.updateEnd";class _H{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){T(this,"id",void 0),T(this,"gl",void 0),T(this,"attributes",void 0),T(this,"updateTriggers",void 0),T(this,"needsRedraw",void 0),T(this,"userData",void 0),T(this,"stats",void 0),T(this,"attributeTransitionManager",void 0),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new dH(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Jn(IT,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Jn(IT,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;Jn(pH,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const h in this.attributes){const p=this.attributes[h],m=p.settings.accessor;p.startIndices=r,p.numInstances=n,s[h]&&Ve.removed("props.".concat(h),"data.attributes.".concat(h))(),p.setExternalBuffer(o[h])||p.setBinaryValue(typeof m=="string"?o[m]:void 0,e.startIndices)||typeof m=="string"&&!o[m]&&p.setConstantValue(s[m])||p.needsUpdate()&&(l=!0,this._updateAttribute({attribute:p,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||p.needsRedraw()}l&&Jn(gH,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new Hv(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Jn(mH,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Jn(yH,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Jn(vH,n,r))}}class EH extends Ru{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Ii(n,r,o)}}const BT=1e-5;function LT(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function wH(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=LT(t[o],e[o],n[o],r,i);return s}return LT(t,e,n,r,i)}function RT(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class TH extends Ru{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=wH(s,o,n,r,i);const l=RT(a,n),h=RT(a,o);l<BT&&h<BT&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const bH={interpolation:EH,spring:TH};class xH{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:h=l.settings.fromValue}=l;n=h,this.remove(e)}if(i=xM(i),!i)return;const o=bH[i.type];if(!o){Ve.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function CH(t){const e=jv(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function SH(t,e){const n=IM({newProps:t,oldProps:e,propTypes:jv(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=MH(t,e);let i=!1;return r||(i=IH(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:BH(t,e),transitionsChanged:PH(t,e)}}function PH(t,e){if(!t.transitions)return!1;const n={},r=jv(t);let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&R1(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function IM({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=R1(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=R1(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function R1(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function MH(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function IH(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&OT(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&OT(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function BH(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function OT(t,e,n){let r=t.updateTriggers[n];r=r==null?{}:r;let i=e.updateTriggers[n];return i=i==null?{}:i,IM({oldProps:i,newProps:r,triggerName:n})}function jv(t){const e=t[Pd],n=e&&e.constructor;return n?n._propTypes:{}}const LH="count(): argument not an object",RH="count(): argument not a container";function OH(t){if(!DH(t))throw new Error(LH);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(FH(t))return Object.keys(t).length;throw new Error(RH)}function FH(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function DH(t){return t!==null&&typeof t=="object"}function kH(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const NH={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},O1={};function UH(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof Hn)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let r=null;e.compressed&&(r={[10241]:e.data.length>1?9985:9729});const i=new Hn(n,{...e,parameters:{...NH,...r,...t.props.textureParameters}});return O1[i.id]=!0,i}function GH(t){!t||!(t instanceof Hn)||O1[t.id]&&(t.delete(),delete O1[t.id])}const zH={boolean:{validate(t,e){return!0},equal(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||eu(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Cg(t,e)}},accessor:{validate(t,e){const n=Id(t);return n==="function"||n===Id(e.value)},equal(t,e,n){return typeof e=="function"?!0:Cg(t,e)}},array:{validate(t,e){return e.optional&&!t||eu(t)},equal(t,e,n){return n.compare?Cg(t,e):t===e}},object:{equal(t,e,n){return n.compare?ya(t,e):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>UH(n,t),release:t=>{GH(t)}}};function Cg(t,e){if(t===e)return!0;if(!eu(t)||!eu(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function VH(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=HH(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function HH(t,e){switch(Id(e)){case"object":return kc(t,e);case"array":return kc(t,{type:"array",value:e,compare:!1});case"boolean":return kc(t,{type:"boolean",value:e});case"number":return kc(t,{type:"number",value:e});case"function":return kc(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function kc(t,e){return"type"in e?{name:t,...zH[e.type],...e}:"value"in e?{name:t,type:Id(e.value),...e}:{name:t,type:"object",value:e}}function eu(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Id(t){return eu(t)?"array":t===null?"null":typeof t}function jH(t,e){const n=BM(t.constructor),r=Object.create(n);r[Pd]=t,r[aa]={},r[Zs]={};for(let i=0;i<e.length;++i){const s=e[i];for(const o in s)r[o]=s[o]}return Object.freeze(r),r}function BM(t){const e=Bd(t,"_mergedDefaultProps");return e||(WH(t),t._mergedDefaultProps)}function WH(t){if(!t.prototype)return;const n=Object.getPrototypeOf(t),r=BM(n),i=Bd(t,"defaultProps")||{},s=VH(i),o=QH(s.defaultProps,r,t),a={...n._propTypes,...s.propTypes};XH(o,a);const l={...n._deprecatedProps,...s.deprecatedProps};$H(o,l),t._mergedDefaultProps=o,t._propTypes=a,t._deprecatedProps=l}function QH(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=JH(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}function $H(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])LM(this,s)||(this[s]=r);Ve.deprecated(i,e[n].join("/"))()}})}function XH(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=YH(o))}t[Ml]=n,t[aa]={},Object.defineProperties(t,r)}function YH(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||TM(e)?this[aa][t]=e:this[Zs][t]=e},get(){if(this[Zs]){if(t in this[Zs])return this[Zs][t]||this[Ml][t];if(t in this[aa]){const e=this[Pd]&&this[Pd].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Ml][t]}}return this[Ml][t]}}}function LM(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Bd(t,e){return LM(t,e)&&t[e]}function JH(t){const e=Bd(t,"layerName")||Bd(t,"componentName");return e||Ve.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}let KH=0;class Wv{constructor(...e){T(this,"id",void 0),T(this,"props",void 0),T(this,"count",void 0),this.props=jH(this,e),this.id=this.props.id,this.count=KH++}clone(e){const{props:n}=this,r={};for(const i in n[Ml])i in n[Zs]?r[i]=n[Zs][i]:i in n[aa]&&(r[i]=n[aa][i]);return new this.constructor({...n,...r,...e})}}T(Wv,"componentName","Component");T(Wv,"defaultProps",{});const ZH=Object.freeze({});class qH{constructor(e){T(this,"component",void 0),T(this,"onAsyncPropUpdated",void 0),T(this,"asyncProps",void 0),T(this,"oldProps",void 0),T(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||ZH}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return Boolean(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){const n=e[Zs]||{},r=e[aa]||e,i=e[Ml]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(!!this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(TM(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class ej extends qH{constructor({attributeManager:e,layer:n}){super(n),T(this,"attributeManager",void 0),T(this,"needsRedraw",void 0),T(this,"needsUpdate",void 0),T(this,"subLayers",void 0),T(this,"usesPickingColorCache",void 0),T(this,"changeFlags",void 0),T(this,"viewport",void 0),T(this,"uniformTransitions",void 0),T(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,n){const r=this.component.props.fetch;return r?r(n,{propName:e,layer:this.layer}):super._fetch(e,n)}_onResolve(e,n){const r=this.component.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:this.layer})}_onError(e,n){this.layer.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const tj="layer.changeFlag",nj="layer.initialize",rj="layer.update",ij="layer.finalize",sj="layer.matched",FT=2**24-1,oj=Object.freeze([]),aj=Lu(({oldViewport:t,viewport:e})=>t.equals(e));let zi=new Uint8ClampedArray(0);const lj={data:{type:"data",value:oj,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let l=o.contains(t);return!l&&!i&&(o.add({resourceId:t,data:vs(t,r),persistent:!1}),l=!0),l?o.subscribe({resourceId:t,onChange:h=>{var p;return(p=n.internalState)===null||p===void 0?void 0:p.reloadAsyncProp(e,h)},consumerId:n.id,requestId:e}):vs(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:Bu.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:$e.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class nr extends Wv{constructor(...e){super(...e),T(this,"internalState",null),T(this,"lifecycle",$a.NO_STATE),T(this,"context",void 0),T(this,"state",void 0),T(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Rn(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=cM(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=sM(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return Rn(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Rn(this.internalState);const r=this.internalState.viewport||this.context.viewport;return AM(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===$e.DEFAULT||e===$e.LNGLAT||e===$e.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Rn(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:OH(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const n=this.getAttributeManager();if(!n)return null;const{positions:r,instancePositions:i}=n.attributes;return(e=r||i)===null||e===void 0?void 0:e.getBounds()}getShaders(e){for(const n of this.props.extensions)e=kH(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const l of r)n.invalidateAll(l);else n.invalidateAll();const{props:i,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable;if(o!==a&&n){const{pickingColors:l,instancePickingColors:h}=n.attributes,p=l||h;p&&(a&&p.constant&&(p.constant=!1,n.invalidate(p.id)),!p.value&&!a&&(p.constant=!0,p.value=[0,0,0]))}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!aj({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();!n||(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(zi.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>FT&&Ve.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),zi=$l.allocate(zi,n,{size:3,copy:!0,maxCount:Math.max(n,FT)});const i=Math.floor(zi.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),zi[o*3+0]=s[0],zi[o*3+1]=s[1],zi[o*3+2]=s[2]}e.value=zi.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;!r||(this.internalState.usesPickingColorCache&&r.value.buffer!==zi.buffer&&(r.value=zi.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Rn(!this.internalState),Rn(Number.isFinite(this.props.coordinateSystem)),Jn(nj,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new ej({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ve.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new xH(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Jn(sj,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.internalState.layer=this,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Jn(rj,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const p of this.props.extensions)p.updateState.call(this,a,p);const h=this.getModels()[0]!==l[0];this._postUpdate(a,h)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Jn(ij,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,l=a&&a(n)||[0,0];_s(s.gl,{polygonOffset:l}),oi(s.gl,r,()=>{const h={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const p of this.props.extensions)p.draw.call(this,h,p);this.draw(h)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Jn(tj,this,i,e)}const r=Boolean(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=SH(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){CH(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new _H(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const h={};o||(h.pickingSelectedColor=null),Array.isArray(l)&&(h.pickingHighlightColor=l),Number.isInteger(a)&&(h.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(h)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;return n=n||i,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}T(nr,"defaultProps",lj);T(nr,"layerName","Layer");const cj="compositeLayer.renderLayers";class Ss extends nr{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:h,highlightColor:p,coordinateSystem:m,coordinateOrigin:_,wrapLongitude:E,positionFormat:b,modelMatrix:x,extensions:I,fetch:S,operation:P,_subLayerProps:M}=this.props,O={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:h,highlightColor:p,coordinateSystem:m,coordinateOrigin:_,wrapLongitude:E,positionFormat:b,modelMatrix:x,extensions:I,fetch:S,operation:P},N=M&&e.id&&M[e.id],z=N&&N.updateTriggers,X=e.id||"sublayer";if(N){const Z=this.constructor._propTypes,Q=e.type?e.type._propTypes:{};for(const k in N){const D=Q[k]||Z[k];D&&D.type==="accessor"&&(N[k]=this.getSubLayerAccessor(N[k]))}}Object.assign(O,e,N),O.id="".concat(this.props.id,"-").concat(X),O.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...z};for(const Z of I){const Q=Z.getSubLayerProps.call(this,Z);Q&&Object.assign(O,Q,{updateTriggers:Object.assign(O.updateTriggers,Q.updateTriggers)})}return O}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=E0(s,Boolean),this.internalState.subLayers=r}Jn(cj,this,i,r);for(const s of r)s.parent=this}}T(Ss,"layerName","CompositeLayer");const Uf=Math.PI/180,DT=180/Math.PI,Fh=6370972,cl=256;function Aj(){const t=cl/Fh,e=Math.PI/180*cl;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class uj extends _o{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:s=.1,farZMultiplier:o=2,resolution:a=10}=e;let{height:l,altitude:h=1.5}=e;l=l||1,h=Math.max(.75,h);const p=new Ye().lookAt({eye:[0,-h,0],up:[0,0,1]}),m=Math.pow(2,i);p.rotateX(n*Uf),p.rotateZ(-r*Uf),p.scale(m/l);const _=Math.atan(.5/h),E=cl*2*m/l;super({...e,height:l,viewMatrix:p,longitude:r,latitude:n,zoom:i,distanceScales:Aj(),fovyRadians:_*2,focalDistance:h,near:s,far:Math.min(2,1/E+1)*h*o}),T(this,"longitude",void 0),T(this,"latitude",void 0),T(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=a}get projectionMode(){return xi.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),o=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],s[0],i[0],o[0]),Math.min(r[1],s[1],i[1],o[1]),Math.max(r[0],s[0],i[0],o[0]),Math.max(r[1],s[1],i[1],o[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,{pixelUnprojectionMatrix:l}=this;let h;if(Number.isFinite(o))h=Sg(l,[i,a,o,1]);else{const E=Sg(l,[i,a,-1,1]),b=Sg(l,[i,a,1,1]),x=((r||0)/Fh+1)*cl,I=pg(UP([],E,b)),S=pg(E),P=pg(b),M=(4*S*P-(I-S-P)**2)/16,O=4*M/I,N=Math.sqrt(S-O),z=Math.sqrt(Math.max(0,x*x-O)),X=(N-z)/Math.sqrt(I);h=gU([],E,b,X)}const[p,m,_]=this.unprojectPosition(h);return Number.isFinite(o)?[p,m,_]:Number.isFinite(r)?[p,m,r]:[p,m]}projectPosition(e){const[n,r,i=0]=e,s=n*Uf,o=r*Uf,a=Math.cos(o),l=(i/Fh+1)*cl;return[Math.sin(s)*a*l,-Math.cos(s)*a*l,Math.sin(o)*l]}unprojectPosition(e){const[n,r,i]=e,s=GP(e),o=Math.asin(i/s),l=Math.atan2(n,-r)*DT,h=o*DT,p=(s/cl-1)*Fh;return[l,h,p]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function Sg(t,e){const n=ic([],e,t);return Lv(n,n,1/n[3]),n}class RM{constructor(e){T(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&ya(this.opts,e.opts)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],o=this.props[i];r[i]=o,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof o=="function"&&(r[i]=this.getSubLayerAccessor(o)))}return r}initializeState(e,n){}updateState(e,n){}draw(e,n){}finalizeState(e,n){}}T(RM,"defaultProps",{});class OM{constructor(e){T(this,"opts",void 0),T(this,"typedArrayManager",void 0),T(this,"indexStarts",[0]),T(this,"vertexStarts",[0]),T(this,"vertexCount",0),T(this,"instanceCount",0),T(this,"attributes",void 0),T(this,"_attributeDefs",void 0),T(this,"data",void 0),T(this,"getGeometry",void 0),T(this,"geometryBuffer",void 0),T(this,"buffers",void 0),T(this,"positionSize",void 0),T(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=$l,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=l,s&&(Rn(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),l||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(a))for(const h of a)this._rebuildGeometry(h);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?bM(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const l=s[a];l.copy=n,r[a]=o.allocate(r[a],e,l)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=Eo(i,n,r);for(const l of o){a.index++;const h=s?s(l,a):null;e(h,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:l=1/0}=e||{},h={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((m,_)=>{const E=m&&this.normalizeGeometry(m);h[_]=E,r[_+1]=r[_]+(E?this.getGeometrySize(E):0)},a,l),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof St){const m=o.accessor.stride||this.positionSize*4;i=i||o.byteLength/m}else if(o.buffer){const m=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/m}else if(o.value){const m=o.value,_=o.stride/m.BYTES_PER_ELEMENT||this.positionSize;i=i||m.length/_}this._allocate(i,Boolean(e)),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const p={};this._forEachGeometry((m,_)=>{const E=h[_]||m;p.vertexStart=r[_],p.indexStart=n[_];const b=_<r.length-1?r[_+1]:i;p.geometrySize=b-r[_],p.geometryIndex=_,this.updateGeometryAttributes(E,p)},a,l),this.vertexCount=n[n.length-1]}}const fj=typeof window<"u"?K.exports.useLayoutEffect:K.exports.useEffect;function Ld(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const hj={position:"absolute",zIndex:-1};function FM(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>FM(n,e));if(b0(t)){if(dj(t))return e.style=hj,K.exports.cloneElement(t,e);if(pj(t))return K.exports.cloneElement(t,e)}return t}function b0(t){return t&&typeof t=="object"&&"type"in t||!1}function dj(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function pj(t){const e=t.type;return e&&e.deckGLViewProps}function F1(t){if(typeof t=="function")return K.exports.createElement(la,{},t);if(Array.isArray(t))return t.map(F1);if(b0(t)){if(t.type===K.exports.Fragment)return F1(t.props.children);if(Ld(t.type,la))return t}return t}function gj({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return K.exports.Children.forEach(F1(t),o=>{if(b0(o)){const a=o.type;if(Ld(a,nr)){const l=mj(a,o.props);i.push(l)}else r.push(o);if(Ld(a,la)&&a!==la&&o.props.id){const l=new a(o.props);s[l.id]=l}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function mj(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function yj({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,l=o;b0(o)&&Ld(o.type,la)&&(a=o.props.id||s,l=o.props.children);const h=r.getViewport(a),p=r.getViewState(a);if(h){const{x:m,y:_,width:E,height:b}=h;l=FM(l,{x:m,y:_,width:E,height:b,viewport:h,viewState:p}),i[a]||(i[a]={viewport:h,children:[]}),i[a].children.push(l)}}return Object.keys(i).map(o=>{const{viewport:a,children:l}=i[o],{x:h,y:p,width:m,height:_}=a,E={position:"absolute",left:h,top:p,width:m,height:_},b="view-".concat(o),x=K.exports.createElement("div",{key:b,id:b,style:E},...l);if(n){const I={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:S=>{S.viewId=o,e._onViewStateChange(S)}};return K.exports.createElement(n,{key:b,value:I},x)}return x})}const vj={mixBlendMode:null};function _j({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in vj?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function Ej(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function DM(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function wj(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():DM(t)}});return r}const kM=K.exports.forwardRef((t,e)=>{const[n,r]=K.exports.useState(0),s=K.exports.useRef({control:null,version:n,forceUpdate:()=>r(N=>N+1)}).current,o=K.exports.useRef(null),a=K.exports.useRef(null),l=K.exports.useMemo(()=>gj(t),[t.layers,t.views,t.children]);let h=!0;const p=N=>{var z;return h&&t.viewState?(s.viewStateUpdateRequested=N,null):(s.viewStateUpdateRequested=null,(z=t.onViewStateChange)===null||z===void 0?void 0:z.call(t,N))},m=N=>{if(h)s.interactionStateUpdateRequested=N;else{var z;s.interactionStateUpdateRequested=null,(z=t.onInteractionStateChange)===null||z===void 0||z.call(t,N)}},_=K.exports.useMemo(()=>{const N={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:p,onInteractionStateChange:m};return delete N._customRender,s.deck&&s.deck.setProps(N),N},[t]);K.exports.useEffect(()=>{const N=t.Deck||T0;return s.deck=wj(s,N,{..._,parent:o.current,canvas:a.current}),()=>{var z;return(z=s.deck)===null||z===void 0?void 0:z.finalize()}},[]),fj(()=>{DM(s);const{viewStateUpdateRequested:N,interactionStateUpdateRequested:z}=s;N&&p(N),z&&m(z)}),K.exports.useImperativeHandle(e,()=>Ej(s),[]);const E=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:b,width:x,height:I,id:S,style:P}=t,{containerStyle:M,canvasStyle:O}=K.exports.useMemo(()=>_j({width:x,height:I,style:P}),[x,I,P]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===E||s.version!==n){s.lastRenderedViewports=E,s.version=n;const N=yj({children:l.children,deck:s.deck,ContextProvider:b}),z=K.exports.createElement("canvas",{key:"canvas",id:S||"deckgl-overlay",ref:a,style:O});s.control=K.exports.createElement("div",{id:"".concat(S||"deckgl","-wrapper"),ref:o,style:M},[z,N])}return h=!1,s.control});kM.defaultProps=T0.defaultProps;const Tj=`#define SHADER_NAME arc-layer-vertex-shader

attribute vec3 positions;
attribute vec4 instanceSourceColors;
attribute vec4 instanceTargetColors;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceTargetPositions64Low;
attribute vec3 instancePickingColors;
attribute float instanceWidths;
attribute float instanceHeights;
attribute float instanceTilts;

uniform bool greatCircle;
uniform bool useShortestPath;
uniform float numSegments;
uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;
varying float isValid;

float paraboloid(float distance, float sourceZ, float targetZ, float ratio) {
  // d: distance on the xy plane
  // r: ratio of the current point
  // p: ratio of the peak of the arc
  // h: height multiplier
  // z = f(r) = sqrt(r * (p * 2 - r)) * d * h
  // f(0) = 0
  // f(1) = dz

  float deltaZ = targetZ - sourceZ;
  float dh = distance * instanceHeights;
  if (dh == 0.0) {
    return sourceZ + deltaZ * ratio;
  }
  float unitZ = deltaZ / dh;
  float p2 = unitZ * unitZ + 1.0;

  // sqrt does not deal with negative values, manually flip source and target if delta.z < 0
  float dir = step(deltaZ, 0.0);
  float z0 = mix(sourceZ, targetZ, dir);
  float r = mix(ratio, 1.0 - ratio, dir);
  return sqrt(r * (p2 - r)) * dh + z0;
}

// offset vector by strokeWidth pixels
// offset_direction is -1 (left) or 1 (right)
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));
}

vec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {
  float distance = length(source.xy - target.xy);
  float z = paraboloid(distance, source.z, target.z, segmentRatio);

  float tiltAngle = radians(instanceTilts);
  vec2 tiltDirection = normalize(target.xy - source.xy);
  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);

  return vec3(
    mix(source.xy, target.xy, segmentRatio) + tilt,
    z * cos(tiltAngle)
  );
}

/* Great circle interpolation
 * http://www.movable-type.co.uk/scripts/latlong.html
 */
float getAngularDist (vec2 source, vec2 target) {
  vec2 sourceRadians = radians(source);
  vec2 targetRadians = radians(target);
  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);
  vec2 shd_sq = sin_half_delta * sin_half_delta;

  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;
  return 2.0 * asin(sqrt(a));
}

vec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {
  vec2 lngLat;

  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    lngLat = (1.0 - t) * source.xy + t * target.xy;
  } else {
    float a = sin((1.0 - t) * angularDist);
    float b = sin(t * angularDist);
    vec3 p = source3D.yxz * a + target3D.yxz * b;
    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));
  }

  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);

  return vec3(lngLat, z);
}

/* END GREAT CIRCLE */

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  float segmentIndex = positions.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));
  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));

  // if it's the first point, use next - current as direction
  // otherwise use current - prev
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  isValid = 1.0;

  uv = vec2(segmentRatio, positions.y);
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;

  vec4 curr;
  vec4 next;
  vec3 source;
  vec3 target;

  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));
    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));
    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);

    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);
    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);
    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);

    if (abs(currPos.x - prevPos.x) > 180.0) {
      indexDir = -1.0;
      isValid = 0.0;
    } else if (abs(currPos.x - nextPos.x) > 180.0) {
      indexDir = 1.0;
      isValid = 0.0;
    }
    nextPos = indexDir < 0.0 ? prevPos : nextPos;
    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;

    if (isValid == 0.0) {
      // split at the 180th meridian
      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;
      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);
      currPos = mix(currPos, nextPos, t);
      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);
    }

    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);
    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);
  
    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);
    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));
  
  } else {
    vec3 source_world = instanceSourcePositions;
    vec3 target_world = instanceTargetPositions;
    if (useShortestPath) {
      source_world.x = mod(source_world.x + 180., 360.0) - 180.;
      target_world.x = mod(target_world.x + 180., 360.0) - 180.;

      float deltaLng = target_world.x - source_world.x;
      if (deltaLng > 180.) target_world.x -= 360.;
      if (deltaLng < -180.) source_world.x -= 360.;
    }
    source = project_position(source_world, instanceSourcePositions64Low);
    target = project_position(target_world, instanceTargetPositions64Low);

    // common x at longitude=-180
    float antiMeridianX = 0.0;

    if (useShortestPath) {
      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;
      }
      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);

      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {
        isValid = 0.0;
        indexDir = sign(segmentRatio - thresholdRatio);
        segmentRatio = thresholdRatio;
      }
    }

    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
    vec3 currPos = interpolateFlat(source, target, segmentRatio);
    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);

    if (useShortestPath) {
      if (nextPos.x < antiMeridianX) {
        currPos.x += TILE_SIZE;
        nextPos.x += TILE_SIZE;
      }
    }

    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));
    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));
    geometry.position = vec4(currPos, 1.0);
  }

  // Multiply out width and clamp to limits
  // mercator pixels are interpreted as screen pixels
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );

  // extrude
  vec3 offset = vec3(
    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);
  vColor = vec4(color.rgb, color.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,bj=`#define SHADER_NAME arc-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;
varying float isValid;

void main(void) {
  if (isValid == 0.0) {
    discard;
  }

  gl_FragColor = vColor;
  geometry.uv = uv;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Rd=[0,0,0,255],xj={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:Rd},getTargetColor:{type:"accessor",value:Rd},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class Qv extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:Tj,fs:bj,modules:[ci,Ai]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:Rd},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:Rd},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:s,greatCircle:o,wrapLongitude:a}=this.props;this.state.model.setUniforms(e).setUniforms({greatCircle:o,widthUnits:Vr[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s,useShortestPath:a}).draw()}_getModel(e){let n=[];for(let s=0;s<50;s++)n=n.concat([s,1,0,s,-1,0]);const i=new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:5,attributes:{positions:new Float32Array(n)}}),isInstanced:!0});return i.setUniforms({numSegments:50}),i}}T(Qv,"layerName","ArcLayer");T(Qv,"defaultProps",xj);const Cj=new Uint16Array([0,2,1,0,3,2]),Sj=new Float32Array([0,1,0,0,1,0,1,1]);function Pj(t,e){if(!e)return Mj(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,s=Math.ceil(r/e)+1,o=(i-1)*(s-1)*6,a=new Uint32Array(o),l=new Float32Array(i*s*2),h=new Float64Array(i*s*3);let p=0,m=0;for(let _=0;_<i;_++){const E=_/(i-1);for(let b=0;b<s;b++){const x=b/(s-1),I=Ij(t,E,x);h[p*3+0]=I[0],h[p*3+1]=I[1],h[p*3+2]=I[2]||0,l[p*2+0]=E,l[p*2+1]=1-x,_>0&&b>0&&(a[m++]=p-s,a[m++]=p-s-1,a[m++]=p-1,a[m++]=p-s,a[m++]=p-1,a[m++]=p),p++}}return{vertexCount:o,positions:h,indices:a,texCoords:l}}function Mj(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:Cj,texCoords:Sj}}function Ij(t,e,n){return Ii(Ii(t[0],t[1],n),Ii(t[3],t[2],n),e)}const Bj=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,Lj=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,Rj=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  return mix(transparentColor, vec4(color, 1.0), alpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(Lj,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),Oj={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:$e.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};class NM extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:Bj,fs:Rj,modules:[ci,Ai]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var s;const{gl:o}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(o),i.invalidateAll()}if(e.bounds!==n.bounds){const o=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const l in a)o&&o[l]!==a[l]&&i.invalidate(l);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:s}=n;r.index=0;const o=Fj(r.color),a=[Math.floor(o[0]*i),Math.floor(o[1]*s)];return r.bitmap={size:{width:i,height:s},uv:o,pixel:a},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return kT(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),Pj(n,this.context.viewport.resolution)}_getModel(e){return e?new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:s,bounds:o,disablePicking:a}=this.state,{image:l,desaturate:h,transparentColor:p,tintColor:m}=this.props;r.pickingActive&&a||l&&i&&i.setUniforms(n).setUniforms({bitmapTexture:l,desaturate:h,transparentColor:p.map(_=>_/255),tintColor:m.slice(0,3).map(_=>_/255),coordinateConversion:s,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=$e;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:s}=this.props;if(!kT(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const o=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&o===n)return{coordinateConversion:-1,bounds:s};if(i===n&&o===e){const a=ho([s[0],s[1]]),l=ho([s[2],s[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],l[0],l[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}T(NM,"layerName","BitmapLayer");T(NM,"defaultProps",Oj);function Fj(t){const[e,n,r]=t,i=(r&240)/256,s=(r&15)/16;return[(e+s)/256,(n+i)/256]}function kT(t){return Number.isFinite(t[0])}const Dj=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  // convert size in meters to pixels, then scaled and clamp
 
  // project meters to pixels and clamp to limits 
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );

  // scale icon height to match instanceSize
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;

  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,kj=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);

  // if colorMode == 0, use pixel color from the texture
  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  // Take the global opacity and the alpha from vColor into account for the alpha component
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Nj=1024,Uj=4,NT=()=>{},UT={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071};function Gj(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function zj(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}function tu(t){return t&&(t.id||t.url)}function Vj(t,e,n,r){const i=t.width,s=t.height,o=new Hn(t.gl,{width:e,height:n,parameters:r});return L8(t,o,{targetY:0,width:i,height:s}),t.delete(),o}function GT(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=tu(i);t[o]={...i,x:s,y:n}}}function Hj({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<t.length;l++){const h=t[l],p=tu(h);if(!n[p]){const{height:m,width:_}=h;r+_+e>o&&(GT(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:h,xOffset:r}),r=r+_+e,s=Math.max(s,m)}}return a.length>0&&GT(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:Gj(s+i+e)}}function jj(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Eo(t);for(const o of i){s.index++;const a=e(o,s),l=tu(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[l]&&(!n[l]||a.url!==n[l].url)&&(r[l]={...a,source:o,sourceIndex:s.index})}return r}class Wj{constructor(e,{onUpdate:n=NT,onError:r=NT}){T(this,"gl",void 0),T(this,"onUpdate",void 0),T(this,"onError",void 0),T(this,"_loadOptions",null),T(this,"_texture",null),T(this,"_externalTexture",null),T(this,"_mapping",{}),T(this,"_textureParameters",null),T(this,"_pendingCount",0),T(this,"_autoPacking",!1),T(this,"_xOffset",0),T(this,"_yOffset",0),T(this,"_rowHeight",0),T(this,"_buffer",Uj),T(this,"_canvasWidth",Nj),T(this,"_canvasHeight",0),T(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?tu(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var o;(o=this._texture)===null||o===void 0||o.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(jj(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:l}=Hj({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=l,this._texture||(this._texture=new Hn(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||UT})),this._texture.height!==this._canvasHeight&&(this._texture=Vj(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||UT)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d");for(const r of e)this._pendingCount++,vs(r.url,dv,this._loadOptions).then(i=>{const s=tu(r),{x:o,y:a,width:l,height:h}=this._mapping[s],p=zj(n,i,l,h);this._texture.setSubImageData({data:p,x:o,y:a,width:l,height:h}),this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const UM=[0,0,0,255],Qj={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:UM},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class x0 extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:Dj,fs:kj,modules:[ci,Ai]})}initializeState(){this.state={iconManager:new Wj(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:UM},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:h,textureParameters:p}=n,{iconManager:m}=this.state,_=o||this.internalState.isAsyncPropLoading("iconAtlas");if(m.setProps({loadOptions:n.loadOptions,autoPacking:!_,iconAtlas:o,iconMapping:_?a:null,textureParameters:p}),_?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&m.packIcons(l,h),i.extensionsChanged){var E;const{gl:b}=this.context;(E=this.state.model)===null||E===void 0||E.delete(),this.state.model=this._getModel(b),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,h=l.getTexture();h&&this.state.model.setUniforms(e).setUniforms({iconsTexture:h,iconsTextureDim:[h.width,h.height],sizeUnits:Vr[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):Ve.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}T(x0,"defaultProps",Qj);T(x0,"layerName","IconLayer");const $j=`#define SHADER_NAME line-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions64Low;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute float instanceWidths;

uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float useShortestPath;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;

// offset vector by strokeWidth pixels
// offset_direction is -1 (left) or 1 (right)
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

vec3 splitLine(vec3 a, vec3 b, float x) {
  float t = (x - a.x) / (b.x - a.x);
  return vec3(x, mix(a.yz, b.yz, t));
}

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  vec3 source_world = instanceSourcePositions;
  vec3 target_world = instanceTargetPositions;
  vec3 source_world_64low = instanceSourcePositions64Low;
  vec3 target_world_64low = instanceTargetPositions64Low;

  if (useShortestPath > 0.5 || useShortestPath < -0.5) {
    source_world.x = mod(source_world.x + 180., 360.0) - 180.;
    target_world.x = mod(target_world.x + 180., 360.0) - 180.;
    float deltaLng = target_world.x - source_world.x;

    if (deltaLng * useShortestPath > 180.) {
      source_world.x += 360. * useShortestPath;
      source_world = splitLine(source_world, target_world, 180. * useShortestPath);
      source_world_64low = vec3(0.0);
    } else if (deltaLng * useShortestPath < -180.) {
      target_world.x += 360. * useShortestPath;
      target_world = splitLine(source_world, target_world, 180. * useShortestPath);
      target_world_64low = vec3(0.0);
    } else if (useShortestPath < 0.) {
      // Line is not split, abort
      gl_Position = vec4(0.);
      return;
    }
  }

  // Position
  vec4 source_commonspace;
  vec4 target_commonspace;
  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);
  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);
  
  // linear interpolation of source & target to pick right coord
  float segmentIndex = positions.x;
  vec4 p = mix(source, target, segmentIndex);
  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);
  uv = positions.xy;
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;

  // Multiply out width and clamp to limits
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );

  // extrude
  vec3 offset = vec3(
    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Color
  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Xj=`#define SHADER_NAME line-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Yj=[0,0,0,255],Jj={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:Yj},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class GM extends nr{getShaders(){return super.getShaders({vs:$j,fs:Xj,modules:[ci,Ai]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:s,wrapLongitude:o}=this.props;this.state.model.setUniforms(e).setUniforms({widthUnits:Vr[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s,useShortestPath:o?1:0}).draw(),o&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(e){const n=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:5,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}T(GM,"layerName","LineLayer");T(GM,"defaultProps",Jj);const Kj=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);

  // position on the containing square in [-1, 1] space
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  // Find the center of the point and add the current vertex
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply lighting
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);

  // Apply opacity to instance color, or return instance picking color
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Zj=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,zM=[0,0,0,255],VM=[0,0,1],qj={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:VM},getColor:{type:"accessor",value:zM},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function e7(t){const{header:e,attributes:n}=t;!e||!n||(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}class $v extends nr{getShaders(){return super.getShaders({vs:Kj,fs:Zj,modules:[ci,Ov,Ai]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:VM},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:zM}})}updateState(e){const{changeFlags:n,props:r}=e;if(super.updateState(e),n.extensionsChanged){var i;const{gl:s}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}n.dataChanged&&e7(r.data)}draw({uniforms:e}){const{pointSize:n,sizeUnits:r}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:Vr[r],radiusPixels:n}).draw()}_getModel(e){const n=[];for(let r=0;r<3;r++){const i=r/3*Math.PI*2;n.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:4,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}T($v,"layerName","PointCloudLayer");T($v,"defaultProps",qj);const t7=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  
  // Multiply out line width and clamp to limits
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;

  // Expand geometry to accomodate edge smoothing
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;

  // position on the containing square in [-1, 1] space
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
  }

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply opacity to instance color, or return instance picking color
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,n7=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (filled) {
    gl_FragColor = vFillColor;
  } else {
    discard;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,zT=[0,0,0,255],r7={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:zT},getLineColor:{type:"accessor",value:zT},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class C0 extends nr{getShaders(){return super.getShaders({vs:t7,fs:n7,modules:[ci,Ai]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:h,lineWidthUnits:p,lineWidthScale:m,lineWidthMinPixels:_,lineWidthMaxPixels:E}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:o?1:0,filled:a,billboard:l,antialiasing:h,radiusUnits:Vr[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Vr[p],lineWidthScale:m,lineWidthMinPixels:_,lineWidthMaxPixels:E}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}T(C0,"defaultProps",r7);T(C0,"layerName","ScatterplotLayer");const Xv={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function Yv(t,e,n={}){return i7(t,n)!==e?(s7(t,n),!0):!1}function i7(t,e={}){return Math.sign(Od(t,e))}function Od(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let o=n,a=r-i;o<r;o+=i)s+=(t[o]-t[a])*(t[o+1]+t[a+1]),a=o;return s/2}function s7(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=n+a*i,h=n+(s-1-a)*i;for(let p=0;p<i;++p){const m=t[l+p];t[l+p]=t[h+p],t[h+p]=m}}}function o7(t,e,n=2,r){const i=e&&e.length,s=i?e[0]*n:t.length;let o=HM(t,0,s,n,!0,r&&r[0]);const a=[];if(!o||o.next===o.prev)return a;let l,h,p,m,_,E,b;if(i&&(o=u7(t,e,o,n,r)),t.length>80*n){m=h=t[0],_=p=t[1];for(let x=n;x<s;x+=n)E=t[x],b=t[x+1],E<m&&(m=E),b<_&&(_=b),E>h&&(h=E),b>p&&(p=b);l=Math.max(h-m,p-_),l=l!==0?1/l:0}return nu(o,a,n,m,_,l),a}function HM(t,e,n,r,i,s){let o,a;if(s===void 0&&(s=Od(t,{start:e,end:n,size:r})),i===s<0)for(o=e;o<n;o+=r)a=VT(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=VT(o,t[o],t[o+1],a);return a&&S0(a,a.next)&&(iu(a),a=a.next),a}function go(t,e){if(!t)return t;e||(e=t);let n=t,r;do if(r=!1,!n.steiner&&(S0(n,n.next)||tn(n.prev,n,n.next)===0)){if(iu(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function nu(t,e,n,r,i,s,o){if(!t)return;!o&&s&&g7(t,r,i,s);let a=t,l,h;for(;t.prev!==t.next;){if(l=t.prev,h=t.next,s?l7(t,r,i,s):a7(t)){e.push(l.i/n),e.push(t.i/n),e.push(h.i/n),iu(t),t=h.next,a=h.next;continue}if(t=h,t===a){o?o===1?(t=c7(go(t),e,n),nu(t,e,n,r,i,s,2)):o===2&&A7(t,e,n,r,i,s):nu(go(t),e,n,r,i,s,1);break}}}function a7(t){const e=t.prev,n=t,r=t.next;if(tn(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(Al(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&tn(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function l7(t,e,n,r){const i=t.prev,s=t,o=t.next;if(tn(i,s,o)>=0)return!1;const a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,l=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,h=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,p=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,m=D1(a,l,e,n,r),_=D1(h,p,e,n,r);let E=t.prevZ,b=t.nextZ;for(;E&&E.z>=m&&b&&b.z<=_;){if(E!==t.prev&&E!==t.next&&Al(i.x,i.y,s.x,s.y,o.x,o.y,E.x,E.y)&&tn(E.prev,E,E.next)>=0||(E=E.prevZ,b!==t.prev&&b!==t.next&&Al(i.x,i.y,s.x,s.y,o.x,o.y,b.x,b.y)&&tn(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;E&&E.z>=m;){if(E!==t.prev&&E!==t.next&&Al(i.x,i.y,s.x,s.y,o.x,o.y,E.x,E.y)&&tn(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;b&&b.z<=_;){if(b!==t.prev&&b!==t.next&&Al(i.x,i.y,s.x,s.y,o.x,o.y,b.x,b.y)&&tn(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function c7(t,e,n){let r=t;do{const i=r.prev,s=r.next.next;!S0(i,s)&&jM(i,r,r.next,s)&&ru(i,s)&&ru(s,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(s.i/n),iu(r),iu(r.next),r=t=s),r=r.next}while(r!==t);return go(r)}function A7(t,e,n,r,i,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&v7(o,a)){let l=WM(o,a);o=go(o,o.next),l=go(l,l.next),nu(o,e,n,r,i,s),nu(l,e,n,r,i,s);return}a=a.next}o=o.next}while(o!==t)}function u7(t,e,n,r,i){const s=[];let o,a,l,h,p;for(o=0,a=e.length;o<a;o++)l=e[o]*r,h=o<a-1?e[o+1]*r:t.length,p=HM(t,l,h,r,!1,i&&i[o+1]),p===p.next&&(p.steiner=!0),s.push(y7(p));for(s.sort(f7),o=0;o<s.length;o++)h7(s[o],n),n=go(n,n.next);return n}function f7(t,e){return t.x-e.x}function h7(t,e){if(e=d7(t,e),e){const n=WM(e,t);go(e,e.next),go(n,n.next)}}function d7(t,e){let n=e;const r=t.x,i=t.y;let s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const _=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(_<=r&&_>s){if(s=_,_===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o;const a=o,l=o.x,h=o.y;let p=1/0,m;n=o;do r>=n.x&&n.x>=l&&r!==n.x&&Al(i<h?r:s,i,l,h,i<h?s:r,i,n.x,n.y)&&(m=Math.abs(i-n.y)/(r-n.x),ru(n,t)&&(m<p||m===p&&(n.x>o.x||n.x===o.x&&p7(o,n)))&&(o=n,p=m)),n=n.next;while(n!==a);return o}function p7(t,e){return tn(t.prev,t,e.prev)<0&&tn(e.next,t,t.next)<0}function g7(t,e,n,r){let i=t;do i.z===null&&(i.z=D1(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,m7(i)}function m7(t){let e,n,r=1,i,s,o,a,l,h;do{for(s=t,t=null,h=null,i=0;s;){for(i++,a=s,o=0,n=0;n<r&&(o++,a=a.nextZ,!!a);n++);for(l=r;o>0||l>0&&a;)o!==0&&(l===0||!a||s.z<=a.z)?(e=s,s=s.nextZ,o--):(e=a,a=a.nextZ,l--),h?h.nextZ=e:t=e,e.prevZ=h,h=e;s=a}h.nextZ=null,r*=2}while(i>1);return t}function D1(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function y7(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Al(t,e,n,r,i,s,o,a){return(i-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(i-o)*(r-a)>=0}function v7(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!_7(t,e)&&(ru(t,e)&&ru(e,t)&&E7(t,e)&&(tn(t.prev,t,e.prev)||tn(t,e.prev,e))||S0(t,e)&&tn(t.prev,t,t.next)>0&&tn(e.prev,e,e.next)>0)}function tn(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function S0(t,e){return t.x===e.x&&t.y===e.y}function jM(t,e,n,r){const i=zf(tn(t,e,n)),s=zf(tn(t,e,r)),o=zf(tn(n,r,t)),a=zf(tn(n,r,e));return!!(i!==s&&o!==a||i===0&&Gf(t,n,e)||s===0&&Gf(t,r,e)||o===0&&Gf(n,t,r)||a===0&&Gf(n,e,r))}function Gf(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function zf(t){return t>0?1:t<0?-1:0}function _7(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&jM(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function ru(t,e){return tn(t.prev,t,t.next)<0?tn(t,e,t.next)>=0&&tn(t,t.prev,e)>=0:tn(t,e,t.prev)<0||tn(t,t.next,e)<0}function E7(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function WM(t,e){const n=new k1(t.i,t.x,t.y),r=new k1(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function VT(t,e,n,r){const i=new k1(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function iu(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function k1(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Si(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function N1(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function su(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function U1(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function Dh(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function QM(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},l=(a-o)/n;let h=[];const p=[h],m=su(t,0,n,o);let _,E;const b=XM(m,i,s,[]),x=[];Si(h,m);for(let I=1;I<l;I++){for(_=su(t,I,n,o,_),E=Dh(_,b);E;){U1(m,_,E,b,x);const S=Dh(x,b);S&&(U1(m,x,S,b,x),E=S),Si(h,x),N1(m,x),T7(b,i,E),r&&h.length>n&&(h=[],p.push(h),Si(h,m)),E=Dh(_,b)}Si(h,_),N1(m,_)}return r?p:p[0]}const HT=0,w7=1;function Vf(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function $M(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],l=[{pos:t,types:o?new Array(t.length/r).fill(w7):null,holes:e||[]}],h=[[],[]];let p=[];for(;l.length;){const{pos:m,types:_,holes:E}=l.shift();b7(m,r,E[0]||m.length,h),p=XM(h[0],i,s,p);const b=Dh(h[1],p);if(b){let x=jT(m,_,r,0,E[0]||m.length,p,b);const I={pos:x[0].pos,types:x[0].types,holes:[]},S={pos:x[1].pos,types:x[1].types,holes:[]};l.push(I,S);for(let P=0;P<E.length;P++)x=jT(m,_,r,E[P],E[P+1]||m.length,p,b),x[0]&&(I.holes.push(I.pos.length),I.pos=Vf(I.pos,x[0].pos),o&&(I.types=Vf(I.types,x[0].types))),x[1]&&(S.holes.push(S.pos.length),S.pos=Vf(S.pos,x[1].pos),o&&(S.types=Vf(S.types,x[1].types)))}else{const x={positions:m};o&&(x.edgeTypes=_),E.length&&(x.holeIndices=E),a.push(x)}}return a}function jT(t,e,n,r,i,s,o){const a=(i-r)/n,l=[],h=[],p=[],m=[],_=[];let E,b,x;const I=su(t,a-1,n,r);let S=Math.sign(o&8?I[1]-s[3]:I[0]-s[2]),P=e&&e[a-1],M=0,O=0;for(let N=0;N<a;N++)E=su(t,N,n,r,E),b=Math.sign(o&8?E[1]-s[3]:E[0]-s[2]),x=e&&e[r/n+N],b&&S&&S!==b&&(U1(I,E,o,s,_),Si(l,_)&&p.push(P),Si(h,_)&&m.push(P)),b<=0?(Si(l,E)&&p.push(x),M-=b):p.length&&(p[p.length-1]=HT),b>=0?(Si(h,E)&&m.push(x),O+=b):m.length&&(m[m.length-1]=HT),N1(I,E),S=b,P=x;return[M?{pos:l,types:e&&p}:null,O?{pos:h,types:e&&m}:null]}function XM(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function T7(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function b7(t,e,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<n;l+=e){const h=t[l],p=t[l+1];i=h<i?h:i,s=h>s?h:s,o=p<o?p:o,a=p>a?p:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}const x7=85.051129;function C7(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);YM(o,n,0,i-r);const a=QM(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)JM(l,n);return a}function S7(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let l=0,h=0;for(let m=0;m<=e.length;m++){const _=e[m]||t.length,E=h,b=P7(t,r,l,_);for(let x=b;x<_;x++)o[h++]=t[x];for(let x=l;x<b;x++)o[h++]=t[x];YM(o,r,E,h),M7(o,r,E,h,n==null?void 0:n.maxLatitude),l=_,a[m]=h}a.pop();const p=$M(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const m of p)JM(m.positions,r);return p}function P7(t,e,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=e){const a=Math.abs(t[o]);a>i&&(i=a,s=o-1)}return s}function M7(t,e,n,r,i=x7){const s=t[n],o=t[r-e];if(Math.abs(s-o)>180){const a=su(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,Si(t,a),a[1]=Math.sign(a[1])*i,Si(t,a),a[0]=s,Si(t,a)}}function YM(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function JM(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}class I7 extends Ar{constructor(e){const{id:n=Ri("column-geometry")}=e,{indices:r,attributes:i}=B7(e);super({...e,id:n,indices:r,attributes:i})}}function B7(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(Ve.assert(i.length>=r),i=i.flatMap(E=>[E[0],E[1]]),Yv(i,Xv.COUNTER_CLOCKWISE));const s=n>0,o=r+1,a=s?o*3+1:r,l=Math.PI*2/r,h=new Uint16Array(s?r*3*2:0),p=new Float32Array(a*3),m=new Float32Array(a*3);let _=0;if(s){for(let E=0;E<o;E++){const b=E*l,x=E%r,I=Math.sin(b),S=Math.cos(b);for(let P=0;P<2;P++)p[_+0]=i?i[x*2]:S*e,p[_+1]=i?i[x*2+1]:I*e,p[_+2]=(1/2-P)*n,m[_+0]=i?i[x*2]:S,m[_+1]=i?i[x*2+1]:I,_+=3}p[_+0]=p[_-3],p[_+1]=p[_-2],p[_+2]=p[_-1],_+=3}for(let E=s?0:1;E<o;E++){const b=Math.floor(E/2)*Math.sign(.5-E%2),x=b*l,I=(b+r)%r,S=Math.sin(x),P=Math.cos(x);p[_+0]=i?i[I*2]:P*e,p[_+1]=i?i[I*2+1]:S*e,p[_+2]=n/2,m[_+2]=1,_+=3}if(s){let E=0;for(let b=0;b<r;b++)h[E++]=b*2+0,h[E++]=b*2+2,h[E++]=b*2+0,h[E++]=b*2+1,h[E++]=b*2+1,h[E++]=b*2+3}return{indices:h,attributes:{POSITION:{size:3,value:p},NORMAL:{size:3,value:m}}}}const L7=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;

// Custom uniforms
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;

// Result
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  // rotate primitive position and normal
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));

  // calculate elevation, if 3d not enabled set to 0
  // cylindar gemoetry height are between -1.0 to 1.0, transform it to between 0, 1
  float elevation = 0.0;
  // calculate stroke offset
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }

  // if alpha == 0.0 or z < 0.0, do not render element
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;

  // project center of column
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Light calculations
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,R7=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Fd=[0,0,0,255],O7={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:Fd},getLineColor:{type:"accessor",value:Fd},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class P0 extends nr{getShaders(){const{gl:e}=this.context,n=!nt(e),r={},i=this.props.flatShading&&y0(e,Bt.GLSL_DERIVATIVES);return i&&(r.FLAT_SHADING=1),super.getShaders({vs:L7,fs:R7,defines:r,transpileToGLSL100:n,modules:[ci,i?JP:Ov,Ai]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:Fd},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:Fd},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=i.extensionsChanged||n.flatShading!==r.flatShading;if(s){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}(s||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new I7({radius:1,height:r?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o];s+=Math.sqrt(a[0]*a[0]+a[1]*a[1])/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModel(e){return new tr(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const s=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3,wireframeVertexCount:s.indices.value.length}),this.state.model.setProps({geometry:s})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:l,filled:h,stroked:p,wireframe:m,offset:_,coverage:E,radius:b,angle:x}=this.props,{model:I,fillVertexCount:S,wireframeVertexCount:P,edgeDistance:M}=this.state;I.setUniforms(e).setUniforms({radius:b,angle:x/180*Math.PI,offset:_,extruded:l,stroked:p,coverage:E,elevationScale:a,edgeDistance:M,radiusUnits:Vr[o],widthUnits:Vr[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s}),l&&m&&(I.setProps({isIndexed:!0}),I.setVertexCount(P).setDrawMode(1).setUniforms({isStroke:!0}).draw()),h&&(I.setProps({isIndexed:!1}),I.setVertexCount(S).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!l&&p&&(I.setProps({isIndexed:!1}),I.setVertexCount(S*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}T(P0,"layerName","ColumnLayer");T(P0,"defaultProps",O7);const F7={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}};class KM extends P0{getGeometry(e){return new iz}draw({uniforms:e}){const{elevationScale:n,extruded:r,offset:i,coverage:s,cellSize:o,angle:a,radiusUnits:l}=this.props;this.state.model.setUniforms(e).setUniforms({radius:o/2,radiusUnits:Vr[l],angle:a,offset:i,extruded:r,coverage:s,elevationScale:n,edgeDistance:1,isWireframe:!1}).draw()}}T(KM,"layerName","GridCellLayer");T(KM,"defaultProps",F7);function D7(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?QM(i,{size:e,gridResolution:n}):r?C7(i,{size:e}):i}const k7=1,N7=2,Pg=4;class U7 extends OM{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?D7(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(WT(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&WT(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=Pg,r[s+o-2]=Pg):(r[s]+=k7,r[s+o-2]+=N7),r[s+o-1]=Pg}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,l=0;l<s;a++,l++)this.getPointOnPath(e,l,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function WT(t){return Array.isArray(t[0])}const G7=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}

// calculate line join positions
vec3 lineJoin(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  // side of the segment - -1: left, 0: center, 1: right
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);

  // tangent of the corner
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  // direction of the corner
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  // direction of the segment
  vec2 dir = isEnd ? dirA : dirB;
  // direction of the extrusion
  vec2 perp = isEnd ? perpA : perpB;
  // length of the segment
  float L = isEnd ? lenA : lenB;

  // A = angle of the corner
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));

  // -1: right, 1: left
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);

  // relative position to the corner:
  // -1: inside (smaller side of the angle)
  // 0: center
  // 1: outside (bigger side of the angle)
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  // trim if inside corner extends further than the line segment
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);

  // special treatment for start cap and end cap
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;

  // extend out a triangle to envelope the round cap
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }

  // Generate variables for fragment shader
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return currPoint + offset;
}

// In clipspace extrusion, if a line extends behind the camera, clip it to avoid visual artifacts
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    // Extrude in clipspace
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 pos = lineJoin(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);
  } else {
    // Extrude in commonspace
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec4 pos = vec4(
      lineJoin(prevPosition, currPosition, nextPosition, width.xy),
      1.0);
    geometry.position = pos;
    gl_Position = project_common_position_to_clipspace(pos);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,z7=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
/*
 * vPathPosition represents the relative coordinates of the current fragment on the path segment.
 * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.
 * vPathPosition.y - position along the length of the path, between [0, L / width].
 */
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    // if joint is rounded, test distance from the corner
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    // trim miter
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,ZM=[0,0,0,255],V7={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:ZM},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Mg={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class ca extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:G7,fs:z7,modules:[ci,Ai]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Mg,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Mg,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Mg,defaultValue:ZM},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new U7({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,l=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:l.getPath,buffers:l,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else this._disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:h}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Vr[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:h}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}T(ca,"defaultProps",V7);T(ca,"layerName","PathLayer");var Jv={exports:{}};Jv.exports=M0;Jv.exports.default=M0;function M0(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=qM(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,h,p,m,_,E;if(r&&(s=$7(t,e,s,n)),t.length>80*n){a=h=t[0],l=p=t[1];for(var b=n;b<i;b+=n)m=t[b],_=t[b+1],m<a&&(a=m),_<l&&(l=_),m>h&&(h=m),_>p&&(p=_);E=Math.max(h-a,p-l),E=E!==0?32767/E:0}return ou(s,o,n,a,l,E,0),o}function qM(t,e,n,r,i){var s,o;if(i===V1(t,e,n,r)>0)for(s=e;s<n;s+=r)o=QT(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=QT(s,t[s],t[s+1],o);return o&&I0(o,o.next)&&(lu(o),o=o.next),o}function Aa(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(I0(n,n.next)||nn(n.prev,n,n.next)===0)){if(lu(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function ou(t,e,n,r,i,s,o){if(!!t){!o&&s&&Z7(t,r,i,s);for(var a=t,l,h;t.prev!==t.next;){if(l=t.prev,h=t.next,s?j7(t,r,i,s):H7(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(h.i/n|0),lu(t),t=h.next,a=h.next;continue}if(t=h,t===a){o?o===1?(t=W7(Aa(t),e,n),ou(t,e,n,r,i,s,2)):o===2&&Q7(t,e,n,r,i,s):ou(Aa(t),e,n,r,i,s,1);break}}}}function H7(t){var e=t.prev,n=t,r=t.next;if(nn(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,h=r.y,p=i<s?i<o?i:o:s<o?s:o,m=a<l?a<h?a:h:l<h?l:h,_=i>s?i>o?i:o:s>o?s:o,E=a>l?a>h?a:h:l>h?l:h,b=r.next;b!==e;){if(b.x>=p&&b.x<=_&&b.y>=m&&b.y<=E&&ul(i,a,s,l,o,h,b.x,b.y)&&nn(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function j7(t,e,n,r){var i=t.prev,s=t,o=t.next;if(nn(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,h=o.x,p=i.y,m=s.y,_=o.y,E=a<l?a<h?a:h:l<h?l:h,b=p<m?p<_?p:_:m<_?m:_,x=a>l?a>h?a:h:l>h?l:h,I=p>m?p>_?p:_:m>_?m:_,S=G1(E,b,e,n,r),P=G1(x,I,e,n,r),M=t.prevZ,O=t.nextZ;M&&M.z>=S&&O&&O.z<=P;){if(M.x>=E&&M.x<=x&&M.y>=b&&M.y<=I&&M!==i&&M!==o&&ul(a,p,l,m,h,_,M.x,M.y)&&nn(M.prev,M,M.next)>=0||(M=M.prevZ,O.x>=E&&O.x<=x&&O.y>=b&&O.y<=I&&O!==i&&O!==o&&ul(a,p,l,m,h,_,O.x,O.y)&&nn(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;M&&M.z>=S;){if(M.x>=E&&M.x<=x&&M.y>=b&&M.y<=I&&M!==i&&M!==o&&ul(a,p,l,m,h,_,M.x,M.y)&&nn(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;O&&O.z<=P;){if(O.x>=E&&O.x<=x&&O.y>=b&&O.y<=I&&O!==i&&O!==o&&ul(a,p,l,m,h,_,O.x,O.y)&&nn(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function W7(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!I0(i,s)&&eI(i,r,r.next,s)&&au(i,s)&&au(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),lu(r),lu(r.next),r=t=s),r=r.next}while(r!==t);return Aa(r)}function Q7(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&tW(o,a)){var l=tI(o,a);o=Aa(o,o.next),l=Aa(l,l.next),ou(o,e,n,r,i,s,0),ou(l,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function $7(t,e,n,r){var i=[],s,o,a,l,h;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,h=qM(t,a,l,r,!1),h===h.next&&(h.steiner=!0),i.push(eW(h));for(i.sort(X7),s=0;s<i.length;s++)n=Y7(i[s],n);return n}function X7(t,e){return t.x-e.x}function Y7(t,e){var n=J7(t,e);if(!n)return e;var r=tI(n,t);return Aa(r,r.next),Aa(n,n.next)}function J7(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var l=o,h=o.x,p=o.y,m=1/0,_;n=o;do r>=n.x&&n.x>=h&&r!==n.x&&ul(i<p?r:s,i,h,p,i<p?s:r,i,n.x,n.y)&&(_=Math.abs(i-n.y)/(r-n.x),au(n,t)&&(_<m||_===m&&(n.x>o.x||n.x===o.x&&K7(o,n)))&&(o=n,m=_)),n=n.next;while(n!==l);return o}function K7(t,e){return nn(t.prev,t,e.prev)<0&&nn(e.next,t,t.next)<0}function Z7(t,e,n,r){var i=t;do i.z===0&&(i.z=G1(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,q7(i)}function q7(t){var e,n,r,i,s,o,a,l,h=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<h&&(a++,r=r.nextZ,!!r);e++);for(l=h;a>0||l>0&&r;)a!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,h*=2}while(o>1);return t}function G1(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function eW(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function ul(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function tW(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!nW(t,e)&&(au(t,e)&&au(e,t)&&rW(t,e)&&(nn(t.prev,t,e.prev)||nn(t,e.prev,e))||I0(t,e)&&nn(t.prev,t,t.next)>0&&nn(e.prev,e,e.next)>0)}function nn(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function I0(t,e){return t.x===e.x&&t.y===e.y}function eI(t,e,n,r){var i=jf(nn(t,e,n)),s=jf(nn(t,e,r)),o=jf(nn(n,r,t)),a=jf(nn(n,r,e));return!!(i!==s&&o!==a||i===0&&Hf(t,n,e)||s===0&&Hf(t,r,e)||o===0&&Hf(n,t,r)||a===0&&Hf(n,e,r))}function Hf(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function jf(t){return t>0?1:t<0?-1:0}function nW(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&eI(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function au(t,e){return nn(t.prev,t,t.next)<0?nn(t,e,t.next)>=0&&nn(t,t.prev,e)>=0:nn(t,e,t.prev)<0||nn(t,t.next,e)<0}function rW(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function tI(t,e){var n=new z1(t.i,t.x,t.y),r=new z1(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function QT(t,e,n,r){var i=new z1(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function lu(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function z1(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}M0.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(V1(t,0,s,n));if(i)for(var a=0,l=e.length;a<l;a++){var h=e[a]*n,p=a<l-1?e[a+1]*n:t.length;o-=Math.abs(V1(t,h,p,n))}var m=0;for(a=0;a<r.length;a+=3){var _=r[a]*n,E=r[a+1]*n,b=r[a+2]*n;m+=Math.abs((t[_]-t[b])*(t[E+1]-t[_+1])-(t[_]-t[E])*(t[b+1]-t[_+1]))}return o===0&&m===0?0:Math.abs((m-o)/o)};function V1(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}M0.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};const Wf=Xv.CLOCKWISE,$T=Xv.COUNTER_CLOCKWISE,qs={isClosed:!0};function iW(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function sA(t){return"positions"in t?t.positions:t}function kh(t){return"holeIndices"in t?t.holeIndices:null}function sW(t){return Array.isArray(t[0])}function oW(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function aW(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function lW(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function XT(t,e,n,r,i){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let l=0;l<r;l++)t[s++]=n[a][l]||0;if(!aW(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return qs.start=e,qs.end=s,qs.size=r,Yv(t,i,qs),s}function YT(t,e,n,r,i=0,s,o){s=s||n.length;const a=s-i;if(a<=0)return e;let l=e;for(let h=0;h<a;h++)t[l++]=n[i+h];if(!lW(n,r,i,s))for(let h=0;h<r;h++)t[l++]=n[i+h];return qs.start=e,qs.end=l,qs.size=r,Yv(t,o,qs),l}function nI(t,e){iW(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=YT(n,o,i,e,s[a-1],s[a],a===0?Wf:$T),r.push(o);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!sW(t))return YT(n,0,t,e,0,n.length,Wf),n;if(!oW(t)){let i=0;for(const[s,o]of t.entries())i=XT(n,i,o,e,s===0?Wf:$T),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return XT(n,0,t,e,Wf),n}function cW(t,e,n){let r=kh(t);r&&(r=r.map(s=>s/e));let i=sA(t);if(n){const s=i.length;i=i.slice();const o=[];for(let a=0;a<s;a+=e){o[0]=i[a],o[1]=i[a+1];const l=n(o);i[a]=l[0],i[a+1]=l[1]}}return Jv.exports(i,r,e)}class AW extends OM{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=nI(e,this.positionSize);return this.opts.resolution?$M(sA(n),kh(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?S7(sA(n),kh(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(JT(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return sA(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&JT(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let h=i;const p=cW(e,this.positionSize,this.opts.preproject);l=a.allocate(l,i+p.length,{copy:!0});for(let m=0;m<p.length;m++)l[h++]=p[m]+r;o[n+1]=i+p.length,s.indices=l}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=sA(e);for(let a=n,l=0;l<r;a++,l++){const h=o[l*s],p=o[l*s+1],m=s>2?o[l*s+2]:0;i[a*3]=h,i[a*3+1]=p,i[a*3+2]=m}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&kh(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function JT(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const rI=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,uW=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(rI,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),fW=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(rI,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),hW=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Dd=[0,0,0,255],dW={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Dd},getLineColor:{type:"accessor",value:Dd},material:!0},Qf={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class B0 extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?uW:fW,fs:hW,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[ci,Ov,Ai]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;n.isGeospatial&&r===$e.DEFAULT&&(r=$e.LNGLAT),this.setState({numInstances:0,polygonTesselator:new AW({preproject:r===$e.LNGLAT&&n.projectFlat.bind(n),fp64:this.use64bitPositions(),IndexType:!e||_v(e,Bt.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const i=this.getAttributeManager(),s=!0;i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Qf,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:Qf,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Qf,accessor:"getFillColor",defaultValue:Dd,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Qf,accessor:"getLineColor",defaultValue:Dd,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(o,{index:a,target:l})=>this.encodePickingColor(o&&o.__source?o.__source.index:a,l),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else this._disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,polygonTesselator:l}=this.state,h={...e,extruded:Boolean(n),elevationScale:s};a&&(a.setInstanceCount(l.instanceCount-1),a.setUniforms(h),i&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),r&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(l.vertexCount),o.setUniforms(h).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(l=>l.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,o;if(r){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new tr(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new tr(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Ar({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,s].filter(Boolean),topModel:s,sideModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}T(B0,"defaultProps",dW);T(B0,"layerName","SolidPolygonLayer");function iI({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,o=t.length;let a=o,l=o;for(let _=0;_<o;_++){const E=e(t[_]);if(a>_&&E>=i&&(a=_),E>=s){l=_;break}}let h=a;const m=l-a!==r.length?t.slice(l):void 0;for(let _=0;_<r.length;_++)t[h++]=r[_];if(m){for(let _=0;_<m.length;_++)t[h++]=m[_];t.length=h}return{startRow:a,endRow:a+r.length}}const sI=[0,0,0,255],pW=[0,0,0,255],gW={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:pW},getLineColor:{type:"accessor",value:sI},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class oc extends Ss{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&Ve.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(s=>iI({data:r,getIndex:o=>o.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:s}=this.props,o=[],a=i==="XY"?2:3,{startRow:l,endRow:h}=e,{iterable:p,objectInfo:m}=Eo(n,l,h);for(const _ of p){m.index++;let E=r(_,m);s&&(E=nI(E,a));const{holeIndices:b}=E,x=E.positions||E;if(b)for(let I=0;I<=b.length;I++){const S=x.slice(b[I-1]||0,b[I]||x.length);o.push(this.getSubLayerRow({path:S},_,m.index))}else o.push(this.getSubLayerRow({path:x},_,m.index))}return o}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:s,wireframe:o,_normalize:a,_windingOrder:l,elevationScale:h,transitions:p,positionFormat:m}=this.props,{lineWidthUnits:_,lineWidthScale:E,lineWidthMinPixels:b,lineWidthMaxPixels:x,lineJointRounded:I,lineMiterLimit:S,lineDashJustified:P}=this.props,{getFillColor:M,getLineColor:O,getLineWidth:N,getLineDashArray:z,getElevation:X,getPolygon:Z,updateTriggers:Q,material:k}=this.props,{paths:D,pathsDiff:ne}=this.state,se=this.getSubLayerClass("fill",B0),oe=this.getSubLayerClass("stroke",ca),xe=this.shouldRenderSubLayer("fill",D)&&new se({_dataDiff:n,extruded:s,elevationScale:h,filled:i,wireframe:o,_normalize:a,_windingOrder:l,getElevation:X,getFillColor:M,getLineColor:s&&o?O:sI,material:k,transitions:p},this.getSubLayerProps({id:"fill",updateTriggers:Q&&{getPolygon:Q.getPolygon,getElevation:Q.getElevation,getFillColor:Q.getFillColor,lineColors:s&&o,getLineColor:Q.getLineColor}}),{data:e,positionFormat:m,getPolygon:Z}),Pe=!s&&r&&this.shouldRenderSubLayer("stroke",D)&&new oe({_dataDiff:ne&&(()=>ne),widthUnits:_,widthScale:E,widthMinPixels:b,widthMaxPixels:x,jointRounded:I,miterLimit:S,dashJustified:P,_pathType:"loop",transitions:p&&{getWidth:p.getLineWidth,getColor:p.getLineColor,getPath:p.getPolygon},getColor:this.getSubLayerAccessor(O),getWidth:this.getSubLayerAccessor(N),getDashArray:this.getSubLayerAccessor(z)},this.getSubLayerProps({id:"stroke",updateTriggers:Q&&{getWidth:Q.getLineWidth,getColor:Q.getLineColor,getDashArray:Q.getLineDashArray}}),{data:D,positionFormat:m,getPath:Ue=>Ue.path});return[!s&&xe,Pe,s&&xe]}}T(oc,"layerName","PolygonLayer");T(oc,"defaultProps",gW);function mW(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?yW(t,r,n):null}function yW(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function vW(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let o=0;o<i.length;o++)e(i[o],s),n[r][o*3+0]=s[0],n[r][o*3+1]=s[1],n[r][o*3+2]=s[2]}return n}const _W=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float buffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;

    // if enable sdf (signed distance fields)
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }

    // Take the global opacity and the alpha from color into account for the alpha component
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,KT=192/256,ZT=[],EW={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class Kv extends x0{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:_W}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&Ve.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state;e.uniforms={...e.uniforms,buffer:KT,outlineBuffer:i?Math.max(r,KT*(1-i)):-1,gamma:r,sdf:Boolean(n),outlineColor:s},super.draw(e)}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):ZT}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):ZT}}T(Kv,"defaultProps",EW);T(Kv,"layerName","MultiIconLayer");var Zv={exports:{}};Zv.exports=Ou;Zv.exports.default=Ou;var Il=1e20;function Ou(t,e,n,r,i,s){this.fontSize=t||24,this.buffer=e===void 0?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=s||"normal",this.radius=n||8;var o=this.size=this.fontSize+this.buffer*2,a=o+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function wW(t,e,n,r,i,s,o){s.fill(Il,0,e*n),o.fill(0,0,e*n);for(var a=(e-r)/2,l=0;l<i;l++)for(var h=0;h<r;h++){var p=(l+a)*e+h+a,m=t.data[4*(l*r+h)+3]/255;if(m===1)s[p]=0,o[p]=Il;else if(m===0)s[p]=Il,o[p]=0;else{var _=Math.max(0,.5-m),E=Math.max(0,m-.5);s[p]=_*_,o[p]=E*E}}}function TW(t,e,n,r,i,s,o){for(var a=0;a<e*n;a++){var l=Math.sqrt(r[a])-Math.sqrt(i[a]);t[a]=Math.round(255-255*(l/s+o))}}Ou.prototype._draw=function(t,e){var n=this.ctx.measureText(t),r=n.width,i=2*this.buffer,s,o,a,l,h,p,m,_;e&&this.useMetrics?(h=Math.floor(n.actualBoundingBoxAscent),_=this.buffer+Math.ceil(n.actualBoundingBoxAscent),p=this.buffer,m=this.buffer,o=Math.min(this.size,Math.ceil(n.actualBoundingBoxRight-n.actualBoundingBoxLeft)),l=Math.min(this.size-p,Math.ceil(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)),s=o+i,a=l+i,this.ctx.textBaseline="alphabetic"):(s=o=this.size,a=l=this.size,h=19*this.fontSize/24,p=m=0,_=this.middle,this.ctx.textBaseline="middle");var E;o&&l&&(this.ctx.clearRect(m,p,o,l),this.ctx.fillText(t,this.buffer,_),E=this.ctx.getImageData(m,p,o,l));var b=new Uint8ClampedArray(s*a);return wW(E,s,a,o,l,this.gridOuter,this.gridInner),qT(this.gridOuter,s,a,this.f,this.v,this.z),qT(this.gridInner,s,a,this.f,this.v,this.z),TW(b,s,a,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:b,metrics:{width:o,height:l,sdfWidth:s,sdfHeight:a,top:h,left:0,advance:r}}};Ou.prototype.draw=function(t){return this._draw(t,!1).data};Ou.prototype.drawWithMetrics=function(t){return this._draw(t,!0)};function qT(t,e,n,r,i,s){for(var o=0;o<e;o++)eb(t,o,e,n,r,i,s);for(var a=0;a<n;a++)eb(t,a*e,1,e,r,i,s)}function eb(t,e,n,r,i,s,o){var a,l,h,p;for(s[0]=0,o[0]=-Il,o[1]=Il,a=0;a<r;a++)i[a]=t[e+a*n];for(a=1,l=0,h=0;a<r;a++){do p=s[l],h=(i[a]-i[p]+a*a-p*p)/(a-p)/2;while(h<=o[l]&&--l>-1);l++,s[l]=a,o[l]=h,o[l+1]=Il}for(a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;p=s[l],t[e+a*n]=i[p]+(a-p)*(a-p)}}const bW=32,xW=[];function CW(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function SW({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,h=o;for(const m of t)if(!s[m]){const _=e(m);h+_+r*2>i&&(h=0,l++),s[m]={x:h+r,y:a+l*(n+r*2)+r,width:_,height:n},h+=_+r*2}const p=n+r*2;return{mapping:s,xOffset:h,yOffset:a+l*p,canvasHeight:CW(a+(l+1)*p)}}function oI(t,e,n,r){let i=0;for(let o=e;o<n;o++){var s;const a=t[o];i+=((s=r[a])===null||s===void 0?void 0:s.width)||0}return i}function aI(t,e,n,r,i,s){let o=e,a=0;for(let l=e;l<n;l++){const h=oI(t,l,l+1,i);a+h>r&&(o<l&&s.push(l),o=l,a=0),a+=h}return a}function PW(t,e,n,r,i,s){let o=e,a=e,l=e,h=0;for(let p=e;p<n;p++)if((t[p]===" "||t[p+1]===" "||p+1===n)&&(l=p+1),l>a){let m=oI(t,a,l,i);h+m>r&&(o<a&&(s.push(a),o=a,h=0),m>r&&(m=aI(t,a,l,r,i,s),o=s[s.length-1])),a=l,h+=m}return h}function MW(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?aI(t,i,s,n,r,o):PW(t,i,s,n,r,o),o}function IW(t,e,n,r,i,s){let o=0,a=0;for(let l=e;l<n;l++){const h=t[l],p=r[h];p?(a||(a=p.height),i[l]=o+p.width/2,o+=p.width):(Ve.warn("Missing character: ".concat(h," (").concat(h.codePointAt(0),")"))(),i[l]=o,o+=bW)}s[0]=o,s[1]=a}function tb(t,e,n,r,i){const s=Array.from(t),o=s.length,a=new Array(o),l=new Array(o),h=new Array(o),p=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,m=[0,0],_=[0,0];let E=0,b=0,x=0;for(let I=0;I<=o;I++){const S=s[I];if((S===`
`||I===o)&&(x=I),x>b){const P=p?MW(s,n,r,i,b,x):xW;for(let M=0;M<=P.length;M++){const O=M===0?b:P[M-1],N=M<P.length?P[M]:x;IW(s,O,N,i,a,_);for(let z=O;z<N;z++)l[z]=E+_[1]/2,h[z]=_[0];E=E+_[1]*e,m[0]=Math.max(m[0],_[0])}b=x}S===`
`&&(a[b]=0,l[b]=0,h[b]=0,b++)}return m[1]=E,{x:a,y:l,rowWidth:h,size:m}}function BW({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,l=r?r/o:0,h=i[e]||Math.ceil((t.length-l)/a),p=s&&new Set,m=new Array(e);let _=t;if(a>1||l>0){const E=t.constructor;_=new E(h);for(let b=0;b<h;b++)_[b]=t[b*a+l]}for(let E=0;E<e;E++){const b=i[E],x=i[E+1]||h,I=_.subarray(b,x);m[E]=String.fromCodePoint.apply(null,I),p&&I.forEach(p.add,p)}if(p)for(const E of p)s.add(String.fromCodePoint(E));return{texts:m,characterCount:h}}class lI{constructor(e=5){T(this,"limit",void 0),T(this,"_cache",{}),T(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function LW(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const xA={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:LW(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},nb=1024,RW=.9,rb=1.2,cI=3;let kd=new lI(cI);function OW(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=kd.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function FW(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function ib(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function DW(t){Ve.assert(Number.isFinite(t)&&t>=cI,"Invalid cache limit"),kd=new lI(t)}class kW{constructor(){T(this,"props",{...xA}),T(this,"_key",void 0),T(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return rb}setProps(e={}){Object.assign(this.props,e);const n=this._key;this._key=this._getKey();const r=OW(this._key,this.props.characterSet),i=kd.get(this._key);if(i&&r.size===0){this._key!==n&&(this._atlas=i);return}const s=this._generateFontAtlas(this._key,r,i);this._atlas=s,kd.set(this._key,s)}_generateFontAtlas(e,n,r){const{fontFamily:i,fontWeight:s,fontSize:o,buffer:a,sdf:l,radius:h,cutoff:p}=this.props;let m=r&&r.data;m||(m=document.createElement("canvas"),m.width=nb);const _=m.getContext("2d");ib(_,i,o,s);const{mapping:E,canvasHeight:b,xOffset:x,yOffset:I}=SW({getFontWidth:S=>_.measureText(S).width,fontHeight:o*rb,buffer:a,characterSet:n,maxCanvasWidth:nb,...r&&{mapping:r.mapping,xOffset:r.xOffset,yOffset:r.yOffset}});if(m.height!==b){const S=_.getImageData(0,0,m.width,m.height);m.height=b,_.putImageData(S,0,0)}if(ib(_,i,o,s),l){const S=new Zv.exports(o,a,h,p,i,s),P=_.getImageData(0,0,S.size,S.size);for(const M of n)FW(S.draw(M),P),_.putImageData(P,E[M].x-a,E[M].y+a)}else for(const S of n)_.fillText(S,E[S].x,E[S].y+o*RW);return{xOffset:x,yOffset:I,mapping:E,data:m,width:m.width,height:m.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(o," ").concat(a):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const NW=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;

  // convert size in meters to pixels, then scaled and clamp

  // project meters to pixels and clamp to limits
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply opacity to instance color, or return instance picking color
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,UW=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,GW={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class qv extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:NW,fs:UW,modules:[ci,Ai]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:Boolean(a),padding:l,sizeUnits:Vr[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new tr(e,{...this.getShaders(),id:this.props.id,geometry:new Ar({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}T(qv,"defaultProps",GW);T(qv,"layerName","TextBackgroundLayer");const sb={start:1,middle:0,end:-1},ob={top:1,center:0,bottom:-1},Ig=[0,0,0,255],zW=1,VW={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Ig},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:xA.characterSet},fontFamily:xA.fontFamily,fontWeight:xA.fontWeight,lineHeight:zW,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Ig},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Ig},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class e_ extends Ss{constructor(...e){super(...e),T(this,"state",void 0),T(this,"getBoundingRect",(n,r)=>{const i=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:h,getAlignmentBaseline:p}=this.props,m=s(n,r)||"",{size:[_,E]}=tb(m,l,o,a,i),b=sb[typeof h=="function"?h(n,r):h],x=ob[typeof p=="function"?p(n,r):p];return[(b-1)*_/2,(x-1)*E/2,_,E]}),T(this,"getIconOffsets",(n,r)=>{const i=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:h,getAlignmentBaseline:p}=this.props,m=s(n,r)||"",{x:_,y:E,rowWidth:b,size:[x,I]}=tb(m,l,o,a,i),S=sb[typeof h=="function"?h(n,r):h],P=ob[typeof p=="function"?p(n,r):p],M=_.length,O=new Array(M*2);let N=0;for(let z=0;z<M;z++){const X=(1-S)*(x-b[z])/2;O[N++]=(S-1)*x/2+X+_[z],O[N++]=(P-1)*I/2+E[z]}return O})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new kW}}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,o=n.startIndices,a;const l=r==="auto"&&new Set;if(i&&o){const{texts:h,characterCount:p}=BW({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:o,characterSet:l});a=p,s=(m,{index:_})=>h[_]}else{const{iterable:h,objectInfo:p}=Eo(n);o=[0],a=0;for(const m of h){p.index++;const _=Array.from(s(m,p)||"");l&&_.forEach(l.add,l),a+=_.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||r})}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:o},styleVersion:a}=this.state,{data:l,_dataDiff:h,getPosition:p,getColor:m,getSize:_,getAngle:E,getPixelOffset:b,getBackgroundColor:x,getBorderColor:I,getBorderWidth:S,backgroundPadding:P,background:M,billboard:O,fontSettings:N,outlineWidth:z,outlineColor:X,sizeScale:Z,sizeUnits:Q,sizeMinPixels:k,sizeMaxPixels:D,transitions:ne,updateTriggers:se}=this.props,oe=this.getSubLayerClass("characters",Kv),xe=this.getSubLayerClass("background",qv);return[M&&new xe({getFillColor:x,getLineColor:I,getLineWidth:S,padding:P,getPosition:p,getSize:_,getAngle:E,getPixelOffset:b,billboard:O,sizeScale:Z/this.state.fontAtlasManager.props.fontSize,sizeUnits:Q,sizeMinPixels:k,sizeMaxPixels:D,transitions:ne&&{getPosition:ne.getPosition,getAngle:ne.getAngle,getSize:ne.getSize,getFillColor:ne.getBackgroundColor,getLineColor:ne.getBorderColor,getLineWidth:ne.getBorderWidth,getPixelOffset:ne.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:se.getPosition,getAngle:se.getAngle,getSize:se.getSize,getFillColor:se.getBackgroundColor,getLineColor:se.getBorderColor,getLineWidth:se.getBorderWidth,getPixelOffset:se.getPixelOffset,getBoundingRect:{getText:se.getText,getTextAnchor:se.getTextAnchor,getAlignmentBaseline:se.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:h,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new oe({sdf:N.sdf,smoothing:Number.isFinite(N.smoothing)?N.smoothing:xA.smoothing,outlineWidth:z,outlineColor:X,iconAtlas:s,iconMapping:o,getPosition:p,getColor:m,getSize:_,getAngle:E,getPixelOffset:b,billboard:O,sizeScale:Z*i,sizeUnits:Q,sizeMinPixels:k*i,sizeMaxPixels:D*i,transitions:ne&&{getPosition:ne.getPosition,getAngle:ne.getAngle,getColor:ne.getColor,getSize:ne.getSize,getPixelOffset:ne.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:se.getText,getPosition:se.getPosition,getAngle:se.getAngle,getColor:se.getColor,getSize:se.getSize,getPixelOffset:se.getPixelOffset,getIconOffsets:{getText:se.getText,getTextAnchor:se.getTextAnchor,getAlignmentBaseline:se.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:h,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){DW(e)}}T(e_,"defaultProps",VW);T(e_,"layerName","TextLayer");const Nh={circle:{type:C0,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:x0,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:e_,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Uh={type:ca,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},H1={type:B0,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Nc({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Bg(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function HW(t){if(Array.isArray(t))return t;switch(Ve.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Ve.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function ab(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let o=i;o<s;o++){const a=t[o];Ve.assert(a&&a.geometry,"GeoJSON does not have geometry");const{geometry:l}=a;if(l.type==="GeometryCollection"){Ve.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");const{geometries:h}=l;for(let p=0;p<h.length;p++){const m=h[p];lb(m,r,e,a,o)}}else lb(l,r,e,a,o)}return r}function lb(t,e,n,r,i){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:h,polygonOutlineFeatures:p}=e;if(!WW(s,o)){Ve.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":o.forEach(m=>{a.push(n({geometry:{type:"Point",coordinates:m}},r,i))});break;case"LineString":l.push(n({geometry:t},r,i));break;case"MultiLineString":o.forEach(m=>{l.push(n({geometry:{type:"LineString",coordinates:m}},r,i))});break;case"Polygon":h.push(n({geometry:t},r,i)),o.forEach(m=>{p.push(n({geometry:{type:"LineString",coordinates:m}},r,i))});break;case"MultiPolygon":o.forEach(m=>{h.push(n({geometry:{type:"Polygon",coordinates:m}},r,i)),m.forEach(_=>{p.push(n({geometry:{type:"LineString",coordinates:_}},r,i))})});break}}const jW={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function WW(t,e){let n=jW[t];for(Ve.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function AI(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function $f(t){return t.geometry.coordinates}function QW(t,e){const n=AI(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=$f,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=$f,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=$f,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=$f,n}function $W(t,e){const n=AI(),{points:r,lines:i,polygons:s}=t,o=vW(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const XW=["points","linestrings","polygons"],YW={...Nc(Nh.circle),...Nc(Nh.icon),...Nc(Nh.text),...Nc(Uh),...Nc(H1),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Fu extends Ss{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=$W(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=HW(e.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const l=this.state.features;for(const h in l)s[h]=l[h].slice(),o[h]=[];for(const h of n.dataChanged){const p=ab(r,i,h);for(const m in l)o[m].push(iI({data:s[m],getIndex:_=>_.__source.index,dataRange:h,replace:p[m]}))}}else s=ab(r,i);const a=QW(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=XW.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,H1.type);if(s){const o=Bg(this,H1.props),a=e&&n;return a||delete o.getLineColor,o.updateTriggers.lineColors=a,new s(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,Uh.type),a=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,Uh.type);if(o||a){const l=Bg(this,Uh.props);return[o&&new o(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers}),r.polygonsOutline),a&&new a(l,this.getSubLayerProps({id:s,updateTriggers:l.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(a=>a.__source.index===i));const s=new Set(e.split("+")),o=[];for(const a of s){const l="points-".concat(a),h=Nh[a],p=h&&this.shouldRenderSubLayer(l,n.points.data)&&this.getSubLayerClass(l,h.type);if(p){const m=Bg(this,h.props);let _=n.points;if(a==="text"&&r){const{instancePickingColors:E,...b}=_.data.attributes;_={..._,data:{..._.data,attributes:b}}}o.push(new p(m,this.getSubLayerProps({id:l,updateTriggers:m.updateTriggers,highlightedObjectIndex:i}),_))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:o}=i,a=mW(s,o);return e(a,i)}}}T(Fu,"layerName","GeoJsonLayer");T(Fu,"defaultProps",YW);const JW={getHeight:{type:"accessor",value:0},greatCircle:!0};class uI extends Qv{}T(uI,"layerName","GreatCircleLayer");T(uI,"defaultProps",JW);const KW={...oc.defaultProps};class ac extends Ss{indexToBounds(){return null}renderLayers(){const{elevationScale:e,extruded:n,wireframe:r,filled:i,stroked:s,lineWidthUnits:o,lineWidthScale:a,lineWidthMinPixels:l,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:m,lineDashJustified:_,getElevation:E,getFillColor:b,getLineColor:x,getLineWidth:I}=this.props,{updateTriggers:S,material:P,transitions:M}=this.props,O=this.getSubLayerClass("cell",oc);return new O({filled:i,wireframe:r,extruded:n,elevationScale:e,stroked:s,lineWidthUnits:o,lineWidthScale:a,lineWidthMinPixels:l,lineWidthMaxPixels:h,lineJointRounded:p,lineMiterLimit:m,lineDashJustified:_,material:P,transitions:M,getElevation:E,getFillColor:b,getLineColor:x,getLineWidth:I},this.getSubLayerProps({id:"cell",updateTriggers:S&&{getElevation:S.getElevation,getFillColor:S.getFillColor,getLineColor:S.getLineColor,getLineWidth:S.getLineWidth}}),this.indexToBounds())}}T(ac,"layerName","GeoCellLayer");T(ac,"defaultProps",KW);function ZW(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fI={exports:{}};(function(t){/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */(function(e,n){typeof ZW=="function"&&!0&&t&&t.exports?t.exports=n():(e.dcodeIO=e.dcodeIO||{}).Long=n()})($R,function(){function e(k,D,ne){this.low=k|0,this.high=D|0,this.unsigned=!!ne}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function n(k){return(k&&k.__isLong__)===!0}e.isLong=n;var r={},i={};function s(k,D){var ne,se,oe;return D?(k>>>=0,(oe=0<=k&&k<256)&&(se=i[k],se)?se:(ne=a(k,(k|0)<0?-1:0,!0),oe&&(i[k]=ne),ne)):(k|=0,(oe=-128<=k&&k<128)&&(se=r[k],se)?se:(ne=a(k,k<0?-1:0,!1),oe&&(r[k]=ne),ne))}e.fromInt=s;function o(k,D){if(isNaN(k)||!isFinite(k))return D?P:S;if(D){if(k<0)return P;if(k>=b)return X}else{if(k<=-x)return Z;if(k+1>=x)return z}return k<0?o(-k,D).neg():a(k%E|0,k/E|0,D)}e.fromNumber=o;function a(k,D,ne){return new e(k,D,ne)}e.fromBits=a;var l=Math.pow;function h(k,D,ne){if(k.length===0)throw Error("empty string");if(k==="NaN"||k==="Infinity"||k==="+Infinity"||k==="-Infinity")return S;if(typeof D=="number"?(ne=D,D=!1):D=!!D,ne=ne||10,ne<2||36<ne)throw RangeError("radix");var se;if((se=k.indexOf("-"))>0)throw Error("interior hyphen");if(se===0)return h(k.substring(1),D,ne).neg();for(var oe=o(l(ne,8)),xe=S,Pe=0;Pe<k.length;Pe+=8){var Ue=Math.min(8,k.length-Pe),le=parseInt(k.substring(Pe,Pe+Ue),ne);if(Ue<8){var ve=o(l(ne,Ue));xe=xe.mul(ve).add(o(le))}else xe=xe.mul(oe),xe=xe.add(o(le))}return xe.unsigned=D,xe}e.fromString=h;function p(k){return k instanceof e?k:typeof k=="number"?o(k):typeof k=="string"?h(k):a(k.low,k.high,k.unsigned)}e.fromValue=p;var m=1<<16,_=1<<24,E=m*m,b=E*E,x=b/2,I=s(_),S=s(0);e.ZERO=S;var P=s(0,!0);e.UZERO=P;var M=s(1);e.ONE=M;var O=s(1,!0);e.UONE=O;var N=s(-1);e.NEG_ONE=N;var z=a(-1,2147483647,!1);e.MAX_VALUE=z;var X=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=X;var Z=a(0,-2147483648,!1);e.MIN_VALUE=Z;var Q=e.prototype;return Q.toInt=function(){return this.unsigned?this.low>>>0:this.low},Q.toNumber=function(){return this.unsigned?(this.high>>>0)*E+(this.low>>>0):this.high*E+(this.low>>>0)},Q.toString=function(D){if(D=D||10,D<2||36<D)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Z)){var ne=o(D),se=this.div(ne),oe=se.mul(ne).sub(this);return se.toString(D)+oe.toInt().toString(D)}else return"-"+this.neg().toString(D);for(var xe=o(l(D,6),this.unsigned),Pe=this,Ue="";;){var le=Pe.div(xe),ve=Pe.sub(le.mul(xe)).toInt()>>>0,Ce=ve.toString(D);if(Pe=le,Pe.isZero())return Ce+Ue;for(;Ce.length<6;)Ce="0"+Ce;Ue=""+Ce+Ue}},Q.getHighBits=function(){return this.high},Q.getHighBitsUnsigned=function(){return this.high>>>0},Q.getLowBits=function(){return this.low},Q.getLowBitsUnsigned=function(){return this.low>>>0},Q.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Z)?64:this.neg().getNumBitsAbs();for(var D=this.high!=0?this.high:this.low,ne=31;ne>0&&(D&1<<ne)==0;ne--);return this.high!=0?ne+33:ne+1},Q.isZero=function(){return this.high===0&&this.low===0},Q.isNegative=function(){return!this.unsigned&&this.high<0},Q.isPositive=function(){return this.unsigned||this.high>=0},Q.isOdd=function(){return(this.low&1)===1},Q.isEven=function(){return(this.low&1)===0},Q.equals=function(D){return n(D)||(D=p(D)),this.unsigned!==D.unsigned&&this.high>>>31===1&&D.high>>>31===1?!1:this.high===D.high&&this.low===D.low},Q.eq=Q.equals,Q.notEquals=function(D){return!this.eq(D)},Q.neq=Q.notEquals,Q.lessThan=function(D){return this.comp(D)<0},Q.lt=Q.lessThan,Q.lessThanOrEqual=function(D){return this.comp(D)<=0},Q.lte=Q.lessThanOrEqual,Q.greaterThan=function(D){return this.comp(D)>0},Q.gt=Q.greaterThan,Q.greaterThanOrEqual=function(D){return this.comp(D)>=0},Q.gte=Q.greaterThanOrEqual,Q.compare=function(D){if(n(D)||(D=p(D)),this.eq(D))return 0;var ne=this.isNegative(),se=D.isNegative();return ne&&!se?-1:!ne&&se?1:this.unsigned?D.high>>>0>this.high>>>0||D.high===this.high&&D.low>>>0>this.low>>>0?-1:1:this.sub(D).isNegative()?-1:1},Q.comp=Q.compare,Q.negate=function(){return!this.unsigned&&this.eq(Z)?Z:this.not().add(M)},Q.neg=Q.negate,Q.add=function(D){n(D)||(D=p(D));var ne=this.high>>>16,se=this.high&65535,oe=this.low>>>16,xe=this.low&65535,Pe=D.high>>>16,Ue=D.high&65535,le=D.low>>>16,ve=D.low&65535,Ce=0,Fe=0,ke=0,it=0;return it+=xe+ve,ke+=it>>>16,it&=65535,ke+=oe+le,Fe+=ke>>>16,ke&=65535,Fe+=se+Ue,Ce+=Fe>>>16,Fe&=65535,Ce+=ne+Pe,Ce&=65535,a(ke<<16|it,Ce<<16|Fe,this.unsigned)},Q.subtract=function(D){return n(D)||(D=p(D)),this.add(D.neg())},Q.sub=Q.subtract,Q.multiply=function(D){if(this.isZero()||(n(D)||(D=p(D)),D.isZero()))return S;if(this.eq(Z))return D.isOdd()?Z:S;if(D.eq(Z))return this.isOdd()?Z:S;if(this.isNegative())return D.isNegative()?this.neg().mul(D.neg()):this.neg().mul(D).neg();if(D.isNegative())return this.mul(D.neg()).neg();if(this.lt(I)&&D.lt(I))return o(this.toNumber()*D.toNumber(),this.unsigned);var ne=this.high>>>16,se=this.high&65535,oe=this.low>>>16,xe=this.low&65535,Pe=D.high>>>16,Ue=D.high&65535,le=D.low>>>16,ve=D.low&65535,Ce=0,Fe=0,ke=0,it=0;return it+=xe*ve,ke+=it>>>16,it&=65535,ke+=oe*ve,Fe+=ke>>>16,ke&=65535,ke+=xe*le,Fe+=ke>>>16,ke&=65535,Fe+=se*ve,Ce+=Fe>>>16,Fe&=65535,Fe+=oe*le,Ce+=Fe>>>16,Fe&=65535,Fe+=xe*Ue,Ce+=Fe>>>16,Fe&=65535,Ce+=ne*ve+se*le+oe*Ue+xe*Pe,Ce&=65535,a(ke<<16|it,Ce<<16|Fe,this.unsigned)},Q.mul=Q.multiply,Q.divide=function(D){if(n(D)||(D=p(D)),D.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?P:S;var ne,se,oe;if(this.unsigned){if(D.unsigned||(D=D.toUnsigned()),D.gt(this))return P;if(D.gt(this.shru(1)))return O;oe=P}else{if(this.eq(Z)){if(D.eq(M)||D.eq(N))return Z;if(D.eq(Z))return M;var xe=this.shr(1);return ne=xe.div(D).shl(1),ne.eq(S)?D.isNegative()?M:N:(se=this.sub(D.mul(ne)),oe=ne.add(se.div(D)),oe)}else if(D.eq(Z))return this.unsigned?P:S;if(this.isNegative())return D.isNegative()?this.neg().div(D.neg()):this.neg().div(D).neg();if(D.isNegative())return this.div(D.neg()).neg();oe=S}for(se=this;se.gte(D);){ne=Math.max(1,Math.floor(se.toNumber()/D.toNumber()));for(var Pe=Math.ceil(Math.log(ne)/Math.LN2),Ue=Pe<=48?1:l(2,Pe-48),le=o(ne),ve=le.mul(D);ve.isNegative()||ve.gt(se);)ne-=Ue,le=o(ne,this.unsigned),ve=le.mul(D);le.isZero()&&(le=M),oe=oe.add(le),se=se.sub(ve)}return oe},Q.div=Q.divide,Q.modulo=function(D){return n(D)||(D=p(D)),this.sub(this.div(D).mul(D))},Q.mod=Q.modulo,Q.not=function(){return a(~this.low,~this.high,this.unsigned)},Q.and=function(D){return n(D)||(D=p(D)),a(this.low&D.low,this.high&D.high,this.unsigned)},Q.or=function(D){return n(D)||(D=p(D)),a(this.low|D.low,this.high|D.high,this.unsigned)},Q.xor=function(D){return n(D)||(D=p(D)),a(this.low^D.low,this.high^D.high,this.unsigned)},Q.shiftLeft=function(D){return n(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?a(this.low<<D,this.high<<D|this.low>>>32-D,this.unsigned):a(0,this.low<<D-32,this.unsigned)},Q.shl=Q.shiftLeft,Q.shiftRight=function(D){return n(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?a(this.low>>>D|this.high<<32-D,this.high>>D,this.unsigned):a(this.high>>D-32,this.high>=0?0:-1,this.unsigned)},Q.shr=Q.shiftRight,Q.shiftRightUnsigned=function(D){if(n(D)&&(D=D.toInt()),D&=63,D===0)return this;var ne=this.high;if(D<32){var se=this.low;return a(se>>>D|ne<<32-D,ne>>>D,this.unsigned)}else return D===32?a(ne,0,this.unsigned):a(ne>>>D-32,0,this.unsigned)},Q.shru=Q.shiftRightUnsigned,Q.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},Q.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},Q.toBytes=function(k){return k?this.toBytesLE():this.toBytesBE()},Q.toBytesLE=function(){var k=this.high,D=this.low;return[D&255,D>>>8&255,D>>>16&255,D>>>24&255,k&255,k>>>8&255,k>>>16&255,k>>>24&255]},Q.toBytesBE=function(){var k=this.high,D=this.low;return[k>>>24&255,k>>>16&255,k>>>8&255,k&255,D>>>24&255,D>>>16&255,D>>>8&255,D&255]},e})})(fI);const Gh=fI.exports,qW=3,eQ=30,tQ=2*eQ+1,cb=180/Math.PI;function nQ(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function Ab(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function rQ(t){return[Ab(t[0]),Ab(t[1])]}function iQ(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function sQ([t,e,n]){const r=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*cb,r*cb]}function oQ(t){let e=Gh.fromString(t,!0,10).toString(2);for(;e.length<qW+tQ;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),s=i.length/2,o=Gh.fromString(r,!0,2).toString(10);let a=Gh.fromString(i,!0,2).toString(4);for(;a.length<s;)a="0"+a;return"".concat(o,"/").concat(a)}function aQ(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function lQ(t){const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length,s=[0,0];let o;for(let a=i-1;a>=0;a--){o=i-a;const l=r[a];let h=0,p=0;l==="1"?p=1:l==="2"?(h=1,p=1):l==="3"&&(h=1);const m=Math.pow(2,o-1);aQ(m,s,h,p),s[0]+=m*h,s[1]+=m*p}if(n%2===1){const a=s[0];s[0]=s[1],s[1]=a}return{face:n,ij:s,level:o}}function cQ(t){const e=t.padEnd(16,"0");return Gh.fromString(e,16)}const AQ=100;function uQ({face:t,ij:e,level:n}){const r=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(AQ*Math.pow(2,-n))),s=new Float64Array(4*i*2+2);let o=0,a=0;for(let l=0;l<4;l++){const h=r[l].slice(0),p=r[l+1],m=(p[0]-h[0])/i,_=(p[1]-h[1])/i;for(let E=0;E<i;E++){h[0]+=m,h[1]+=_;const b=nQ(e,n,h),x=rQ(b),I=iQ(t,x),S=sQ(I);Math.abs(S[1])>89.999&&(S[0]=a);const P=S[0]-a;S[0]+=P>180?-360:P<-180?360:0,s[o++]=S[0],s[o++]=S[1],a=S[0]}}return s[o++]=s[0],s[o++]=s[1],s}function fQ(t){if(typeof t=="string"){if(t.indexOf("/")>0)return t;t=cQ(t)}return oQ(t.toString())}function hQ(t){const e=fQ(t),n=lQ(e);return uQ(n)}const dQ={getS2Token:{type:"accessor",value:t=>t.token}};class hI extends ac{indexToBounds(){const{data:e,getS2Token:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(r,i)=>hQ(n(r,i))}}}T(hI,"layerName","S2Layer");T(hI,"defaultProps",dQ);const Lg=512;function pQ(t){let e=0,n=0,r=1<<t.length;const i=r/Lg;for(let s=0;s<t.length;s++){r>>=1;const o=parseInt(t[s]);o%2&&(e|=r),o>1&&(n|=r)}return[[e/i,Lg-n/i],[(e+.99)/i,Lg-(n+.99)/i]]}function gQ(t){const[e,n]=pQ(t),[r,i]=po(e),[s,o]=po(n);return[s,i,s,o,r,o,r,i,s,i]}const mQ={getQuadkey:{type:"accessor",value:t=>t.quadkey}};class dI extends ac{indexToBounds(){const{data:e,getQuadkey:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(r,i)=>gQ(n(r,i))}}}T(dI,"layerName","QuadkeyLayer");T(dI,"defaultProps",mQ);class yQ{constructor(e){T(this,"index",void 0),T(this,"isVisible",void 0),T(this,"isSelected",void 0),T(this,"parent",void 0),T(this,"children",void 0),T(this,"content",void 0),T(this,"state",void 0),T(this,"layers",void 0),T(this,"id",void 0),T(this,"bbox",void 0),T(this,"zoom",void 0),T(this,"userData",void 0),T(this,"_abortController",void 0),T(this,"_loader",void 0),T(this,"_loaderId",void 0),T(this,"_isLoaded",void 0),T(this,"_isCancelled",void 0),T(this,"_needsReload",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||Ve.error("byteLength not defined in tile data")(),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:s,id:o,bbox:a,userData:l,zoom:h}=this,p=this._loaderId;this._abortController=new AbortController;const{signal:m}=this._abortController,_=await n.scheduleRequest(this,x=>x.isSelected?1:-1);if(!_){this._isCancelled=!0;return}if(this._isCancelled){_.done();return}let E=null,b;try{E=await e({index:s,id:o,bbox:a,userData:l,zoom:h,signal:m})}catch(x){b=x||!0}finally{_.done()}if(p===this._loaderId){if(this._loader=void 0,this.content=E,this._isCancelled&&!E){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,b?i(b,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const Kn={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},ub=new ee,vQ=new ee;class t_{constructor(e=[0,0,0],n=[0,0,0],r){T(this,"center",void 0),T(this,"halfDiagonal",void 0),T(this,"minimum",void 0),T(this,"maximum",void 0),r=r||ub.copy(e).add(n).scale(.5),this.center=new ee(r),this.halfDiagonal=new ee(n).subtract(this.center),this.minimum=new ee(e),this.maximum=new ee(n)}clone(){return new t_(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=vQ.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),s=this.center.dot(r)+e.distance;return s-i>0?Kn.INSIDE:s+i<0?Kn.OUTSIDE:Kn.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=ub.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,s;return s=Math.abs(n.x)-r.x,s>0&&(i+=s*s),s=Math.abs(n.y)-r.y,s>0&&(i+=s*s),s=Math.abs(n.z)-r.z,s>0&&(i+=s*s),i}}const Uc=new ee,fb=new ee;class Du{constructor(e=[0,0,0],n=0){T(this,"center",void 0),T(this,"radius",void 0),this.radius=-0,this.center=new ee,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Uc.from(n),this.center=new ee().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new Du(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,o=Uc.copy(i).subtract(n),a=o.magnitude();if(r>=a+s)return this.clone();if(s>=a+r)return e.clone();const l=(r+a+s)*.5;return fb.copy(o).scale((-r+l)/a).add(n),this.center.copy(fb),this.radius=l,this}expand(e){const r=Uc.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=DU(Uc,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Uc.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?Kn.OUTSIDE:s<r?Kn.INTERSECTING:Kn.INSIDE}}const _Q=new ee,EQ=new ee,Xf=new ee,Yf=new ee,Jf=new ee,wQ=new ee,TQ=new ee,ss={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class ku{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){T(this,"center",void 0),T(this,"halfAxes",void 0),this.center=new ee().from(e),this.halfAxes=new xn(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new ee(e).len(),new ee(n).len(),new ee(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new ee(e).normalize(),s=new ee(n).normalize(),o=new ee(r).normalize();return new KA().fromMatrix3(new xn([...i,...s,...o]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new KA(r),s=new xn().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new ee().from(e),this.halfAxes=s,this}clone(){return new ku(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new Du){const n=this.halfAxes,r=n.getColumn(0,Xf),i=n.getColumn(1,Yf),s=n.getColumn(2,Jf),o=_Q.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,o=r.y,a=r.z,l=Math.abs(s*i[ss.COLUMN0ROW0]+o*i[ss.COLUMN0ROW1]+a*i[ss.COLUMN0ROW2])+Math.abs(s*i[ss.COLUMN1ROW0]+o*i[ss.COLUMN1ROW1]+a*i[ss.COLUMN1ROW2])+Math.abs(s*i[ss.COLUMN2ROW0]+o*i[ss.COLUMN2ROW1]+a*i[ss.COLUMN2ROW2]),h=r.dot(n)+e.distance;return h<=-l?Kn.OUTSIDE:h>=l?Kn.INSIDE:Kn.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=EQ.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,Xf),s=r.getColumn(1,Yf),o=r.getColumn(2,Jf),a=i.magnitude(),l=s.magnitude(),h=o.magnitude();i.normalize(),s.normalize(),o.normalize();let p=0,m;return m=Math.abs(n.dot(i))-a,m>0&&(p+=m*m),m=Math.abs(n.dot(s))-l,m>0&&(p+=m*m),m=Math.abs(n.dot(o))-h,m>0&&(p+=m*m),p}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,l=a.getColumn(0,Xf),h=a.getColumn(1,Yf),p=a.getColumn(2,Jf),m=wQ.copy(l).add(h).add(p).add(o),_=TQ.copy(m).subtract(e);let E=n.dot(_);return i=Math.min(E,i),s=Math.max(E,s),m.copy(o).add(l).add(h).subtract(p),_.copy(m).subtract(e),E=n.dot(_),i=Math.min(E,i),s=Math.max(E,s),m.copy(o).add(l).subtract(h).add(p),_.copy(m).subtract(e),E=n.dot(_),i=Math.min(E,i),s=Math.max(E,s),m.copy(o).add(l).subtract(h).subtract(p),_.copy(m).subtract(e),E=n.dot(_),i=Math.min(E,i),s=Math.max(E,s),o.copy(m).subtract(l).add(h).add(p),_.copy(m).subtract(e),E=n.dot(_),i=Math.min(E,i),s=Math.max(E,s),o.copy(m).subtract(l).add(h).subtract(p),_.copy(m).subtract(e),E=n.dot(_),i=Math.min(E,i),s=Math.max(E,s),o.copy(m).subtract(l).subtract(h).add(p),_.copy(m).subtract(e),E=n.dot(_),i=Math.min(E,i),s=Math.max(E,s),o.copy(m).subtract(l).subtract(h).subtract(p),_.copy(m).subtract(e),E=n.dot(_),i=Math.min(E,i),s=Math.max(E,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,Xf);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,Yf);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,Jf);return i.transformAsPoint(e),this.halfAxes=new xn([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const hb=new ee,db=new ee;class ni{constructor(e=[0,0,1],n=0){T(this,"normal",void 0),T(this,"distance",void 0),this.normal=new ee,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return bi(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=hb.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),bi(Ur(this.normal.len(),1)),this.distance=i,this}clone(){return new ni(this.normal,this.distance)}equals(e){return Ur(this.distance,e.distance)&&Ur(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=db.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=hb.from(e);const r=this.getPointDistance(e),i=db.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const pb=[new ee([1,0,0]),new ee([0,1,0]),new ee([0,0,1])],gb=new ee,bQ=new ee;new ni(new ee(1,0,0),0);class Fr{constructor(e=[]){T(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*pb.length;const n=e.center,r=e.radius;let i=0;for(const s of pb){let o=this.planes[i],a=this.planes[i+1];o||(o=this.planes[i]=new ni),a||(a=this.planes[i+1]=new ni);const l=gb.copy(s).scale(-r).add(n);-s.dot(l),o.fromPointNormal(l,s);const h=gb.copy(s).scale(r).add(n),p=bQ.copy(s).negate();-p.dot(h),a.fromPointNormal(h,p),i+=2}return this}computeVisibility(e){let n=Kn.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case Kn.OUTSIDE:return Kn.OUTSIDE;case Kn.INTERSECTING:n=Kn.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(bi(Number.isFinite(n),"parentPlaneMask is required."),n===Fr.MASK_OUTSIDE||n===Fr.MASK_INSIDE)return n;let r=Fr.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const o=s<31?1<<s:0;if(s<31&&(n&o)===0)continue;const a=i[s],l=e.intersectPlane(a);if(l===Kn.OUTSIDE)return Fr.MASK_OUTSIDE;l===Kn.INTERSECTING&&(r|=o)}return r}}T(Fr,"MASK_OUTSIDE",4294967295);T(Fr,"MASK_INSIDE",0);T(Fr,"MASK_INDETERMINATE",2147483647);new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;new ee;const Vi=new xn,xQ=new xn,CQ=new xn,Kf=new xn,mb=new xn;function SQ(t,e={}){const n=ZA.EPSILON20,r=10;let i=0,s=0;const o=xQ,a=CQ;o.identity(),a.copy(t);const l=n*PQ(a);for(;s<r&&MQ(a)>l;)IQ(a,Kf),mb.copy(Kf).transpose(),a.multiplyRight(Kf),a.multiplyLeft(mb),o.multiplyRight(Kf),++i>2&&(++s,i=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function PQ(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const j1=[1,0,0],W1=[2,2,1];function MQ(t){let e=0;for(let n=0;n<3;++n){const r=t[Vi.getElementIndex(W1[n],j1[n])];e+=2*r*r}return Math.sqrt(e)}function IQ(t,e){const n=ZA.EPSILON15;let r=0,i=1;for(let h=0;h<3;++h){const p=Math.abs(t[Vi.getElementIndex(W1[h],j1[h])]);p>r&&(i=h,r=p)}const s=j1[i],o=W1[i];let a=1,l=0;if(Math.abs(t[Vi.getElementIndex(o,s)])>n){const h=t[Vi.getElementIndex(o,o)],p=t[Vi.getElementIndex(s,s)],m=t[Vi.getElementIndex(o,s)],_=(h-p)/2/m;let E;_<0?E=-1/(-_+Math.sqrt(1+_*_)):E=1/(_+Math.sqrt(1+_*_)),a=1/Math.sqrt(1+E*E),l=E*a}return xn.IDENTITY.to(e),e[Vi.getElementIndex(s,s)]=e[Vi.getElementIndex(o,o)]=a,e[Vi.getElementIndex(o,s)]=l,e[Vi.getElementIndex(s,o)]=-l,e}const Gs=new ee,BQ=new ee,LQ=new ee,RQ=new ee,OQ=new ee,FQ=new xn,DQ={diagonal:new xn,unitary:new xn};function kQ(t,e=new ku){if(!t||t.length===0)return e.halfAxes=new xn([0,0,0,0,0,0,0,0,0]),e.center=new ee,e;const n=t.length,r=new ee(0,0,0);for(const Q of t)r.add(Q);const i=1/n;r.multiplyByScalar(i);let s=0,o=0,a=0,l=0,h=0,p=0;for(const Q of t){const k=Gs.copy(Q).subtract(r);s+=k.x*k.x,o+=k.x*k.y,a+=k.x*k.z,l+=k.y*k.y,h+=k.y*k.z,p+=k.z*k.z}s*=i,o*=i,a*=i,l*=i,h*=i,p*=i;const m=FQ;m[0]=s,m[1]=o,m[2]=a,m[3]=o,m[4]=l,m[5]=h,m[6]=a,m[7]=h,m[8]=p;const{unitary:_}=SQ(m,DQ),E=e.halfAxes.copy(_);let b=E.getColumn(0,LQ),x=E.getColumn(1,RQ),I=E.getColumn(2,OQ),S=-Number.MAX_VALUE,P=-Number.MAX_VALUE,M=-Number.MAX_VALUE,O=Number.MAX_VALUE,N=Number.MAX_VALUE,z=Number.MAX_VALUE;for(const Q of t)Gs.copy(Q),S=Math.max(Gs.dot(b),S),P=Math.max(Gs.dot(x),P),M=Math.max(Gs.dot(I),M),O=Math.min(Gs.dot(b),O),N=Math.min(Gs.dot(x),N),z=Math.min(Gs.dot(I),z);b=b.multiplyByScalar(.5*(O+S)),x=x.multiplyByScalar(.5*(N+P)),I=I.multiplyByScalar(.5*(z+M)),e.center.copy(b).add(x).add(I);const X=BQ.set(S-O,P-N,M-z).multiplyByScalar(.5),Z=new xn([X[0],0,0,0,X[1],0,0,0,X[2]]);return e.halfAxes.multiplyRight(Z),e}const fl=512,yb=3,pI=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],gI=pI.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),NQ=gI.concat([[.25,.5],[.75,.5]]);class hl{constructor(e,n,r){T(this,"x",void 0),T(this,"y",void 0),T(this,"z",void 0),T(this,"childVisible",void 0),T(this,"selected",void 0),T(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new hl(e,n,r),new hl(e,n+1,r),new hl(e+1,n,r),new hl(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:s,maxZ:o,bounds:a,offset:l,project:h}=e,p=this.getBoundingVolume(i,l,h);if(a&&!this.insideBounds(a)||r.computeVisibility(p)<0)return!1;if(!this.childVisible){let{z:_}=this;if(_<o&&_>=s){const E=p.distanceTo(n.cameraPosition)*n.scale/n.height;_+=Math.floor(Math.log2(E))}if(_>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const _ of this.children)_.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const s=Math.pow(2,this.z),o=fl/s;return this.x*o<r&&this.y*o<i&&(this.x+1)*o>e&&(this.y+1)*o>n}getBoundingVolume(e,n,r){if(r){const l=this.z<1?NQ:this.z<2?gI:pI,h=[];for(const p of l){const m=$1(this.x+p[0],this.y+p[1],this.z);m[2]=e[0],h.push(r(m)),e[0]!==e[1]&&(m[2]=e[1],h.push(r(m)))}return kQ(h)}const i=Math.pow(2,this.z),s=fl/i,o=this.x*s+n*fl,a=fl-(this.y+1)*s;return new t_([o,a,e[0]],[o+s,a+s,e[1]])}}function UQ(t,e,n,r){const i=t instanceof uj&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:E,distance:b})=>new ni(E.clone().negate(),b)),o=new Fr(s),a=t.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,h=n&&n[1]*a||0,p=t instanceof ns&&t.pitch<=60?e:0;if(r){const[E,b,x,I]=r,S=ho([E,I]),P=ho([x,b]);r=[S[0],fl-S[1],P[0],fl-P[1]]}const m=new hl(0,0,0),_={viewport:t,project:i,cullingVolume:o,elevationBounds:[l,h],minZ:p,maxZ:e,bounds:r,offset:0};if(m.update(_),t instanceof ns&&t.subViewports&&t.subViewports.length>1){for(_.offset=-1;m.update(_)&&!(--_.offset<-yb););for(_.offset=1;m.update(_)&&!(++_.offset>yb););}return m.getSelected()}const ws=512,GQ=[-1/0,-1/0,1/0,1/0],Q1={type:"url",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equals:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function mI(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function zQ(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function Nd(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const s=zQ(r)%t.length;t=t[s]}let i=t;for(const s of Object.keys(n)){const o=new RegExp("{".concat(s,"}"),"g");i=i.replace(o,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function VQ(t,e,n){let r;if(e&&e.length===2){const[i,s]=e,o=t.getBounds({z:i}),a=t.getBounds({z:s});r=[Math.min(o[0],a[0]),Math.min(o[1],a[1]),Math.max(o[2],a[2]),Math.max(o[3],a[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function Ud({viewport:t,z:e,cullRect:n}){const r=n.x-t.x,i=n.y-t.y,{width:s,height:o}=n;if(!Array.isArray(e)){const h={targetZ:e||0},p=t.unproject([r,i],h),m=t.unproject([r+s,i],h),_=t.unproject([r,i+o],h),E=t.unproject([r+s,i+o],h);return[Math.min(p[0],m[0],_[0],E[0]),Math.min(p[1],m[1],_[1],E[1]),Math.max(p[0],m[0],_[0],E[0]),Math.max(p[1],m[1],_[1],E[1])]}const a=Ud({viewport:t,z:e[0],cullRect:n}),l=Ud({viewport:t,z:e[1],cullRect:n});return[Math.min(a[0],l[0]),Math.min(a[1],l[1]),Math.max(a[2],l[2]),Math.max(a[3],l[3])]}function HQ(t,e,n){return n?mI(t,n).map(i=>i*e/ws):t.map(r=>r*e/ws)}function n_(t,e){return Math.pow(2,t)*ws/e}function $1(t,e,n){const r=n_(n,ws),i=t/r*360-180,s=Math.PI-2*Math.PI*e/r,o=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,o]}function vb(t,e,n,r){const i=n_(n,r);return[t/i*ws,e/i*ws]}function jQ(t,e,n,r,i=ws){if(t.isGeospatial){const[h,p]=$1(e,n,r),[m,_]=$1(e+1,n+1,r);return{west:h,north:p,east:m,south:_}}const[s,o]=vb(e,n,r,i),[a,l]=vb(e+1,n+1,r,i);return{left:s,top:o,right:a,bottom:l}}function WQ(t,e,n,r,i){const s=VQ(t,null,r),o=n_(e,n),[a,l,h,p]=HQ(s,o,i),m=[];for(let _=Math.floor(a);_<h;_++)for(let E=Math.floor(l);E<p;E++)m.push({x:_,y:E,z:e});return m}function QQ({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:s=ws,modelMatrix:o,modelMatrixInverse:a,zoomOffset:l=0}){let h=t.isGeospatial?Math.round(t.zoom+Math.log2(ws/s))+l:Math.ceil(t.zoom)+l;if(typeof n=="number"&&Number.isFinite(n)&&h<n){if(!i)return[];h=n}typeof e=="number"&&Number.isFinite(e)&&h>e&&(h=e);let p=i;return o&&a&&i&&!t.isGeospatial&&(p=mI(i,o)),t.isGeospatial?UQ(t,h,r,i):WQ(t,h,s,p||GQ,a)}function $Q(t){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t)}function XQ(t){return Number.isFinite(t.west)&&Number.isFinite(t.north)&&Number.isFinite(t.east)&&Number.isFinite(t.south)}const _b=1,L0=2,YQ="never",JQ="no-overlap",r_="best-available",KQ=5,ZQ={[r_]:e$,[JQ]:t$,[YQ]:()=>{}};class qQ{constructor(e){T(this,"opts",void 0),T(this,"_requestScheduler",void 0),T(this,"_cache",void 0),T(this,"_dirty",void 0),T(this,"_tiles",void 0),T(this,"_cacheByteSize",void 0),T(this,"_viewport",void 0),T(this,"_zRange",void 0),T(this,"_selectedTiles",void 0),T(this,"_frameNumber",void 0),T(this,"_modelMatrix",void 0),T(this,"_modelMatrixInverse",void 0),T(this,"_maxZoom",void 0),T(this,"_minZoom",void 0),T(this,"onTileLoad",void 0),T(this,"_getCullBounds",Lu(Ud)),this.opts=e,this.onTileLoad=n=>{this.opts.onTileLoad(n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new O3({maxRequests:e.maxRequests,throttleRequests:e.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Ye,this._modelMatrixInverse=new Ye,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new Ye(r),s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Ur(this._zRange,n)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(l=>this._getTile(l,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const[r,i,s,o]=Ud({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:a}=e;if("west"in a)return a.west<s&&a.east>r&&a.south<o&&a.north>i;const l=Math.min(a.top,a.bottom),h=Math.max(a.top,a.bottom);return a.left<s&&a.right>r&&l<o&&h>i}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:o}){const{tileSize:a,extent:l,zoomOffset:h}=this.opts;return QQ({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:a,extent:l,modelMatrix:s,modelMatrixInverse:o,zoomOffset:h})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:jQ(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||r_,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:ZQ[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:KQ*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[o,a]of e)if(a.isVisible||(this._cacheByteSize-=n.maxCacheByteSize?a.byteLength:0,e.delete(o),this.opts.onTileUnload(a)),e.size<=r&&this._cacheByteSize<=i)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((o,a)=>o.zoom-a.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),s=!1;return!i&&n?(i=new yQ(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function e$(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!yI(e)&&i_(e);for(const e of t)e.isVisible=Boolean(e.state&L0)}function t$(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&yI(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=Boolean(n.state&L0),n.children&&(n.isVisible||n.state&_b))for(const r of n.children)r.state=_b;else n.isSelected&&i_(n)}function yI(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=L0,!0;e=e.parent}return!1}function i_(t){for(const e of t.children)e.isLoaded||e.content?e.state|=L0:i_(e)}const n$={TilesetClass:qQ,data:{type:"data",value:[]},dataComparator:Q1.equals,renderSubLayers:{type:"function",value:t=>new Fu(t),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:t=>console.error(t),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:r_,zRange:null,maxRequests:6,zoomOffset:0};class Nu extends Ss{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0?void 0:n.selectedTiles.every(r=>r.isLoaded&&r.layers&&r.layers.every(i=>i.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:s,maxZoom:o,minZoom:a,maxRequests:l,zoomOffset:h}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:o,minZoom:a,tileSize:e,refinementStrategy:i,extent:s,maxRequests:l,zoomOffset:h,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:s}=e,o=this.state.isLoaded!==s,a=this.state.frameNumber!==i;s&&(o||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?Nd(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){return e.tile=n.props.tile,e}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(e.id),data:e.content,_offset:0,tile:e});e.layers=E0(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}T(Nu,"defaultProps",n$);T(Nu,"layerName","TileLayer");const r$={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}};class s_ extends ca{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:n,trailLength:r,currentTime:i}=this.props;e.uniforms={...e.uniforms,fadeTrail:n,trailLength:r,currentTime:i},super.draw(e)}}T(s_,"layerName","TripsLayer");T(s_,"defaultProps",r$);var Kt=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(J){return e.locateFile?e.locateFile(J,i):i+J}var o;document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",o=function(ae,me,Ge){var u=new XMLHttpRequest;u.open("GET",ae,!0),u.responseType="arraybuffer",u.onload=function(){if(u.status==200||u.status==0&&u.response){me(u.response);return}var At=uc(ae);if(At){me(At.buffer);return}Ge()},u.onerror=Ge,u.send(null)};var a=e.print||console.log.bind(console),l=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var h=0,p=function(J){h=J},m=function(){return h},_=8;function E(J,ae,me,Ge){switch(me=me||"i8",me.charAt(me.length-1)==="*"&&(me="i32"),me){case"i1":ne[J>>0]=ae;break;case"i8":ne[J>>0]=ae;break;case"i16":oe[J>>1]=ae;break;case"i32":xe[J>>2]=ae;break;case"i64":Oe=[ae>>>0,(pe=ae,+In(pe)>=1?pe>0?(yn(+kn(pe/4294967296),4294967295)|0)>>>0:~~+jn((pe-+(~~pe>>>0))/4294967296)>>>0:0)],xe[J>>2]=Oe[0],xe[J+4>>2]=Oe[1];break;case"float":Pe[J>>2]=ae;break;case"double":Ue[J>>3]=ae;break;default:Fi("invalid type for setValue: "+me)}}function b(J,ae,me){switch(ae=ae||"i8",ae.charAt(ae.length-1)==="*"&&(ae="i32"),ae){case"i1":return ne[J>>0];case"i8":return ne[J>>0];case"i16":return oe[J>>1];case"i32":return xe[J>>2];case"i64":return xe[J>>2];case"float":return Pe[J>>2];case"double":return Ue[J>>3];default:Fi("invalid type for getValue: "+ae)}return null}var x=!1;function I(J,ae){J||Fi("Assertion failed: "+ae)}function S(J){var ae=e["_"+J];return I(ae,"Cannot call unknown function "+J+", make sure it is exported"),ae}function P(J,ae,me,Ge,u){var G={string:function(an){var Di=0;if(an!=null&&an!==0){var Ea=(an.length<<2)+1;Di=$u(Ea),Z(an,Di,Ea)}return Di},array:function(an){var Di=$u(an.length);return Q(an,Di),Di}};function At(an){return ae==="string"?z(an):ae==="boolean"?Boolean(an):an}var ht=S(J),Ze=[],tt=0;if(Ge)for(var Ht=0;Ht<Ge.length;Ht++){var ut=G[me[Ht]];ut?(tt===0&&(tt=Xu()),Ze[Ht]=ut(Ge[Ht])):Ze[Ht]=Ge[Ht]}var st=ht.apply(null,Ze);return st=At(st),tt!==0&&ap(tt),st}function M(J,ae,me,Ge){me=me||[];var u=me.every(function(At){return At==="number"}),G=ae!=="string";return G&&u&&!Ge?S(J):function(){return P(J,ae,me,arguments)}}var O=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function N(J,ae,me){for(var Ge=ae+me,u=ae;J[u]&&!(u>=Ge);)++u;if(u-ae>16&&J.subarray&&O)return O.decode(J.subarray(ae,u));for(var G="";ae<u;){var At=J[ae++];if(!(At&128)){G+=String.fromCharCode(At);continue}var ht=J[ae++]&63;if((At&224)==192){G+=String.fromCharCode((At&31)<<6|ht);continue}var Ze=J[ae++]&63;if((At&240)==224?At=(At&15)<<12|ht<<6|Ze:At=(At&7)<<18|ht<<12|Ze<<6|J[ae++]&63,At<65536)G+=String.fromCharCode(At);else{var tt=At-65536;G+=String.fromCharCode(55296|tt>>10,56320|tt&1023)}}return G}function z(J,ae){return J?N(se,J,ae):""}function X(J,ae,me,Ge){if(!(Ge>0))return 0;for(var u=me,G=me+Ge-1,At=0;At<J.length;++At){var ht=J.charCodeAt(At);if(ht>=55296&&ht<=57343){var Ze=J.charCodeAt(++At);ht=65536+((ht&1023)<<10)|Ze&1023}if(ht<=127){if(me>=G)break;ae[me++]=ht}else if(ht<=2047){if(me+1>=G)break;ae[me++]=192|ht>>6,ae[me++]=128|ht&63}else if(ht<=65535){if(me+2>=G)break;ae[me++]=224|ht>>12,ae[me++]=128|ht>>6&63,ae[me++]=128|ht&63}else{if(me+3>=G)break;ae[me++]=240|ht>>18,ae[me++]=128|ht>>12&63,ae[me++]=128|ht>>6&63,ae[me++]=128|ht&63}}return ae[me]=0,me-u}function Z(J,ae,me){return X(J,se,ae,me)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Q(J,ae){ne.set(J,ae)}function k(J,ae){return J%ae>0&&(J+=ae-J%ae),J}var D,ne,se,oe,xe,Pe,Ue;function le(J){D=J,e.HEAP8=ne=new Int8Array(J),e.HEAP16=oe=new Int16Array(J),e.HEAP32=xe=new Int32Array(J),e.HEAPU8=se=new Uint8Array(J),e.HEAPU16=new Uint16Array(J),e.HEAPU32=new Uint32Array(J),e.HEAPF32=Pe=new Float32Array(J),e.HEAPF64=Ue=new Float64Array(J)}var ve=5266928,Ce=24016,Fe=e.TOTAL_MEMORY||33554432;e.buffer?D=e.buffer:D=new ArrayBuffer(Fe),Fe=D.byteLength,le(D),xe[Ce>>2]=ve;function ke(J){for(;J.length>0;){var ae=J.shift();if(typeof ae=="function"){ae();continue}var me=ae.func;typeof me=="number"?ae.arg===void 0?e.dynCall_v(me):e.dynCall_vi(me,ae.arg):me(ae.arg===void 0?null:ae.arg)}}var it=[],Rt=[],Pn=[],un=[];function Tt(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)zt(e.preRun.shift());ke(it)}function Ut(){ke(Rt)}function ot(){ke(Pn)}function Gt(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Mn(e.postRun.shift());ke(un)}function zt(J){it.unshift(J)}function Mn(J){un.unshift(J)}var In=Math.abs,jn=Math.ceil,kn=Math.floor,yn=Math.min,on=0,rr=null;function $r(J){on++,e.monitorRunDependencies&&e.monitorRunDependencies(on)}function ir(J){if(on--,e.monitorRunDependencies&&e.monitorRunDependencies(on),on==0&&rr){var ae=rr;rr=null,ae()}}e.preloadedImages={},e.preloadedAudios={};var vt=null,Xr="data:application/octet-stream;base64,";function fi(J){return String.prototype.startsWith?J.startsWith(Xr):J.indexOf(Xr)===0}var pe,Oe;vt="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Xe=24032;function et(J){return J}function We(J){var ae=/\b__Z[\w\d_]+/g;return J.replace(ae,function(me){var Ge=me;return me===Ge?me:Ge+" ["+me+"]"})}function lt(){var J=new Error;if(!J.stack){try{throw new Error(0)}catch(ae){J=ae}if(!J.stack)return"(no stack trace available)"}return J.stack.toString()}function Me(){var J=lt();return e.extraStackTrace&&(J+=`
`+e.extraStackTrace()),We(J)}function Vt(J,ae,me,Ge){Fi("Assertion failed: "+z(J)+", at: "+[ae?z(ae):"unknown filename",me,Ge?z(Ge):"unknown function"])}function at(){return ne.length}function sr(J,ae,me){se.set(se.subarray(ae,ae+me),J)}function Ps(J){return e.___errno_location&&(xe[e.___errno_location()>>2]=J),J}function rp(J){Fi("OOM")}function ju(J){try{var ae=new ArrayBuffer(J);return ae.byteLength!=J?void 0:(new Int8Array(ae).set(ne),op(ae),le(ae),1)}catch{}}function ip(J){var ae=at(),me=16777216,Ge=2147483648-me;if(J>Ge)return!1;for(var u=16777216,G=Math.max(ae,u);G<J;)G<=536870912?G=k(2*G,me):G=Math.min(k((3*G+2147483648)/4,me),Ge);var At=ju(G);return!!At}var va=typeof atob=="function"?atob:function(J){var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",me="",Ge,u,G,At,ht,Ze,tt,Ht=0;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");do At=ae.indexOf(J.charAt(Ht++)),ht=ae.indexOf(J.charAt(Ht++)),Ze=ae.indexOf(J.charAt(Ht++)),tt=ae.indexOf(J.charAt(Ht++)),Ge=At<<2|ht>>4,u=(ht&15)<<4|Ze>>2,G=(Ze&3)<<6|tt,me=me+String.fromCharCode(Ge),Ze!==64&&(me=me+String.fromCharCode(u)),tt!==64&&(me=me+String.fromCharCode(G));while(Ht<J.length);return me};function sp(J){try{for(var ae=va(J),me=new Uint8Array(ae.length),Ge=0;Ge<ae.length;++Ge)me[Ge]=ae.charCodeAt(Ge);return me}catch{throw new Error("Converting base64 string to bytes failed.")}}function uc(J){if(!!fi(J))return sp(J.slice(Xr.length))}var Wu={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Qu={a:Fi,b:p,c:m,d:Vt,e:Ps,f:at,g:sr,h:ip,i:rp,j:et,k:We,l:ju,m:lt,n:Me,o:Xe,p:Ce},ge=function(J,ae,me){var Ge=new J.Int8Array(me),u=new J.Int32Array(me);new J.Uint8Array(me),new J.Float32Array(me);var G=new J.Float64Array(me),At=ae.p|0,ht=J.Math.floor,Ze=J.Math.abs,tt=J.Math.sqrt,Ht=J.Math.pow,ut=J.Math.cos,st=J.Math.sin,an=J.Math.tan,Di=J.Math.acos,Ea=J.Math.asin,Ms=J.Math.atan,jt=J.Math.atan2,hi=J.Math.ceil,Bn=J.Math.imul,di=J.Math.min,xr=J.Math.clz32,De=ae.b,j=ae.c,dt=ae.d,dc=ae.e,wa=ae.f,Cr=ae.g,Ta=ae.h,pc=ae.i,U=24048;function gc(c){return Ge=new Int8Array(c),u=new Int32Array(c),G=new Float64Array(c),me=c,!0}function mc(c){c=c|0;var A=0;return A=U,U=U+c|0,U=U+15&-16,A|0}function ba(){return U|0}function pi(c){c=c|0,U=c}function lp(c,A){c=c|0,U=c}function Ku(c){return c=c|0,(Bn(c*3|0,c+1|0)|0)+1|0}function xa(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0;!(yc(c,A,f,d,0)|0)||(v=(Bn(f*3|0,f+1|0)|0)+1|0,mi(d|0,0,v<<3|0)|0,g=gi(v,4)|0,g&&(Yr(c,A,f,d,g,v,0),Ke(g)))}function Zu(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0;if(!!(yc(c,A,f,d,g)|0)){if(v=(Bn(f*3|0,f+1|0)|0)+1|0,mi(d|0,0,v<<3|0)|0,g|0){mi(g|0,0,v<<2|0)|0,Yr(c,A,f,d,g,v,0);return}g=gi(v,4)|0,g&&(Yr(c,A,f,d,g,v,0),Ke(g))}}function yc(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0;if(Y=U,U=U+16|0,W=Y,v=d,u[v>>2]=c,u[v+4>>2]=A,v=(g|0)!=0,v&&(u[g>>2]=0),_n(c,A)|0)return W=1,U=Y,W|0;u[W>>2]=0;e:do if((f|0)>=1)if(v)for(B=0,L=1,V=1,y=0,v=c;;){if(!(y|B)){if(v=R(v,A,4,W)|0,A=j()|0,(v|0)==0&(A|0)==0){v=2;break e}if(_n(v,A)|0){v=1;break e}}if(v=R(v,A,u[16+(B<<2)>>2]|0,W)|0,A=j()|0,(v|0)==0&(A|0)==0){v=2;break e}if(c=d+(V<<3)|0,u[c>>2]=v,u[c+4>>2]=A,u[g+(V<<2)>>2]=L,y=y+1|0,c=(y|0)==(L|0),w=B+1|0,C=(w|0)==6,_n(v,A)|0){v=1;break e}if(L=L+(C&c&1)|0,(L|0)>(f|0)){v=0;break}else B=c?C?0:w:B,V=V+1|0,y=c?0:y}else for(B=0,L=1,V=1,y=0,v=c;;){if(!(y|B)){if(v=R(v,A,4,W)|0,A=j()|0,(v|0)==0&(A|0)==0){v=2;break e}if(_n(v,A)|0){v=1;break e}}if(v=R(v,A,u[16+(B<<2)>>2]|0,W)|0,A=j()|0,(v|0)==0&(A|0)==0){v=2;break e}if(c=d+(V<<3)|0,u[c>>2]=v,u[c+4>>2]=A,y=y+1|0,c=(y|0)==(L|0),w=B+1|0,C=(w|0)==6,_n(v,A)|0){v=1;break e}if(L=L+(C&c&1)|0,(L|0)>(f|0)){v=0;break}else B=c?C?0:w:B,V=V+1|0,y=c?0:y}else v=0;while(0);return W=v,U=Y,W|0}function Yr(c,A,f,d,g,v,y){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0,v=v|0,y=y|0;var w=0,C=0,B=0,L=0,V=0,W=0,Y=0;if(V=U,U=U+16|0,L=V,(c|0)==0&(A|0)==0){U=V;return}if(w=Ls(c|0,A|0,v|0,((v|0)<0)<<31>>31|0)|0,j()|0,C=d+(w<<3)|0,W=C,Y=u[W>>2]|0,W=u[W+4>>2]|0,B=(Y|0)==(c|0)&(W|0)==(A|0),!((Y|0)==0&(W|0)==0|B))do w=(w+1|0)%(v|0)|0,C=d+(w<<3)|0,Y=C,W=u[Y>>2]|0,Y=u[Y+4>>2]|0,B=(W|0)==(c|0)&(Y|0)==(A|0);while(!((W|0)==0&(Y|0)==0|B));if(w=g+(w<<2)|0,B&&(u[w>>2]|0)<=(y|0)){U=V;return}if(Y=C,u[Y>>2]=c,u[Y+4>>2]=A,u[w>>2]=y,(y|0)>=(f|0)){U=V;return}Y=y+1|0,u[L>>2]=0,W=R(c,A,2,L)|0,Yr(W,j()|0,f,d,g,v,Y),u[L>>2]=0,W=R(c,A,3,L)|0,Yr(W,j()|0,f,d,g,v,Y),u[L>>2]=0,W=R(c,A,1,L)|0,Yr(W,j()|0,f,d,g,v,Y),u[L>>2]=0,W=R(c,A,5,L)|0,Yr(W,j()|0,f,d,g,v,Y),u[L>>2]=0,W=R(c,A,4,L)|0,Yr(W,j()|0,f,d,g,v,Y),u[L>>2]=0,W=R(c,A,6,L)|0,Yr(W,j()|0,f,d,g,v,Y),U=V}function R(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0;if((u[d>>2]|0)>0){g=0;do f=Po(f)|0,g=g+1|0;while((g|0)<(u[d>>2]|0))}w=he(c|0,A|0,45)|0,j()|0,C=w&127,v=dr(c,A)|0,g=he(c|0,A|0,52)|0,j()|0,g=g&15;e:do if(!g)y=6;else for(;;){if(V=(15-g|0)*3|0,W=he(c|0,A|0,V|0)|0,j()|0,W=W&7,Y=(Jr(g)|0)==0,g=g+-1|0,L=we(7,0,V|0)|0,A=A&~(j()|0),V=we(u[(Y?464:48)+(W*28|0)+(f<<2)>>2]|0,0,V|0)|0,B=j()|0,f=u[(Y?672:256)+(W*28|0)+(f<<2)>>2]|0,c=V|c&~L,A=B|A,!f){f=0;break e}if(!g){y=6;break}}while(0);(y|0)==6&&(Y=u[880+(C*28|0)+(f<<2)>>2]|0,W=we(Y|0,0,45)|0,c=W|c,A=j()|0|A&-1040385,f=u[4304+(C*28|0)+(f<<2)>>2]|0,(Y&127|0)==127&&(Y=we(u[880+(C*28|0)+20>>2]|0,0,45)|0,A=j()|0|A&-1040385,f=u[4304+(C*28|0)+20>>2]|0,c=Bs(Y|c,A)|0,A=j()|0,u[d>>2]=(u[d>>2]|0)+1)),y=he(c|0,A|0,45)|0,j()|0,y=y&127;e:do if(Je(y)|0){t:do if((dr(c,A)|0)==1){if((C|0)!=(y|0))if(X_(y,u[7728+(C*28|0)>>2]|0)|0){c=mp(c,A)|0,v=1,A=j()|0;break}else{c=Bs(c,A)|0,v=1,A=j()|0;break}switch(v|0){case 5:{c=mp(c,A)|0,A=j()|0,u[d>>2]=(u[d>>2]|0)+5,v=0;break t}case 3:{c=Bs(c,A)|0,A=j()|0,u[d>>2]=(u[d>>2]|0)+1,v=0;break t}default:return W=0,Y=0,De(W|0),Y|0}}else v=0;while(0);if((f|0)>0){g=0;do c=gp(c,A)|0,A=j()|0,g=g+1|0;while((g|0)!=(f|0))}if((C|0)!=(y|0)){if(!(vn(y)|0)){if((v|0)!=0|(dr(c,A)|0)!=5)break;u[d>>2]=(u[d>>2]|0)+1;break}switch(w&127){case 8:case 118:break e}(dr(c,A)|0)!=3&&(u[d>>2]=(u[d>>2]|0)+1)}}else if((f|0)>0){g=0;do c=Bs(c,A)|0,A=j()|0,g=g+1|0;while((g|0)!=(f|0))}while(0);return u[d>>2]=((u[d>>2]|0)+f|0)%6|0,W=A,Y=c,De(W|0),Y|0}function F(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0;if(V=U,U=U+16|0,L=V,!f)return L=d,u[L>>2]=c,u[L+4>>2]=A,L=0,U=V,L|0;u[L>>2]=0;e:do if(_n(c,A)|0)c=1;else{if(v=(f|0)>0,v){g=0,B=c;do{if(B=R(B,A,4,L)|0,A=j()|0,(B|0)==0&(A|0)==0){c=2;break e}if(g=g+1|0,_n(B,A)|0){c=1;break e}}while((g|0)<(f|0));if(C=d,u[C>>2]=B,u[C+4>>2]=A,C=f+-1|0,v){v=0,y=1,g=B,c=A;do{if(g=R(g,c,2,L)|0,c=j()|0,(g|0)==0&(c|0)==0){c=2;break e}if(w=d+(y<<3)|0,u[w>>2]=g,u[w+4>>2]=c,y=y+1|0,_n(g,c)|0){c=1;break e}v=v+1|0}while((v|0)<(f|0));w=0,v=y;do{if(g=R(g,c,3,L)|0,c=j()|0,(g|0)==0&(c|0)==0){c=2;break e}if(y=d+(v<<3)|0,u[y>>2]=g,u[y+4>>2]=c,v=v+1|0,_n(g,c)|0){c=1;break e}w=w+1|0}while((w|0)<(f|0));y=0;do{if(g=R(g,c,1,L)|0,c=j()|0,(g|0)==0&(c|0)==0){c=2;break e}if(w=d+(v<<3)|0,u[w>>2]=g,u[w+4>>2]=c,v=v+1|0,_n(g,c)|0){c=1;break e}y=y+1|0}while((y|0)<(f|0));y=0;do{if(g=R(g,c,5,L)|0,c=j()|0,(g|0)==0&(c|0)==0){c=2;break e}if(w=d+(v<<3)|0,u[w>>2]=g,u[w+4>>2]=c,v=v+1|0,_n(g,c)|0){c=1;break e}y=y+1|0}while((y|0)<(f|0));y=0;do{if(g=R(g,c,4,L)|0,c=j()|0,(g|0)==0&(c|0)==0){c=2;break e}if(w=d+(v<<3)|0,u[w>>2]=g,u[w+4>>2]=c,v=v+1|0,_n(g,c)|0){c=1;break e}y=y+1|0}while((y|0)<(f|0));for(y=0;;){if(g=R(g,c,6,L)|0,c=j()|0,(g|0)==0&(c|0)==0){c=2;break e}if((y|0)!=(C|0))if(w=d+(v<<3)|0,u[w>>2]=g,u[w+4>>2]=c,!(_n(g,c)|0))v=v+1|0;else{c=1;break e}if(y=y+1|0,(y|0)>=(f|0)){y=B,v=A;break}}}else y=B,g=B,v=A,c=A}else y=d,u[y>>2]=c,u[y+4>>2]=A,y=c,g=c,v=A,c=A;c=((y|0)!=(g|0)|(v|0)!=(c|0))&1}while(0);return L=c,U=V,L|0}function H(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0;if(v=U,U=U+48|0,g=v+8|0,d=v,w=c,y=u[w+4>>2]|0,f=d,u[f>>2]=u[w>>2],u[f+4>>2]=y,_p(d,g),g=up(g,A)|0,A=u[d>>2]|0,d=u[c+8>>2]|0,(d|0)<=0)return w=A,y=(g|0)<(w|0),w=y?w:g,w=w+12|0,U=v,w|0;f=u[c+12>>2]|0,c=0;do A=(u[f+(c<<3)>>2]|0)+A|0,c=c+1|0;while((c|0)<(d|0));return w=(g|0)<(A|0),w=w?A:g,w=w+12|0,U=v,w|0}function q(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0;if(w=U,U=U+48|0,d=w+8|0,g=w,!(ce(c,A,f)|0)){U=w;return}if(C=c,v=u[C+4>>2]|0,y=g,u[y>>2]=u[C>>2],u[y+4>>2]=v,_p(g,d),y=up(d,A)|0,A=u[g>>2]|0,v=u[c+8>>2]|0,(v|0)>0){g=u[c+12>>2]|0,d=0;do A=(u[g+(d<<3)>>2]|0)+A|0,d=d+1|0;while((d|0)!=(v|0))}if(A=(y|0)<(A|0)?A:y,(A|0)<=-12){U=w;return}C=A+11|0,mi(f|0,0,(((C|0)>0?C:0)<<3)+8|0)|0,U=w}function ce(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0,It=0,pt=0,Ot=0,Ft=0,He=0;if(He=U,U=U+112|0,It=He+80|0,C=He+72|0,pt=He,Ot=He+56|0,B=c+8|0,Ft=ki((u[B>>2]<<5)+32|0)|0,Ft||dt(22848,22448,800,22456),SR(c,Ft),v=c,d=u[v+4>>2]|0,w=C,u[w>>2]=u[v>>2],u[w+4>>2]=d,_p(C,It),w=up(It,A)|0,d=u[C>>2]|0,v=u[B>>2]|0,(v|0)>0){y=u[c+12>>2]|0,g=0;do d=(u[y+(g<<3)>>2]|0)+d|0,g=g+1|0;while((g|0)!=(v|0))}if(w=(w|0)<(d|0)?d:w,yt=w+12|0,g=gi(yt,8)|0,L=gi(yt,8)|0,u[It>>2]=0,Qe=c,bt=u[Qe+4>>2]|0,d=C,u[d>>2]=u[Qe>>2],u[d+4>>2]=bt,d=Se(C,yt,A,It,g,L)|0,d|0)return Ke(g),Ke(L),Ke(Ft),Ft=d,U=He,Ft|0;e:do if((u[B>>2]|0)>0){for(v=c+12|0,d=0;y=Se((u[v>>2]|0)+(d<<3)|0,yt,A,It,g,L)|0,d=d+1|0,!(y|0);)if((d|0)>=(u[B>>2]|0))break e;return Ke(g),Ke(L),Ke(Ft),Ft=y,U=He,Ft|0}while(0);(w|0)>-12&&mi(L|0,0,((yt|0)>1?yt:1)<<3|0)|0;e:do if((u[It>>2]|0)>0){bt=((yt|0)<0)<<31>>31,$=g,be=L,Ie=g,ye=g,Ee=L,Qe=g,d=g,de=g,Te=L,te=L,Ae=L,g=L;t:for(;;){for(ie=u[It>>2]|0,Y=0,re=0,v=0;;){y=pt,w=y+56|0;do u[y>>2]=0,y=y+4|0;while((y|0)<(w|0));if(A=$+(Y<<3)|0,C=u[A>>2]|0,A=u[A+4>>2]|0,yc(C,A,1,pt,0)|0){y=pt,w=y+56|0;do u[y>>2]=0,y=y+4|0;while((y|0)<(w|0));y=gi(7,4)|0,y|0&&(Yr(C,A,1,pt,y,7,0),Ke(y))}W=0;do{V=pt+(W<<3)|0,L=u[V>>2]|0,V=u[V+4>>2]|0;n:do if(!((L|0)==0&(V|0)==0)){if(C=Ls(L|0,V|0,yt|0,bt|0)|0,j()|0,y=f+(C<<3)|0,w=y,A=u[w>>2]|0,w=u[w+4>>2]|0,!((A|0)==0&(w|0)==0))for(B=0;;){if((B|0)>(yt|0))break t;if((A|0)==(L|0)&(w|0)==(V|0))break n;if(C=(C+1|0)%(yt|0)|0,y=f+(C<<3)|0,w=y,A=u[w>>2]|0,w=u[w+4>>2]|0,(A|0)==0&(w|0)==0)break;B=B+1|0}(L|0)==0&(V|0)==0||(Mo(L,V,Ot),PR(c,Ft,Ot)|0&&(B=y,u[B>>2]=L,u[B+4>>2]=V,B=be+(v<<3)|0,u[B>>2]=L,u[B+4>>2]=V,v=v+1|0))}while(0);W=W+1|0}while(W>>>0<7);if(re=re+1|0,(re|0)>=(ie|0))break;Y=Y+1|0}if((ie|0)>0&&mi(Ie|0,0,ie<<3|0)|0,u[It>>2]=v,(v|0)>0)L=g,V=Ae,W=Qe,Y=te,re=Te,ie=be,g=de,Ae=d,te=ye,Te=Ie,de=L,d=V,Qe=Ee,Ee=W,ye=Y,Ie=re,be=$,$=ie;else break e}return Ke(ye),Ke(Ee),Ke(Ft),Ft=-1,U=He,Ft|0}else d=L;while(0);return Ke(Ft),Ke(g),Ke(d),Ft=0,U=He,Ft|0}function Se(c,A,f,d,g,v){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0,v=v|0;var y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0,It=0;if(bt=U,U=U+48|0,Ie=bt+32|0,ye=bt+16|0,Ee=bt,y=u[c>>2]|0,(y|0)<=0)return Qe=0,U=bt,Qe|0;Te=c+4|0,te=Ie+8|0,Ae=ye+8|0,$=Ee+8|0,be=((A|0)<0)<<31>>31,de=0;e:for(;;){w=u[Te>>2]|0,re=w+(de<<4)|0,u[Ie>>2]=u[re>>2],u[Ie+4>>2]=u[re+4>>2],u[Ie+8>>2]=u[re+8>>2],u[Ie+12>>2]=u[re+12>>2],(de|0)==(y+-1|0)?(u[ye>>2]=u[w>>2],u[ye+4>>2]=u[w+4>>2],u[ye+8>>2]=u[w+8>>2],u[ye+12>>2]=u[w+12>>2]):(re=w+(de+1<<4)|0,u[ye>>2]=u[re>>2],u[ye+4>>2]=u[re+4>>2],u[ye+8>>2]=u[re+8>>2],u[ye+12>>2]=u[re+12>>2]),re=IL(Ie,ye,f)|0;t:do if((re|0)>0){ie=+(re|0),Y=0;n:for(;;){It=+(re-Y|0),yt=+(Y|0),G[Ee>>3]=+G[Ie>>3]*It/ie+ +G[ye>>3]*yt/ie,G[$>>3]=+G[te>>3]*It/ie+ +G[Ae>>3]*yt/ie,V=A2(Ee,f)|0,W=j()|0,w=Ls(V|0,W|0,A|0,be|0)|0,j()|0,y=v+(w<<3)|0,C=y,B=u[C>>2]|0,C=u[C+4>>2]|0;r:do if((B|0)==0&(C|0)==0)Qe=14;else for(L=0;;){if((L|0)>(A|0)){y=1;break r}if((B|0)==(V|0)&(C|0)==(W|0)){y=7;break r}if(w=(w+1|0)%(A|0)|0,y=v+(w<<3)|0,C=y,B=u[C>>2]|0,C=u[C+4>>2]|0,(B|0)==0&(C|0)==0){Qe=14;break}else L=L+1|0}while(0);switch((Qe|0)==14&&(Qe=0,(V|0)==0&(W|0)==0?y=7:(u[y>>2]=V,u[y+4>>2]=W,y=u[d>>2]|0,L=g+(y<<3)|0,u[L>>2]=V,u[L+4>>2]=W,u[d>>2]=y+1,y=0)),y&7){case 7:case 0:break;default:break n}if(Y=Y+1|0,(re|0)<=(Y|0)){Qe=8;break t}}if(y|0){y=-1,Qe=20;break e}}else Qe=8;while(0);if((Qe|0)==8&&(Qe=0),de=de+1|0,y=u[c>>2]|0,(de|0)>=(y|0)){y=0,Qe=20;break}}return(Qe|0)==20?(U=bt,y|0):0}function rt(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0;if(B=U,U=U+176|0,C=B,(A|0)<1){v2(f,0,0),U=B;return}y=c,y=he(u[y>>2]|0,u[y+4>>2]|0,52)|0,j()|0,v2(f,(A|0)>6?A:6,y&15),y=0;do{if(d=c+(y<<3)|0,Io(u[d>>2]|0,u[d+4>>2]|0,C),d=u[C>>2]|0,(d|0)>0){w=0;do v=C+8+(w<<4)|0,w=w+1|0,d=C+8+(((w|0)%(d|0)|0)<<4)|0,g=zR(f,d,v)|0,g?w2(f,g)|0:GR(f,v,d)|0,d=u[C>>2]|0;while((w|0)<(d|0))}y=y+1|0}while((y|0)!=(A|0));U=B}function fn(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0;if(v=U,U=U+32|0,d=v,g=v+16|0,rt(c,A,g),u[f>>2]=0,u[f+4>>2]=0,u[f+8>>2]=0,c=E2(g)|0,!c){h2(f)|0,_2(g),U=v;return}do{A=vR(f)|0;do _R(A,c)|0,y=c+16|0,u[d>>2]=u[y>>2],u[d+4>>2]=u[y+4>>2],u[d+8>>2]=u[y+8>>2],u[d+12>>2]=u[y+12>>2],w2(g,c)|0,c=VR(g,d)|0;while((c|0)!=0);c=E2(g)|0}while((c|0)!=0);h2(f)|0,_2(g),U=v}function Je(c){return c=c|0,u[7728+(c*28|0)+16>>2]|0}function vn(c){return c=c|0,(c|0)==4|(c|0)==117|0}function Sr(c){return c=c|0,u[11152+((u[c>>2]|0)*216|0)+((u[c+4>>2]|0)*72|0)+((u[c+8>>2]|0)*24|0)+(u[c+12>>2]<<3)>>2]|0}function xL(c){return c=c|0,u[11152+((u[c>>2]|0)*216|0)+((u[c+4>>2]|0)*72|0)+((u[c+8>>2]|0)*24|0)+(u[c+12>>2]<<3)+4>>2]|0}function CL(c,A){c=c|0,A=A|0,c=7728+(c*28|0)|0,u[A>>2]=u[c>>2],u[A+4>>2]=u[c+4>>2],u[A+8>>2]=u[c+8>>2],u[A+12>>2]=u[c+12>>2]}function SL(c,A){c=c|0,A=A|0;var f=0,d=0;if(A>>>0>20)return A=-1,A|0;do if((u[11152+(A*216|0)>>2]|0)!=(c|0))if((u[11152+(A*216|0)+8>>2]|0)!=(c|0))if((u[11152+(A*216|0)+16>>2]|0)!=(c|0))if((u[11152+(A*216|0)+24>>2]|0)!=(c|0))if((u[11152+(A*216|0)+32>>2]|0)!=(c|0))if((u[11152+(A*216|0)+40>>2]|0)!=(c|0))if((u[11152+(A*216|0)+48>>2]|0)!=(c|0))if((u[11152+(A*216|0)+56>>2]|0)!=(c|0))if((u[11152+(A*216|0)+64>>2]|0)!=(c|0))if((u[11152+(A*216|0)+72>>2]|0)!=(c|0))if((u[11152+(A*216|0)+80>>2]|0)!=(c|0))if((u[11152+(A*216|0)+88>>2]|0)!=(c|0))if((u[11152+(A*216|0)+96>>2]|0)!=(c|0))if((u[11152+(A*216|0)+104>>2]|0)!=(c|0))if((u[11152+(A*216|0)+112>>2]|0)!=(c|0))if((u[11152+(A*216|0)+120>>2]|0)!=(c|0))if((u[11152+(A*216|0)+128>>2]|0)!=(c|0))if((u[11152+(A*216|0)+136>>2]|0)==(c|0))c=2,f=1,d=2;else{if((u[11152+(A*216|0)+144>>2]|0)==(c|0)){c=0,f=2,d=0;break}if((u[11152+(A*216|0)+152>>2]|0)==(c|0)){c=0,f=2,d=1;break}if((u[11152+(A*216|0)+160>>2]|0)==(c|0)){c=0,f=2,d=2;break}if((u[11152+(A*216|0)+168>>2]|0)==(c|0)){c=1,f=2,d=0;break}if((u[11152+(A*216|0)+176>>2]|0)==(c|0)){c=1,f=2,d=1;break}if((u[11152+(A*216|0)+184>>2]|0)==(c|0)){c=1,f=2,d=2;break}if((u[11152+(A*216|0)+192>>2]|0)==(c|0)){c=2,f=2,d=0;break}if((u[11152+(A*216|0)+200>>2]|0)==(c|0)){c=2,f=2,d=1;break}if((u[11152+(A*216|0)+208>>2]|0)==(c|0)){c=2,f=2,d=2;break}else c=-1;return c|0}else c=2,f=1,d=1;else c=2,f=1,d=0;else c=1,f=1,d=2;else c=1,f=1,d=1;else c=1,f=1,d=0;else c=0,f=1,d=2;else c=0,f=1,d=1;else c=0,f=1,d=0;else c=2,f=0,d=2;else c=2,f=0,d=1;else c=2,f=0,d=0;else c=1,f=0,d=2;else c=1,f=0,d=1;else c=1,f=0,d=0;else c=0,f=0,d=2;else c=0,f=0,d=1;else c=0,f=0,d=0;while(0);return A=u[11152+(A*216|0)+(f*72|0)+(c*24|0)+(d<<3)+4>>2]|0,A|0}function X_(c,A){return c=c|0,A=A|0,(u[7728+(c*28|0)+20>>2]|0)==(A|0)?(A=1,A|0):(A=(u[7728+(c*28|0)+24>>2]|0)==(A|0),A|0)}function cp(c,A){return c=c|0,A=A|0,u[880+(c*28|0)+(A<<2)>>2]|0}function Ap(c,A){return c=c|0,A=A|0,(u[880+(c*28|0)>>2]|0)==(A|0)?(A=0,A|0):(u[880+(c*28|0)+4>>2]|0)==(A|0)?(A=1,A|0):(u[880+(c*28|0)+8>>2]|0)==(A|0)?(A=2,A|0):(u[880+(c*28|0)+12>>2]|0)==(A|0)?(A=3,A|0):(u[880+(c*28|0)+16>>2]|0)==(A|0)?(A=4,A|0):(u[880+(c*28|0)+20>>2]|0)==(A|0)?(A=5,A|0):((u[880+(c*28|0)+24>>2]|0)==(A|0)?6:7)|0}function PL(){return 122}function ML(c){c=c|0;var A=0,f=0,d=0;A=0;do we(A|0,0,45)|0,d=j()|0|134225919,f=c+(A<<3)|0,u[f>>2]=-1,u[f+4>>2]=d,A=A+1|0;while((A|0)!=122)}function Y_(c){return c=c|0,+G[c+16>>3]<+G[c+24>>3]|0}function J_(c,A){c=c|0,A=A|0;var f=0,d=0,g=0;return f=+G[A>>3],!(f>=+G[c+8>>3])||!(f<=+G[c>>3])?(A=0,A|0):(d=+G[c+16>>3],f=+G[c+24>>3],g=+G[A+8>>3],A=g>=f,c=g<=d&1,d<f?A&&(c=1):A||(c=0),A=(c|0)!=0,A|0)}function up(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0;y=U,U=U+288|0,f=y+264|0,d=y+96|0,g=y,v=g,w=v+96|0;do u[v>>2]=0,v=v+4|0;while((v|0)<(w|0));return vp(A,g),v=g,w=u[v>>2]|0,v=u[v+4>>2]|0,Mo(w,v,f),Io(w,v,d),C=+Ec(f,d+8|0),G[f>>3]=+G[c>>3],v=f+8|0,G[v>>3]=+G[c+16>>3],G[d>>3]=+G[c+8>>3],w=d+8|0,G[w>>3]=+G[c+24>>3],B=+Ec(f,d),w=~~+hi(+(B*B/+b2(+ +Ze(+((+G[v>>3]-+G[w>>3])/(+G[f>>3]-+G[d>>3]))),3)/(C*(C*2.59807621135)*.8))),U=y,((w|0)==0?1:w)|0}function IL(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0;w=U,U=U+288|0,d=w+264|0,g=w+96|0,v=w,y=v,C=y+96|0;do u[y>>2]=0,y=y+4|0;while((y|0)<(C|0));return vp(f,v),C=v,y=u[C>>2]|0,C=u[C+4>>2]|0,Mo(y,C,d),Io(y,C,g),B=+Ec(d,g+8|0),C=~~+hi(+(+Ec(c,A)/(B*2))),U=w,((C|0)==0?1:C)|0}function BL(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0,u[c>>2]=A,u[c+4>>2]=f,u[c+8>>2]=d}function LL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0;V=A+8|0,u[V>>2]=0,C=+G[c>>3],y=+Ze(+C),B=+G[c+8>>3],w=+Ze(+B)/.8660254037844386,y=y+w*.5,f=~~y,c=~~w,y=y-+(f|0),w=w-+(c|0);do if(y<.5)if(y<.3333333333333333)if(u[A>>2]=f,w<(y+1)*.5){u[A+4>>2]=c;break}else{c=c+1|0,u[A+4>>2]=c;break}else if(W=1-y,c=(!(w<W)&1)+c|0,u[A+4>>2]=c,W<=w&w<y*2){f=f+1|0,u[A>>2]=f;break}else{u[A>>2]=f;break}else{if(!(y<.6666666666666666))if(f=f+1|0,u[A>>2]=f,w<y*.5){u[A+4>>2]=c;break}else{c=c+1|0,u[A+4>>2]=c;break}if(w<1-y){if(u[A+4>>2]=c,y*2+-1<w){u[A>>2]=f;break}}else c=c+1|0,u[A+4>>2]=c;f=f+1|0,u[A>>2]=f}while(0);do if(C<0)if(c&1){L=(c+1|0)/2|0,L=Tc(f|0,((f|0)<0)<<31>>31|0,L|0,((L|0)<0)<<31>>31|0)|0,f=~~(+(f|0)-((+(L>>>0)+4294967296*+(j()|0))*2+1)),u[A>>2]=f;break}else{L=(c|0)/2|0,L=Tc(f|0,((f|0)<0)<<31>>31|0,L|0,((L|0)<0)<<31>>31|0)|0,f=~~(+(f|0)-(+(L>>>0)+4294967296*+(j()|0))*2),u[A>>2]=f;break}while(0);L=A+4|0,B<0&&(f=f-((c<<1|1|0)/2|0)|0,u[A>>2]=f,c=0-c|0,u[L>>2]=c),d=c-f|0,(f|0)<0?(g=0-f|0,u[L>>2]=d,u[V>>2]=g,u[A>>2]=0,c=d,f=0):g=0,(c|0)<0&&(f=f-c|0,u[A>>2]=f,g=g-c|0,u[V>>2]=g,u[L>>2]=0,c=0),v=f-g|0,d=c-g|0,(g|0)<0&&(u[A>>2]=v,u[L>>2]=d,u[V>>2]=0,c=d,f=v,g=0),d=(c|0)<(f|0)?c:f,d=(g|0)<(d|0)?g:d,!((d|0)<=0)&&(u[A>>2]=f-d,u[L>>2]=c-d,u[V>>2]=g-d)}function Wn(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0;A=u[c>>2]|0,y=c+4|0,f=u[y>>2]|0,(A|0)<0&&(f=f-A|0,u[y>>2]=f,v=c+8|0,u[v>>2]=(u[v>>2]|0)-A,u[c>>2]=0,A=0),(f|0)<0?(A=A-f|0,u[c>>2]=A,v=c+8|0,g=(u[v>>2]|0)-f|0,u[v>>2]=g,u[y>>2]=0,f=0):(g=c+8|0,v=g,g=u[g>>2]|0),(g|0)<0&&(A=A-g|0,u[c>>2]=A,f=f-g|0,u[y>>2]=f,u[v>>2]=0,g=0),d=(f|0)<(A|0)?f:A,d=(g|0)<(d|0)?g:d,!((d|0)<=0)&&(u[c>>2]=A-d,u[y>>2]=f-d,u[v>>2]=g-d)}function Co(c,A){c=c|0,A=A|0;var f=0,d=0;d=u[c+8>>2]|0,f=+((u[c+4>>2]|0)-d|0),G[A>>3]=+((u[c>>2]|0)-d|0)-f*.5,G[A+8>>3]=f*.8660254037844386}function or(c,A,f){c=c|0,A=A|0,f=f|0,u[f>>2]=(u[A>>2]|0)+(u[c>>2]|0),u[f+4>>2]=(u[A+4>>2]|0)+(u[c+4>>2]|0),u[f+8>>2]=(u[A+8>>2]|0)+(u[c+8>>2]|0)}function fp(c,A,f){c=c|0,A=A|0,f=f|0,u[f>>2]=(u[c>>2]|0)-(u[A>>2]|0),u[f+4>>2]=(u[c+4>>2]|0)-(u[A+4>>2]|0),u[f+8>>2]=(u[c+8>>2]|0)-(u[A+8>>2]|0)}function K_(c,A){c=c|0,A=A|0;var f=0,d=0;f=Bn(u[c>>2]|0,A)|0,u[c>>2]=f,f=c+4|0,d=Bn(u[f>>2]|0,A)|0,u[f>>2]=d,c=c+8|0,A=Bn(u[c>>2]|0,A)|0,u[c>>2]=A}function qu(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;y=u[c>>2]|0,w=(y|0)<0,d=(u[c+4>>2]|0)-(w?y:0)|0,v=(d|0)<0,g=(v?0-d|0:0)+((u[c+8>>2]|0)-(w?y:0))|0,f=(g|0)<0,c=f?0:g,A=(v?0:d)-(f?g:0)|0,g=(w?0:y)-(v?d:0)-(f?g:0)|0,f=(A|0)<(g|0)?A:g,f=(c|0)<(f|0)?c:f,d=(f|0)>0,c=c-(d?f:0)|0,A=A-(d?f:0)|0;e:do switch(g-(d?f:0)|0){case 0:switch(A|0){case 0:return w=(c|0)==0?0:(c|0)==1?1:7,w|0;case 1:return w=(c|0)==0?2:(c|0)==1?3:7,w|0;default:break e}case 1:switch(A|0){case 0:return w=(c|0)==0?4:(c|0)==1?5:7,w|0;case 1:{if(!c)c=6;else break e;return c|0}default:break e}}while(0);return w=7,w|0}function Z_(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;y=c+8|0,f=u[y>>2]|0,A=(u[c>>2]|0)-f|0,w=c+4|0,f=(u[w>>2]|0)-f|0,d=sf(+((A*3|0)-f|0)/7)|0,u[c>>2]=d,A=sf(+((f<<1)+A|0)/7)|0,u[w>>2]=A,u[y>>2]=0,f=A-d|0,(d|0)<0?(v=0-d|0,u[w>>2]=f,u[y>>2]=v,u[c>>2]=0,A=f,d=0,f=v):f=0,(A|0)<0&&(d=d-A|0,u[c>>2]=d,f=f-A|0,u[y>>2]=f,u[w>>2]=0,A=0),v=d-f|0,g=A-f|0,(f|0)<0?(u[c>>2]=v,u[w>>2]=g,u[y>>2]=0,A=g,g=v,f=0):g=d,d=(A|0)<(g|0)?A:g,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(u[c>>2]=g-d,u[w>>2]=A-d,u[y>>2]=f-d)}function hp(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;y=c+8|0,f=u[y>>2]|0,A=(u[c>>2]|0)-f|0,w=c+4|0,f=(u[w>>2]|0)-f|0,d=sf(+((A<<1)+f|0)/7)|0,u[c>>2]=d,A=sf(+((f*3|0)-A|0)/7)|0,u[w>>2]=A,u[y>>2]=0,f=A-d|0,(d|0)<0?(v=0-d|0,u[w>>2]=f,u[y>>2]=v,u[c>>2]=0,A=f,d=0,f=v):f=0,(A|0)<0&&(d=d-A|0,u[c>>2]=d,f=f-A|0,u[y>>2]=f,u[w>>2]=0,A=0),v=d-f|0,g=A-f|0,(f|0)<0?(u[c>>2]=v,u[w>>2]=g,u[y>>2]=0,A=g,g=v,f=0):g=d,d=(A|0)<(g|0)?A:g,d=(f|0)<(d|0)?f:d,!((d|0)<=0)&&(u[c>>2]=g-d,u[w>>2]=A-d,u[y>>2]=f-d)}function ef(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;A=u[c>>2]|0,y=c+4|0,f=u[y>>2]|0,w=c+8|0,d=u[w>>2]|0,g=f+(A*3|0)|0,u[c>>2]=g,f=d+(f*3|0)|0,u[y>>2]=f,A=(d*3|0)+A|0,u[w>>2]=A,d=f-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=d,u[w>>2]=A,u[c>>2]=0,f=d,d=0):d=g,(f|0)<0&&(d=d-f|0,u[c>>2]=d,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),v=d-A|0,g=f-A|0,(A|0)<0?(u[c>>2]=v,u[y>>2]=g,u[w>>2]=0,d=v,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[c>>2]=d-f,u[y>>2]=g-f,u[w>>2]=A-f)}function So(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;g=u[c>>2]|0,y=c+4|0,A=u[y>>2]|0,w=c+8|0,f=u[w>>2]|0,d=(A*3|0)+g|0,g=f+(g*3|0)|0,u[c>>2]=g,u[y>>2]=d,A=(f*3|0)+A|0,u[w>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=f,u[w>>2]=A,u[c>>2]=0,g=0):f=d,(f|0)<0&&(g=g-f|0,u[c>>2]=g,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),v=g-A|0,d=f-A|0,(A|0)<0?(u[c>>2]=v,u[y>>2]=d,u[w>>2]=0,g=v,A=0):d=f,f=(d|0)<(g|0)?d:g,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[c>>2]=g-f,u[y>>2]=d-f,u[w>>2]=A-f)}function q_(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0;(A+-1|0)>>>0>=6||(g=(u[15472+(A*12|0)>>2]|0)+(u[c>>2]|0)|0,u[c>>2]=g,w=c+4|0,d=(u[15472+(A*12|0)+4>>2]|0)+(u[w>>2]|0)|0,u[w>>2]=d,y=c+8|0,A=(u[15472+(A*12|0)+8>>2]|0)+(u[y>>2]|0)|0,u[y>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[w>>2]=f,u[y>>2]=A,u[c>>2]=0,d=0):(f=d,d=g),(f|0)<0&&(d=d-f|0,u[c>>2]=d,A=A-f|0,u[y>>2]=A,u[w>>2]=0,f=0),v=d-A|0,g=f-A|0,(A|0)<0?(u[c>>2]=v,u[w>>2]=g,u[y>>2]=0,d=v,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[c>>2]=d-f,u[w>>2]=g-f,u[y>>2]=A-f))}function e2(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;g=u[c>>2]|0,y=c+4|0,A=u[y>>2]|0,w=c+8|0,f=u[w>>2]|0,d=A+g|0,g=f+g|0,u[c>>2]=g,u[y>>2]=d,A=f+A|0,u[w>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=f,u[w>>2]=A,u[c>>2]=0,d=0):(f=d,d=g),(f|0)<0&&(d=d-f|0,u[c>>2]=d,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),v=d-A|0,g=f-A|0,(A|0)<0?(u[c>>2]=v,u[y>>2]=g,u[w>>2]=0,d=v,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[c>>2]=d-f,u[y>>2]=g-f,u[w>>2]=A-f)}function tf(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;A=u[c>>2]|0,y=c+4|0,d=u[y>>2]|0,w=c+8|0,f=u[w>>2]|0,g=d+A|0,u[c>>2]=g,d=f+d|0,u[y>>2]=d,A=f+A|0,u[w>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=f,u[w>>2]=A,u[c>>2]=0,d=0):(f=d,d=g),(f|0)<0&&(d=d-f|0,u[c>>2]=d,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),v=d-A|0,g=f-A|0,(A|0)<0?(u[c>>2]=v,u[y>>2]=g,u[w>>2]=0,d=v,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[c>>2]=d-f,u[y>>2]=g-f,u[w>>2]=A-f)}function Po(c){switch(c=c|0,c|0){case 1:{c=5;break}case 5:{c=4;break}case 4:{c=6;break}case 6:{c=2;break}case 2:{c=3;break}case 3:{c=1;break}}return c|0}function Is(c){switch(c=c|0,c|0){case 1:{c=3;break}case 3:{c=2;break}case 2:{c=6;break}case 6:{c=4;break}case 4:{c=5;break}case 5:{c=1;break}}return c|0}function t2(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;A=u[c>>2]|0,y=c+4|0,f=u[y>>2]|0,w=c+8|0,d=u[w>>2]|0,g=f+(A<<1)|0,u[c>>2]=g,f=d+(f<<1)|0,u[y>>2]=f,A=(d<<1)+A|0,u[w>>2]=A,d=f-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=d,u[w>>2]=A,u[c>>2]=0,f=d,d=0):d=g,(f|0)<0&&(d=d-f|0,u[c>>2]=d,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),v=d-A|0,g=f-A|0,(A|0)<0?(u[c>>2]=v,u[y>>2]=g,u[w>>2]=0,d=v,A=0):g=f,f=(g|0)<(d|0)?g:d,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[c>>2]=d-f,u[y>>2]=g-f,u[w>>2]=A-f)}function n2(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;g=u[c>>2]|0,y=c+4|0,A=u[y>>2]|0,w=c+8|0,f=u[w>>2]|0,d=(A<<1)+g|0,g=f+(g<<1)|0,u[c>>2]=g,u[y>>2]=d,A=(f<<1)+A|0,u[w>>2]=A,f=d-g|0,(g|0)<0?(A=A-g|0,u[y>>2]=f,u[w>>2]=A,u[c>>2]=0,g=0):f=d,(f|0)<0&&(g=g-f|0,u[c>>2]=g,A=A-f|0,u[w>>2]=A,u[y>>2]=0,f=0),v=g-A|0,d=f-A|0,(A|0)<0?(u[c>>2]=v,u[y>>2]=d,u[w>>2]=0,g=v,A=0):d=f,f=(d|0)<(g|0)?d:g,f=(A|0)<(f|0)?A:f,!((f|0)<=0)&&(u[c>>2]=g-f,u[y>>2]=d-f,u[w>>2]=A-f)}function dp(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0;return y=(u[c>>2]|0)-(u[A>>2]|0)|0,w=(y|0)<0,d=(u[c+4>>2]|0)-(u[A+4>>2]|0)-(w?y:0)|0,v=(d|0)<0,g=(w?0-y|0:0)+(u[c+8>>2]|0)-(u[A+8>>2]|0)+(v?0-d|0:0)|0,c=(g|0)<0,A=c?0:g,f=(v?0:d)-(c?g:0)|0,g=(w?0:y)-(v?d:0)-(c?g:0)|0,c=(f|0)<(g|0)?f:g,c=(A|0)<(c|0)?A:c,d=(c|0)>0,A=A-(d?c:0)|0,f=f-(d?c:0)|0,c=g-(d?c:0)|0,c=(c|0)>-1?c:0-c|0,f=(f|0)>-1?f:0-f|0,A=(A|0)>-1?A:0-A|0,A=(f|0)>(A|0)?f:A,((c|0)>(A|0)?c:A)|0}function RL(c,A){c=c|0,A=A|0;var f=0;f=u[c+8>>2]|0,u[A>>2]=(u[c>>2]|0)-f,u[A+4>>2]=(u[c+4>>2]|0)-f}function OL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0;d=u[c>>2]|0,u[A>>2]=d,c=u[c+4>>2]|0,y=A+4|0,u[y>>2]=c,w=A+8|0,u[w>>2]=0,f=c-d|0,(d|0)<0?(c=0-d|0,u[y>>2]=f,u[w>>2]=c,u[A>>2]=0,d=0):(f=c,c=0),(f|0)<0&&(d=d-f|0,u[A>>2]=d,c=c-f|0,u[w>>2]=c,u[y>>2]=0,f=0),v=d-c|0,g=f-c|0,(c|0)<0?(u[A>>2]=v,u[y>>2]=g,u[w>>2]=0,f=g,g=v,c=0):g=d,d=(f|0)<(g|0)?f:g,d=(c|0)<(d|0)?c:d,!((d|0)<=0)&&(u[A>>2]=g-d,u[y>>2]=f-d,u[w>>2]=c-d)}function r2(c){c=c|0;var A=0,f=0,d=0,g=0;A=c+8|0,g=u[A>>2]|0,f=g-(u[c>>2]|0)|0,u[c>>2]=f,d=c+4|0,c=(u[d>>2]|0)-g|0,u[d>>2]=c,u[A>>2]=0-(c+f)}function FL(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;f=u[c>>2]|0,A=0-f|0,u[c>>2]=A,y=c+8|0,u[y>>2]=0,w=c+4|0,d=u[w>>2]|0,g=d+f|0,(f|0)>0?(u[w>>2]=g,u[y>>2]=f,u[c>>2]=0,A=0,d=g):f=0,(d|0)<0?(v=A-d|0,u[c>>2]=v,f=f-d|0,u[y>>2]=f,u[w>>2]=0,g=v-f|0,A=0-f|0,(f|0)<0?(u[c>>2]=g,u[w>>2]=A,u[y>>2]=0,d=A,f=0):(d=0,g=v)):g=A,A=(d|0)<(g|0)?d:g,A=(f|0)<(A|0)?f:A,!((A|0)<=0)&&(u[c>>2]=g-A,u[w>>2]=d-A,u[y>>2]=f-A)}function DL(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0;d=U,U=U+16|0,g=d,kL(c,A,f,g),LL(g,f+4|0),U=d}function kL(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0,w=0,C=0;if(C=U,U=U+32|0,v=C,kR(c,v),u[f>>2]=0,g=+hn(15888,v),y=+hn(15912,v),y<g&&(u[f>>2]=1,g=y),y=+hn(15936,v),y<g&&(u[f>>2]=2,g=y),y=+hn(15960,v),y<g&&(u[f>>2]=3,g=y),y=+hn(15984,v),y<g&&(u[f>>2]=4,g=y),y=+hn(16008,v),y<g&&(u[f>>2]=5,g=y),y=+hn(16032,v),y<g&&(u[f>>2]=6,g=y),y=+hn(16056,v),y<g&&(u[f>>2]=7,g=y),y=+hn(16080,v),y<g&&(u[f>>2]=8,g=y),y=+hn(16104,v),y<g&&(u[f>>2]=9,g=y),y=+hn(16128,v),y<g&&(u[f>>2]=10,g=y),y=+hn(16152,v),y<g&&(u[f>>2]=11,g=y),y=+hn(16176,v),y<g&&(u[f>>2]=12,g=y),y=+hn(16200,v),y<g&&(u[f>>2]=13,g=y),y=+hn(16224,v),y<g&&(u[f>>2]=14,g=y),y=+hn(16248,v),y<g&&(u[f>>2]=15,g=y),y=+hn(16272,v),y<g&&(u[f>>2]=16,g=y),y=+hn(16296,v),y<g&&(u[f>>2]=17,g=y),y=+hn(16320,v),y<g&&(u[f>>2]=18,g=y),y=+hn(16344,v),y<g&&(u[f>>2]=19,g=y),y=+Di(+(1-g*.5)),y<1e-16){u[d>>2]=0,u[d+4>>2]=0,u[d+8>>2]=0,u[d+12>>2]=0,U=C;return}if(f=u[f>>2]|0,g=+G[16368+(f*24|0)>>3],g=+_c(g-+_c(+HL(15568+(f<<4)|0,c))),Jr(A)|0?w=+_c(g+-.3334731722518321):w=g,g=+an(+y)/.381966011250105,(A|0)>0){v=0;do g=g*2.6457513110645907,v=v+1|0;while((v|0)!=(A|0))}y=+ut(+w)*g,G[d>>3]=y,w=+st(+w)*g,G[d+8>>3]=w,U=C}function vc(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0;if(v=+DR(c),v<1e-16){A=15568+(A<<4)|0,u[g>>2]=u[A>>2],u[g+4>>2]=u[A+4>>2],u[g+8>>2]=u[A+8>>2],u[g+12>>2]=u[A+12>>2];return}if(y=+jt(+ +G[c+8>>3],+ +G[c>>3]),(f|0)>0){c=0;do v=v/2.6457513110645907,c=c+1|0;while((c|0)!=(f|0))}d?(v=v/3,f=(Jr(f)|0)==0,v=+Ms(+((f?v:v/2.6457513110645907)*.381966011250105))):(v=+Ms(+(v*.381966011250105)),Jr(f)|0&&(y=+_c(y+.3334731722518321))),jL(15568+(A<<4)|0,+_c(+G[16368+(A*24|0)>>3]-y),v,g)}function NL(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0;d=U,U=U+16|0,g=d,Co(c+4|0,g),vc(g,u[c>>2]|0,A,0,f),U=d}function i2(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0,It=0,pt=0,Ot=0,Ft=0,He=0;if(Ot=U,U=U+272|0,v=Ot+256|0,te=Ot+240|0,yt=Ot,It=Ot+224|0,pt=Ot+208|0,Ae=Ot+176|0,$=Ot+160|0,be=Ot+192|0,Ie=Ot+144|0,ye=Ot+128|0,Ee=Ot+112|0,Qe=Ot+96|0,bt=Ot+80|0,u[v>>2]=A,u[te>>2]=u[c>>2],u[te+4>>2]=u[c+4>>2],u[te+8>>2]=u[c+8>>2],u[te+12>>2]=u[c+12>>2],s2(te,v,yt),u[g>>2]=0,te=d+f+((d|0)==5&1)|0,(te|0)<=(f|0)){U=Ot;return}C=u[v>>2]|0,B=It+4|0,L=Ae+4|0,V=f+5|0,W=16848+(C<<2)|0,Y=16928+(C<<2)|0,re=ye+8|0,ie=Ee+8|0,de=Qe+8|0,Te=pt+4|0,w=f;e:for(;;){y=yt+(((w|0)%5|0)<<4)|0,u[pt>>2]=u[y>>2],u[pt+4>>2]=u[y+4>>2],u[pt+8>>2]=u[y+8>>2],u[pt+12>>2]=u[y+12>>2];do;while((Ca(pt,C,0,1)|0)==2);if((w|0)>(f|0)&(Jr(A)|0)!=0){if(u[Ae>>2]=u[pt>>2],u[Ae+4>>2]=u[pt+4>>2],u[Ae+8>>2]=u[pt+8>>2],u[Ae+12>>2]=u[pt+12>>2],Co(B,$),d=u[Ae>>2]|0,v=u[17008+(d*80|0)+(u[It>>2]<<2)>>2]|0,u[Ae>>2]=u[18608+(d*80|0)+(v*20|0)>>2],y=u[18608+(d*80|0)+(v*20|0)+16>>2]|0,(y|0)>0){c=0;do e2(L),c=c+1|0;while((c|0)<(y|0))}switch(y=18608+(d*80|0)+(v*20|0)+4|0,u[be>>2]=u[y>>2],u[be+4>>2]=u[y+4>>2],u[be+8>>2]=u[y+8>>2],K_(be,(u[W>>2]|0)*3|0),or(L,be,L),Wn(L),Co(L,Ie),Ft=+(u[Y>>2]|0),G[ye>>3]=Ft*3,G[re>>3]=0,He=Ft*-1.5,G[Ee>>3]=He,G[ie>>3]=Ft*2.598076211353316,G[Qe>>3]=He,G[de>>3]=Ft*-2.598076211353316,u[17008+((u[Ae>>2]|0)*80|0)+(u[pt>>2]<<2)>>2]|0){case 1:{c=Ee,d=ye;break}case 3:{c=Qe,d=Ee;break}case 2:{c=ye,d=Qe;break}default:{c=12;break e}}m2($,Ie,d,c,bt),vc(bt,u[Ae>>2]|0,C,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1}if((w|0)<(V|0)&&(Co(Te,Ae),vc(Ae,u[pt>>2]|0,C,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1),u[It>>2]=u[pt>>2],u[It+4>>2]=u[pt+4>>2],u[It+8>>2]=u[pt+8>>2],u[It+12>>2]=u[pt+12>>2],w=w+1|0,(w|0)>=(te|0)){c=3;break}}if((c|0)==3){U=Ot;return}else(c|0)==12&&dt(22474,22521,581,22531)}function s2(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0;C=U,U=U+128|0,d=C+64|0,g=C,v=d,y=20208,w=v+60|0;do u[v>>2]=u[y>>2],v=v+4|0,y=y+4|0;while((v|0)<(w|0));v=g,y=20272,w=v+60|0;do u[v>>2]=u[y>>2],v=v+4|0,y=y+4|0;while((v|0)<(w|0));w=(Jr(u[A>>2]|0)|0)==0,d=w?d:g,g=c+4|0,t2(g),n2(g),Jr(u[A>>2]|0)|0&&(So(g),u[A>>2]=(u[A>>2]|0)+1),u[f>>2]=u[c>>2],A=f+4|0,or(g,d,A),Wn(A),u[f+16>>2]=u[c>>2],A=f+20|0,or(g,d+12|0,A),Wn(A),u[f+32>>2]=u[c>>2],A=f+36|0,or(g,d+24|0,A),Wn(A),u[f+48>>2]=u[c>>2],A=f+52|0,or(g,d+36|0,A),Wn(A),u[f+64>>2]=u[c>>2],f=f+68|0,or(g,d+48|0,f),Wn(f),U=C}function Ca(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0;if(re=U,U=U+32|0,W=re+12|0,w=re,Y=c+4|0,V=u[16928+(A<<2)>>2]|0,L=(d|0)!=0,V=L?V*3|0:V,g=u[Y>>2]|0,B=c+8|0,y=u[B>>2]|0,L){if(v=c+12|0,d=u[v>>2]|0,g=y+g+d|0,(g|0)==(V|0))return Y=1,U=re,Y|0;C=v}else C=c+12|0,d=u[C>>2]|0,g=y+g+d|0;if((g|0)<=(V|0))return Y=0,U=re,Y|0;do if((d|0)>0){if(d=u[c>>2]|0,(y|0)>0){v=18608+(d*80|0)+60|0,d=c;break}d=18608+(d*80|0)+40|0,f?(BL(W,V,0,0),fp(Y,W,w),tf(w),or(w,W,Y),v=d,d=c):(v=d,d=c)}else v=18608+((u[c>>2]|0)*80|0)+20|0,d=c;while(0);if(u[d>>2]=u[v>>2],g=v+16|0,(u[g>>2]|0)>0){d=0;do e2(Y),d=d+1|0;while((d|0)<(u[g>>2]|0))}return c=v+4|0,u[W>>2]=u[c>>2],u[W+4>>2]=u[c+4>>2],u[W+8>>2]=u[c+8>>2],A=u[16848+(A<<2)>>2]|0,K_(W,L?A*3|0:A),or(Y,W,Y),Wn(Y),L?d=((u[B>>2]|0)+(u[Y>>2]|0)+(u[C>>2]|0)|0)==(V|0)?1:2:d=2,Y=d,U=re,Y|0}function UL(c,A){c=c|0,A=A|0;var f=0;do f=Ca(c,A,0,1)|0;while((f|0)==2);return f|0}function o2(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0;if(Qe=U,U=U+240|0,v=Qe+224|0,be=Qe+208|0,Ie=Qe,ye=Qe+192|0,Ee=Qe+176|0,de=Qe+160|0,Te=Qe+144|0,te=Qe+128|0,Ae=Qe+112|0,$=Qe+96|0,u[v>>2]=A,u[be>>2]=u[c>>2],u[be+4>>2]=u[c+4>>2],u[be+8>>2]=u[c+8>>2],u[be+12>>2]=u[c+12>>2],a2(be,v,Ie),u[g>>2]=0,ie=d+f+((d|0)==6&1)|0,(ie|0)<=(f|0)){U=Qe;return}C=u[v>>2]|0,B=f+6|0,L=16928+(C<<2)|0,V=Te+8|0,W=te+8|0,Y=Ae+8|0,re=ye+4|0,y=0,w=f,d=-1;e:for(;;){if(v=(w|0)%6|0,c=Ie+(v<<4)|0,u[ye>>2]=u[c>>2],u[ye+4>>2]=u[c+4>>2],u[ye+8>>2]=u[c+8>>2],u[ye+12>>2]=u[c+12>>2],c=y,y=Ca(ye,C,0,1)|0,(w|0)>(f|0)&(Jr(A)|0)!=0&&(c|0)!=1&&(u[ye>>2]|0)!=(d|0)){switch(Co(Ie+(((v+5|0)%6|0)<<4)+4|0,Ee),Co(Ie+(v<<4)+4|0,de),bt=+(u[L>>2]|0),G[Te>>3]=bt*3,G[V>>3]=0,yt=bt*-1.5,G[te>>3]=yt,G[W>>3]=bt*2.598076211353316,G[Ae>>3]=yt,G[Y>>3]=bt*-2.598076211353316,v=u[be>>2]|0,u[17008+(v*80|0)+(((d|0)==(v|0)?u[ye>>2]|0:d)<<2)>>2]|0){case 1:{c=te,d=Te;break}case 3:{c=Ae,d=te;break}case 2:{c=Te,d=Ae;break}default:{c=8;break e}}m2(Ee,de,d,c,$),!(y2(Ee,$)|0)&&!(y2(de,$)|0)&&(vc($,u[be>>2]|0,C,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1)}if((w|0)<(B|0)&&(Co(re,Ee),vc(Ee,u[ye>>2]|0,C,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1),w=w+1|0,(w|0)>=(ie|0)){c=3;break}else d=u[ye>>2]|0}if((c|0)==3){U=Qe;return}else(c|0)==8&&dt(22557,22521,746,22602)}function a2(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0;C=U,U=U+160|0,d=C+80|0,g=C,v=d,y=20336,w=v+72|0;do u[v>>2]=u[y>>2],v=v+4|0,y=y+4|0;while((v|0)<(w|0));v=g,y=20416,w=v+72|0;do u[v>>2]=u[y>>2],v=v+4|0,y=y+4|0;while((v|0)<(w|0));w=(Jr(u[A>>2]|0)|0)==0,d=w?d:g,g=c+4|0,t2(g),n2(g),Jr(u[A>>2]|0)|0&&(So(g),u[A>>2]=(u[A>>2]|0)+1),u[f>>2]=u[c>>2],A=f+4|0,or(g,d,A),Wn(A),u[f+16>>2]=u[c>>2],A=f+20|0,or(g,d+12|0,A),Wn(A),u[f+32>>2]=u[c>>2],A=f+36|0,or(g,d+24|0,A),Wn(A),u[f+48>>2]=u[c>>2],A=f+52|0,or(g,d+36|0,A),Wn(A),u[f+64>>2]=u[c>>2],A=f+68|0,or(g,d+48|0,A),Wn(A),u[f+80>>2]=u[c>>2],f=f+84|0,or(g,d+60|0,f),Wn(f),U=C}function _c(c){c=+c;var A=0;return A=c<0?c+6.283185307179586:c,+(c>=6.283185307179586?A+-6.283185307179586:A)}function Sa(c,A){return c=c|0,A=A|0,+Ze(+(+G[c>>3]-+G[A>>3]))<17453292519943298e-27?(A=+Ze(+(+G[c+8>>3]-+G[A+8>>3]))<17453292519943298e-27,A|0):(A=0,A|0)}function zL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0;return g=+G[A>>3],d=+G[c>>3],v=+st(+((g-d)*.5)),f=+st(+((+G[A+8>>3]-+G[c+8>>3])*.5)),f=v*v+f*(+ut(+g)*+ut(+d)*f),+(+jt(+ +tt(+f),+ +tt(+(1-f)))*2)}function Ec(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0;return g=+G[A>>3],d=+G[c>>3],v=+st(+((g-d)*.5)),f=+st(+((+G[A+8>>3]-+G[c+8>>3])*.5)),f=v*v+f*(+ut(+g)*+ut(+d)*f),+(+jt(+ +tt(+f),+ +tt(+(1-f)))*2*6371.007180918475)}function VL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0;return g=+G[A>>3],d=+G[c>>3],v=+st(+((g-d)*.5)),f=+st(+((+G[A+8>>3]-+G[c+8>>3])*.5)),f=v*v+f*(+ut(+g)*+ut(+d)*f),+(+jt(+ +tt(+f),+ +tt(+(1-f)))*2*6371.007180918475*1e3)}function HL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0;return v=+G[A>>3],d=+ut(+v),g=+G[A+8>>3]-+G[c+8>>3],y=d*+st(+g),f=+G[c>>3],+ +jt(+y,+(+st(+v)*+ut(+f)-+ut(+g)*(d*+st(+f))))}function jL(c,A,f,d){c=c|0,A=+A,f=+f,d=d|0;var g=0,v=0,y=0,w=0;if(f<1e-16){u[d>>2]=u[c>>2],u[d+4>>2]=u[c+4>>2],u[d+8>>2]=u[c+8>>2],u[d+12>>2]=u[c+12>>2];return}v=A<0?A+6.283185307179586:A,v=A>=6.283185307179586?v+-6.283185307179586:v;do if(v<1e-16)A=+G[c>>3]+f,G[d>>3]=A,g=d;else{if(g=+Ze(+(v+-3.141592653589793))<1e-16,A=+G[c>>3],g){A=A-f,G[d>>3]=A,g=d;break}if(y=+ut(+f),f=+st(+f),A=y*+st(+A)+ +ut(+v)*(f*+ut(+A)),A=A>1?1:A,A=+Ea(+(A<-1?-1:A)),G[d>>3]=A,+Ze(+(A+-1.5707963267948966))<1e-16){G[d>>3]=1.5707963267948966,G[d+8>>3]=0;return}if(+Ze(+(A+1.5707963267948966))<1e-16){G[d>>3]=-1.5707963267948966,G[d+8>>3]=0;return}if(w=+ut(+A),v=f*+st(+v)/w,f=+G[c>>3],A=(y-+st(+A)*+st(+f))/+ut(+f)/w,y=v>1?1:v,A=A>1?1:A,A=+G[c+8>>3]+ +jt(+(y<-1?-1:y),+(A<-1?-1:A)),A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);G[d+8>>3]=A;return}while(0);if(+Ze(+(A+-1.5707963267948966))<1e-16){G[g>>3]=1.5707963267948966,G[d+8>>3]=0;return}if(+Ze(+(A+1.5707963267948966))<1e-16){G[g>>3]=-1.5707963267948966,G[d+8>>3]=0;return}if(A=+G[c+8>>3],A>3.141592653589793)do A=A+-6.283185307179586;while(A>3.141592653589793);if(A<-3.141592653589793)do A=A+6.283185307179586;while(A<-3.141592653589793);G[d+8>>3]=A}function WL(c){return c=c|0,+ +G[20496+(c<<3)>>3]}function QL(c){return c=c|0,+ +G[20624+(c<<3)>>3]}function $L(c){return c=c|0,+ +G[20752+(c<<3)>>3]}function XL(c){return c=c|0,+ +G[20880+(c<<3)>>3]}function YL(c){c=c|0;var A=0;return A=21008+(c<<3)|0,c=u[A>>2]|0,De(u[A+4>>2]|0),c|0}function Pa(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0;return W=+G[A>>3],L=+G[c>>3],C=+st(+((W-L)*.5)),v=+G[A+8>>3],B=+G[c+8>>3],y=+st(+((v-B)*.5)),w=+ut(+L),V=+ut(+W),y=C*C+y*(V*w*y),y=+jt(+ +tt(+y),+ +tt(+(1-y)))*2,C=+G[f>>3],W=+st(+((C-W)*.5)),d=+G[f+8>>3],v=+st(+((d-v)*.5)),g=+ut(+C),v=W*W+v*(V*g*v),v=+jt(+ +tt(+v),+ +tt(+(1-v)))*2,C=+st(+((L-C)*.5)),d=+st(+((B-d)*.5)),d=C*C+d*(w*g*d),d=+jt(+ +tt(+d),+ +tt(+(1-d)))*2,g=(y+v+d)*.5,+(+Ms(+ +tt(+(+an(+(g*.5))*+an(+((g-y)*.5))*+an(+((g-v)*.5))*+an(+((g-d)*.5)))))*4)}function JL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0;if(v=U,U=U+192|0,d=v+168|0,g=v,Mo(c,A,d),Io(c,A,g),A=u[g>>2]|0,(A|0)<=0)return f=0,U=v,+f;if(f=+Pa(g+8|0,g+8+(((A|0)!=1&1)<<4)|0,d)+0,(A|0)==1)return U=v,+f;c=1;do y=c,c=c+1|0,f=f+ +Pa(g+8+(y<<4)|0,g+8+(((c|0)%(A|0)|0)<<4)|0,d);while((c|0)<(A|0));return U=v,+f}function KL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0;if(v=U,U=U+192|0,d=v+168|0,g=v,Mo(c,A,d),Io(c,A,g),A=u[g>>2]|0,(A|0)>0){if(f=+Pa(g+8|0,g+8+(((A|0)!=1&1)<<4)|0,d)+0,(A|0)!=1){c=1;do y=c,c=c+1|0,f=f+ +Pa(g+8+(y<<4)|0,g+8+(((c|0)%(A|0)|0)<<4)|0,d);while((c|0)<(A|0))}}else f=0;return U=v,+(f*6371.007180918475*6371.007180918475)}function ZL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0;if(v=U,U=U+192|0,d=v+168|0,g=v,Mo(c,A,d),Io(c,A,g),A=u[g>>2]|0,(A|0)>0){if(f=+Pa(g+8|0,g+8+(((A|0)!=1&1)<<4)|0,d)+0,(A|0)!=1){c=1;do y=c,c=c+1|0,f=f+ +Pa(g+8+(y<<4)|0,g+8+(((c|0)%(A|0)|0)<<4)|0,d);while((c|0)<(A|0))}}else f=0;return U=v,+(f*6371.007180918475*6371.007180918475*1e3*1e3)}function qL(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0;if(y=U,U=U+176|0,v=y,nf(c,A,v),c=u[v>>2]|0,(c|0)<=1)return g=0,U=y,+g;A=c+-1|0,c=0,f=0,d=+G[v+8>>3],g=+G[v+16>>3];do c=c+1|0,C=d,d=+G[v+8+(c<<4)>>3],B=+st(+((d-C)*.5)),w=g,g=+G[v+8+(c<<4)+8>>3],w=+st(+((g-w)*.5)),w=B*B+w*(+ut(+d)*+ut(+C)*w),f=f+ +jt(+ +tt(+w),+ +tt(+(1-w)))*2;while((c|0)<(A|0));return U=y,+f}function eR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0;if(y=U,U=U+176|0,v=y,nf(c,A,v),c=u[v>>2]|0,(c|0)<=1)return g=0,U=y,+g;A=c+-1|0,c=0,f=0,d=+G[v+8>>3],g=+G[v+16>>3];do c=c+1|0,C=d,d=+G[v+8+(c<<4)>>3],B=+st(+((d-C)*.5)),w=g,g=+G[v+8+(c<<4)+8>>3],w=+st(+((g-w)*.5)),w=B*B+w*(+ut(+C)*+ut(+d)*w),f=f+ +jt(+ +tt(+w),+ +tt(+(1-w)))*2;while((c|0)!=(A|0));return B=f*6371.007180918475,U=y,+B}function tR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0;if(y=U,U=U+176|0,v=y,nf(c,A,v),c=u[v>>2]|0,(c|0)<=1)return g=0,U=y,+g;A=c+-1|0,c=0,f=0,d=+G[v+8>>3],g=+G[v+16>>3];do c=c+1|0,C=d,d=+G[v+8+(c<<4)>>3],B=+st(+((d-C)*.5)),w=g,g=+G[v+8+(c<<4)+8>>3],w=+st(+((g-w)*.5)),w=B*B+w*(+ut(+C)*+ut(+d)*w),f=f+ +jt(+ +tt(+w),+ +tt(+(1-w)))*2;while((c|0)!=(A|0));return B=f*6371.007180918475*1e3,U=y,+B}function nR(c,A){return c=c|0,A=A|0,A=he(c|0,A|0,52)|0,j()|0,A&15|0}function l2(c,A){return c=c|0,A=A|0,A=he(c|0,A|0,45)|0,j()|0,A&127|0}function c2(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0;if(!(!0&(A&-16777216|0)==134217728)||(y=he(c|0,A|0,45)|0,j()|0,y=y&127,y>>>0>121))return A=0,A|0;f=he(c|0,A|0,52)|0,j()|0,f=f&15;do if(f|0){for(g=1,d=0;;){if(v=he(c|0,A|0,(15-g|0)*3|0)|0,j()|0,v=v&7,(v|0)!=0&(d^1))if((v|0)==1&(Je(y)|0)!=0){w=0,d=13;break}else d=1;if((v|0)==7){w=0,d=13;break}if(g>>>0<f>>>0)g=g+1|0;else{d=9;break}}if((d|0)==9){if((f|0)==15)w=1;else break;return w|0}else if((d|0)==13)return w|0}while(0);for(;;){if(w=he(c|0,A|0,(14-f|0)*3|0)|0,j()|0,!((w&7|0)==7&!0)){w=0,d=13;break}if(f>>>0<14)f=f+1|0;else{w=1,d=13;break}}return(d|0)==13?w|0:0}function pp(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0;if(d=he(c|0,A|0,52)|0,j()|0,d=d&15,(d|0)>=(f|0)){if((d|0)!=(f|0))if(f>>>0<=15){if(g=we(f|0,0,52)|0,c=g|c,A=j()|0|A&-15728641,(d|0)>(f|0))do g=we(7,0,(14-f|0)*3|0)|0,f=f+1|0,c=g|c,A=j()|0|A;while((f|0)<(d|0))}else A=0,c=0}else A=0,c=0;return De(A|0),c|0}function rR(c,A,f){return c=c|0,A=A|0,f=f|0,c=he(c|0,A|0,52)|0,j()|0,c=c&15,(f|0)<16&(c|0)<=(f|0)?(f=rf(7,f-c|0)|0,f|0):(f=0,f|0)}function hr(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0,w=0,C=0,B=0,L=0;if(y=he(c|0,A|0,52)|0,j()|0,y=y&15,!!((f|0)<16&(y|0)<=(f|0))){if((y|0)==(f|0)){f=d,u[f>>2]=c,u[f+4>>2]=A;return}if(C=rf(7,f-y|0)|0,B=(C|0)/7|0,w=he(c|0,A|0,45)|0,j()|0,!(Je(w&127)|0))v=0;else{e:do if(!y)g=0;else for(v=1;;){if(g=he(c|0,A|0,(15-v|0)*3|0)|0,j()|0,g=g&7,g|0)break e;if(v>>>0<y>>>0)v=v+1|0;else{g=0;break}}while(0);v=(g|0)==0}if(L=we(y+1|0,0,52)|0,g=j()|0|A&-15728641,w=(14-y|0)*3|0,A=we(7,0,w|0)|0,A=(L|c)&~A,y=g&~(j()|0),hr(A,y,f,d),g=d+(B<<3)|0,!v){L=we(1,0,w|0)|0,hr(L|A,j()|0|y,f,g),L=g+(B<<3)|0,C=we(2,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(3,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(4,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(5,0,w|0)|0,hr(C|A,j()|0|y,f,L),C=we(6,0,w|0)|0,hr(C|A,j()|0|y,f,L+(B<<3)|0);return}v=g+(B<<3)|0,(C|0)>6&&(C=g+8|0,L=(v>>>0>C>>>0?v:C)+-1+(0-g)|0,mi(g|0,0,L+8&-8|0)|0,g=C+(L>>>3<<3)|0),L=we(2,0,w|0)|0,hr(L|A,j()|0|y,f,g),L=g+(B<<3)|0,C=we(3,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(4,0,w|0)|0,hr(C|A,j()|0|y,f,L),L=L+(B<<3)|0,C=we(5,0,w|0)|0,hr(C|A,j()|0|y,f,L),C=we(6,0,w|0)|0,hr(C|A,j()|0|y,f,L+(B<<3)|0)}}function _n(c,A){c=c|0,A=A|0;var f=0,d=0,g=0;if(g=he(c|0,A|0,45)|0,j()|0,!(Je(g&127)|0))return g=0,g|0;g=he(c|0,A|0,52)|0,j()|0,g=g&15;e:do if(!g)f=0;else for(d=1;;){if(f=he(c|0,A|0,(15-d|0)*3|0)|0,j()|0,f=f&7,f|0)break e;if(d>>>0<g>>>0)d=d+1|0;else{f=0;break}}while(0);return g=(f|0)==0&1,g|0}function iR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0;if(d=he(c|0,A|0,52)|0,j()|0,d=d&15,(f|0)<16&(d|0)<=(f|0)){if((d|0)!=(f|0)&&(g=we(f|0,0,52)|0,c=g|c,A=j()|0|A&-15728641,(d|0)<(f|0)))do g=we(7,0,(14-d|0)*3|0)|0,d=d+1|0,c=c&~g,A=A&~(j()|0);while((d|0)<(f|0))}else A=0,c=0;return De(A|0),c|0}function sR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0;if(!f)return ye=0,ye|0;if(g=c,d=u[g>>2]|0,g=u[g+4>>2]|0,!0&(g&15728640|0)==0){if((f|0)<=0||(ye=A,u[ye>>2]=d,u[ye+4>>2]=g,(f|0)==1))return ye=0,ye|0;d=1;do be=c+(d<<3)|0,Ie=u[be+4>>2]|0,ye=A+(d<<3)|0,u[ye>>2]=u[be>>2],u[ye+4>>2]=Ie,d=d+1|0;while((d|0)!=(f|0));return d=0,d|0}if(be=f<<3,Ie=ki(be)|0,!Ie)return ye=-3,ye|0;if(af(Ie|0,c|0,be|0)|0,$=gi(f,8)|0,!$)return Ke(Ie),ye=-3,ye|0;d=f;e:for(;;){y=Ie,L=u[y>>2]|0,y=u[y+4>>2]|0,te=he(L|0,y|0,52)|0,j()|0,te=te&15,Ae=te+-1|0,Te=(d|0)>0;t:do if(Te){if(de=((d|0)<0)<<31>>31,re=we(Ae|0,0,52)|0,ie=j()|0,Ae>>>0>15)for(g=0,c=L,f=y;;){if(!((c|0)==0&(f|0)==0)){if(v=he(c|0,f|0,52)|0,j()|0,v=v&15,w=(v|0)<(Ae|0),v=(v|0)==(Ae|0),B=w?0:v?c:0,c=w?0:v?f:0,f=Ls(B|0,c|0,d|0,de|0)|0,j()|0,v=$+(f<<3)|0,w=v,C=u[w>>2]|0,w=u[w+4>>2]|0,(C|0)==0&(w|0)==0)f=B;else for(re=0,Y=f,W=w,f=B;;){if((re|0)>(d|0)){ye=41;break e}if((C|0)==(f|0)&(W&-117440513|0)==(c|0)){B=he(C|0,W|0,56)|0,j()|0,B=B&7,V=B+1|0,ie=he(C|0,W|0,45)|0,j()|0;n:do if(!(Je(ie&127)|0))w=7;else{if(C=he(C|0,W|0,52)|0,j()|0,C=C&15,!C){w=6;break}for(w=1;;){if(ie=we(7,0,(15-w|0)*3|0)|0,!((ie&f|0)==0&((j()|0)&c|0)==0)){w=7;break n}if(w>>>0<C>>>0)w=w+1|0;else{w=6;break}}}while(0);if((B+2|0)>>>0>w>>>0){ye=51;break e}ie=we(V|0,0,56)|0,c=j()|0|c&-117440513,w=v,u[w>>2]=0,u[w+4>>2]=0,w=Y,f=ie|f}else w=(Y+1|0)%(d|0)|0;if(v=$+(w<<3)|0,W=v,C=u[W>>2]|0,W=u[W+4>>2]|0,(C|0)==0&(W|0)==0)break;re=re+1|0,Y=w}ie=v,u[ie>>2]=f,u[ie+4>>2]=c}if(g=g+1|0,(g|0)>=(d|0))break t;f=Ie+(g<<3)|0,c=u[f>>2]|0,f=u[f+4>>2]|0}for(g=0,c=L,f=y;;){if(!((c|0)==0&(f|0)==0)){if(w=he(c|0,f|0,52)|0,j()|0,w=w&15,(w|0)>=(Ae|0)){if((w|0)!=(Ae|0)&&(c=c|re,f=f&-15728641|ie,w>>>0>=te>>>0)){v=Ae;do Y=we(7,0,(14-v|0)*3|0)|0,v=v+1|0,c=Y|c,f=j()|0|f;while(v>>>0<w>>>0)}}else c=0,f=0;if(w=Ls(c|0,f|0,d|0,de|0)|0,j()|0,v=$+(w<<3)|0,C=v,B=u[C>>2]|0,C=u[C+4>>2]|0,!((B|0)==0&(C|0)==0))for(Y=0;;){if((Y|0)>(d|0)){ye=41;break e}if((B|0)==(c|0)&(C&-117440513|0)==(f|0)){V=he(B|0,C|0,56)|0,j()|0,V=V&7,W=V+1|0,Ee=he(B|0,C|0,45)|0,j()|0;n:do if(!(Je(Ee&127)|0))C=7;else{if(B=he(B|0,C|0,52)|0,j()|0,B=B&15,!B){C=6;break}for(C=1;;){if(Ee=we(7,0,(15-C|0)*3|0)|0,!((Ee&c|0)==0&((j()|0)&f|0)==0)){C=7;break n}if(C>>>0<B>>>0)C=C+1|0;else{C=6;break}}}while(0);if((V+2|0)>>>0>C>>>0){ye=51;break e}Ee=we(W|0,0,56)|0,f=j()|0|f&-117440513,W=v,u[W>>2]=0,u[W+4>>2]=0,c=Ee|c}else w=(w+1|0)%(d|0)|0;if(v=$+(w<<3)|0,C=v,B=u[C>>2]|0,C=u[C+4>>2]|0,(B|0)==0&(C|0)==0)break;Y=Y+1|0}Ee=v,u[Ee>>2]=c,u[Ee+4>>2]=f}if(g=g+1|0,(g|0)>=(d|0))break t;f=Ie+(g<<3)|0,c=u[f>>2]|0,f=u[f+4>>2]|0}}while(0);if((d+5|0)>>>0<11){ye=99;break}if(ie=gi((d|0)/6|0,8)|0,!ie){ye=58;break}t:do if(Te){Y=0,W=0;do{if(w=$+(Y<<3)|0,c=w,g=u[c>>2]|0,c=u[c+4>>2]|0,!((g|0)==0&(c|0)==0)){C=he(g|0,c|0,56)|0,j()|0,C=C&7,f=C+1|0,B=c&-117440513,Ee=he(g|0,c|0,45)|0,j()|0;n:do if(Je(Ee&127)|0){if(V=he(g|0,c|0,52)|0,j()|0,V=V&15,V|0)for(v=1;;){if(Ee=we(7,0,(15-v|0)*3|0)|0,!((g&Ee|0)==0&(B&(j()|0)|0)==0))break n;if(v>>>0<V>>>0)v=v+1|0;else break}c=we(f|0,0,56)|0,g=c|g,c=j()|0|B,f=w,u[f>>2]=g,u[f+4>>2]=c,f=C+2|0}while(0);(f|0)==7&&(Ee=ie+(W<<3)|0,u[Ee>>2]=g,u[Ee+4>>2]=c&-117440513,W=W+1|0)}Y=Y+1|0}while((Y|0)!=(d|0));if(Te){if(re=((d|0)<0)<<31>>31,V=we(Ae|0,0,52)|0,Y=j()|0,Ae>>>0>15)for(c=0,g=0;;){do if(!((L|0)==0&(y|0)==0)){for(C=he(L|0,y|0,52)|0,j()|0,C=C&15,v=(C|0)<(Ae|0),C=(C|0)==(Ae|0),w=v?0:C?L:0,C=v?0:C?y:0,v=Ls(w|0,C|0,d|0,re|0)|0,j()|0,f=0;;){if((f|0)>(d|0)){ye=98;break e}if(Ee=$+(v<<3)|0,B=u[Ee+4>>2]|0,(B&-117440513|0)==(C|0)&&(u[Ee>>2]|0)==(w|0)){ye=70;break}if(v=(v+1|0)%(d|0)|0,Ee=$+(v<<3)|0,(u[Ee>>2]|0)==(w|0)&&(u[Ee+4>>2]|0)==(C|0))break;f=f+1|0}if((ye|0)==70&&(ye=0,!0&(B&117440512|0)==100663296))break;Ee=A+(g<<3)|0,u[Ee>>2]=L,u[Ee+4>>2]=y,g=g+1|0}while(0);if(c=c+1|0,(c|0)>=(d|0)){d=W;break t}y=Ie+(c<<3)|0,L=u[y>>2]|0,y=u[y+4>>2]|0}for(c=0,g=0;;){do if(!((L|0)==0&(y|0)==0)){if(C=he(L|0,y|0,52)|0,j()|0,C=C&15,(C|0)>=(Ae|0))if((C|0)!=(Ae|0))if(f=L|V,v=y&-15728641|Y,C>>>0<te>>>0)C=v;else{w=Ae;do Ee=we(7,0,(14-w|0)*3|0)|0,w=w+1|0,f=Ee|f,v=j()|0|v;while(w>>>0<C>>>0);C=v}else f=L,C=y;else f=0,C=0;for(w=Ls(f|0,C|0,d|0,re|0)|0,j()|0,v=0;;){if((v|0)>(d|0)){ye=98;break e}if(Ee=$+(w<<3)|0,B=u[Ee+4>>2]|0,(B&-117440513|0)==(C|0)&&(u[Ee>>2]|0)==(f|0)){ye=93;break}if(w=(w+1|0)%(d|0)|0,Ee=$+(w<<3)|0,(u[Ee>>2]|0)==(f|0)&&(u[Ee+4>>2]|0)==(C|0))break;v=v+1|0}if((ye|0)==93&&(ye=0,!0&(B&117440512|0)==100663296))break;Ee=A+(g<<3)|0,u[Ee>>2]=L,u[Ee+4>>2]=y,g=g+1|0}while(0);if(c=c+1|0,(c|0)>=(d|0)){d=W;break t}y=Ie+(c<<3)|0,L=u[y>>2]|0,y=u[y+4>>2]|0}}else g=0,d=W}else g=0,d=0;while(0);if(mi($|0,0,be|0)|0,af(Ie|0,ie|0,d<<3|0)|0,Ke(ie),d)A=A+(g<<3)|0;else break}return(ye|0)==41?(Ke(Ie),Ke($),Ee=-1,Ee|0):(ye|0)==51?(Ke(Ie),Ke($),Ee=-2,Ee|0):(ye|0)==58?(Ke(Ie),Ke($),Ee=-3,Ee|0):(ye|0)==98?(Ke(ie),Ke(Ie),Ke($),Ee=-1,Ee|0):((ye|0)==99&&af(A|0,Ie|0,d<<3|0)|0,Ke(Ie),Ke($),Ee=0,Ee|0)}function oR(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0,w=0,C=0,B=0,L=0;if((A|0)<=0)return g=0,g|0;if((g|0)>=16){for(v=0;;){if(L=c+(v<<3)|0,!((u[L>>2]|0)==0&(u[L+4>>2]|0)==0)){v=14;break}if(v=v+1|0,(v|0)>=(A|0)){y=0,v=16;break}}if((v|0)==14)return((d|0)>0?-2:-1)|0;if((v|0)==16)return y|0}v=0,L=0;e:for(;;){B=c+(L<<3)|0,w=B,y=u[w>>2]|0,w=u[w+4>>2]|0;do if(!((y|0)==0&(w|0)==0)){if((v|0)>=(d|0)){y=-1,v=16;break e}if(C=he(y|0,w|0,52)|0,j()|0,C=C&15,(C|0)>(g|0)){y=-2,v=16;break e}if((C|0)==(g|0)){B=f+(v<<3)|0,u[B>>2]=y,u[B+4>>2]=w,v=v+1|0;break}if(y=(rf(7,g-C|0)|0)+v|0,(y|0)>(d|0)){y=-1,v=16;break e}hr(u[B>>2]|0,u[B+4>>2]|0,g,f+(v<<3)|0),v=y}while(0);if(L=L+1|0,(L|0)>=(A|0)){y=0,v=16;break}}return(v|0)==16?y|0:0}function aR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0;if((A|0)<=0)return f=0,f|0;if((f|0)>=16){for(d=0;;){if(y=c+(d<<3)|0,!((u[y>>2]|0)==0&(u[y+4>>2]|0)==0)){d=-1,g=13;break}if(d=d+1|0,(d|0)>=(A|0)){d=0,g=13;break}}if((g|0)==13)return d|0}d=0,y=0;e:for(;;){g=c+(y<<3)|0,v=u[g>>2]|0,g=u[g+4>>2]|0;do if(!((v|0)==0&(g|0)==0)){if(g=he(v|0,g|0,52)|0,j()|0,g=g&15,(g|0)>(f|0)){d=-1,g=13;break e}if((g|0)==(f|0)){d=d+1|0;break}else{d=(rf(7,f-g|0)|0)+d|0;break}}while(0);if(y=y+1|0,(y|0)>=(A|0)){g=13;break}}return(g|0)==13?d|0:0}function lR(c,A){return c=c|0,A=A|0,A=he(c|0,A|0,52)|0,j()|0,A&1|0}function dr(c,A){c=c|0,A=A|0;var f=0,d=0,g=0;if(g=he(c|0,A|0,52)|0,j()|0,g=g&15,!g)return g=0,g|0;for(d=1;;){if(f=he(c|0,A|0,(15-d|0)*3|0)|0,j()|0,f=f&7,f|0){d=5;break}if(d>>>0<g>>>0)d=d+1|0;else{f=0,d=5;break}}return(d|0)==5?f|0:0}function gp(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0;if(C=he(c|0,A|0,52)|0,j()|0,C=C&15,!C)return w=A,C=c,De(w|0),C|0;for(w=1,f=0;;){v=(15-w|0)*3|0,d=we(7,0,v|0)|0,g=j()|0,y=he(c|0,A|0,v|0)|0,j()|0,v=we(Po(y&7)|0,0,v|0)|0,y=j()|0,c=v|c&~d,A=y|A&~g;e:do if(!f)if((v&d|0)==0&(y&g|0)==0)f=0;else if(d=he(c|0,A|0,52)|0,j()|0,d=d&15,!d)f=1;else{f=1;t:for(;;){switch(y=he(c|0,A|0,(15-f|0)*3|0)|0,j()|0,y&7){case 1:break t;case 0:break;default:{f=1;break e}}if(f>>>0<d>>>0)f=f+1|0;else{f=1;break e}}for(f=1;;)if(y=(15-f|0)*3|0,g=he(c|0,A|0,y|0)|0,j()|0,v=we(7,0,y|0)|0,A=A&~(j()|0),y=we(Po(g&7)|0,0,y|0)|0,c=c&~v|y,A=A|(j()|0),f>>>0<d>>>0)f=f+1|0;else{f=1;break}}while(0);if(w>>>0<C>>>0)w=w+1|0;else break}return De(A|0),c|0}function Bs(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0;if(d=he(c|0,A|0,52)|0,j()|0,d=d&15,!d)return f=A,d=c,De(f|0),d|0;for(f=1;v=(15-f|0)*3|0,y=he(c|0,A|0,v|0)|0,j()|0,g=we(7,0,v|0)|0,A=A&~(j()|0),v=we(Po(y&7)|0,0,v|0)|0,c=v|c&~g,A=j()|0|A,f>>>0<d>>>0;)f=f+1|0;return De(A|0),c|0}function cR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0;if(C=he(c|0,A|0,52)|0,j()|0,C=C&15,!C)return w=A,C=c,De(w|0),C|0;for(w=1,f=0;;){v=(15-w|0)*3|0,d=we(7,0,v|0)|0,g=j()|0,y=he(c|0,A|0,v|0)|0,j()|0,v=we(Is(y&7)|0,0,v|0)|0,y=j()|0,c=v|c&~d,A=y|A&~g;e:do if(!f)if((v&d|0)==0&(y&g|0)==0)f=0;else if(d=he(c|0,A|0,52)|0,j()|0,d=d&15,!d)f=1;else{f=1;t:for(;;){switch(y=he(c|0,A|0,(15-f|0)*3|0)|0,j()|0,y&7){case 1:break t;case 0:break;default:{f=1;break e}}if(f>>>0<d>>>0)f=f+1|0;else{f=1;break e}}for(f=1;;)if(g=(15-f|0)*3|0,v=we(7,0,g|0)|0,y=A&~(j()|0),A=he(c|0,A|0,g|0)|0,j()|0,A=we(Is(A&7)|0,0,g|0)|0,c=c&~v|A,A=y|(j()|0),f>>>0<d>>>0)f=f+1|0;else{f=1;break}}while(0);if(w>>>0<C>>>0)w=w+1|0;else break}return De(A|0),c|0}function mp(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0;if(d=he(c|0,A|0,52)|0,j()|0,d=d&15,!d)return f=A,d=c,De(f|0),d|0;for(f=1;y=(15-f|0)*3|0,v=we(7,0,y|0)|0,g=A&~(j()|0),A=he(c|0,A|0,y|0)|0,j()|0,A=we(Is(A&7)|0,0,y|0)|0,c=A|c&~v,A=j()|0|g,f>>>0<d>>>0;)f=f+1|0;return De(A|0),c|0}function AR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0;if(C=U,U=U+64|0,w=C+40|0,d=C+24|0,g=C+12|0,v=C,we(A|0,0,52)|0,f=j()|0|134225919,!A)return(u[c+4>>2]|0)>2||(u[c+8>>2]|0)>2||(u[c+12>>2]|0)>2?(y=0,w=0,De(y|0),U=C,w|0):(we(Sr(c)|0,0,45)|0,y=j()|0|f,w=-1,De(y|0),U=C,w|0);if(u[w>>2]=u[c>>2],u[w+4>>2]=u[c+4>>2],u[w+8>>2]=u[c+8>>2],u[w+12>>2]=u[c+12>>2],y=w+4|0,(A|0)>0)for(c=-1;u[d>>2]=u[y>>2],u[d+4>>2]=u[y+4>>2],u[d+8>>2]=u[y+8>>2],A&1?(Z_(y),u[g>>2]=u[y>>2],u[g+4>>2]=u[y+4>>2],u[g+8>>2]=u[y+8>>2],ef(g)):(hp(y),u[g>>2]=u[y>>2],u[g+4>>2]=u[y+4>>2],u[g+8>>2]=u[y+8>>2],So(g)),fp(d,g,v),Wn(v),L=(15-A|0)*3|0,B=we(7,0,L|0)|0,f=f&~(j()|0),L=we(qu(v)|0,0,L|0)|0,c=L|c&~B,f=j()|0|f,(A|0)>1;)A=A+-1|0;else c=-1;e:do if((u[y>>2]|0)<=2&&(u[w+8>>2]|0)<=2&&(u[w+12>>2]|0)<=2){if(d=Sr(w)|0,A=we(d|0,0,45)|0,A=A|c,c=j()|0|f&-1040385,v=xL(w)|0,!(Je(d)|0)){if((v|0)<=0)break;for(g=0;;){if(d=he(A|0,c|0,52)|0,j()|0,d=d&15,d)for(f=1;L=(15-f|0)*3|0,w=he(A|0,c|0,L|0)|0,j()|0,B=we(7,0,L|0)|0,c=c&~(j()|0),L=we(Po(w&7)|0,0,L|0)|0,A=A&~B|L,c=c|(j()|0),f>>>0<d>>>0;)f=f+1|0;if(g=g+1|0,(g|0)==(v|0))break e}}g=he(A|0,c|0,52)|0,j()|0,g=g&15;t:do if(g){f=1;n:for(;;){switch(L=he(A|0,c|0,(15-f|0)*3|0)|0,j()|0,L&7){case 1:break n;case 0:break;default:break t}if(f>>>0<g>>>0)f=f+1|0;else break t}if(X_(d,u[w>>2]|0)|0)for(f=1;w=(15-f|0)*3|0,B=we(7,0,w|0)|0,L=c&~(j()|0),c=he(A|0,c|0,w|0)|0,j()|0,c=we(Is(c&7)|0,0,w|0)|0,A=A&~B|c,c=L|(j()|0),f>>>0<g>>>0;)f=f+1|0;else for(f=1;L=(15-f|0)*3|0,w=he(A|0,c|0,L|0)|0,j()|0,B=we(7,0,L|0)|0,c=c&~(j()|0),L=we(Po(w&7)|0,0,L|0)|0,A=A&~B|L,c=c|(j()|0),f>>>0<g>>>0;)f=f+1|0}while(0);if((v|0)>0){f=0;do A=gp(A,c)|0,c=j()|0,f=f+1|0;while((f|0)!=(v|0))}}else A=0,c=0;while(0);return B=c,L=A,De(B|0),U=C,L|0}function Jr(c){return c=c|0,(c|0)%2|0|0}function A2(c,A){c=c|0,A=A|0;var f=0,d=0;return d=U,U=U+16|0,f=d,A>>>0<=15&&(u[c+4>>2]&2146435072|0)!=2146435072&&(u[c+8+4>>2]&2146435072|0)!=2146435072?(DL(c,A,f),A=AR(f,A)|0,c=j()|0):(c=0,A=0),De(c|0),U=d,A|0}function yp(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0;if(g=f+4|0,v=he(c|0,A|0,52)|0,j()|0,v=v&15,y=he(c|0,A|0,45)|0,j()|0,d=(v|0)==0,Je(y&127)|0){if(d)return y=1,y|0;d=1}else{if(d)return y=0,y|0;(u[g>>2]|0)==0&&(u[f+8>>2]|0)==0?d=(u[f+12>>2]|0)!=0&1:d=1}for(f=1;f&1?ef(g):So(g),y=he(c|0,A|0,(15-f|0)*3|0)|0,j()|0,q_(g,y&7),f>>>0<v>>>0;)f=f+1|0;return d|0}function wc(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0;L=U,U=U+16|0,C=L,B=he(c|0,A|0,45)|0,j()|0,B=B&127;e:do if((Je(B)|0)!=0&&(v=he(c|0,A|0,52)|0,j()|0,v=v&15,(v|0)!=0)){d=1;t:for(;;){switch(w=he(c|0,A|0,(15-d|0)*3|0)|0,j()|0,w&7){case 5:break t;case 0:break;default:{d=A;break e}}if(d>>>0<v>>>0)d=d+1|0;else{d=A;break e}}for(g=1,d=A;A=(15-g|0)*3|0,y=we(7,0,A|0)|0,w=d&~(j()|0),d=he(c|0,d|0,A|0)|0,j()|0,d=we(Is(d&7)|0,0,A|0)|0,c=c&~y|d,d=w|(j()|0),g>>>0<v>>>0;)g=g+1|0}else d=A;while(0);if(w=7728+(B*28|0)|0,u[f>>2]=u[w>>2],u[f+4>>2]=u[w+4>>2],u[f+8>>2]=u[w+8>>2],u[f+12>>2]=u[w+12>>2],!(yp(c,d,f)|0)){U=L;return}if(y=f+4|0,u[C>>2]=u[y>>2],u[C+4>>2]=u[y+4>>2],u[C+8>>2]=u[y+8>>2],v=he(c|0,d|0,52)|0,j()|0,w=v&15,v&1?(So(y),v=w+1|0):v=w,!(Je(B)|0))d=0;else{e:do if(!w)d=0;else for(A=1;;){if(g=he(c|0,d|0,(15-A|0)*3|0)|0,j()|0,g=g&7,g|0){d=g;break e}if(A>>>0<w>>>0)A=A+1|0;else{d=0;break}}while(0);d=(d|0)==4&1}if(!(Ca(f,v,d,0)|0))(v|0)!=(w|0)&&(u[y>>2]=u[C>>2],u[y+4>>2]=u[C+4>>2],u[y+8>>2]=u[C+8>>2]);else{if(Je(B)|0)do;while((Ca(f,v,0,0)|0)!=0);(v|0)!=(w|0)&&hp(y)}U=L}function Mo(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0;d=U,U=U+16|0,g=d,wc(c,A,g),A=he(c|0,A|0,52)|0,j()|0,NL(g,A&15,f),U=d}function Io(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0;y=U,U=U+16|0,v=y,wc(c,A,v),d=he(c|0,A|0,45)|0,j()|0,d=(Je(d&127)|0)==0,g=he(c|0,A|0,52)|0,j()|0,g=g&15;e:do if(!d){if(g|0)for(d=1;;){if(w=we(7,0,(15-d|0)*3|0)|0,!((w&c|0)==0&((j()|0)&A|0)==0))break e;if(d>>>0<g>>>0)d=d+1|0;else break}i2(v,g,0,5,f),U=y;return}while(0);o2(v,g,0,6,f),U=y}function uR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0;if(d=he(c|0,A|0,45)|0,j()|0,!(Je(d&127)|0))return d=2,d|0;if(d=he(c|0,A|0,52)|0,j()|0,d=d&15,!d)return d=5,d|0;for(f=1;;){if(g=we(7,0,(15-f|0)*3|0)|0,!((g&c|0)==0&((j()|0)&A|0)==0)){f=2,c=6;break}if(f>>>0<d>>>0)f=f+1|0;else{f=5,c=6;break}}return(c|0)==6?f|0:0}function u2(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0;V=U,U=U+128|0,B=V+112|0,v=V+96|0,L=V,g=he(c|0,A|0,52)|0,j()|0,w=g&15,u[B>>2]=w,y=he(c|0,A|0,45)|0,j()|0,y=y&127;e:do if(Je(y)|0){if(w|0)for(d=1;;){if(C=we(7,0,(15-d|0)*3|0)|0,!((C&c|0)==0&((j()|0)&A|0)==0)){g=0;break e}if(d>>>0<w>>>0)d=d+1|0;else break}if(g&1)g=1;else{C=we(w+1|0,0,52)|0,L=j()|0|A&-15728641,B=we(7,0,(14-w|0)*3|0)|0,u2((C|c)&~B,L&~(j()|0),f),U=V;return}}else g=0;while(0);wc(c,A,v),g?(s2(v,B,L),C=5):(a2(v,B,L),C=6);e:do if(Je(y)|0)if(!w)d=20;else for(d=1;;){if(y=we(7,0,(15-d|0)*3|0)|0,!((y&c|0)==0&((j()|0)&A|0)==0)){d=8;break e}if(d>>>0<w>>>0)d=d+1|0;else{d=20;break}}else d=8;while(0);if(mi(f|0,-1,d|0)|0,g){g=0;do{for(v=L+(g<<4)|0,UL(v,u[B>>2]|0)|0,v=u[v>>2]|0,d=0;y=f+(d<<2)|0,w=u[y>>2]|0,!((w|0)==-1|(w|0)==(v|0));)d=d+1|0;u[y>>2]=v,g=g+1|0}while((g|0)!=(C|0))}else{g=0;do{for(v=L+(g<<4)|0,Ca(v,u[B>>2]|0,0,1)|0,v=u[v>>2]|0,d=0;y=f+(d<<2)|0,w=u[y>>2]|0,!((w|0)==-1|(w|0)==(v|0));)d=d+1|0;u[y>>2]=v,g=g+1|0}while((g|0)!=(C|0))}U=V}function fR(){return 12}function vp(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0;if(we(c|0,0,52)|0,w=j()|0|134225919,(c|0)<1){d=0,f=0;do Je(d)|0&&(we(d|0,0,45)|0,y=w|(j()|0),c=A+(f<<3)|0,u[c>>2]=-1,u[c+4>>2]=y,f=f+1|0),d=d+1|0;while((d|0)!=122);return}y=0,f=0;do{if(Je(y)|0){for(we(y|0,0,45)|0,d=1,g=-1,v=w|(j()|0);C=we(7,0,(15-d|0)*3|0)|0,g=g&~C,v=v&~(j()|0),(d|0)!=(c|0);)d=d+1|0;C=A+(f<<3)|0,u[C>>2]=g,u[C+4>>2]=v,f=f+1|0}y=y+1|0}while((y|0)!=122)}function f2(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0,w=0,C=0,B=0;if(w=U,U=U+64|0,y=w,(c|0)==(f|0)&(A|0)==(d|0)|(!1|(A&2013265920|0)!=134217728|(!1|(d&2013265920|0)!=134217728))||(g=he(c|0,A|0,52)|0,j()|0,g=g&15,v=he(f|0,d|0,52)|0,j()|0,(g|0)!=(v&15|0)))return y=0,U=w,y|0;if(v=g+-1|0,g>>>0>1&&(B=pp(c,A,v)|0,C=j()|0,v=pp(f,d,v)|0,(B|0)==(v|0)&(C|0)==(j()|0))&&(v=(g^15)*3|0,g=he(c|0,A|0,v|0)|0,j()|0,g=g&7,v=he(f|0,d|0,v|0)|0,j()|0,v=v&7,(g|0)==0|(v|0)==0||(u[21136+(g<<2)>>2]|0)==(v|0)||(u[21168+(g<<2)>>2]|0)==(v|0)))return B=1,U=w,B|0;g=y,v=g+56|0;do u[g>>2]=0,g=g+4|0;while((g|0)<(v|0));return xa(c,A,1,y),B=y,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0))&&(B=y+8|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))&&(B=y+16|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))&&(B=y+24|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))&&(B=y+32|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))&&(B=y+40|0,!((u[B>>2]|0)==(f|0)&&(u[B+4>>2]|0)==(d|0)))?(g=y+48|0,g=((u[g>>2]|0)==(f|0)?(u[g+4>>2]|0)==(d|0):0)&1):g=1,B=g,U=w,B|0}function hR(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0,w=0,C=0,B=0,L=0;if(B=U,U=U+16|0,y=B,!(f2(c,A,f,d)|0))return w=0,C=0,De(w|0),U=B,C|0;for(w=A&-2130706433,g=(_n(c,A)|0)==0,g=g?1:2;u[y>>2]=0,L=R(c,A,g,y)|0,v=g+1|0,!((L|0)==(f|0)&(j()|0)==(d|0));)if(v>>>0<7)g=v;else{g=0,c=0,C=6;break}return(C|0)==6?(De(g|0),U=B,c|0):(L=we(g|0,0,56)|0,C=w|(j()|0)|268435456,L=c|L,De(C|0),U=B,L|0)}function dR(c,A){c=c|0,A=A|0;var f=0;return f=!0&(A&2013265920|0)==268435456,De((f?A&-2130706433|134217728:0)|0),(f?c:0)|0}function pR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0;return d=U,U=U+16|0,f=d,!0&(A&2013265920|0)==268435456?(g=he(c|0,A|0,56)|0,j()|0,u[f>>2]=0,f=R(c,A&-2130706433|134217728,g&7,f)|0,A=j()|0,De(A|0),U=d,f|0):(A=0,f=0,De(A|0),U=d,f|0)}function gR(c,A){c=c|0,A=A|0;var f=0;if(!(!0&(A&2013265920|0)==268435456))return f=0,f|0;switch(f=he(c|0,A|0,56)|0,j()|0,f&7){case 0:case 7:return f=0,f|0}return f=A&-2130706433|134217728,!0&(A&117440512|0)==16777216&(_n(c,f)|0)!=0?(f=0,f|0):(f=c2(c,f)|0,f|0)}function mR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0;v=U,U=U+16|0,d=v,y=!0&(A&2013265920|0)==268435456,g=A&-2130706433|134217728,w=f,u[w>>2]=y?c:0,u[w+4>>2]=y?g:0,y?(A=he(c|0,A|0,56)|0,j()|0,u[d>>2]=0,c=R(c,g,A&7,d)|0,A=j()|0):(c=0,A=0),w=f+8|0,u[w>>2]=c,u[w+4>>2]=A,U=v}function yR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0;g=(_n(c,A)|0)==0,A=A&-2130706433,d=f,u[d>>2]=g?c:0,u[d+4>>2]=g?A|285212672:0,d=f+8|0,u[d>>2]=c,u[d+4>>2]=A|301989888,d=f+16|0,u[d>>2]=c,u[d+4>>2]=A|318767104,d=f+24|0,u[d>>2]=c,u[d+4>>2]=A|335544320,d=f+32|0,u[d>>2]=c,u[d+4>>2]=A|352321536,f=f+40|0,u[f>>2]=c,u[f+4>>2]=A|369098752}function nf(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0;if(y=U,U=U+16|0,v=y,d=he(c|0,A|0,56)|0,j()|0,w=!0&(A&2013265920|0)==268435456,g=w?c:0,c=w?A&-2130706433|134217728:0,A=UR(g,c,d&7)|0,(A|0)==-1){u[f>>2]=0,U=y;return}wc(g,c,v),d=he(g|0,c|0,52)|0,j()|0,d=d&15,_n(g,c)|0?i2(v,d,A,2,f):o2(v,d,A,2,f),U=y}function vR(c){c=c|0;var A=0,f=0,d=0;return A=gi(1,12)|0,A||dt(22691,22646,49,22704),f=c+4|0,d=u[f>>2]|0,d|0?(d=d+8|0,u[d>>2]=A,u[f>>2]=A,A|0):(u[c>>2]|0&&dt(22721,22646,61,22744),d=c,u[d>>2]=A,u[f>>2]=A,A|0)}function _R(c,A){c=c|0,A=A|0;var f=0,d=0;return d=ki(24)|0,d||dt(22758,22646,78,22772),u[d>>2]=u[A>>2],u[d+4>>2]=u[A+4>>2],u[d+8>>2]=u[A+8>>2],u[d+12>>2]=u[A+12>>2],u[d+16>>2]=0,A=c+4|0,f=u[A>>2]|0,f|0?(u[f+16>>2]=d,u[A>>2]=d,d|0):(u[c>>2]|0&&dt(22787,22646,82,22772),u[c>>2]=d,u[A>>2]=d,d|0)}function ER(c){c=c|0;var A=0,f=0,d=0,g=0;if(!!c)for(d=1;;){if(A=u[c>>2]|0,A|0)do{if(f=u[A>>2]|0,f|0)do g=f,f=u[f+16>>2]|0,Ke(g);while((f|0)!=0);g=A,A=u[A+8>>2]|0,Ke(g)}while((A|0)!=0);if(A=c,c=u[c+8>>2]|0,d||Ke(A),c)d=0;else break}}function h2(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0,Ee=0,Qe=0,bt=0,yt=0,It=0,pt=0,Ot=0,Ft=0,He=0;if(g=c+8|0,u[g>>2]|0)return He=1,He|0;if(d=u[c>>2]|0,!d)return He=0,He|0;A=d,f=0;do f=f+1|0,A=u[A+8>>2]|0;while((A|0)!=0);if(f>>>0<2)return He=0,He|0;Ot=ki(f<<2)|0,Ot||dt(22807,22646,317,22826),pt=ki(f<<5)|0,pt||dt(22848,22646,321,22826),u[c>>2]=0,Ie=c+4|0,u[Ie>>2]=0,u[g>>2]=0,f=0,It=0,be=0,V=0;e:for(;;){if(L=u[d>>2]|0,L){v=0,y=L;do{if(C=+G[y+8>>3],A=y,y=u[y+16>>2]|0,B=(y|0)==0,g=B?L:y,w=+G[g+8>>3],+Ze(+(C-w))>3.141592653589793){He=14;break}v=v+(w-C)*(+G[A>>3]+ +G[g>>3])}while(!B);if((He|0)==14){He=0,v=0,A=L;do $=+G[A+8>>3],yt=A+16|0,bt=u[yt>>2]|0,bt=(bt|0)==0?L:bt,Ae=+G[bt+8>>3],v=v+(+G[A>>3]+ +G[bt>>3])*((Ae<0?Ae+6.283185307179586:Ae)-($<0?$+6.283185307179586:$)),A=u[((A|0)==0?d:yt)>>2]|0;while((A|0)!=0)}v>0?(u[Ot+(It<<2)>>2]=d,It=It+1|0,g=be,A=V):He=19}else He=19;if((He|0)==19){He=0;do if(f){if(A=f+8|0,u[A>>2]|0){He=21;break e}if(f=gi(1,12)|0,!f){He=23;break e}u[A>>2]=f,g=f+4|0,y=f,A=V}else if(V){g=Ie,y=V+8|0,A=d,f=c;break}else if(u[c>>2]|0){He=27;break e}else{g=Ie,y=c,A=d,f=c;break}while(0);if(u[y>>2]=d,u[g>>2]=d,y=pt+(be<<5)|0,B=u[d>>2]|0,B){for(L=pt+(be<<5)+8|0,G[L>>3]=17976931348623157e292,V=pt+(be<<5)+24|0,G[V>>3]=17976931348623157e292,G[y>>3]=-17976931348623157e292,W=pt+(be<<5)+16|0,G[W>>3]=-17976931348623157e292,Te=17976931348623157e292,te=-17976931348623157e292,g=0,Y=B,C=17976931348623157e292,ie=17976931348623157e292,de=-17976931348623157e292,w=-17976931348623157e292;v=+G[Y>>3],$=+G[Y+8>>3],Y=u[Y+16>>2]|0,re=(Y|0)==0,Ae=+G[(re?B:Y)+8>>3],v<C&&(G[L>>3]=v,C=v),$<ie&&(G[V>>3]=$,ie=$),v>de?G[y>>3]=v:v=de,$>w&&(G[W>>3]=$,w=$),Te=$>0&$<Te?$:Te,te=$<0&$>te?$:te,g=g|+Ze(+($-Ae))>3.141592653589793,!re;)de=v;g&&(G[W>>3]=te,G[V>>3]=Te)}else u[y>>2]=0,u[y+4>>2]=0,u[y+8>>2]=0,u[y+12>>2]=0,u[y+16>>2]=0,u[y+20>>2]=0,u[y+24>>2]=0,u[y+28>>2]=0;g=be+1|0}if(yt=d+8|0,d=u[yt>>2]|0,u[yt>>2]=0,d)be=g,V=A;else{He=45;break}}if((He|0)==21)dt(22624,22646,35,22658);else if((He|0)==23)dt(22678,22646,37,22658);else if((He|0)==27)dt(22721,22646,61,22744);else if((He|0)==45){e:do if((It|0)>0){for(yt=(g|0)==0,Qe=g<<2,bt=(c|0)==0,Ee=0,A=0;;){if(ye=u[Ot+(Ee<<2)>>2]|0,yt)He=73;else{if(be=ki(Qe)|0,!be){He=50;break}if(Ie=ki(Qe)|0,!Ie){He=52;break}t:do if(bt)f=0;else{for(g=0,f=0,y=c;d=pt+(g<<5)|0,d2(u[y>>2]|0,d,u[ye>>2]|0)|0?(u[be+(f<<2)>>2]=y,u[Ie+(f<<2)>>2]=d,re=f+1|0):re=f,y=u[y+8>>2]|0,y;)g=g+1|0,f=re;if((re|0)>0)if(d=u[be>>2]|0,(re|0)==1)f=d;else for(W=0,Y=-1,f=d,V=d;;){for(B=u[V>>2]|0,d=0,y=0;g=u[u[be+(y<<2)>>2]>>2]|0,(g|0)==(B|0)?L=d:L=d+((d2(g,u[Ie+(y<<2)>>2]|0,u[B>>2]|0)|0)&1)|0,y=y+1|0,(y|0)!=(re|0);)d=L;if(g=(L|0)>(Y|0),f=g?V:f,d=W+1|0,(d|0)==(re|0))break t;W=d,Y=g?L:Y,V=u[be+(d<<2)>>2]|0}else f=0}while(0);if(Ke(be),Ke(Ie),f){if(g=f+4|0,d=u[g>>2]|0,d)f=d+8|0;else if(u[f>>2]|0){He=70;break}u[f>>2]=ye,u[g>>2]=ye}else He=73}if((He|0)==73){if(He=0,A=u[ye>>2]|0,A|0)do Ie=A,A=u[A+16>>2]|0,Ke(Ie);while((A|0)!=0);Ke(ye),A=2}if(Ee=Ee+1|0,(Ee|0)>=(It|0)){Ft=A;break e}}(He|0)==50?dt(22863,22646,249,22882):(He|0)==52?dt(22901,22646,252,22882):(He|0)==70&&dt(22721,22646,61,22744)}else Ft=0;while(0);return Ke(Ot),Ke(pt),He=Ft,He|0}return 0}function d2(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0;if(!(J_(A,f)|0)||(A=Y_(A)|0,B=+G[f>>3],d=+G[f+8>>3],d=A&d<0?d+6.283185307179586:d,c=u[c>>2]|0,!c))return c=0,c|0;if(A){A=0,f=c;e:for(;;){for(;y=+G[f>>3],C=+G[f+8>>3],f=f+16|0,L=u[f>>2]|0,L=(L|0)==0?c:L,v=+G[L>>3],g=+G[L+8>>3],y>v?(w=y,y=C):(w=v,v=y,y=g,g=C),!!(B<v|B>w);)if(f=u[f>>2]|0,!f){f=22;break e}if(C=g<0?g+6.283185307179586:g,y=y<0?y+6.283185307179586:y,d=y==d|C==d?d+-2220446049250313e-31:d,C=C+(B-v)/(w-v)*(y-C),(C<0?C+6.283185307179586:C)>d&&(A=A^1),f=u[f>>2]|0,!f){f=22;break}}if((f|0)==22)return A|0}else{A=0,f=c;e:for(;;){for(;y=+G[f>>3],C=+G[f+8>>3],f=f+16|0,L=u[f>>2]|0,L=(L|0)==0?c:L,v=+G[L>>3],g=+G[L+8>>3],y>v?(w=y,y=C):(w=v,v=y,y=g,g=C),!!(B<v|B>w);)if(f=u[f>>2]|0,!f){f=22;break e}if(d=y==d|g==d?d+-2220446049250313e-31:d,g+(B-v)/(w-v)*(y-g)>d&&(A=A^1),f=u[f>>2]|0,!f){f=22;break}}if((f|0)==22)return A|0}return 0}function rs(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0;if(te=U,U=U+32|0,Te=te+16|0,de=te,v=he(c|0,A|0,52)|0,j()|0,v=v&15,Y=he(f|0,d|0,52)|0,j()|0,(v|0)!=(Y&15|0))return Te=1,U=te,Te|0;if(B=he(c|0,A|0,45)|0,j()|0,B=B&127,L=he(f|0,d|0,45)|0,j()|0,L=L&127,Y=(B|0)!=(L|0),Y){if(w=Ap(B,L)|0,(w|0)==7)return Te=2,U=te,Te|0;C=Ap(L,B)|0,(C|0)==7?dt(22925,22949,151,22959):(re=w,y=C)}else re=0,y=0;V=Je(B)|0,W=Je(L)|0,u[Te>>2]=0,u[Te+4>>2]=0,u[Te+8>>2]=0,u[Te+12>>2]=0;do if(re){if(L=u[4304+(B*28|0)+(re<<2)>>2]|0,w=(L|0)>0,W)if(w){B=0,C=f,w=d;do C=cR(C,w)|0,w=j()|0,y=Is(y)|0,(y|0)==1&&(y=Is(1)|0),B=B+1|0;while((B|0)!=(L|0));L=y,B=C,C=w}else L=y,B=f,C=d;else if(w){B=0,C=f,w=d;do C=mp(C,w)|0,w=j()|0,y=Is(y)|0,B=B+1|0;while((B|0)!=(L|0));L=y,B=C,C=w}else L=y,B=f,C=d;if(yp(B,C,Te)|0,Y||dt(22972,22949,181,22959),w=(V|0)!=0,y=(W|0)!=0,w&y&&dt(22999,22949,182,22959),w){if(y=dr(c,A)|0,Ge[22032+(y*7|0)+re>>0]|0){v=3;break}C=u[21200+(y*28|0)+(re<<2)>>2]|0,B=C,ie=26}else if(y){if(y=dr(B,C)|0,Ge[22032+(y*7|0)+L>>0]|0){v=4;break}B=0,C=u[21200+(L*28|0)+(y<<2)>>2]|0,ie=26}else y=0;if((ie|0)==26)if((C|0)<=-1&&dt(23030,22949,212,22959),(B|0)<=-1&&dt(23053,22949,213,22959),(C|0)>0){w=Te+4|0,y=0;do tf(w),y=y+1|0;while((y|0)!=(C|0));y=B}else y=B;if(u[de>>2]=0,u[de+4>>2]=0,u[de+8>>2]=0,q_(de,re),v|0)for(;Jr(v)|0?ef(de):So(de),(v|0)>1;)v=v+-1|0;if((y|0)>0){v=0;do tf(de),v=v+1|0;while((v|0)!=(y|0))}ie=Te+4|0,or(ie,de,ie),Wn(ie),ie=50}else if(yp(f,d,Te)|0,(V|0)!=0&(W|0)!=0)if((L|0)!=(B|0)&&dt(23077,22949,243,22959),y=dr(c,A)|0,v=dr(f,d)|0,Ge[22032+(y*7|0)+v>>0]|0)v=5;else if(y=u[21200+(y*28|0)+(v<<2)>>2]|0,(y|0)>0){w=Te+4|0,v=0;do tf(w),v=v+1|0;while((v|0)!=(y|0));ie=50}else ie=50;else ie=50;while(0);return(ie|0)==50&&(v=Te+4|0,u[g>>2]=u[v>>2],u[g+4>>2]=u[v+4>>2],u[g+8>>2]=u[v+8>>2],v=0),Te=v,U=te,Te|0}function p2(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0;if(re=U,U=U+48|0,y=re+36|0,w=re+24|0,C=re+12|0,B=re,v=he(c|0,A|0,52)|0,j()|0,v=v&15,W=he(c|0,A|0,45)|0,j()|0,W=W&127,L=Je(W)|0,we(v|0,0,52)|0,de=j()|0|134225919,ie=d,u[ie>>2]=-1,u[ie+4>>2]=de,!v)return(u[f>>2]|0)>1||(u[f+4>>2]|0)>1||(u[f+8>>2]|0)>1||(g=cp(W,qu(f)|0)|0,(g|0)==127)?(de=1,U=re,de|0):(Y=we(g|0,0,45)|0,ie=j()|0,W=d,ie=u[W+4>>2]&-1040385|ie,de=d,u[de>>2]=u[W>>2]|Y,u[de+4>>2]=ie,de=0,U=re,de|0);for(u[y>>2]=u[f>>2],u[y+4>>2]=u[f+4>>2],u[y+8>>2]=u[f+8>>2];u[w>>2]=u[y>>2],u[w+4>>2]=u[y+4>>2],u[w+8>>2]=u[y+8>>2],Jr(v)|0?(Z_(y),u[C>>2]=u[y>>2],u[C+4>>2]=u[y+4>>2],u[C+8>>2]=u[y+8>>2],ef(C)):(hp(y),u[C>>2]=u[y>>2],u[C+4>>2]=u[y+4>>2],u[C+8>>2]=u[y+8>>2],So(C)),fp(w,C,B),Wn(B),ie=d,Te=u[ie>>2]|0,ie=u[ie+4>>2]|0,te=(15-v|0)*3|0,f=we(7,0,te|0)|0,ie=ie&~(j()|0),te=we(qu(B)|0,0,te|0)|0,ie=j()|0|ie,de=d,u[de>>2]=te|Te&~f,u[de+4>>2]=ie,(v|0)>1;)v=v+-1|0;e:do if((u[y>>2]|0)<=1&&(u[y+4>>2]|0)<=1&&(u[y+8>>2]|0)<=1){v=qu(y)|0,w=cp(W,v)|0,(w|0)==127?B=0:B=Je(w)|0;t:do if(v){if(L){if(y=21408+((dr(c,A)|0)*28|0)+(v<<2)|0,y=u[y>>2]|0,(y|0)>0){f=0;do v=Po(v)|0,f=f+1|0;while((f|0)!=(y|0))}if((v|0)==1){g=3;break e}f=cp(W,v)|0,(f|0)==127&&dt(23104,22949,376,23134),Je(f)|0?dt(23147,22949,377,23134):(Y=y,V=v,g=f)}else Y=0,V=v,g=w;if(C=u[4304+(W*28|0)+(V<<2)>>2]|0,(C|0)<=-1&&dt(23178,22949,384,23134),!B){if((Y|0)<=-1&&dt(23030,22949,417,23134),Y|0){y=d,v=0,f=u[y>>2]|0,y=u[y+4>>2]|0;do f=Bs(f,y)|0,y=j()|0,te=d,u[te>>2]=f,u[te+4>>2]=y,v=v+1|0;while((v|0)<(Y|0))}if((C|0)<=0){v=54;break}for(y=d,v=0,f=u[y>>2]|0,y=u[y+4>>2]|0;;)if(f=Bs(f,y)|0,y=j()|0,te=d,u[te>>2]=f,u[te+4>>2]=y,v=v+1|0,(v|0)==(C|0)){v=54;break t}}if(w=Ap(g,W)|0,(w|0)==7&&dt(22925,22949,393,23134),v=d,f=u[v>>2]|0,v=u[v+4>>2]|0,(C|0)>0){y=0;do f=Bs(f,v)|0,v=j()|0,te=d,u[te>>2]=f,u[te+4>>2]=v,y=y+1|0;while((y|0)!=(C|0))}if(f=dr(f,v)|0,te=vn(g)|0,f=u[(te?21824:21616)+(w*28|0)+(f<<2)>>2]|0,(f|0)<=-1&&dt(23030,22949,412,23134),!f)v=54;else{w=d,v=0,y=u[w>>2]|0,w=u[w+4>>2]|0;do y=gp(y,w)|0,w=j()|0,te=d,u[te>>2]=y,u[te+4>>2]=w,v=v+1|0;while((v|0)<(f|0));v=54}}else if((L|0)!=0&(B|0)!=0)if(te=dr(c,A)|0,v=d,v=21408+(te*28|0)+((dr(u[v>>2]|0,u[v+4>>2]|0)|0)<<2)|0,v=u[v>>2]|0,(v|0)<=-1&&dt(23201,22949,433,23134),!v)g=w,v=55;else{y=d,g=0,f=u[y>>2]|0,y=u[y+4>>2]|0;do f=Bs(f,y)|0,y=j()|0,te=d,u[te>>2]=f,u[te+4>>2]=y,g=g+1|0;while((g|0)<(v|0));g=w,v=54}else g=w,v=54;while(0);if((v|0)==54&&B&&(v=55),(v|0)==55&&(te=d,(dr(u[te>>2]|0,u[te+4>>2]|0)|0)==1)){g=4;break}te=d,de=u[te>>2]|0,te=u[te+4>>2]&-1040385,Te=we(g|0,0,45)|0,te=te|(j()|0),g=d,u[g>>2]=de|Te,u[g+4>>2]=te,g=0}else g=2;while(0);return te=g,U=re,te|0}function wR(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0;return y=U,U=U+16|0,v=y,c=rs(c,A,f,d,v)|0,c||(RL(v,g),c=0),U=y,c|0}function TR(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0;return g=U,U=U+16|0,v=g,OL(f,v),d=p2(c,A,v,d)|0,U=g,d|0}function bR(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0;return y=U,U=U+32|0,g=y+12|0,v=y,(rs(c,A,c,A,g)|0)==0&&(rs(c,A,f,d,v)|0)==0?c=dp(g,v)|0:c=-1,U=y,c|0}function xR(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0,y=0;return y=U,U=U+32|0,g=y+12|0,v=y,(rs(c,A,c,A,g)|0)==0&&(rs(c,A,f,d,v)|0)==0?c=dp(g,v)|0:c=-1,U=y,(c>>>31^1)+c|0}function CR(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0;if(be=U,U=U+48|0,v=be+24|0,y=be+12|0,$=be,(rs(c,A,c,A,v)|0)==0&&(rs(c,A,f,d,y)|0)==0){if(Ae=dp(v,y)|0,(Ae|0)<0)return $=Ae,U=be,$|0;for(u[v>>2]=0,u[v+4>>2]=0,u[v+8>>2]=0,u[y>>2]=0,u[y+4>>2]=0,u[y+8>>2]=0,rs(c,A,c,A,v)|0,rs(c,A,f,d,y)|0,r2(v),r2(y),Ae?(L=u[v>>2]|0,Y=+(Ae|0),de=v+4|0,V=u[de>>2]|0,Te=v+8|0,W=u[Te>>2]|0,te=v,f=L,d=V,v=W,re=+((u[y>>2]|0)-L|0)/Y,ie=+((u[y+4>>2]|0)-V|0)/Y,Y=+((u[y+8>>2]|0)-W|0)/Y):(d=v+4|0,W=v+8|0,de=d,Te=W,te=v,f=u[v>>2]|0,d=u[d>>2]|0,v=u[W>>2]|0,re=0,ie=0,Y=0),u[$>>2]=f,W=$+4|0,u[W>>2]=d,V=$+8|0,u[V>>2]=v,L=0;;){C=+(L|0),Ie=re*C+ +(f|0),w=ie*C+ +(u[de>>2]|0),C=Y*C+ +(u[Te>>2]|0),d=~~+of(+Ie),y=~~+of(+w),f=~~+of(+C),Ie=+Ze(+(+(d|0)-Ie)),w=+Ze(+(+(y|0)-w)),C=+Ze(+(+(f|0)-C));do if(Ie>w&Ie>C)d=0-(y+f)|0,v=y;else if(B=0-d|0,w>C){v=B-f|0;break}else{v=y,f=B-y|0;break}while(0);if(u[$>>2]=d,u[W>>2]=v,u[V>>2]=f,FL($),p2(c,A,$,g+(L<<3)|0)|0,(L|0)==(Ae|0))break;L=L+1|0,f=u[te>>2]|0}return $=0,U=be,$|0}return $=-1,U=be,$|0}function rf(c,A){c=c|0,A=A|0;var f=0;if(!A)return f=1,f|0;f=c,c=1;do c=Bn((A&1|0)==0?1:f,c)|0,A=A>>1,f=Bn(f,f)|0;while((A|0)!=0);return c|0}function g2(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0;if(!(J_(A,f)|0)||(A=Y_(A)|0,W=+G[f>>3],d=+G[f+8>>3],d=A&d<0?d+6.283185307179586:d,V=u[c>>2]|0,(V|0)<=0))return V=0,V|0;if(L=u[c+4>>2]|0,A){A=0,f=-1,c=0;e:for(;;){for(B=c;y=+G[L+(B<<4)>>3],C=+G[L+(B<<4)+8>>3],c=(f+2|0)%(V|0)|0,v=+G[L+(c<<4)>>3],g=+G[L+(c<<4)+8>>3],y>v?(w=y,y=C):(w=v,v=y,y=g,g=C),!!(W<v|W>w);)if(f=B+1|0,(f|0)<(V|0))c=B,B=f,f=c;else{f=22;break e}if(C=g<0?g+6.283185307179586:g,y=y<0?y+6.283185307179586:y,d=y==d|C==d?d+-2220446049250313e-31:d,C=C+(W-v)/(w-v)*(y-C),(C<0?C+6.283185307179586:C)>d&&(A=A^1),c=B+1|0,(c|0)>=(V|0)){f=22;break}else f=B}if((f|0)==22)return A|0}else{A=0,f=-1,c=0;e:for(;;){for(B=c;y=+G[L+(B<<4)>>3],C=+G[L+(B<<4)+8>>3],c=(f+2|0)%(V|0)|0,v=+G[L+(c<<4)>>3],g=+G[L+(c<<4)+8>>3],y>v?(w=y,y=C):(w=v,v=y,y=g,g=C),!!(W<v|W>w);)if(f=B+1|0,(f|0)<(V|0))c=B,B=f,f=c;else{f=22;break e}if(d=y==d|g==d?d+-2220446049250313e-31:d,g+(W-v)/(w-v)*(y-g)>d&&(A=A^1),c=B+1|0,(c|0)>=(V|0)){f=22;break}else f=B}if((f|0)==22)return A|0}return 0}function _p(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0;if(re=u[c>>2]|0,!re){u[A>>2]=0,u[A+4>>2]=0,u[A+8>>2]=0,u[A+12>>2]=0,u[A+16>>2]=0,u[A+20>>2]=0,u[A+24>>2]=0,u[A+28>>2]=0;return}if(ie=A+8|0,G[ie>>3]=17976931348623157e292,de=A+24|0,G[de>>3]=17976931348623157e292,G[A>>3]=-17976931348623157e292,Te=A+16|0,G[Te>>3]=-17976931348623157e292,!((re|0)<=0)){for(W=u[c+4>>2]|0,B=17976931348623157e292,L=-17976931348623157e292,V=0,c=-1,v=17976931348623157e292,y=17976931348623157e292,C=-17976931348623157e292,d=-17976931348623157e292,Y=0;f=+G[W+(Y<<4)>>3],w=+G[W+(Y<<4)+8>>3],c=c+2|0,g=+G[W+(((c|0)==(re|0)?0:c)<<4)+8>>3],f<v&&(G[ie>>3]=f,v=f),w<y&&(G[de>>3]=w,y=w),f>C?G[A>>3]=f:f=C,w>d&&(G[Te>>3]=w,d=w),B=w>0&w<B?w:B,L=w<0&w>L?w:L,V=V|+Ze(+(w-g))>3.141592653589793,c=Y+1|0,(c|0)!=(re|0);)te=Y,C=f,Y=c,c=te;!V||(G[Te>>3]=L,G[de>>3]=B)}}function SR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0,Ie=0,ye=0;if(re=u[c>>2]|0,re){if(ie=A+8|0,G[ie>>3]=17976931348623157e292,de=A+24|0,G[de>>3]=17976931348623157e292,G[A>>3]=-17976931348623157e292,Te=A+16|0,G[Te>>3]=-17976931348623157e292,(re|0)>0){for(g=u[c+4>>2]|0,W=17976931348623157e292,Y=-17976931348623157e292,d=0,f=-1,C=17976931348623157e292,B=17976931348623157e292,V=-17976931348623157e292,y=-17976931348623157e292,te=0;v=+G[g+(te<<4)>>3],L=+G[g+(te<<4)+8>>3],Ie=f+2|0,w=+G[g+(((Ie|0)==(re|0)?0:Ie)<<4)+8>>3],v<C&&(G[ie>>3]=v,C=v),L<B&&(G[de>>3]=L,B=L),v>V?G[A>>3]=v:v=V,L>y&&(G[Te>>3]=L,y=L),W=L>0&L<W?L:W,Y=L<0&L>Y?L:Y,d=d|+Ze(+(L-w))>3.141592653589793,f=te+1|0,(f|0)!=(re|0);)Ie=te,V=v,te=f,f=Ie;d&&(G[Te>>3]=Y,G[de>>3]=W)}}else u[A>>2]=0,u[A+4>>2]=0,u[A+8>>2]=0,u[A+12>>2]=0,u[A+16>>2]=0,u[A+20>>2]=0,u[A+24>>2]=0,u[A+28>>2]=0;if(Ie=c+8|0,f=u[Ie>>2]|0,!((f|0)<=0)){be=c+12|0,$=0;do if(g=u[be>>2]|0,d=$,$=$+1|0,de=A+($<<5)|0,Te=u[g+(d<<3)>>2]|0,Te){if(te=A+($<<5)+8|0,G[te>>3]=17976931348623157e292,c=A+($<<5)+24|0,G[c>>3]=17976931348623157e292,G[de>>3]=-17976931348623157e292,Ae=A+($<<5)+16|0,G[Ae>>3]=-17976931348623157e292,(Te|0)>0){for(re=u[g+(d<<3)+4>>2]|0,W=17976931348623157e292,Y=-17976931348623157e292,g=0,d=-1,ie=0,C=17976931348623157e292,B=17976931348623157e292,L=-17976931348623157e292,y=-17976931348623157e292;v=+G[re+(ie<<4)>>3],V=+G[re+(ie<<4)+8>>3],d=d+2|0,w=+G[re+(((d|0)==(Te|0)?0:d)<<4)+8>>3],v<C&&(G[te>>3]=v,C=v),V<B&&(G[c>>3]=V,B=V),v>L?G[de>>3]=v:v=L,V>y&&(G[Ae>>3]=V,y=V),W=V>0&V<W?V:W,Y=V<0&V>Y?V:Y,g=g|+Ze(+(V-w))>3.141592653589793,d=ie+1|0,(d|0)!=(Te|0);)ye=ie,ie=d,L=v,d=ye;g&&(G[Ae>>3]=Y,G[c>>3]=W)}}else u[de>>2]=0,u[de+4>>2]=0,u[de+8>>2]=0,u[de+12>>2]=0,u[de+16>>2]=0,u[de+20>>2]=0,u[de+24>>2]=0,u[de+28>>2]=0,f=u[Ie>>2]|0;while(($|0)<(f|0))}}function PR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0;if(!(g2(c,A,f)|0))return g=0,g|0;if(g=c+8|0,(u[g>>2]|0)<=0)return g=1,g|0;for(d=c+12|0,c=0;;){if(v=c,c=c+1|0,g2((u[d>>2]|0)+(v<<3)|0,A+(c<<5)|0,f)|0){c=0,d=6;break}if((c|0)>=(u[g>>2]|0)){c=1,d=6;break}}return(d|0)==6?c|0:0}function MR(){return 8}function IR(){return 16}function BR(){return 168}function LR(){return 8}function RR(){return 16}function OR(){return 12}function FR(){return 8}function DR(c){c=c|0;var A=0,f=0;return f=+G[c>>3],A=+G[c+8>>3],+ +tt(+(f*f+A*A))}function m2(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0;B=+G[c>>3],C=+G[A>>3]-B,w=+G[c+8>>3],y=+G[A+8>>3]-w,V=+G[f>>3],v=+G[d>>3]-V,W=+G[f+8>>3],L=+G[d+8>>3]-W,v=(v*(w-W)-(B-V)*L)/(C*L-y*v),G[g>>3]=B+C*v,G[g+8>>3]=w+y*v}function y2(c,A){return c=c|0,A=A|0,+G[c>>3]!=+G[A>>3]?(A=0,A|0):(A=+G[c+8>>3]==+G[A+8>>3],A|0)}function hn(c,A){c=c|0,A=A|0;var f=0,d=0,g=0;return g=+G[c>>3]-+G[A>>3],d=+G[c+8>>3]-+G[A+8>>3],f=+G[c+16>>3]-+G[A+16>>3],+(g*g+d*d+f*f)}function kR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0;f=+G[c>>3],d=+ut(+f),f=+st(+f),G[A+16>>3]=f,f=+G[c+8>>3],g=d*+ut(+f),G[A>>3]=g,f=d*+st(+f),G[A+8>>3]=f}function NR(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0;if(B=U,U=U+32|0,g=B+16|0,v=B,wc(c,A,g),y=l2(c,A)|0,C=dr(c,A)|0,CL(y,v),A=SL(y,u[g>>2]|0)|0,!(Je(y)|0))return C=A,U=B,C|0;do switch(y|0){case 4:{c=0,f=14;break}case 14:{c=1,f=14;break}case 24:{c=2,f=14;break}case 38:{c=3,f=14;break}case 49:{c=4,f=14;break}case 58:{c=5,f=14;break}case 63:{c=6,f=14;break}case 72:{c=7,f=14;break}case 83:{c=8,f=14;break}case 97:{c=9,f=14;break}case 107:{c=10,f=14;break}case 117:{c=11,f=14;break}default:w=0,d=0}while(0);return(f|0)==14&&(w=u[22096+(c*24|0)+8>>2]|0,d=u[22096+(c*24|0)+16>>2]|0),c=u[g>>2]|0,(c|0)!=(u[v>>2]|0)&&(y=vn(y)|0,c=u[g>>2]|0,y|(c|0)==(d|0)&&(A=(A+1|0)%6|0)),(C|0)==3&(c|0)==(d|0)?(C=(A+5|0)%6|0,U=B,C|0):(C|0)==5&(c|0)==(w|0)?(C=(A+1|0)%6|0,U=B,C|0):(C=A,U=B,C|0)}function UR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0;return d=_n(c,A)|0,(f+-1|0)>>>0>5||(g=(d|0)!=0,(f|0)==1&g)?(f=-1,f|0):(d=NR(c,A)|0,g?(f=(5-d+(u[22384+(f<<2)>>2]|0)|0)%5|0,f|0):(f=(6-d+(u[22416+(f<<2)>>2]|0)|0)%6|0,f|0))}function v2(c,A,f){c=c|0,A=A|0,f=f|0;var d=0;(A|0)>0?(d=gi(A,4)|0,u[c>>2]=d,d||dt(23230,23253,40,23267)):u[c>>2]=0,u[c+4>>2]=A,u[c+8>>2]=0,u[c+12>>2]=f}function _2(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0;g=c+4|0,v=c+12|0,y=c+8|0;e:for(;;){for(f=u[g>>2]|0,A=0;;){if((A|0)>=(f|0))break e;if(d=u[c>>2]|0,w=u[d+(A<<2)>>2]|0,!w)A=A+1|0;else break}A=d+(~~(+Ze(+(+Ht(10,+ +(15-(u[v>>2]|0)|0))*(+G[w>>3]+ +G[w+8>>3])))%+(f|0))>>>0<<2)|0,f=u[A>>2]|0;t:do if(f|0){if(d=w+32|0,(f|0)==(w|0))u[A>>2]=u[d>>2];else{if(f=f+32|0,A=u[f>>2]|0,!A)break;for(;(A|0)!=(w|0);)if(f=A+32|0,A=u[f>>2]|0,!A)break t;u[f>>2]=u[d>>2]}Ke(w),u[y>>2]=(u[y>>2]|0)+-1}while(0)}Ke(u[c>>2]|0)}function E2(c){c=c|0;var A=0,f=0,d=0;for(d=u[c+4>>2]|0,f=0;;){if((f|0)>=(d|0)){A=0,f=4;break}if(A=u[(u[c>>2]|0)+(f<<2)>>2]|0,!A)f=f+1|0;else{f=4;break}}return(f|0)==4?A|0:0}function w2(c,A){c=c|0,A=A|0;var f=0,d=0,g=0,v=0;if(f=~~(+Ze(+(+Ht(10,+ +(15-(u[c+12>>2]|0)|0))*(+G[A>>3]+ +G[A+8>>3])))%+(u[c+4>>2]|0))>>>0,f=(u[c>>2]|0)+(f<<2)|0,d=u[f>>2]|0,!d)return v=1,v|0;v=A+32|0;do if((d|0)!=(A|0)){if(f=u[d+32>>2]|0,!f)return v=1,v|0;for(g=f;;){if((g|0)==(A|0)){g=8;break}if(f=u[g+32>>2]|0,f)d=g,g=f;else{f=1,g=10;break}}if((g|0)==8){u[d+32>>2]=u[v>>2];break}else if((g|0)==10)return f|0}else u[f>>2]=u[v>>2];while(0);return Ke(A),v=c+8|0,u[v>>2]=(u[v>>2]|0)+-1,v=0,v|0}function GR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0;v=ki(40)|0,v||dt(23283,23253,98,23296),u[v>>2]=u[A>>2],u[v+4>>2]=u[A+4>>2],u[v+8>>2]=u[A+8>>2],u[v+12>>2]=u[A+12>>2],g=v+16|0,u[g>>2]=u[f>>2],u[g+4>>2]=u[f+4>>2],u[g+8>>2]=u[f+8>>2],u[g+12>>2]=u[f+12>>2],u[v+32>>2]=0,g=~~(+Ze(+(+Ht(10,+ +(15-(u[c+12>>2]|0)|0))*(+G[A>>3]+ +G[A+8>>3])))%+(u[c+4>>2]|0))>>>0,g=(u[c>>2]|0)+(g<<2)|0,d=u[g>>2]|0;do if(!d)u[g>>2]=v;else{for(;!(Sa(d,A)|0&&Sa(d+16|0,f)|0);)if(g=u[d+32>>2]|0,d=(g|0)==0?d:g,!(u[d+32>>2]|0)){y=10;break}if((y|0)==10){u[d+32>>2]=v;break}return Ke(v),y=d,y|0}while(0);return y=c+8|0,u[y>>2]=(u[y>>2]|0)+1,y=v,y|0}function zR(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0;if(g=~~(+Ze(+(+Ht(10,+ +(15-(u[c+12>>2]|0)|0))*(+G[A>>3]+ +G[A+8>>3])))%+(u[c+4>>2]|0))>>>0,g=u[(u[c>>2]|0)+(g<<2)>>2]|0,!g)return f=0,f|0;if(!f){for(c=g;;){if(Sa(c,A)|0){d=10;break}if(c=u[c+32>>2]|0,!c){c=0,d=10;break}}if((d|0)==10)return c|0}for(c=g;;){if(Sa(c,A)|0&&Sa(c+16|0,f)|0){d=10;break}if(c=u[c+32>>2]|0,!c){c=0,d=10;break}}return(d|0)==10?c|0:0}function VR(c,A){c=c|0,A=A|0;var f=0;if(f=~~(+Ze(+(+Ht(10,+ +(15-(u[c+12>>2]|0)|0))*(+G[A>>3]+ +G[A+8>>3])))%+(u[c+4>>2]|0))>>>0,c=u[(u[c>>2]|0)+(f<<2)>>2]|0,!c)return f=0,f|0;for(;;){if(Sa(c,A)|0){A=5;break}if(c=u[c+32>>2]|0,!c){c=0,A=5;break}}return(A|0)==5?c|0:0}function HR(){return 23312}function jR(c){return c=+c,+ +x2(+c)}function sf(c){return c=+c,~~+jR(c)|0}function ki(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0,ie=0,de=0,Te=0,te=0,Ae=0,$=0,be=0;be=U,U=U+16|0,W=be;do if(c>>>0<245){if(B=c>>>0<11?16:c+11&-8,c=B>>>3,V=u[5829]|0,f=V>>>c,f&3|0)return A=(f&1^1)+c|0,c=23356+(A<<1<<2)|0,f=c+8|0,d=u[f>>2]|0,g=d+8|0,v=u[g>>2]|0,(v|0)==(c|0)?u[5829]=V&~(1<<A):(u[v+12>>2]=c,u[f>>2]=v),$=A<<3,u[d+4>>2]=$|3,$=d+$+4|0,u[$>>2]=u[$>>2]|1,$=g,U=be,$|0;if(L=u[5831]|0,B>>>0>L>>>0){if(f|0)return A=2<<c,A=f<<c&(A|0-A),A=(A&0-A)+-1|0,w=A>>>12&16,A=A>>>w,f=A>>>5&8,A=A>>>f,v=A>>>2&4,A=A>>>v,c=A>>>1&2,A=A>>>c,d=A>>>1&1,d=(f|w|v|c|d)+(A>>>d)|0,A=23356+(d<<1<<2)|0,c=A+8|0,v=u[c>>2]|0,w=v+8|0,f=u[w>>2]|0,(f|0)==(A|0)?(c=V&~(1<<d),u[5829]=c):(u[f+12>>2]=A,u[c>>2]=f,c=V),$=d<<3,y=$-B|0,u[v+4>>2]=B|3,g=v+B|0,u[g+4>>2]=y|1,u[v+$>>2]=y,L|0&&(d=u[5834]|0,A=L>>>3,f=23356+(A<<1<<2)|0,A=1<<A,c&A?(c=f+8|0,A=u[c>>2]|0):(u[5829]=c|A,A=f,c=f+8|0),u[c>>2]=d,u[A+12>>2]=d,u[d+8>>2]=A,u[d+12>>2]=f),u[5831]=y,u[5834]=g,$=w,U=be,$|0;if(v=u[5830]|0,v){for(f=(v&0-v)+-1|0,g=f>>>12&16,f=f>>>g,d=f>>>5&8,f=f>>>d,y=f>>>2&4,f=f>>>y,w=f>>>1&2,f=f>>>w,C=f>>>1&1,C=u[23620+((d|g|y|w|C)+(f>>>C)<<2)>>2]|0,f=C,w=C,C=(u[C+4>>2]&-8)-B|0;c=u[f+16>>2]|0,!(!c&&(c=u[f+20>>2]|0,!c));)y=(u[c+4>>2]&-8)-B|0,g=y>>>0<C>>>0,f=c,w=g?c:w,C=g?y:C;if(y=w+B|0,y>>>0>w>>>0){g=u[w+24>>2]|0,A=u[w+12>>2]|0;do if((A|0)==(w|0)){if(c=w+20|0,A=u[c>>2]|0,!A&&(c=w+16|0,A=u[c>>2]|0,!A)){f=0;break}for(;;)if(d=A+20|0,f=u[d>>2]|0,f)A=f,c=d;else if(d=A+16|0,f=u[d>>2]|0,f)A=f,c=d;else break;u[c>>2]=0,f=A}else f=u[w+8>>2]|0,u[f+12>>2]=A,u[A+8>>2]=f,f=A;while(0);do if(g|0){if(A=u[w+28>>2]|0,c=23620+(A<<2)|0,(w|0)==(u[c>>2]|0)){if(u[c>>2]=f,!f){u[5830]=v&~(1<<A);break}}else if($=g+16|0,u[((u[$>>2]|0)==(w|0)?$:g+20|0)>>2]=f,!f)break;u[f+24>>2]=g,A=u[w+16>>2]|0,A|0&&(u[f+16>>2]=A,u[A+24>>2]=f),A=u[w+20>>2]|0,A|0&&(u[f+20>>2]=A,u[A+24>>2]=f)}while(0);return C>>>0<16?($=C+B|0,u[w+4>>2]=$|3,$=w+$+4|0,u[$>>2]=u[$>>2]|1):(u[w+4>>2]=B|3,u[y+4>>2]=C|1,u[y+C>>2]=C,L|0&&(d=u[5834]|0,A=L>>>3,f=23356+(A<<1<<2)|0,A=1<<A,A&V?(c=f+8|0,A=u[c>>2]|0):(u[5829]=A|V,A=f,c=f+8|0),u[c>>2]=d,u[A+12>>2]=d,u[d+8>>2]=A,u[d+12>>2]=f),u[5831]=C,u[5834]=y),$=w+8|0,U=be,$|0}else V=B}else V=B}else V=B}else if(c>>>0<=4294967231)if(c=c+11|0,B=c&-8,d=u[5830]|0,d){g=0-B|0,c=c>>>8,c?B>>>0>16777215?C=31:(V=(c+1048320|0)>>>16&8,ie=c<<V,w=(ie+520192|0)>>>16&4,ie=ie<<w,C=(ie+245760|0)>>>16&2,C=14-(w|V|C)+(ie<<C>>>15)|0,C=B>>>(C+7|0)&1|C<<1):C=0,f=u[23620+(C<<2)>>2]|0;e:do if(!f)f=0,c=0,ie=61;else for(c=0,w=B<<((C|0)==31?0:25-(C>>>1)|0),v=0;;){if(y=(u[f+4>>2]&-8)-B|0,y>>>0<g>>>0)if(y)c=f,g=y;else{c=f,g=0,ie=65;break e}if(ie=u[f+20>>2]|0,f=u[f+16+(w>>>31<<2)>>2]|0,v=(ie|0)==0|(ie|0)==(f|0)?v:ie,f)w=w<<1;else{f=v,ie=61;break}}while(0);if((ie|0)==61){if((f|0)==0&(c|0)==0){if(c=2<<C,c=(c|0-c)&d,!c){V=B;break}V=(c&0-c)+-1|0,y=V>>>12&16,V=V>>>y,v=V>>>5&8,V=V>>>v,w=V>>>2&4,V=V>>>w,C=V>>>1&2,V=V>>>C,f=V>>>1&1,c=0,f=u[23620+((v|y|w|C|f)+(V>>>f)<<2)>>2]|0}f?ie=65:(w=c,y=g)}if((ie|0)==65)for(v=f;;)if(V=(u[v+4>>2]&-8)-B|0,f=V>>>0<g>>>0,g=f?V:g,c=f?v:c,f=u[v+16>>2]|0,f||(f=u[v+20>>2]|0),f)v=f;else{w=c,y=g;break}if((w|0)!=0&&y>>>0<((u[5831]|0)-B|0)>>>0&&(L=w+B|0,L>>>0>w>>>0)){v=u[w+24>>2]|0,A=u[w+12>>2]|0;do if((A|0)==(w|0)){if(c=w+20|0,A=u[c>>2]|0,!A&&(c=w+16|0,A=u[c>>2]|0,!A)){A=0;break}for(;;)if(g=A+20|0,f=u[g>>2]|0,f)A=f,c=g;else if(g=A+16|0,f=u[g>>2]|0,f)A=f,c=g;else break;u[c>>2]=0}else $=u[w+8>>2]|0,u[$+12>>2]=A,u[A+8>>2]=$;while(0);do if(v){if(c=u[w+28>>2]|0,f=23620+(c<<2)|0,(w|0)==(u[f>>2]|0)){if(u[f>>2]=A,!A){d=d&~(1<<c),u[5830]=d;break}}else if($=v+16|0,u[((u[$>>2]|0)==(w|0)?$:v+20|0)>>2]=A,!A)break;u[A+24>>2]=v,c=u[w+16>>2]|0,c|0&&(u[A+16>>2]=c,u[c+24>>2]=A),c=u[w+20>>2]|0,c&&(u[A+20>>2]=c,u[c+24>>2]=A)}while(0);e:do if(y>>>0<16)$=y+B|0,u[w+4>>2]=$|3,$=w+$+4|0,u[$>>2]=u[$>>2]|1;else{if(u[w+4>>2]=B|3,u[L+4>>2]=y|1,u[L+y>>2]=y,A=y>>>3,y>>>0<256){f=23356+(A<<1<<2)|0,c=u[5829]|0,A=1<<A,c&A?(c=f+8|0,A=u[c>>2]|0):(u[5829]=c|A,A=f,c=f+8|0),u[c>>2]=L,u[A+12>>2]=L,u[L+8>>2]=A,u[L+12>>2]=f;break}if(A=y>>>8,A?y>>>0>16777215?f=31:(Ae=(A+1048320|0)>>>16&8,$=A<<Ae,te=($+520192|0)>>>16&4,$=$<<te,f=($+245760|0)>>>16&2,f=14-(te|Ae|f)+($<<f>>>15)|0,f=y>>>(f+7|0)&1|f<<1):f=0,A=23620+(f<<2)|0,u[L+28>>2]=f,c=L+16|0,u[c+4>>2]=0,u[c>>2]=0,c=1<<f,!(d&c)){u[5830]=d|c,u[A>>2]=L,u[L+24>>2]=A,u[L+12>>2]=L,u[L+8>>2]=L;break}A=u[A>>2]|0;t:do if((u[A+4>>2]&-8|0)!=(y|0)){for(d=y<<((f|0)==31?0:25-(f>>>1)|0);f=A+16+(d>>>31<<2)|0,c=u[f>>2]|0,!!c;)if((u[c+4>>2]&-8|0)==(y|0)){A=c;break t}else d=d<<1,A=c;u[f>>2]=L,u[L+24>>2]=A,u[L+12>>2]=L,u[L+8>>2]=L;break e}while(0);Ae=A+8|0,$=u[Ae>>2]|0,u[$+12>>2]=L,u[Ae>>2]=L,u[L+8>>2]=$,u[L+12>>2]=A,u[L+24>>2]=0}while(0);return $=w+8|0,U=be,$|0}else V=B}else V=B;else V=-1;while(0);if(f=u[5831]|0,f>>>0>=V>>>0)return A=f-V|0,c=u[5834]|0,A>>>0>15?($=c+V|0,u[5834]=$,u[5831]=A,u[$+4>>2]=A|1,u[c+f>>2]=A,u[c+4>>2]=V|3):(u[5831]=0,u[5834]=0,u[c+4>>2]=f|3,$=c+f+4|0,u[$>>2]=u[$>>2]|1),$=c+8|0,U=be,$|0;if(y=u[5832]|0,y>>>0>V>>>0)return te=y-V|0,u[5832]=te,$=u[5835]|0,Ae=$+V|0,u[5835]=Ae,u[Ae+4>>2]=te|1,u[$+4>>2]=V|3,$=$+8|0,U=be,$|0;if(u[5947]|0?c=u[5949]|0:(u[5949]=4096,u[5948]=4096,u[5950]=-1,u[5951]=-1,u[5952]=0,u[5940]=0,u[5947]=W&-16^1431655768,c=4096),w=V+48|0,C=V+47|0,v=c+C|0,g=0-c|0,B=v&g,B>>>0<=V>>>0||(c=u[5939]|0,c|0&&(L=u[5937]|0,W=L+B|0,W>>>0<=L>>>0|W>>>0>c>>>0)))return $=0,U=be,$|0;e:do if(u[5940]&4)A=0,ie=143;else{f=u[5835]|0;t:do if(f){for(d=23764;W=u[d>>2]|0,!(W>>>0<=f>>>0&&(W+(u[d+4>>2]|0)|0)>>>0>f>>>0);)if(c=u[d+8>>2]|0,c)d=c;else{ie=128;break t}if(A=v-y&g,A>>>0<2147483647)if(c=Rs(A|0)|0,(c|0)==((u[d>>2]|0)+(u[d+4>>2]|0)|0)){if((c|0)!=-1){y=A,v=c,ie=145;break e}}else d=c,ie=136;else A=0}else ie=128;while(0);do if((ie|0)==128)if(f=Rs(0)|0,(f|0)!=-1&&(A=f,Y=u[5948]|0,re=Y+-1|0,A=((re&A|0)==0?0:(re+A&0-Y)-A|0)+B|0,Y=u[5937]|0,re=A+Y|0,A>>>0>V>>>0&A>>>0<2147483647)){if(W=u[5939]|0,W|0&&re>>>0<=Y>>>0|re>>>0>W>>>0){A=0;break}if(c=Rs(A|0)|0,(c|0)==(f|0)){y=A,v=f,ie=145;break e}else d=c,ie=136}else A=0;while(0);do if((ie|0)==136){if(f=0-A|0,!(w>>>0>A>>>0&(A>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){A=0;break}else{y=A,v=d,ie=145;break e}if(c=u[5949]|0,c=C-A+c&0-c,c>>>0>=2147483647){y=A,v=d,ie=145;break e}if((Rs(c|0)|0)==-1){Rs(f|0)|0,A=0;break}else{y=c+A|0,v=d,ie=145;break e}}while(0);u[5940]=u[5940]|4,ie=143}while(0);if((ie|0)==143&&B>>>0<2147483647&&(te=Rs(B|0)|0,re=Rs(0)|0,de=re-te|0,Te=de>>>0>(V+40|0)>>>0,!((te|0)==-1|Te^1|te>>>0<re>>>0&((te|0)!=-1&(re|0)!=-1)^1))&&(y=Te?de:A,v=te,ie=145),(ie|0)==145){A=(u[5937]|0)+y|0,u[5937]=A,A>>>0>(u[5938]|0)>>>0&&(u[5938]=A),C=u[5835]|0;e:do if(C){for(A=23764;;){if(c=u[A>>2]|0,f=u[A+4>>2]|0,(v|0)==(c+f|0)){ie=154;break}if(d=u[A+8>>2]|0,d)A=d;else break}if((ie|0)==154&&(Ae=A+4|0,(u[A+12>>2]&8|0)==0)&&v>>>0>C>>>0&c>>>0<=C>>>0){u[Ae>>2]=f+y,$=(u[5832]|0)+y|0,te=C+8|0,te=(te&7|0)==0?0:0-te&7,Ae=C+te|0,te=$-te|0,u[5835]=Ae,u[5832]=te,u[Ae+4>>2]=te|1,u[C+$+4>>2]=40,u[5836]=u[5951];break}for(v>>>0<(u[5833]|0)>>>0&&(u[5833]=v),f=v+y|0,A=23764;;){if((u[A>>2]|0)==(f|0)){ie=162;break}if(c=u[A+8>>2]|0,c)A=c;else break}if((ie|0)==162&&(u[A+12>>2]&8|0)==0){u[A>>2]=v,L=A+4|0,u[L>>2]=(u[L>>2]|0)+y,L=v+8|0,L=v+((L&7|0)==0?0:0-L&7)|0,A=f+8|0,A=f+((A&7|0)==0?0:0-A&7)|0,B=L+V|0,w=A-L-V|0,u[L+4>>2]=V|3;t:do if((C|0)==(A|0))$=(u[5832]|0)+w|0,u[5832]=$,u[5835]=B,u[B+4>>2]=$|1;else{if((u[5834]|0)==(A|0)){$=(u[5831]|0)+w|0,u[5831]=$,u[5834]=B,u[B+4>>2]=$|1,u[B+$>>2]=$;break}if(c=u[A+4>>2]|0,(c&3|0)==1){y=c&-8,d=c>>>3;n:do if(c>>>0<256)if(c=u[A+8>>2]|0,f=u[A+12>>2]|0,(f|0)==(c|0)){u[5829]=u[5829]&~(1<<d);break}else{u[c+12>>2]=f,u[f+8>>2]=c;break}else{v=u[A+24>>2]|0,c=u[A+12>>2]|0;do if((c|0)==(A|0)){if(f=A+16|0,d=f+4|0,c=u[d>>2]|0,c)f=d;else if(c=u[f>>2]|0,!c){c=0;break}for(;;)if(g=c+20|0,d=u[g>>2]|0,d)c=d,f=g;else if(g=c+16|0,d=u[g>>2]|0,d)c=d,f=g;else break;u[f>>2]=0}else $=u[A+8>>2]|0,u[$+12>>2]=c,u[c+8>>2]=$;while(0);if(!v)break;f=u[A+28>>2]|0,d=23620+(f<<2)|0;do if((u[d>>2]|0)!=(A|0)){if($=v+16|0,u[((u[$>>2]|0)==(A|0)?$:v+20|0)>>2]=c,!c)break n}else{if(u[d>>2]=c,c|0)break;u[5830]=u[5830]&~(1<<f);break n}while(0);if(u[c+24>>2]=v,f=A+16|0,d=u[f>>2]|0,d|0&&(u[c+16>>2]=d,u[d+24>>2]=c),f=u[f+4>>2]|0,!f)break;u[c+20>>2]=f,u[f+24>>2]=c}while(0);A=A+y|0,g=y+w|0}else g=w;if(A=A+4|0,u[A>>2]=u[A>>2]&-2,u[B+4>>2]=g|1,u[B+g>>2]=g,A=g>>>3,g>>>0<256){f=23356+(A<<1<<2)|0,c=u[5829]|0,A=1<<A,c&A?(c=f+8|0,A=u[c>>2]|0):(u[5829]=c|A,A=f,c=f+8|0),u[c>>2]=B,u[A+12>>2]=B,u[B+8>>2]=A,u[B+12>>2]=f;break}A=g>>>8;do if(!A)d=0;else{if(g>>>0>16777215){d=31;break}Ae=(A+1048320|0)>>>16&8,$=A<<Ae,te=($+520192|0)>>>16&4,$=$<<te,d=($+245760|0)>>>16&2,d=14-(te|Ae|d)+($<<d>>>15)|0,d=g>>>(d+7|0)&1|d<<1}while(0);if(A=23620+(d<<2)|0,u[B+28>>2]=d,c=B+16|0,u[c+4>>2]=0,u[c>>2]=0,c=u[5830]|0,f=1<<d,!(c&f)){u[5830]=c|f,u[A>>2]=B,u[B+24>>2]=A,u[B+12>>2]=B,u[B+8>>2]=B;break}A=u[A>>2]|0;n:do if((u[A+4>>2]&-8|0)!=(g|0)){for(d=g<<((d|0)==31?0:25-(d>>>1)|0);f=A+16+(d>>>31<<2)|0,c=u[f>>2]|0,!!c;)if((u[c+4>>2]&-8|0)==(g|0)){A=c;break n}else d=d<<1,A=c;u[f>>2]=B,u[B+24>>2]=A,u[B+12>>2]=B,u[B+8>>2]=B;break t}while(0);Ae=A+8|0,$=u[Ae>>2]|0,u[$+12>>2]=B,u[Ae>>2]=B,u[B+8>>2]=$,u[B+12>>2]=A,u[B+24>>2]=0}while(0);return $=L+8|0,U=be,$|0}for(A=23764;c=u[A>>2]|0,!(c>>>0<=C>>>0&&($=c+(u[A+4>>2]|0)|0,$>>>0>C>>>0));)A=u[A+8>>2]|0;g=$+-47|0,c=g+8|0,c=g+((c&7|0)==0?0:0-c&7)|0,g=C+16|0,c=c>>>0<g>>>0?C:c,A=c+8|0,f=y+-40|0,te=v+8|0,te=(te&7|0)==0?0:0-te&7,Ae=v+te|0,te=f-te|0,u[5835]=Ae,u[5832]=te,u[Ae+4>>2]=te|1,u[v+f+4>>2]=40,u[5836]=u[5951],f=c+4|0,u[f>>2]=27,u[A>>2]=u[5941],u[A+4>>2]=u[5942],u[A+8>>2]=u[5943],u[A+12>>2]=u[5944],u[5941]=v,u[5942]=y,u[5944]=0,u[5943]=A,A=c+24|0;do Ae=A,A=A+4|0,u[A>>2]=7;while((Ae+8|0)>>>0<$>>>0);if((c|0)!=(C|0)){if(v=c-C|0,u[f>>2]=u[f>>2]&-2,u[C+4>>2]=v|1,u[c>>2]=v,A=v>>>3,v>>>0<256){f=23356+(A<<1<<2)|0,c=u[5829]|0,A=1<<A,c&A?(c=f+8|0,A=u[c>>2]|0):(u[5829]=c|A,A=f,c=f+8|0),u[c>>2]=C,u[A+12>>2]=C,u[C+8>>2]=A,u[C+12>>2]=f;break}if(A=v>>>8,A?v>>>0>16777215?d=31:(Ae=(A+1048320|0)>>>16&8,$=A<<Ae,te=($+520192|0)>>>16&4,$=$<<te,d=($+245760|0)>>>16&2,d=14-(te|Ae|d)+($<<d>>>15)|0,d=v>>>(d+7|0)&1|d<<1):d=0,f=23620+(d<<2)|0,u[C+28>>2]=d,u[C+20>>2]=0,u[g>>2]=0,A=u[5830]|0,c=1<<d,!(A&c)){u[5830]=A|c,u[f>>2]=C,u[C+24>>2]=f,u[C+12>>2]=C,u[C+8>>2]=C;break}A=u[f>>2]|0;t:do if((u[A+4>>2]&-8|0)!=(v|0)){for(d=v<<((d|0)==31?0:25-(d>>>1)|0);f=A+16+(d>>>31<<2)|0,c=u[f>>2]|0,!!c;)if((u[c+4>>2]&-8|0)==(v|0)){A=c;break t}else d=d<<1,A=c;u[f>>2]=C,u[C+24>>2]=A,u[C+12>>2]=C,u[C+8>>2]=C;break e}while(0);Ae=A+8|0,$=u[Ae>>2]|0,u[$+12>>2]=C,u[Ae>>2]=C,u[C+8>>2]=$,u[C+12>>2]=A,u[C+24>>2]=0}}else $=u[5833]|0,($|0)==0|v>>>0<$>>>0&&(u[5833]=v),u[5941]=v,u[5942]=y,u[5944]=0,u[5838]=u[5947],u[5837]=-1,u[5842]=23356,u[5841]=23356,u[5844]=23364,u[5843]=23364,u[5846]=23372,u[5845]=23372,u[5848]=23380,u[5847]=23380,u[5850]=23388,u[5849]=23388,u[5852]=23396,u[5851]=23396,u[5854]=23404,u[5853]=23404,u[5856]=23412,u[5855]=23412,u[5858]=23420,u[5857]=23420,u[5860]=23428,u[5859]=23428,u[5862]=23436,u[5861]=23436,u[5864]=23444,u[5863]=23444,u[5866]=23452,u[5865]=23452,u[5868]=23460,u[5867]=23460,u[5870]=23468,u[5869]=23468,u[5872]=23476,u[5871]=23476,u[5874]=23484,u[5873]=23484,u[5876]=23492,u[5875]=23492,u[5878]=23500,u[5877]=23500,u[5880]=23508,u[5879]=23508,u[5882]=23516,u[5881]=23516,u[5884]=23524,u[5883]=23524,u[5886]=23532,u[5885]=23532,u[5888]=23540,u[5887]=23540,u[5890]=23548,u[5889]=23548,u[5892]=23556,u[5891]=23556,u[5894]=23564,u[5893]=23564,u[5896]=23572,u[5895]=23572,u[5898]=23580,u[5897]=23580,u[5900]=23588,u[5899]=23588,u[5902]=23596,u[5901]=23596,u[5904]=23604,u[5903]=23604,$=y+-40|0,te=v+8|0,te=(te&7|0)==0?0:0-te&7,Ae=v+te|0,te=$-te|0,u[5835]=Ae,u[5832]=te,u[Ae+4>>2]=te|1,u[v+$+4>>2]=40,u[5836]=u[5951];while(0);if(A=u[5832]|0,A>>>0>V>>>0)return te=A-V|0,u[5832]=te,$=u[5835]|0,Ae=$+V|0,u[5835]=Ae,u[Ae+4>>2]=te|1,u[$+4>>2]=V|3,$=$+8|0,U=be,$|0}return $=HR()|0,u[$>>2]=12,$=0,U=be,$|0}function Ke(c){c=c|0;var A=0,f=0,d=0,g=0,v=0,y=0,w=0,C=0;if(!c)return;f=c+-8|0,g=u[5833]|0,c=u[c+-4>>2]|0,A=c&-8,C=f+A|0;do if(c&1)w=f,y=f;else{if(d=u[f>>2]|0,!(c&3)||(y=f+(0-d)|0,v=d+A|0,y>>>0<g>>>0))return;if((u[5834]|0)==(y|0)){if(c=C+4|0,A=u[c>>2]|0,(A&3|0)!=3){w=y,A=v;break}u[5831]=v,u[c>>2]=A&-2,u[y+4>>2]=v|1,u[y+v>>2]=v;return}if(f=d>>>3,d>>>0<256)if(c=u[y+8>>2]|0,A=u[y+12>>2]|0,(A|0)==(c|0)){u[5829]=u[5829]&~(1<<f),w=y,A=v;break}else{u[c+12>>2]=A,u[A+8>>2]=c,w=y,A=v;break}g=u[y+24>>2]|0,c=u[y+12>>2]|0;do if((c|0)==(y|0)){if(A=y+16|0,f=A+4|0,c=u[f>>2]|0,c)A=f;else if(c=u[A>>2]|0,!c){c=0;break}for(;;)if(d=c+20|0,f=u[d>>2]|0,f)c=f,A=d;else if(d=c+16|0,f=u[d>>2]|0,f)c=f,A=d;else break;u[A>>2]=0}else w=u[y+8>>2]|0,u[w+12>>2]=c,u[c+8>>2]=w;while(0);if(g){if(A=u[y+28>>2]|0,f=23620+(A<<2)|0,(u[f>>2]|0)==(y|0)){if(u[f>>2]=c,!c){u[5830]=u[5830]&~(1<<A),w=y,A=v;break}}else if(w=g+16|0,u[((u[w>>2]|0)==(y|0)?w:g+20|0)>>2]=c,!c){w=y,A=v;break}u[c+24>>2]=g,A=y+16|0,f=u[A>>2]|0,f|0&&(u[c+16>>2]=f,u[f+24>>2]=c),A=u[A+4>>2]|0,A?(u[c+20>>2]=A,u[A+24>>2]=c,w=y,A=v):(w=y,A=v)}else w=y,A=v}while(0);if(y>>>0>=C>>>0||(c=C+4|0,d=u[c>>2]|0,!(d&1)))return;if(d&2)u[c>>2]=d&-2,u[w+4>>2]=A|1,u[y+A>>2]=A,g=A;else{if((u[5835]|0)==(C|0)){if(C=(u[5832]|0)+A|0,u[5832]=C,u[5835]=w,u[w+4>>2]=C|1,(w|0)!=(u[5834]|0))return;u[5834]=0,u[5831]=0;return}if((u[5834]|0)==(C|0)){C=(u[5831]|0)+A|0,u[5831]=C,u[5834]=y,u[w+4>>2]=C|1,u[y+C>>2]=C;return}g=(d&-8)+A|0,f=d>>>3;do if(d>>>0<256)if(A=u[C+8>>2]|0,c=u[C+12>>2]|0,(c|0)==(A|0)){u[5829]=u[5829]&~(1<<f);break}else{u[A+12>>2]=c,u[c+8>>2]=A;break}else{v=u[C+24>>2]|0,c=u[C+12>>2]|0;do if((c|0)==(C|0)){if(A=C+16|0,f=A+4|0,c=u[f>>2]|0,c)A=f;else if(c=u[A>>2]|0,!c){f=0;break}for(;;)if(d=c+20|0,f=u[d>>2]|0,f)c=f,A=d;else if(d=c+16|0,f=u[d>>2]|0,f)c=f,A=d;else break;u[A>>2]=0,f=c}else f=u[C+8>>2]|0,u[f+12>>2]=c,u[c+8>>2]=f,f=c;while(0);if(v|0){if(c=u[C+28>>2]|0,A=23620+(c<<2)|0,(u[A>>2]|0)==(C|0)){if(u[A>>2]=f,!f){u[5830]=u[5830]&~(1<<c);break}}else if(d=v+16|0,u[((u[d>>2]|0)==(C|0)?d:v+20|0)>>2]=f,!f)break;u[f+24>>2]=v,c=C+16|0,A=u[c>>2]|0,A|0&&(u[f+16>>2]=A,u[A+24>>2]=f),c=u[c+4>>2]|0,c|0&&(u[f+20>>2]=c,u[c+24>>2]=f)}}while(0);if(u[w+4>>2]=g|1,u[y+g>>2]=g,(w|0)==(u[5834]|0)){u[5831]=g;return}}if(c=g>>>3,g>>>0<256){f=23356+(c<<1<<2)|0,A=u[5829]|0,c=1<<c,A&c?(A=f+8|0,c=u[A>>2]|0):(u[5829]=A|c,c=f,A=f+8|0),u[A>>2]=w,u[c+12>>2]=w,u[w+8>>2]=c,u[w+12>>2]=f;return}c=g>>>8,c?g>>>0>16777215?d=31:(y=(c+1048320|0)>>>16&8,C=c<<y,v=(C+520192|0)>>>16&4,C=C<<v,d=(C+245760|0)>>>16&2,d=14-(v|y|d)+(C<<d>>>15)|0,d=g>>>(d+7|0)&1|d<<1):d=0,c=23620+(d<<2)|0,u[w+28>>2]=d,u[w+20>>2]=0,u[w+16>>2]=0,A=u[5830]|0,f=1<<d;e:do if(!(A&f))u[5830]=A|f,u[c>>2]=w,u[w+24>>2]=c,u[w+12>>2]=w,u[w+8>>2]=w;else{c=u[c>>2]|0;t:do if((u[c+4>>2]&-8|0)!=(g|0)){for(d=g<<((d|0)==31?0:25-(d>>>1)|0);f=c+16+(d>>>31<<2)|0,A=u[f>>2]|0,!!A;)if((u[A+4>>2]&-8|0)==(g|0)){c=A;break t}else d=d<<1,c=A;u[f>>2]=w,u[w+24>>2]=c,u[w+12>>2]=w,u[w+8>>2]=w;break e}while(0);y=c+8|0,C=u[y>>2]|0,u[C+12>>2]=w,u[y>>2]=w,u[w+8>>2]=C,u[w+12>>2]=c,u[w+24>>2]=0}while(0);if(C=(u[5837]|0)+-1|0,u[5837]=C,!(C|0)){for(c=23772;c=u[c>>2]|0,c;)c=c+8|0;u[5837]=-1}}function gi(c,A){c=c|0,A=A|0;var f=0;return c?(f=Bn(A,c)|0,(A|c)>>>0>65535&&(f=((f>>>0)/(c>>>0)|0|0)==(A|0)?f:-1)):f=0,c=ki(f)|0,!c||!(u[c+-4>>2]&3)||mi(c|0,0,f|0)|0,c|0}function WR(c,A,f,d){return c=c|0,A=A|0,f=f|0,d=d|0,f=c+f>>>0,De(A+d+(f>>>0<c>>>0|0)>>>0|0),f|0|0}function Tc(c,A,f,d){return c=c|0,A=A|0,f=f|0,d=d|0,d=A-d-(f>>>0>c>>>0|0)>>>0,De(d|0),c-f>>>0|0|0}function T2(c){return c=c|0,(c?31-(xr(c^c-1)|0)|0:32)|0}function QR(c,A,f,d,g){c=c|0,A=A|0,f=f|0,d=d|0,g=g|0;var v=0,y=0,w=0,C=0,B=0,L=0,V=0,W=0,Y=0,re=0;if(L=c,C=A,B=C,y=f,W=d,w=W,!B)return v=(g|0)!=0,w?v?(u[g>>2]=c|0,u[g+4>>2]=A&0,W=0,g=0,De(W|0),g|0):(W=0,g=0,De(W|0),g|0):(v&&(u[g>>2]=(L>>>0)%(y>>>0),u[g+4>>2]=0),W=0,g=(L>>>0)/(y>>>0)>>>0,De(W|0),g|0);v=(w|0)==0;do if(y){if(!v){if(v=(xr(w|0)|0)-(xr(B|0)|0)|0,v>>>0<=31){V=v+1|0,w=31-v|0,A=v-31>>31,y=V,c=L>>>(V>>>0)&A|B<<w,A=B>>>(V>>>0)&A,v=0,w=L<<w;break}return g?(u[g>>2]=c|0,u[g+4>>2]=C|A&0,W=0,g=0,De(W|0),g|0):(W=0,g=0,De(W|0),g|0)}if(v=y-1|0,v&y|0){w=(xr(y|0)|0)+33-(xr(B|0)|0)|0,re=64-w|0,V=32-w|0,C=V>>31,Y=w-32|0,A=Y>>31,y=w,c=V-1>>31&B>>>(Y>>>0)|(B<<V|L>>>(w>>>0))&A,A=A&B>>>(w>>>0),v=L<<re&C,w=(B<<re|L>>>(Y>>>0))&C|L<<V&w-33>>31;break}return g|0&&(u[g>>2]=v&L,u[g+4>>2]=0),(y|0)==1?(Y=C|A&0,re=c|0|0,De(Y|0),re|0):(re=T2(y|0)|0,Y=B>>>(re>>>0)|0,re=B<<32-re|L>>>(re>>>0)|0,De(Y|0),re|0)}else{if(v)return g|0&&(u[g>>2]=(B>>>0)%(y>>>0),u[g+4>>2]=0),Y=0,re=(B>>>0)/(y>>>0)>>>0,De(Y|0),re|0;if(!L)return g|0&&(u[g>>2]=0,u[g+4>>2]=(B>>>0)%(w>>>0)),Y=0,re=(B>>>0)/(w>>>0)>>>0,De(Y|0),re|0;if(v=w-1|0,!(v&w))return g|0&&(u[g>>2]=c|0,u[g+4>>2]=v&B|A&0),Y=0,re=B>>>((T2(w|0)|0)>>>0),De(Y|0),re|0;if(v=(xr(w|0)|0)-(xr(B|0)|0)|0,v>>>0<=30){A=v+1|0,w=31-v|0,y=A,c=B<<w|L>>>(A>>>0),A=B>>>(A>>>0),v=0,w=L<<w;break}return g?(u[g>>2]=c|0,u[g+4>>2]=C|A&0,Y=0,re=0,De(Y|0),re|0):(Y=0,re=0,De(Y|0),re|0)}while(0);if(!y)B=w,C=0,w=0;else{V=f|0|0,L=W|d&0,B=WR(V|0,L|0,-1,-1)|0,f=j()|0,C=w,w=0;do d=C,C=v>>>31|C<<1,v=w|v<<1,d=c<<1|d>>>31|0,W=c>>>31|A<<1|0,Tc(B|0,f|0,d|0,W|0)|0,re=j()|0,Y=re>>31|((re|0)<0?-1:0)<<1,w=Y&1,c=Tc(d|0,W|0,Y&V|0,(((re|0)<0?-1:0)>>31|((re|0)<0?-1:0)<<1)&L|0)|0,A=j()|0,y=y-1|0;while((y|0)!=0);B=C,C=0}return y=0,g|0&&(u[g>>2]=c,u[g+4>>2]=A),Y=(v|0)>>>31|(B|y)<<1|(y<<1|v>>>31)&0|C,re=(v<<1|0>>>31)&-2|w,De(Y|0),re|0}function Ls(c,A,f,d){c=c|0,A=A|0,f=f|0,d=d|0;var g=0,v=0;return v=U,U=U+16|0,g=v|0,QR(c,A,f,d,g)|0,U=v,De(u[g+4>>2]|0),u[g>>2]|0|0}function he(c,A,f){return c=c|0,A=A|0,f=f|0,(f|0)<32?(De(A>>>f|0),c>>>f|(A&(1<<f)-1)<<32-f):(De(0),A>>>f-32|0)}function we(c,A,f){return c=c|0,A=A|0,f=f|0,(f|0)<32?(De(A<<f|(c&(1<<f)-1<<32-f)>>>32-f|0),c<<f):(De(c<<f-32|0),0)}function b2(c,A){return c=+c,A=+A,c!=c?+A:A!=A?+c:+di(+c,+A)}function of(c){return c=+c,c>=0?+ht(c+.5):+hi(c-.5)}function af(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0;if((f|0)>=8192)return Cr(c|0,A|0,f|0)|0,c|0;if(v=c|0,g=c+f|0,(c&3)==(A&3)){for(;c&3;){if(!f)return v|0;Ge[c>>0]=Ge[A>>0]|0,c=c+1|0,A=A+1|0,f=f-1|0}for(f=g&-4|0,d=f-64|0;(c|0)<=(d|0);)u[c>>2]=u[A>>2],u[c+4>>2]=u[A+4>>2],u[c+8>>2]=u[A+8>>2],u[c+12>>2]=u[A+12>>2],u[c+16>>2]=u[A+16>>2],u[c+20>>2]=u[A+20>>2],u[c+24>>2]=u[A+24>>2],u[c+28>>2]=u[A+28>>2],u[c+32>>2]=u[A+32>>2],u[c+36>>2]=u[A+36>>2],u[c+40>>2]=u[A+40>>2],u[c+44>>2]=u[A+44>>2],u[c+48>>2]=u[A+48>>2],u[c+52>>2]=u[A+52>>2],u[c+56>>2]=u[A+56>>2],u[c+60>>2]=u[A+60>>2],c=c+64|0,A=A+64|0;for(;(c|0)<(f|0);)u[c>>2]=u[A>>2],c=c+4|0,A=A+4|0}else for(f=g-4|0;(c|0)<(f|0);)Ge[c>>0]=Ge[A>>0]|0,Ge[c+1>>0]=Ge[A+1>>0]|0,Ge[c+2>>0]=Ge[A+2>>0]|0,Ge[c+3>>0]=Ge[A+3>>0]|0,c=c+4|0,A=A+4|0;for(;(c|0)<(g|0);)Ge[c>>0]=Ge[A>>0]|0,c=c+1|0,A=A+1|0;return v|0}function mi(c,A,f){c=c|0,A=A|0,f=f|0;var d=0,g=0,v=0,y=0;if(v=c+f|0,A=A&255,(f|0)>=67){for(;c&3;)Ge[c>>0]=A,c=c+1|0;for(d=v&-4|0,y=A|A<<8|A<<16|A<<24,g=d-64|0;(c|0)<=(g|0);)u[c>>2]=y,u[c+4>>2]=y,u[c+8>>2]=y,u[c+12>>2]=y,u[c+16>>2]=y,u[c+20>>2]=y,u[c+24>>2]=y,u[c+28>>2]=y,u[c+32>>2]=y,u[c+36>>2]=y,u[c+40>>2]=y,u[c+44>>2]=y,u[c+48>>2]=y,u[c+52>>2]=y,u[c+56>>2]=y,u[c+60>>2]=y,c=c+64|0;for(;(c|0)<(d|0);)u[c>>2]=y,c=c+4|0}for(;(c|0)<(v|0);)Ge[c>>0]=A,c=c+1|0;return v-f|0}function x2(c){return c=+c,c>=0?+ht(c+.5):+hi(c-.5)}function Rs(c){c=c|0;var A=0,f=0,d=0;return d=wa()|0,f=u[At>>2]|0,A=f+c|0,(c|0)>0&(A|0)<(f|0)|(A|0)<0?(pc(A|0)|0,dc(12),-1):(A|0)>(d|0)&&!(Ta(A|0)|0)?(dc(12),-1):(u[At>>2]=A,f|0)}return{___uremdi3:Ls,_bitshift64Lshr:he,_bitshift64Shl:we,_calloc:gi,_cellAreaKm2:KL,_cellAreaM2:ZL,_cellAreaRads2:JL,_compact:sR,_destroyLinkedPolygon:ER,_edgeLengthKm:$L,_edgeLengthM:XL,_emscripten_replace_memory:gc,_exactEdgeLengthKm:eR,_exactEdgeLengthM:tR,_exactEdgeLengthRads:qL,_experimentalH3ToLocalIj:wR,_experimentalLocalIjToH3:TR,_free:Ke,_geoToH3:A2,_getDestinationH3IndexFromUnidirectionalEdge:pR,_getH3IndexesFromUnidirectionalEdge:mR,_getH3UnidirectionalEdge:hR,_getH3UnidirectionalEdgeBoundary:nf,_getH3UnidirectionalEdgesFromHexagon:yR,_getOriginH3IndexFromUnidirectionalEdge:dR,_getPentagonIndexes:vp,_getRes0Indexes:ML,_h3Distance:bR,_h3GetBaseCell:l2,_h3GetFaces:u2,_h3GetResolution:nR,_h3IndexesAreNeighbors:f2,_h3IsPentagon:_n,_h3IsResClassIII:lR,_h3IsValid:c2,_h3Line:CR,_h3LineSize:xR,_h3SetToLinkedGeo:fn,_h3ToCenterChild:iR,_h3ToChildren:hr,_h3ToGeo:Mo,_h3ToGeoBoundary:Io,_h3ToParent:pp,_h3UnidirectionalEdgeIsValid:gR,_hexAreaKm2:WL,_hexAreaM2:QL,_hexRing:F,_i64Subtract:Tc,_kRing:xa,_kRingDistances:Zu,_llvm_minnum_f64:b2,_llvm_round_f64:of,_malloc:ki,_maxFaceCount:uR,_maxH3ToChildrenSize:rR,_maxKringSize:Ku,_maxPolyfillSize:H,_maxUncompactSize:aR,_memcpy:af,_memset:mi,_numHexagons:YL,_pentagonIndexCount:fR,_pointDistKm:Ec,_pointDistM:VL,_pointDistRads:zL,_polyfill:q,_res0IndexCount:PL,_round:x2,_sbrk:Rs,_sizeOfCoordIJ:FR,_sizeOfGeoBoundary:BR,_sizeOfGeoCoord:IR,_sizeOfGeoPolygon:RR,_sizeOfGeofence:LR,_sizeOfH3Index:MR,_sizeOfLinkedGeoPolygon:OR,_uncompact:oR,establishStackSpace:lp,stackAlloc:mc,stackRestore:pi,stackSave:ba}}(Wu,Qu,D);e.___uremdi3=ge.___uremdi3,e._bitshift64Lshr=ge._bitshift64Lshr,e._bitshift64Shl=ge._bitshift64Shl,e._calloc=ge._calloc,e._cellAreaKm2=ge._cellAreaKm2,e._cellAreaM2=ge._cellAreaM2,e._cellAreaRads2=ge._cellAreaRads2,e._compact=ge._compact,e._destroyLinkedPolygon=ge._destroyLinkedPolygon,e._edgeLengthKm=ge._edgeLengthKm,e._edgeLengthM=ge._edgeLengthM;var op=e._emscripten_replace_memory=ge._emscripten_replace_memory;e._exactEdgeLengthKm=ge._exactEdgeLengthKm,e._exactEdgeLengthM=ge._exactEdgeLengthM,e._exactEdgeLengthRads=ge._exactEdgeLengthRads,e._experimentalH3ToLocalIj=ge._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=ge._experimentalLocalIjToH3,e._free=ge._free,e._geoToH3=ge._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=ge._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=ge._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=ge._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=ge._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=ge._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=ge._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=ge._getPentagonIndexes,e._getRes0Indexes=ge._getRes0Indexes,e._h3Distance=ge._h3Distance,e._h3GetBaseCell=ge._h3GetBaseCell,e._h3GetFaces=ge._h3GetFaces,e._h3GetResolution=ge._h3GetResolution,e._h3IndexesAreNeighbors=ge._h3IndexesAreNeighbors,e._h3IsPentagon=ge._h3IsPentagon,e._h3IsResClassIII=ge._h3IsResClassIII,e._h3IsValid=ge._h3IsValid,e._h3Line=ge._h3Line,e._h3LineSize=ge._h3LineSize,e._h3SetToLinkedGeo=ge._h3SetToLinkedGeo,e._h3ToCenterChild=ge._h3ToCenterChild,e._h3ToChildren=ge._h3ToChildren,e._h3ToGeo=ge._h3ToGeo,e._h3ToGeoBoundary=ge._h3ToGeoBoundary,e._h3ToParent=ge._h3ToParent,e._h3UnidirectionalEdgeIsValid=ge._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=ge._hexAreaKm2,e._hexAreaM2=ge._hexAreaM2,e._hexRing=ge._hexRing,e._i64Subtract=ge._i64Subtract,e._kRing=ge._kRing,e._kRingDistances=ge._kRingDistances,e._llvm_minnum_f64=ge._llvm_minnum_f64,e._llvm_round_f64=ge._llvm_round_f64,e._malloc=ge._malloc,e._maxFaceCount=ge._maxFaceCount,e._maxH3ToChildrenSize=ge._maxH3ToChildrenSize,e._maxKringSize=ge._maxKringSize,e._maxPolyfillSize=ge._maxPolyfillSize,e._maxUncompactSize=ge._maxUncompactSize,e._memcpy=ge._memcpy,e._memset=ge._memset,e._numHexagons=ge._numHexagons,e._pentagonIndexCount=ge._pentagonIndexCount,e._pointDistKm=ge._pointDistKm,e._pointDistM=ge._pointDistM,e._pointDistRads=ge._pointDistRads,e._polyfill=ge._polyfill,e._res0IndexCount=ge._res0IndexCount,e._round=ge._round,e._sbrk=ge._sbrk,e._sizeOfCoordIJ=ge._sizeOfCoordIJ,e._sizeOfGeoBoundary=ge._sizeOfGeoBoundary,e._sizeOfGeoCoord=ge._sizeOfGeoCoord,e._sizeOfGeoPolygon=ge._sizeOfGeoPolygon,e._sizeOfGeofence=ge._sizeOfGeofence,e._sizeOfH3Index=ge._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=ge._sizeOfLinkedGeoPolygon,e._uncompact=ge._uncompact,e.establishStackSpace=ge.establishStackSpace;var $u=e.stackAlloc=ge.stackAlloc,ap=e.stackRestore=ge.stackRestore,Xu=e.stackSave=ge.stackSave;if(e.asm=ge,e.cwrap=M,e.setValue=E,e.getValue=b,e.getTempRet0=m,vt){fi(vt)||(vt=s(vt));{$r();var fc=function(J){J.byteLength&&(J=new Uint8Array(J)),se.set(J,_),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,ir()},Yu=function(){o(vt,fc,function(){throw"could not load memory initializer "+vt})},Ju=uc(vt);if(Ju)fc(Ju.buffer);else if(e.memoryInitializerRequest){var xo=function(){var J=e.memoryInitializerRequest,ae=J.response;if(J.status!==200&&J.status!==0){var me=uc(e.memoryInitializerRequestURL);if(me)ae=me.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+J.status+", retrying "+vt),Yu();return}}fc(ae)};e.memoryInitializerRequest.response?setTimeout(xo,0):e.memoryInitializerRequest.addEventListener("load",xo)}else Yu()}}var _a;rr=function J(){_a||hc(),_a||(rr=J)};function hc(J){if(on>0||(Tt(),on>0))return;function ae(){_a||(_a=!0,!x&&(Ut(),ot(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Gt()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),ae()},1)):ae()}e.run=hc;function Fi(J){throw e.onAbort&&e.onAbort(J),J+="",a(J),l(J),x=!0,"abort("+J+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Fi,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return hc(),t}(typeof Kt=="object"?Kt:{}),Ne="number",Gc=Ne,je=Ne,qe=Ne,pr=Ne,ft=Ne,i$=[["sizeOfH3Index",Ne],["sizeOfGeoCoord",Ne],["sizeOfGeoBoundary",Ne],["sizeOfGeoPolygon",Ne],["sizeOfGeofence",Ne],["sizeOfLinkedGeoPolygon",Ne],["sizeOfCoordIJ",Ne],["h3IsValid",Gc,[je,qe]],["geoToH3",je,[Ne,Ne,pr]],["h3ToGeo",null,[je,qe,ft]],["h3ToGeoBoundary",null,[je,qe,ft]],["maxKringSize",Ne,[Ne]],["kRing",null,[je,qe,Ne,ft]],["kRingDistances",null,[je,qe,Ne,ft,ft]],["hexRing",null,[je,qe,Ne,ft]],["maxPolyfillSize",Ne,[ft,pr]],["polyfill",null,[ft,pr,ft]],["h3SetToLinkedGeo",null,[ft,Ne,ft]],["destroyLinkedPolygon",null,[ft]],["compact",Ne,[ft,ft,Ne]],["uncompact",Ne,[ft,Ne,ft,Ne,pr]],["maxUncompactSize",Ne,[ft,Ne,pr]],["h3IsPentagon",Gc,[je,qe]],["h3IsResClassIII",Gc,[je,qe]],["h3GetBaseCell",Ne,[je,qe]],["h3GetResolution",Ne,[je,qe]],["maxFaceCount",Ne,[je,qe]],["h3GetFaces",null,[je,qe,ft]],["h3ToParent",je,[je,qe,pr]],["h3ToChildren",null,[je,qe,pr,ft]],["h3ToCenterChild",je,[je,qe,pr]],["maxH3ToChildrenSize",Ne,[je,qe,pr]],["h3IndexesAreNeighbors",Gc,[je,qe,je,qe]],["getH3UnidirectionalEdge",je,[je,qe,je,qe]],["getOriginH3IndexFromUnidirectionalEdge",je,[je,qe]],["getDestinationH3IndexFromUnidirectionalEdge",je,[je,qe]],["h3UnidirectionalEdgeIsValid",Gc,[je,qe]],["getH3IndexesFromUnidirectionalEdge",null,[je,qe,ft]],["getH3UnidirectionalEdgesFromHexagon",null,[je,qe,ft]],["getH3UnidirectionalEdgeBoundary",null,[je,qe,ft]],["h3Distance",Ne,[je,qe,je,qe]],["h3Line",Ne,[je,qe,je,qe,ft]],["h3LineSize",Ne,[je,qe,je,qe]],["experimentalH3ToLocalIj",Ne,[je,qe,je,qe,ft]],["experimentalLocalIjToH3",Ne,[je,qe,ft,ft]],["hexAreaM2",Ne,[pr]],["hexAreaKm2",Ne,[pr]],["edgeLengthM",Ne,[pr]],["edgeLengthKm",Ne,[pr]],["pointDistM",Ne,[ft,ft]],["pointDistKm",Ne,[ft,ft]],["pointDistRads",Ne,[ft,ft]],["cellAreaM2",Ne,[je,qe]],["cellAreaKm2",Ne,[je,qe]],["cellAreaRads2",Ne,[je,qe]],["exactEdgeLengthM",Ne,[je,qe]],["exactEdgeLengthKm",Ne,[je,qe]],["exactEdgeLengthRads",Ne,[je,qe]],["numHexagons",Ne,[pr]],["getRes0Indexes",null,[ft]],["res0IndexCount",Ne],["getPentagonIndexes",null,[Ne,ft]],["pentagonIndexCount",Ne]],Sn={};i$.forEach(function(e){Sn[e[0]]=Kt.cwrap.apply(Kt,e)});var dl=16,s$=4,Eb=4,Xl=8,o$=Sn.sizeOfH3Index(),vI=Sn.sizeOfGeoCoord(),a$=Sn.sizeOfGeoBoundary();Sn.sizeOfGeoPolygon();Sn.sizeOfGeofence();var l$=Sn.sizeOfLinkedGeoPolygon();Sn.sizeOfCoordIJ();var wb={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function c$(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var A$=/[^0-9a-fA-F]/;function ua(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||A$.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),dl),n=parseInt(t.substring(t.length-8),dl);return[n,e]}function Tb(t){if(t>=0)return t.toString(dl);t=t&2147483647;var e=_I(8,t.toString(dl)),n=(parseInt(e[0],dl)+8).toString(dl);return e=n+e.substring(1),e}function u$(t,e){return Tb(e)+_I(8,Tb(t))}function _I(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function f$(t){var e=Kt.getTempRet0();return[t,e]}function h$(t){var e=f$(t),n=e[0],r=e[1];return r?u$(n,r):null}function d$(t,e,n){Kt.HEAPU32.set(ua(t),e/s$+2*n)}function p$(t,e){for(var n=e.length,r=0;r<n;r++)d$(e[r],t,r)}function Gd(t){return C$(Kt.getValue(t,"double"))}function o_(t){return[Gd(t),Gd(t+Xl)]}function EI(t){return[Gd(t+Xl),Gd(t)]}function g$(t,e,n){for(var r=Kt.getValue(t,"i32"),i=t+Xl,s=[],o=e?EI:o_,a=0;a<r*2;a+=2)s.push(o(i+Xl*a));return n&&s.push(s[0]),s}function m$(t,e){for(var n=[],r=e?EI:o_,i,s,o,a;t;){for(n.push(i=[]),s=Kt.getValue(t,"i8*");s;){for(i.push(o=[]),a=Kt.getValue(s,"i8*");a;)o.push(r(a)),a=Kt.getValue(a+Xl*2,"i8*");e&&o.push(o[0]),s=Kt.getValue(s+Eb*2,"i8*")}t=Kt.getValue(t+Eb*2,"i8*")}return n}function y$(t){var e=ua(t),n=e[0],r=e[1];return Boolean(Sn.h3IsPentagon(n,r))}function v$(t){var e=ua(t),n=e[0],r=e[1];return Sn.h3IsValid(n,r)?Sn.h3GetResolution(n,r):-1}function _$(t,e,n){var r=Kt._malloc(vI);Kt.HEAPF64.set([t,e].map(x$),r/Xl);var i=h$(Sn.geoToH3(r,n));return Kt._free(r),i}function a_(t){var e=Kt._malloc(vI),n=ua(t),r=n[0],i=n[1];Sn.h3ToGeo(r,i,e);var s=o_(e);return Kt._free(e),s}function E$(t,e){var n=Kt._malloc(a$),r=ua(t),i=r[0],s=r[1];Sn.h3ToGeoBoundary(i,s,n);var o=g$(n,e,e);return Kt._free(n),o}function w$(t,e){if(!t||!t.length)return[];var n=t.length,r=Kt._calloc(n,o$);p$(r,t);var i=Kt._calloc(l$),s=i;Sn.h3SetToLinkedGeo(r,n,i);var o=m$(i,e);return Sn.destroyLinkedPolygon(s),Kt._free(s),Kt._free(r),o}function T$(t,e){var n=ua(t),r=n[0],i=n[1],s=ua(e),o=s[0],a=s[1];return Sn.h3Distance(r,i,o,a)}function b$(t,e){switch(c$(t),e){case wb.m:return Sn.edgeLengthM(t);case wb.km:return Sn.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function x$(t){return t*Math.PI/180}function C$(t){return t*180/Math.PI}const S$={getHexagons:{type:"accessor",value:t=>t.hexagons}};class wI extends ac{initializeState(){lc._checkH3Lib()}updateState({props:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagons){const{data:r,getHexagons:i}=e,s=[],{iterable:o,objectInfo:a}=Eo(r);for(const l of o){a.index++;const h=i(l,a),p=w$(h,!0);for(const m of p)s.push(this.getSubLayerRow({polygon:m},l,a.index))}this.setState({polygons:s})}}indexToBounds(){return{data:this.state.polygons,getPolygon:e=>e.polygon}}}T(wI,"layerName","H3ClusterLayer");T(wI,"defaultProps",S$);const P$=10;function TI(t,e){e=e===void 0?t[0][0]:e;for(const n of t){const r=n[0]-e;r>180?n[0]-=360:r<-180&&(n[0]+=360)}}function M$(t,e,n){const[r,i]=a_(t),s=e.length;TI(e,i);const o=e[0]===e[s-1]?s-1:s;for(let a=0;a<o;a++)e[a][0]=Ii(i,e[a][0],n),e[a][1]=Ii(r,e[a][1],n)}function I$(t,e,n){const r=t(e,n),[i,s]=a_(r);return[s,i]}function bb(t,e=1){const n=E$(t,!0);return e!==1?M$(t,n,e):TI(n),n}function B$(t){const e=new Float64Array(t.length*2);let n=0;for(const r of t)e[n++]=r[0],e[n++]=r[1];return e}function L$(t,e){let n;return t==null?n=e:typeof t=="object"?n={...t,coverage:e}:n={getHexagon:t,coverage:e},n}const R$={...oc.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class lc extends Ss{constructor(...e){super(...e),T(this,"state",void 0)}initializeState(){lc._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:e}){return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}updateState({props:e,changeFlags:n}){if(e.highPrecision!==!0&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){const r=this._calculateH3DataProps();this.setState(r)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,n=!1,r=!1;const{iterable:i,objectInfo:s}=Eo(this.props.data);for(const o of i){s.index++;const a=this.props.getHexagon(o,s),l=v$(a);if(e<0){if(e=l,!this.props.highPrecision)break}else if(e!==l){r=!0;break}if(y$(a)){n=!0;break}}return{resolution:e,edgeLengthKM:e>=0?b$(e,"km"):0,hasMultipleRes:r,hasPentagon:n}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){const{resolution:e,hasPentagon:n,hasMultipleRes:r}=this.state,{viewport:i}=this.context;return Boolean(i==null?void 0:i.resolution)||r||n||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;const{resolution:n,edgeLengthKM:r,centerHex:i}=this.state;if(n<0)return;const s=this.props.centerHexagon||_$(e.latitude,e.longitude,n);if(i===s)return;if(i){const _=T$(i,s);if(_>=0&&_*r<P$)return}const{unitsPerMeter:o}=e.distanceScales;let a=bb(s);const[l,h]=a_(s),[p,m]=e.projectFlat([h,l]);a=a.map(_=>{const E=e.projectFlat(_);return[(E[0]-p)/o[0],(E[1]-m)/o[1]]}),this.setState({centerHex:s,vertices:a})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:e,material:n,coverage:r,extruded:i,wireframe:s,stroked:o,filled:a,lineWidthUnits:l,lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:m,getFillColor:_,getElevation:E,getLineColor:b,getLineWidth:x,transitions:I,updateTriggers:S}=this.props;return{elevationScale:e,extruded:i,coverage:r,wireframe:s,stroked:o,filled:a,lineWidthUnits:l,lineWidthScale:h,lineWidthMinPixels:p,lineWidthMaxPixels:m,material:n,getElevation:E,getFillColor:_,getLineColor:b,getLineWidth:x,transitions:I,updateTriggers:{getFillColor:S.getFillColor,getElevation:S.getElevation,getLineColor:S.getLineColor,getLineWidth:S.getLineWidth}}}_renderPolygonLayer(){const{data:e,getHexagon:n,updateTriggers:r,coverage:i}=this.props,s=this.getSubLayerClass("hexagon-cell-hifi",oc),o=this._getForwardProps();return o.updateTriggers.getPolygon=L$(r.getHexagon,i),new s(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(a,l)=>{const h=n(a,l);return B$(bb(h,i))}})}_renderColumnLayer(){const{data:e,getHexagon:n,updateTriggers:r}=this.props,i=this.getSubLayerClass("hexagon-cell",P0),s=this._getForwardProps();return s.updateTriggers.getPosition=r.getHexagon,new i(s,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:s.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:I$.bind(null,n)})}}T(lc,"defaultProps",R$);T(lc,"layerName","H3HexagonLayer");T(lc,"_checkH3Lib",()=>{});const Rg=Math.PI/180,Zf=new Float32Array(16),xb=new Float32Array(12);function Cb(t,e,n){const r=e[0]*Rg,i=e[1]*Rg,s=e[2]*Rg,o=Math.sin(s),a=Math.sin(r),l=Math.sin(i),h=Math.cos(s),p=Math.cos(r),m=Math.cos(i),_=n[0],E=n[1],b=n[2];t[0]=_*m*p,t[1]=_*l*p,t[2]=_*-a,t[3]=E*(-l*h+m*a*o),t[4]=E*(m*h+l*a*o),t[5]=E*p*o,t[6]=b*(l*o+m*a*h),t[7]=b*(-m*o+l*a*h),t[8]=b*p*h}function Sb(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const bI={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,l=Array.isArray(a),h=l&&a.length===16,p=Array.isArray(s),m=Array.isArray(i),_=Array.isArray(o),E=h||!l&&Boolean(a(r[0]));E?t.constant=h:t.constant=m&&p&&_;const b=t.value;if(t.constant){let x;E?(Zf.set(a),x=Sb(Zf)):(x=xb,Cb(x,i,s),x.set(o,9)),t.value=new Float32Array(x)}else{let x=e*t.size;const{iterable:I,objectInfo:S}=Eo(r,e,n);for(const P of I){S.index++;let M;if(E)Zf.set(h?a:a(P,S)),M=Sb(Zf);else{M=xb;const O=m?i:i(P,S),N=p?s:s(P,S);Cb(M,O,N),M.set(_?o:o(P,S),9)}b[x++]=M[0],b[x++]=M[1],b[x++]=M[2],b[x++]=M[3],b[x++]=M[4],b[x++]=M[5],b[x++]=M[6],b[x++]=M[7],b[x++]=M[8],b[x++]=M[9],b[x++]=M[10],b[x++]=M[11]}}}};function xI(t,e){return e===$e.CARTESIAN||e===$e.METER_OFFSETS||e===$e.DEFAULT&&!t.isGeospatial}const O$=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs

// Scale the model
uniform float sizeScale;
uniform bool composeModelMatrix;

// Primitive attributes
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;

// Instance attributes
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;

// Outputs to fragment shader
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    // using instancePositions as world coordinates
    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth
    // call project_normal before setting position to avoid rotation
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,F$=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {

// NOTE(Tarek): This is necessary because
// headless.gl reports the extension as
// available but does not support it in
// the shader.
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function Pb(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),Ve.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function D$(t,e){if(t.attributes)return Pb(t.attributes,e),t instanceof Ar?t:new Ar(t);if(t.positions||t.POSITION)return Pb(t,e),new Ar({attributes:t});throw Error("Invalid mesh")}const k$=[0,0,0,255],N$={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:k$},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};class cu extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){const e=!nt(this.context.gl),n={};return y0(this.context.gl,Bt.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:O$,fs:F$,modules:[ci,JP,Ai],transpileToGLSL100:e,defines:n})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:bI}),this.setState({emptyTexture:new Hn(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var s;if((s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const o=n.mesh.attributes||n.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||xI(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new tr(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:D$(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:Boolean(r)}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:Boolean(e)})}}T(cu,"defaultProps",N$);T(cu,"layerName","SimpleMeshLayer");class Bl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n}=e;this.id=n||Ri(this.constructor.name),this.display=!0,this.position=new ee,this.rotation=new ee,this.scale=new ee(1,1,1),this.matrix=new Ye,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}setPosition(e){return _e(e.length===3,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return _e(e.length===3,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return _e(e.length===3,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:n,rotation:r,scale:i,update:s=!0}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,n=this.rotation,r=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(r),this}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:n,rotation:r,scale:i}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(e,n){_e(e),n=n||this.matrix;const r=new Ye(e).multiplyRight(n),i=r.invert(),s=i.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:r,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class CA extends Bl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:n=[]}=e;Le.assert(n.every(r=>r instanceof Bl),"every child must an instance of ScenegraphNode"),super(e),this.children=n}add(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(e){const n=this.children,r=n.indexOf(e);return r>-1&&n.splice(r,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e){let{worldMatrix:n=new Ye}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new Ye(n).multiplyRight(this.matrix);for(const i of this.children)i instanceof CA?i.traverse(e,{worldMatrix:r}):e(i,{worldMatrix:r})}}const U$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},G$={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Mb(t){if(!t._animation){const e=G$[t.componentType],n=U$[t.type],r=n*t.count,{buffer:i,byteOffset:s}=t.bufferView.data,o=new e(i,s+(t.byteOffset||0),r);if(n===1)t._animation=Array.from(o);else{const a=[];for(let l=0;l<o.length;l+=n)a.push(Array.from(o.slice(l,l+n)));t._animation=a}}return t._animation}const z$=new Ye;function V$(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=z$.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}const Og=new KA;function H$(t,e,n,r,i){if(e==="rotation"){Og.slerp({start:n,target:r,ratio:i});for(let s=0;s<Og.length;s++)t[e][s]=Og[s]}else for(let s=0;s<n.length;s++)t[e][s]=i*r[s]+(1-i)*n[s]}function j$(t,e,n){let{p0:r,outTangent0:i,inTangent1:s,p1:o,tDiff:a,ratio:l}=n;for(let h=0;h<t[e].length;h++){const p=i[h]*a,m=s[h]*a;t[e][h]=(2*Math.pow(l,3)-3*Math.pow(l,2)+1)*r[h]+(Math.pow(l,3)-2*Math.pow(l,2)+l)*p+(-2*Math.pow(l,3)+3*Math.pow(l,2))*o[h]+(Math.pow(l,3)-Math.pow(l,2))*m}}function W$(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}function Q$(t,e,n,r){let{input:i,interpolation:s,output:o}=e;const a=i[i.length-1],l=t%a,h=i.findIndex(E=>E>=l),p=Math.max(0,h-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:Le.warn("Bad animation path ".concat(r))()}_e(n[r].length===o[p].length);const m=i[p],_=i[h];switch(s){case"STEP":W$(n,r,o[p]);break;case"LINEAR":if(_>m){const E=(l-m)/(_-m);H$(n,r,o[p],o[h],E)}break;case"CUBICSPLINE":if(_>m){const E=(l-m)/(_-m),b=_-m,x=o[3*p+1],I=o[3*p+2],S=o[3*h+0],P=o[3*h+1];j$(n,r,{p0:x,outTangent0:I,inTangent1:S,p1:P,tDiff:b,ratio:E})}break;default:Le.warn("Interpolation ".concat(s," not supported"))();break}}class $${constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const r=(e/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:s,target:o,path:a}=i;Q$(r,s,o,a),V$(o,o._node)})}}class X${constructor(e){this.animations=e.animations.map((n,r)=>{const i=n.name||"Animation-".concat(r),s=n.samplers.map(a=>{let{input:l,interpolation:h="LINEAR",output:p}=a;return{input:Mb(e.accessors[l]),interpolation:h,output:Mb(e.accessors[p])}}),o=n.channels.map(a=>{let{sampler:l,target:h}=a;return{sampler:s[l],target:e.nodes[h.node],path:h.path}});return new $$({name:i,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(n=>n.animate(e))}getAnimations(){return this.animations}}class Y$ extends Bl{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(n),this.onBeforeRender=null,this.AfterRender=null,e instanceof tr?(this.model=e,this._setModelNodeProps(n)):this.model=new tr(e,n),this.managedResources=n.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class CI{constructor(e,n){let{attributes:r,material:i,pbrDebug:s,imageBasedLightingEnvironment:o,lights:a,useTangents:l}=n;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},y0(e,Bt.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&l,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,n){e&&(this.defines[n]=1)}parseTexture(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const l=new Hn(this.gl,{id:e.name||e.id,parameters:{...i,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...o});this.uniforms[n]=l,this.defineIfPresent(r,r),this.generatedTextures.push(l)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:n=1,roughnessFactor:r=1}=e;this.uniforms.u_MetallicRoughnessValues=[n,r]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:n=1}=e.normalTexture;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:n=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=n}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode==="MASK"){const{alphaCutoff:n=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=n}else e.alphaMode==="BLEND"&&(Le.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}const J$=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,K$=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function Ib(t,e){return nt(t)?`#version 300 es
`.concat(e):e}function Z$(t,e){const{id:n,drawMode:r,vertexCount:i,attributes:s,modelOptions:o}=e,a=new CI(t,e);Le.info(4,"createGLTFModel defines: ",a.defines)();const l=[];l.push(...a.generatedTextures),l.push(...Object.values(s).map(p=>p.buffer));const h=new Y$(t,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[Fv],defines:a.defines,parameters:a.parameters,vs:Ib(t,J$),fs:Ib(t,K$),managedResources:l},o));return h.setProps({attributes:s}),h.setUniforms(a.uniforms),h}const q$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},eX={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class tX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.options=Object.assign({},eX,n)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(r=>this.createScene(r))}createAnimator(){return Array.isArray(this.gltf.animations)?new X$(this.gltf):null}createScene(e){const r=(e.nodes||[]).map(s=>this.createNode(s));return new CA({id:e.name||e.id,children:r})}createNode(e){if(!e._node){const r=(e.children||[]).map(s=>this.createNode(s));e.mesh&&r.push(this.createMesh(e.mesh));const i=new CA({id:e.name||e.id,children:r});if(e.matrix)i.setMatrix(e.matrix);else{if(i.matrix.identity(),e.translation&&i.matrix.translate(e.translation),e.rotation){const s=new Ye().fromQuaternion(e.rotation);i.matrix.multiplyRight(s)}e.scale&&i.matrix.scale(e.scale)}e._node=i}return e._node}createMesh(e){if(!e._mesh){const r=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),i=new CA({id:e.name||e.id,children:r});e._mesh=i}return e._mesh}getVertexCount(e){Le.warn("getVertexCount() not found")()}createPrimitive(e,n,r){return Z$(this.gl,Object.assign({id:e.name||"".concat(r.name||r.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,n){const r={};return Object.keys(e).forEach(i=>{r[i]=this.createAccessor(e[i],this.createBuffer(e[i],this.gl.ARRAY_BUFFER))}),n&&(r.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),Le.info(4,"glTF Attributes",{attributes:e,indices:n,generated:r})(),r}createBuffer(e,n){e.bufferView||(e.bufferView={});const{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[n]||(r.lumaBuffers[n]=new St(this.gl,{id:"from-".concat(r.id),data:r.data||e.value,target:n})),r.lumaBuffers[n]}createAccessor(e,n){return new vr({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:q$[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function nX(t,e,n){const r=new tX(t,n),i=r.instantiate(e),s=r.createAnimator();return{scenes:i,animator:s}}const rX="3.2.9",iX="3.2.9",SI="3.2.9",sX="https://unpkg.com/@loaders.gl/textures@".concat(SI,"/dist/libs/basis_encoder.wasm"),oX="https://unpkg.com/@loaders.gl/textures@".concat(SI,"/dist/libs/basis_encoder.js");let Fg;async function Bb(t){const e=t.modules||{};return e.basis?e.basis:(Fg=Fg||aX(t),await Fg)}async function aX(t){let e=null,n=null;return[e,n]=await Promise.all([await Ko("basis_transcoder.js","textures",t),await Ko("basis_transcoder.wasm","textures",t)]),e=e||globalThis.BASIS,await lX(e,n)}function lX(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{const{BasisFile:s,initializeBasis:o}=i;o(),r({BasisFile:s})})})}let Dg;async function Lb(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(Dg=Dg||cX(t),await Dg)}async function cX(t){let e=null,n=null;return[e,n]=await Promise.all([await Ko(oX,"textures",t),await Ko(sX,"textures",t)]),e=e||globalThis.BASIS,await AX(e,n)}function AX(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{const{BasisFile:s,KTX2File:o,initializeBasis:a,BasisEncoder:l}=i;a(),r({BasisFile:s,KTX2File:o,BasisEncoder:l})})})}const Da={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},uX=["","WEBKIT_","MOZ_"],Rb={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let qf=null;function fX(t){if(!qf){t=t||hX()||void 0,qf=new Set;for(const e of uX)for(const n in Rb)if(t&&t.getExtension("".concat(e).concat(n))){const r=Rb[n];qf.add(r)}}return qf}function hX(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var Ob,Fb,Db,kb,Nb,Ub,Gb,zb;(function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"})(Ob||(Ob={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(Fb||(Fb={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(Db||(Db={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(kb||(kb={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(Nb||(Nb={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(Ub||(Ub={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(Gb||(Gb={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(zb||(zb={}));const Ir=[171,75,84,88,32,50,48,187,13,10,26,10];function dX(t){const e=new Uint8Array(t);return!(e.byteLength<Ir.length||e[0]!==Ir[0]||e[1]!==Ir[1]||e[2]!==Ir[2]||e[3]!==Ir[3]||e[4]!==Ir[4]||e[5]!==Ir[5]||e[6]!==Ir[6]||e[7]!==Ir[7]||e[8]!==Ir[8]||e[9]!==Ir[9]||e[10]!==Ir[10]||e[11]!==Ir[11])}const pX={etc1:{basisFormat:0,compressed:!0,format:Da.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Da.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Da.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Da.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Da.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Da.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function gX(t,e){if(e.basis.containerFormat==="auto"){if(dX(t)){const r=await Lb(e);return Vb(r.KTX2File,t,e)}const{BasisFile:n}=await Bb(e);return kg(n,t,e)}switch(e.basis.module){case"encoder":const n=await Lb(e);switch(e.basis.containerFormat){case"ktx2":return Vb(n.KTX2File,t,e);case"basis":default:return kg(n.BasisFile,t,e)}case"transcoder":default:const{BasisFile:r}=await Bb(e);return kg(r,t,e)}}function kg(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const i=r.getNumImages(),s=[];for(let o=0;o<i;o++){const a=r.getNumLevels(o),l=[];for(let h=0;h<a;h++)l.push(mX(r,o,h,n));s.push(l)}return s}finally{r.close(),r.delete()}}function mX(t,e,n,r){const i=t.getImageWidth(e,n),s=t.getImageHeight(e,n),o=t.getHasAlpha(),{compressed:a,format:l,basisFormat:h}=PI(r,o),p=t.getImageTranscodedSizeInBytes(e,n,h),m=new Uint8Array(p);if(!t.transcodeImage(m,e,n,h,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:m,compressed:a,format:l,hasAlpha:o}}function Vb(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=r.getLevels(),s=[];for(let o=0;o<i;o++){s.push(yX(r,o,n));break}return[s]}finally{r.close(),r.delete()}}function yX(t,e,n){const{alphaFlag:r,height:i,width:s}=t.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:l}=PI(n,r),h=t.getImageTranscodedSizeInBytes(e,0,0,l),p=new Uint8Array(h);if(!t.transcodeImage(p,e,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:p,compressed:o,hasAlpha:r,format:a}}function PI(t,e){let n=t&&t.basis&&t.basis.format;return n==="auto"&&(n=MI()),typeof n=="object"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),pX[n]}function MI(){const t=fX();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const vX={name:"Basis",id:"basis",module:"textures",version:iX,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},_X={...vX,parse:gX};function Dr(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function II(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const r=e.baseUri||e.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return r.substr(0,r.lastIndexOf("/")+1)+t}function EX(t,e,n){const r=t.bufferViews[n];Dr(r);const i=r.buffer,s=e[i];Dr(s);const o=(r.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,o,r.byteLength)}const Hb=["SCALAR","VEC2","VEC3","VEC4"],wX=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],TX=new Map(wX),bX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},xX={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},CX={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function BI(t){return Hb[t-1]||Hb[0]}function LI(t){const e=TX.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function RI(t,e){const n=CX[t.componentType],r=bX[t.type],i=xX[t.componentType],s=t.count*r,o=t.count*r*i;return Dr(o>=0&&o<=e.byteLength),{ArrayType:n,length:s,byteLength:o}}const SX={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class ui{constructor(e){T(this,"gltf",void 0),T(this,"sourceBuffers",void 0),T(this,"byteLength",void 0),this.gltf=e||{json:{...SX},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){const n=this.getUsedExtensions().find(i=>i===e),r=this.json.extensions||{};return n?r[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(n,"]"));return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);const n=e.buffer,r=this.gltf.buffers[n];Dr(r);const i=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,i,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,{ArrayType:s,length:o}=RI(e,n),a=n.byteOffset+e.byteOffset;return new s(i,a,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,s=n.byteOffset||0;return new Uint8Array(i,s,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,r){return e.extensions=e.extensions||{},e.extensions[n]=r,this.registerUsedExtension(n),this}setObjectExtension(e,n,r){const i=e.extensions||{};i[n]=r}removeObjectExtension(e,n){const r=e.extensions||{},i=r[n];return delete r[n],i}addExtension(e,n={}){return Dr(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e,n={}){return Dr(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){const{meshIndex:n,matrix:r}=e;this.json.nodes=this.json.nodes||[];const i={mesh:n};return r&&(i.matrix=r),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){const{attributes:n,indices:r,material:i,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(n),mode:s}]};if(r){const l=this._addIndices(r);a.primitives[0].indices=l}return Number.isFinite(i)&&(a.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,n){const r=hv(e),i=n||(r==null?void 0:r.mimeType),o={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const n=e.byteLength;Dr(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const r={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=Tu(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}addAccessor(e,n){const r={bufferView:e,type:BI(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e,n={size:3}){const r=this.addBufferView(e);let i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,n.size));const s={size:n.size,componentType:LI(e),count:Math.round(e.length/n.size),min:i.min,max:i.max};return this.addAccessor(r,Object.assign(s,n))}addTexture(e){const{imageIndex:n}=e,r={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];const r=this.byteLength,i=new ArrayBuffer(r),s=new Uint8Array(i);let o=0;for(const a of this.sourceBuffers||[])o=p4(a,s,o);(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(e,n){let r=!0;for(;r;){const i=e.indexOf(n);i>-1?e.splice(i,1):r=!1}}_addAttributes(e={}){const n={};for(const r in e){const i=e[r],s=this._getGltfAttributeName(r),o=this.addBinaryBuffer(i.value,i);n[s]=o}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){const r={min:null,max:null};if(e.length<n)return r;r.min=[],r.max=[];const i=e.subarray(0,n);for(const s of i)r.min.push(s),r.max.push(s);for(let s=n;s<e.length;s+=n)for(let o=0;o<n;o++)r.min[0+o]=Math.min(r.min[0+o],e[s+o]),r.max[0+o]=Math.max(r.max[0+o],e[s+o]);return r}}const PX="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",MX="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",IX=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),BX=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),LX={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},RX={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function OX(t,e,n,r,i,s="NONE"){const o=await FX();NX(o,o.exports[RX[i]],t,e,n,r,o.exports[LX[s||"NONE"]])}let Ng;async function FX(){return Ng||(Ng=DX()),Ng}async function DX(){let t=PX;WebAssembly.validate(IX)&&(t=MX,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(kX(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function kX(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){const i=t.charCodeAt(r);e[r]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?BX[e[r]]:(e[r]-60)*64+e[++r];return e.buffer.slice(0,n)}function NX(t,e,n,r,i,s,o){const a=t.exports.sbrk,l=r+3&-4,h=a(l*i),p=a(s.length),m=new Uint8Array(t.exports.memory.buffer);m.set(s,p);const _=e(h,r,i,p,s.length);if(_===0&&o&&o(h,l,i),n.set(m.subarray(h,h+r*i)),a(h-a(0)),_!==0)throw new Error("Malformed buffer data: ".concat(_))}const l_="EXT_meshopt_compression",UX=l_;async function GX(t,e){var n;const r=new ui(t);if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const i=[];for(const s of t.json.bufferViews||[])i.push(zX(r,s));await Promise.all(i),r.removeExtension(l_)}async function zX(t,e){const n=t.getObjectExtension(e,l_);if(n){const{byteOffset:r=0,byteLength:i=0,byteStride:s,count:o,mode:a,filter:l="NONE",buffer:h}=n,p=t.gltf.buffers[h],m=new Uint8Array(p.arrayBuffer,p.byteOffset+r,i),_=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return await OX(_,o,s,m,a,l),_}return null}const VX=Object.freeze(Object.defineProperty({__proto__:null,name:UX,decode:GX},Symbol.toStringTag,{value:"Module"})),Xa="EXT_texture_webp",HX=Xa;function jX(t,e){const n=new ui(t);if(!oN("image/webp")){if(n.getRequiredExtensions().includes(Xa))throw new Error("gltf: Required extension ".concat(Xa," not supported by browser"));return}const{json:r}=n;for(const i of r.textures||[]){const s=n.getObjectExtension(i,Xa);s&&(i.source=s.source),n.removeObjectExtension(i,Xa)}n.removeExtension(Xa)}const WX=Object.freeze(Object.defineProperty({__proto__:null,name:HX,preprocess:jX},Symbol.toStringTag,{value:"Module"})),zh="KHR_texture_basisu",QX=zh;function $X(t,e){const n=new ui(t),{json:r}=n;for(const i of r.textures||[]){const s=n.getObjectExtension(i,zh);s&&(i.source=s.source),n.removeObjectExtension(i,zh)}n.removeExtension(zh)}const XX=Object.freeze(Object.defineProperty({__proto__:null,name:QX,preprocess:$X},Symbol.toStringTag,{value:"Module"})),YX="3.2.9",JX={draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},KX={name:"Draco",id:"draco",module:"draco",shapes:["mesh"],version:YX,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:JX};function c_(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;const a=t.POSITION?t.POSITION.value:[],l=a&&a.length;for(let h=0;h<l;h+=3){const p=a[h],m=a[h+1],_=a[h+2];e=p<e?p:e,n=m<n?m:n,r=_<r?_:r,i=p>i?p:i,s=m>s?m:s,o=_>o?_:o}return[[e,n,r],[i,s,o]]}function ZX(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class pl{constructor(e,n){T(this,"fields",void 0),T(this,"metadata",void 0),ZX(Array.isArray(e)),qX(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(...e){const n=Object.create(null);for(const i of e)n[i]=!0;const r=this.fields.filter(i=>n[i.name]);return new pl(r,this.metadata)}selectAt(...e){const n=e.map(r=>this.fields[r]).filter(Boolean);return new pl(n,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof pl){const o=e;n=o.fields,r=jb(jb(new Map,this.metadata),o.metadata)}else n=e;const i=Object.create(null);for(const o of this.fields)i[o.name]=o;for(const o of n)i[o.name]=o;const s=Object.values(i);return new pl(s,r)}}function qX(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function jb(t,e){return new Map([...t||new Map,...e||new Map])}class zd{constructor(e,n,r=!1,i=new Map){T(this,"name",void 0),T(this,"type",void 0),T(this,"nullable",void 0),T(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new zd(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Yt;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"})(Yt||(Yt={}));let OI,FI,DI;class A_{static isNull(e){return e&&e.typeId===Yt.Null}static isInt(e){return e&&e.typeId===Yt.Int}static isFloat(e){return e&&e.typeId===Yt.Float}static isBinary(e){return e&&e.typeId===Yt.Binary}static isUtf8(e){return e&&e.typeId===Yt.Utf8}static isBool(e){return e&&e.typeId===Yt.Bool}static isDecimal(e){return e&&e.typeId===Yt.Decimal}static isDate(e){return e&&e.typeId===Yt.Date}static isTime(e){return e&&e.typeId===Yt.Time}static isTimestamp(e){return e&&e.typeId===Yt.Timestamp}static isInterval(e){return e&&e.typeId===Yt.Interval}static isList(e){return e&&e.typeId===Yt.List}static isStruct(e){return e&&e.typeId===Yt.Struct}static isUnion(e){return e&&e.typeId===Yt.Union}static isFixedSizeBinary(e){return e&&e.typeId===Yt.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Yt.FixedSizeList}static isMap(e){return e&&e.typeId===Yt.Map}static isDictionary(e){return e&&e.typeId===Yt.Dictionary}get typeId(){return Yt.NONE}compareTo(e){return this===e}}OI=Symbol.toStringTag;class cc extends A_{constructor(e,n){super(),T(this,"isSigned",void 0),T(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Yt.Int}get[OI](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class eY extends cc{constructor(){super(!0,8)}}class tY extends cc{constructor(){super(!0,16)}}class nY extends cc{constructor(){super(!0,32)}}class rY extends cc{constructor(){super(!1,8)}}class iY extends cc{constructor(){super(!1,16)}}class sY extends cc{constructor(){super(!1,32)}}const kI={HALF:16,SINGLE:32,DOUBLE:64};FI=Symbol.toStringTag;class NI extends A_{constructor(e){super(),T(this,"precision",void 0),this.precision=e}get typeId(){return Yt.Float}get[FI](){return"Float"}toString(){return"Float".concat(this.precision)}}class oY extends NI{constructor(){super(kI.SINGLE)}}class aY extends NI{constructor(){super(kI.DOUBLE)}}DI=Symbol.toStringTag;class lY extends A_{constructor(e,n){super(),T(this,"listSize",void 0),T(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Yt.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[DI](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function cY(t){switch(t.constructor){case Int8Array:return new eY;case Uint8Array:return new rY;case Int16Array:return new tY;case Uint16Array:return new iY;case Int32Array:return new nY;case Uint32Array:return new sY;case Float32Array:return new oY;case Float64Array:return new aY;default:throw new Error("array type not supported")}}function AY(t,e,n){const r=cY(e.value),i=n||uY(e);return new zd(t,new lY(e.size,new zd("value",r)),!1,i)}function uY(t){const e=new Map;return"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&e.set("normalized",t.normalized.toString()),e}function fY(t,e,n){const r=UI(e.metadata),i=[],s=hY(e.attributes);for(const o in t){const a=t[o],l=Wb(o,a,s[o]);i.push(l)}if(n){const o=Wb("indices",n);i.push(o)}return new pl(i,r)}function hY(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}function Wb(t,e,n){const r=n?UI(n.metadata):void 0;return AY(t,e,r)}function UI(t){const e=new Map;for(const n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}const Qb={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},dY={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},pY=4;class gY{constructor(e){T(this,"draco",void 0),T(this,"decoder",void 0),T(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,n={}){const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);const i=this.decoder.GetEncodedGeometryType(r),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(i){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(r,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(r,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const _="DRACO decompression failed: ".concat(o.error_msg());throw new Error(_)}const a=this._getDracoLoaderData(s,i,n),l=this._getMeshData(s,a,n),h=c_(l.attributes),p=fY(l.attributes,a,l.indices);return{loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:h},...l,schema:p}}finally{this.draco.destroy(r),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,n,r){const i=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,r);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(e,n){const r={};for(let i=0;i<e.num_attributes();i++){const s=this.decoder.GetAttribute(e,i),o=this._getAttributeMetadata(e,i);r[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:o};const a=this._getQuantizationTransform(s,n);a&&(r[s.unique_id()].quantization_transform=a);const l=this._getOctahedronTransform(s,n);l&&(r[s.unique_id()].octahedron_transform=l)}return r}_getMeshData(e,n,r){const i=this._getMeshAttributes(n,e,r);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(r.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(e,n,r){const i={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,r);s.name=o;const{value:a,size:l}=this._getAttributeValues(n,s);i[o]={value:a,size:l,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return i}_getTriangleListIndices(e){const r=e.num_faces()*3,i=r*pY,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,r).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),vY(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){const r=dY[n.data_type],i=n.num_components,o=e.num_points()*i,a=o*r.BYTES_PER_ELEMENT,l=mY(this.draco,r);let h;const p=this.draco._malloc(a);try{const m=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,m,l,a,p),h=new r(this.draco.HEAPF32.buffer,p,o).slice()}finally{this.draco._free(p)}return{value:h,size:i}}_deduceAttributeName(e,n){const r=e.unique_id;for(const[o,a]of Object.entries(n.extraAttributes||{}))if(a===r)return o;const i=e.attribute_type;for(const o in Qb)if(this.draco[o]===i)return Qb[o];const s=n.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(r)}_getTopLevelMetadata(e){const n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){const r=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const n={},r=this.metadataQuerier.NumEntries(e);for(let i=0;i<r;i++){const s=this.metadataQuerier.GetEntryName(e,i);n[s]=this._getDracoMetadataField(e,s)}return n}_getDracoMetadataField(e,n){const r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,r);const i=yY(r);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:i}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){const{quantizedAttributes:n=[],octahedronAttributes:r=[]}=e,i=[...n,...r];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,n){const{quantizedAttributes:r=[]}=n,i=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(i)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,n){const{octahedronAttributes:r=[]}=n,i=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(i)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}function mY(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function yY(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}function vY(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}const u_="1.4.1",_Y="https://www.gstatic.com/draco/versioned/decoders/".concat(u_,"/draco_decoder.js"),EY="https://www.gstatic.com/draco/versioned/decoders/".concat(u_,"/draco_wasm_wrapper.js"),wY="https://www.gstatic.com/draco/versioned/decoders/".concat(u_,"/draco_decoder.wasm");let zc;async function TY(t){const e=t.modules||{};return e.draco3d?zc=zc||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):zc=zc||bY(t),await zc}async function bY(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await Ko(_Y,"draco",t);break;case"wasm":default:[e,n]=await Promise.all([await Ko(EY,"draco",t),await Ko(wY,"draco",t)])}return e=e||globalThis.DracoDecoderModule,await xY(e,n)}function xY(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t({...n,onModuleLoaded:i=>r({draco:i})})})}const GI={...KX,parse:CY};async function CY(t,e){const{draco:n}=await TY(e),r=new gY(n);try{return r.parseSync(t,e==null?void 0:e.draco)}finally{r.destroy()}}function SY(t){const e={};for(const n in t){const r=t[n];if(n!=="indices"){const i=zI(r);e[n]=i}}return e}function zI(t){const{buffer:e,size:n,count:r}=PY(t);return{value:e,size:n,byteOffset:0,count:r,type:BI(n),componentType:LI(e)}}function PY(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=MY(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}function MY(t,e,n=!1){return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}const fa="KHR_draco_mesh_compression",IY=fa;function BY(t,e,n){const r=new ui(t);for(const i of VI(r))r.getObjectExtension(i,fa)}async function LY(t,e,n){var r;if(!(e!=null&&(r=e.gltf)!==null&&r!==void 0&&r.decompressMeshes))return;const i=new ui(t),s=[];for(const o of VI(i))i.getObjectExtension(o,fa)&&s.push(OY(i,o,e,n));await Promise.all(s),i.removeExtension(fa)}function RY(t,e={}){const n=new ui(t);for(const r of n.json.meshes||[])FY(r),n.addRequiredExtension(fa)}async function OY(t,e,n,r){const i=t.getObjectExtension(e,fa);if(!i)return;const s=t.getTypedArrayForBufferView(i.bufferView),o=lv(s.buffer,s.byteOffset),{parse:a}=r,l={...n};delete l["3d-tiles"];const h=await a(o,GI,l,r),p=SY(h.attributes);for(const[m,_]of Object.entries(p))if(m in e.attributes){const E=e.attributes[m],b=t.getAccessor(E);b!=null&&b.min&&b!==null&&b!==void 0&&b.max&&(_.min=b.min,_.max=b.max)}e.attributes=p,h.indices&&(e.indices=zI(h.indices)),DY(e)}function FY(t,e,n=4,r,i){var s;if(!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=r.DracoWriter.encodeSync({attributes:t}),a=i==null||(s=i.parseSync)===null||s===void 0?void 0:s.call(i,{attributes:t}),l=r._addFauxAttributes(a.attributes),h=r.addBufferView(o);return{primitives:[{attributes:l,mode:n,extensions:{[fa]:{bufferView:h,attributes:l}}}]}}function DY(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*VI(t){for(const e of t.json.meshes||[])for(const n of e.primitives)yield n}const kY=Object.freeze(Object.defineProperty({__proto__:null,name:IY,preprocess:BY,decode:LY,encode:RY},Symbol.toStringTag,{value:"Module"})),Wo="KHR_lights_punctual",NY=Wo;async function UY(t){const e=new ui(t),{json:n}=e,r=e.getExtension(Wo);r&&(e.json.lights=r.lights,e.removeExtension(Wo));for(const i of n.nodes||[]){const s=e.getObjectExtension(i,Wo);s&&(i.light=s.light),e.removeObjectExtension(i,Wo)}}async function GY(t){const e=new ui(t),{json:n}=e;if(n.lights){const r=e.addExtension(Wo);Dr(!r.lights),r.lights=n.lights,delete n.lights}if(e.json.lights){for(const r of e.json.lights){const i=r.node;e.addObjectExtension(i,Wo,r)}delete e.json.lights}}const zY=Object.freeze(Object.defineProperty({__proto__:null,name:NY,decode:UY,encode:GY},Symbol.toStringTag,{value:"Module"})),Au="KHR_materials_unlit",VY=Au;async function HY(t){const e=new ui(t),{json:n}=e;e.removeExtension(Au);for(const r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,Au)}function jY(t){const e=new ui(t),{json:n}=e;if(e.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,Au,{}),e.addExtension(Au))}const WY=Object.freeze(Object.defineProperty({__proto__:null,name:VY,decode:HY,encode:jY},Symbol.toStringTag,{value:"Module"})),oA="KHR_techniques_webgl",QY=oA;async function $Y(t){const e=new ui(t),{json:n}=e,r=e.getExtension(oA);if(r){const i=YY(r,e);for(const s of n.materials||[]){const o=e.getObjectExtension(s,oA);o&&(s.technique=Object.assign({},o,i[o.technique]),s.technique.values=JY(s.technique,e)),e.removeObjectExtension(s,oA)}e.removeExtension(oA)}}async function XY(t,e){}function YY(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,s=new TextDecoder;return r.forEach(o=>{if(Number.isFinite(o.bufferView))o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(o=>{o.fragmentShader=r[o.fragmentShader],o.vertexShader=r[o.vertexShader]}),i.forEach(o=>{o.program=n[o.program]}),i}function JY(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(r=>{t.uniforms[r].value&&!(r in n)&&(n[r]=t.uniforms[r].value)}),Object.keys(n).forEach(r=>{typeof n[r]=="object"&&n[r].index!==void 0&&(n[r].texture=e.getTexture(n[r].index))}),n}const KY=Object.freeze(Object.defineProperty({__proto__:null,name:QY,decode:$Y,encode:XY},Symbol.toStringTag,{value:"Module"})),HI=[VX,WX,XX,kY,zY,WY,KY];function ZY(t,e={},n){const r=HI.filter(s=>jI(s.name,e));for(const s of r){var i;(i=s.preprocess)===null||i===void 0||i.call(s,t,e,n)}}async function qY(t,e={},n){const r=HI.filter(s=>jI(s.name,e));for(const s of r){var i;await((i=s.decode)===null||i===void 0?void 0:i.call(s,t,e,n))}}function jI(t,e){var n;const r=(e==null||(n=e.gltf)===null||n===void 0?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}const Ug="KHR_binary_glTF";function eJ(t){const e=new ui(t),{json:n}=e;for(const r of n.images||[]){const i=e.getObjectExtension(r,Ug);i&&Object.assign(r,i),e.removeObjectExtension(r,Ug)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(Ug)}const $b={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},tJ={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class nJ{constructor(){T(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),T(this,"json",void 0)}normalize(e,n){this.json=e.json;const r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(r.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),eJ(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const n in $b)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){const r=e[n];if(!(!r||Array.isArray(r))){e[n]=[];for(const i in r){const s=r[i];s.id=s.id||i;const o=e[n].length;e[n].push(s),this.idToIndexMap[n][i]=o}}}_convertObjectIdsToArrayIndices(e){for(const n in $b)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const n of e.textures)this._convertTextureIds(n);for(const n of e.meshes)this._convertMeshIds(n);for(const n of e.nodes)this._convertNodeIds(n);for(const n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const n of e.primitives){const{attributes:r,indices:i,material:s}=n;for(const o in r)r[o]=this._convertIdToIndex(r[o],"accessor");i&&(n.indices=this._convertIdToIndex(i,"accessor")),s&&(n.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),e[n]=[]);for(const r of e[n])for(const i in r){const s=r[i],o=this._convertIdToIndex(s,i);r[i]=o}}_convertIdToIndex(e,n){const r=tJ[n];if(r in this.idToIndexMap){const i=this.idToIndexMap[r][e];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(e));return i}return e}_updateObjects(e){for(const n of this.json.buffers)delete n.type}_updateMaterial(e){for(const i of e.materials){var n,r;i.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const s=((n=i.values)===null||n===void 0?void 0:n.tex)||((r=i.values)===null||r===void 0?void 0:r.texture2d_0),o=e.textures.findIndex(a=>a.id===s);o!==-1&&(i.pbrMetallicRoughness.baseColorTexture={index:o})}}}function rJ(t,e={}){return new nJ().normalize(t,e)}const iJ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},sJ={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Kr={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},oJ={magFilter:Kr.TEXTURE_MAG_FILTER,minFilter:Kr.TEXTURE_MIN_FILTER,wrapS:Kr.TEXTURE_WRAP_S,wrapT:Kr.TEXTURE_WRAP_T},aJ={[Kr.TEXTURE_MAG_FILTER]:Kr.LINEAR,[Kr.TEXTURE_MIN_FILTER]:Kr.NEAREST_MIPMAP_LINEAR,[Kr.TEXTURE_WRAP_S]:Kr.REPEAT,[Kr.TEXTURE_WRAP_T]:Kr.REPEAT};function lJ(t){return sJ[t]}function cJ(t){return iJ[t]}class AJ{constructor(){T(this,"baseUri",""),T(this,"json",{}),T(this,"buffers",[]),T(this,"images",[])}postProcess(e,n={}){const{json:r,buffers:i=[],images:s=[],baseUri:o=""}=e;return Dr(r),this.baseUri=o,this.json=r,this.buffers=i,this.images=s,this._resolveTree(this.json,n),this.json}_resolveTree(e,n={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((r,i)=>this._resolveBufferView(r,i))),e.images&&(e.images=e.images.map((r,i)=>this._resolveImage(r,i))),e.samplers&&(e.samplers=e.samplers.map((r,i)=>this._resolveSampler(r,i))),e.textures&&(e.textures=e.textures.map((r,i)=>this._resolveTexture(r,i))),e.accessors&&(e.accessors=e.accessors.map((r,i)=>this._resolveAccessor(r,i))),e.materials&&(e.materials=e.materials.map((r,i)=>this._resolveMaterial(r,i))),e.meshes&&(e.meshes=e.meshes.map((r,i)=>this._resolveMesh(r,i))),e.nodes&&(e.nodes=e.nodes.map((r,i)=>this._resolveNode(r,i))),e.skins&&(e.skins=e.skins.map((r,i)=>this._resolveSkin(r,i))),e.scenes&&(e.scenes=e.scenes.map((r,i)=>this._resolveScene(r,i))),e.scene!==void 0&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(n,"]")),r}_resolveScene(e,n){return e.id=e.id||"scene-".concat(n),e.nodes=(e.nodes||[]).map(r=>this.getNode(r)),e}_resolveNode(e,n){return e.id=e.id||"node-".concat(n),e.children&&(e.children=e.children.map(r=>this.getNode(r))),e.mesh!==void 0?e.mesh=this.getMesh(e.mesh):e.meshes!==void 0&&e.meshes.length&&(e.mesh=e.meshes.reduce((r,i)=>{const s=this.getMesh(i);return r.id=s.id,r.primitives=r.primitives.concat(s.primitives),r},{primitives:[]})),e.camera!==void 0&&(e.camera=this.getCamera(e.camera)),e.skin!==void 0&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,n){return e.id=e.id||"skin-".concat(n),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,n){return e.id=e.id||"mesh-".concat(n),e.primitives&&(e.primitives=e.primitives.map(r=>{r={...r};const i=r.attributes;r.attributes={};for(const s in i)r.attributes[s]=this.getAccessor(i[s]);return r.indices!==void 0&&(r.indices=this.getAccessor(r.indices)),r.material!==void 0&&(r.material=this.getMaterial(r.material)),r})),e}_resolveMaterial(e,n){if(e.id=e.id||"material-".concat(n),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture={...r.baseColorTexture},r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture={...r.metallicRoughnessTexture},r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,n){if(e.id=e.id||"accessor-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=lJ(e.componentType),e.components=cJ(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const r=e.bufferView.buffer,{ArrayType:i,byteLength:s}=RI(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+r.byteOffset;let a=r.arrayBuffer.slice(o,o+s);e.bufferView.byteStride&&(a=this._getValueFromInterleavedBuffer(r,o,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new i(a)}return e}_getValueFromInterleavedBuffer(e,n,r,i,s){const o=new Uint8Array(s*i);for(let a=0;a<s;a++){const l=n+a*r;o.set(new Uint8Array(e.arrayBuffer.slice(l,l+i)),a*i)}return o.buffer}_resolveTexture(e,n){return e.id=e.id||"texture-".concat(n),e.sampler="sampler"in e?this.getSampler(e.sampler):aJ,e.source=this.getImage(e.source),e}_resolveSampler(e,n){e.id=e.id||"sampler-".concat(n),e.parameters={};for(const r in e){const i=this._enumSamplerParameter(r);i!==void 0&&(e.parameters[i]=e[r])}return e}_enumSamplerParameter(e){return oJ[e]}_resolveImage(e,n){e.id=e.id||"image-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView));const r=this.images[n];return r&&(e.image=r),e}_resolveBufferView(e,n){const r=e.buffer,i={id:"bufferView-".concat(n),...e,buffer:this.buffers[r]},s=this.buffers[r].arrayBuffer;let o=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(o+=e.byteOffset),i.data=new Uint8Array(s,o,e.byteLength),i}_resolveCamera(e,n){return e.id=e.id||"camera-".concat(n),e.perspective,e.orthographic,e}}function uJ(t,e){return new AJ().postProcess(t,e)}const Xb=1735152710,f_=12,Vd=8,fJ=1313821514,hJ=5130562,dJ=0,pJ=1,gJ=0,Yl=!0;function mJ(t,e=0){return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function yJ(t,e=0,n={}){const r=new DataView(t),{magic:i=Xb}=n,s=r.getUint32(e,!1);return s===i||s===Xb}function vJ(t,e,n=0,r={}){const i=new DataView(e),s=mJ(i,n+0),o=i.getUint32(n+4,Yl),a=i.getUint32(n+8,Yl);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),n+=f_,t.version){case 1:return _J(t,i,n);case 2:return EJ(t,i,n,r={});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}function _J(t,e,n){Ct(t.header.byteLength>f_+Vd);const r=e.getUint32(n+0,Yl),i=e.getUint32(n+4,Yl);return n+=Vd,Ct(i===gJ),X1(t,e,n,r),n+=r,n+=Y1(t,e,n,t.header.byteLength),n}function EJ(t,e,n,r){return Ct(t.header.byteLength>f_+Vd),wJ(t,e,n,r),n+t.header.byteLength}function wJ(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,Yl),s=e.getUint32(n+4,Yl);switch(n+=Vd,s){case fJ:X1(t,e,n,i);break;case hJ:Y1(t,e,n,i);break;case dJ:r.strict||X1(t,e,n,i);break;case pJ:r.strict||Y1(t,e,n,i);break}n+=Tu(i,4)}return n}function X1(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),Tu(r,4)}function Y1(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),Tu(r,4)}async function TJ(t,e,n=0,r,i){var s,o,a,l;bJ(t,e,n,r),rJ(t,{normalize:r==null||(s=r.gltf)===null||s===void 0?void 0:s.normalize}),ZY(t,r,i);const h=[];if(r!=null&&(o=r.gltf)!==null&&o!==void 0&&o.loadBuffers&&t.json.buffers&&await xJ(t,r,i),r!=null&&(a=r.gltf)!==null&&a!==void 0&&a.loadImages){const m=CJ(t,r,i);h.push(m)}const p=qY(t,r,i);return h.push(p),await Promise.all(h),r!=null&&(l=r.gltf)!==null&&l!==void 0&&l.postProcess?uJ(t,r):t}function bJ(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!yJ(e,n,r)&&(e=new TextDecoder().decode(e)),typeof e=="string")t.json=u4(e);else if(e instanceof ArrayBuffer){const o={};n=vJ(o,e,n,r.glb),Dr(o.type==="glTF","Invalid GLB magic string ".concat(o.type)),t._glb=o,t.json=o.json}else Dr(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:o}=t._glb;t.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}const s=t.json.images||[];t.images=new Array(s.length).fill({})}async function xJ(t,e,n){const r=t.json.buffers||[];for(let o=0;o<r.length;++o){const a=r[o];if(a.uri){var i,s;const{fetch:l}=n;Dr(l);const h=II(a.uri,e),p=await(n==null||(i=n.fetch)===null||i===void 0?void 0:i.call(n,h)),m=await(p==null||(s=p.arrayBuffer)===null||s===void 0?void 0:s.call(p));t.buffers[o]={arrayBuffer:m,byteOffset:0,byteLength:m.byteLength},delete a.uri}else t.buffers[o]===null&&(t.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}async function CJ(t,e,n){const r=SJ(t),i=t.json.images||[],s=[];for(const o of r)s.push(PJ(t,i[o],o,e,n));return await Promise.all(s)}function SJ(t){const e=new Set,n=t.json.textures||[];for(const r of n)r.source!==void 0&&e.add(r.source);return Array.from(e).sort()}async function PJ(t,e,n,r,i){const{fetch:s,parse:o}=i;let a;if(e.uri){const h=II(e.uri,r);a=await(await s(h)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const h=EX(t.json,t.buffers,e.bufferView);a=lv(h.buffer,h.byteOffset,h.byteLength)}Dr(a,"glTF image has no data");let l=await o(a,[dv,_X],{mimeType:e.mimeType,basis:r.basis||{format:MI()}},i);l&&l[0]&&(l={compressed:!0,mipmaps:!1,width:l[0].width,height:l[0].height,data:l[0]}),t.images=t.images||[],t.images[n]=l}const uu={name:"glTF",id:"gltf",module:"gltf",version:rX,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:MJ,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function MJ(t,e={},n){e={...uu.options,...e},e.gltf={...uu.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await TJ({},t,r,e,n)}async function IJ(t){const e=[];return t.scenes.forEach(n=>{n.traverse(r=>{Object.values(r.model.getUniforms()).forEach(i=>{i.loaded===!1&&e.push(i)})})}),await BJ(()=>e.some(n=>!n.loaded))}async function BJ(t){for(;t();)await new Promise(e=>requestAnimationFrame(e))}const LJ=`#version 300 es

// Instance attributes
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;

// Uniforms
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;

// Attributes
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif

// Varying
out vec4 vColor;

// MODULE_PBR contains all the varying definitions needed
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif

// Main
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    // using instancePositions as world coordinates
    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth
    // call project_normal before setting position to avoid rotation
    geometry.normal = project_normal(normal);
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    // set PBR data
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,RJ=`#version 300 es

// Uniforms
uniform float opacity;

// Varying
in vec4 vColor;

out vec4 fragmentColor;

// MODULE_PBR contains all the varying definitions needed
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,WI=[255,255,255,255],OJ={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?typeof t.scene=="object"?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:WI},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[uu]};class h_ extends nr{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){const e=[ci,Ai];return this.props._lighting==="pbr"&&e.push(Fv),{vs:LJ,fs:RJ,modules:e}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:WI,transition:!0},instanceModelMatrix:bI})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.scenegraph!==r.scenegraph?this._updateScenegraph():n._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:n}=this.context;let r=null;if(e.scenegraph instanceof Bl)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const a=e.scenegraph,l=nX(n,a,this._getModelOptions());r={gltf:a,...l},IJ(l).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(Ve.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);const i={layer:this,gl:n},s=e.getScene(r,i),o=e.getAnimator(r,i);s instanceof Bl?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,o,e._animations),this.setState({scenegraph:s,animator:o})):s!==null&&Ve.warn("invalid scenegraph:",s)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const n=this.getAttributeManager().getAttributes();e.traverse(r=>{this._setModelAttributes(r.model,n)})}}_applyAnimationsProp(e,n,r){if(!e||!n||!r)return;const i=n.getAnimations();Object.keys(r).sort().forEach(s=>{const o=r[s];if(s==="*")i.forEach(a=>{Object.assign(a,o)});else if(Number.isFinite(Number(s))){const a=Number(s);a>=0&&a<i.length?Object.assign(i[a],o):Ve.warn("animation ".concat(s," not found"))()}else{const a=i.find(({name:l})=>l===s);a?Object.assign(a,o):Ve.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof Bl&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let n=null;return e&&(typeof e=="function"?n=e({gl:this.context.gl,layer:this}):n=e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:n,modelOptions:{isInstanced:!0,transpileToGLSL100:!nt(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(n=>{this._setModelAttributes(n.model,e)})}draw({moduleParameters:e=null,parameters:n={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:i}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:a,opacity:l,coordinateSystem:h}=this.props,p=this.getNumInstances();this.state.scenegraph.traverse((m,{worldMatrix:_})=>{m.model.setInstanceCount(p),m.updateModuleSettings(e),m.draw({parameters:n,uniforms:{sizeScale:s,opacity:l,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:xI(i,h),sceneModelMatrix:_,u_Camera:m.model.getUniforms().project_uCameraPosition}})})}}T(h_,"defaultProps",OJ);T(h_,"layerName","ScenegraphLayer");const FJ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs

// Scale the model
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;

// Primitive attributes
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;

// Instance attributes
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;

// Outputs to fragment shader
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    // https://github.com/Esri/i3s-spec/blob/master/docs/1.7/geometryUVRegion.cmn.md
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    // set PBR data
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,DJ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {

// NOTE(Tarek): This is necessary because
// headless.gl reports the extension as
// available but does not support it in
// the shader.
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function kJ(t){t.COLOR_0||t.colors||(t.colors={constant:!0,value:new Float32Array([1,1,1])})}const NJ={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class d_ extends cu{getShaders(){const e=super.getShaders();return e.modules.push(Fv),{...e,vs:FJ,fs:DJ}}initializeState(){const{featureIds:e}=this.props;super.initializeState();const n=this.getAttributeManager();e&&n.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.pbrMaterial!==r.pbrMaterial&&this.updatePbrMaterialUniforms(n.pbrMaterial)}draw(e){const{featureIds:n}=this.props;!this.state.model||(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:Boolean(n)}),super.draw(e))}getModel(e){const{id:n,pbrMaterial:r}=this.props,i=this.parseMaterial(r,e);this.setState({materialParser:i});const s=this.getShaders();return kJ(e.attributes),new tr(this.context.gl,{...this.getShaders(),id:n,geometry:e,defines:{...s.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:e.attributes.uvRegions},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){const{model:n}=this.state;if(n){const{mesh:r}=this.props,i=this.parseMaterial(e,r);this.setState({materialParser:i}),n.setUniforms(i.uniforms)}}parseMaterial(e,n){var r;const i=Boolean(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return(r=this.state.materialParser)===null||r===void 0||r.delete(),new CI(this.context.gl,{attributes:{NORMAL:n.attributes.normals,TEXCOORD_0:n.attributes.texCoords},material:{unlit:i,...e},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){const n=this.props.featureIds,r=new Uint8ClampedArray(n.length*e.size),i=[];for(let s=0;s<n.length;s++)this.encodePickingColor(n[s],i),r[s*3]=i[0],r[s*3+1]=i[1],r[s*3+2]=i[2];e.value=r}finalizeState(e){var n;super.finalizeState(e),(n=this.state.materialParser)===null||n===void 0||n.delete(),this.setState({materialParser:null})}}T(d_,"layerName","MeshLayer");T(d_,"defaultProps",NJ);const UJ=6378137,GJ=6378137,zJ=6356752314245179e-9;function R0(t){return t}new ee;function VJ(t,e=[],n=R0){return"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):"x"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function HJ(t,e=[]){return VJ(t,e,bn._cartographicRadians?R0:eU)}function jJ(t,e,n=R0){return"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):"x"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function WJ(t,e){return jJ(t,e,bn._cartographicRadians?R0:tU)}const ka=new ee,QJ=new ee,$J=new ee;function XJ(t,e,n=[]){const{oneOverRadii:r,oneOverRadiiSquared:i,centerToleranceSquared:s}=e;ka.from(t);const o=ka.x,a=ka.y,l=ka.z,h=r.x,p=r.y,m=r.z,_=o*o*h*h,E=a*a*p*p,b=l*l*m*m,x=_+E+b,I=Math.sqrt(1/x);if(!Number.isFinite(I))return;const S=QJ;if(S.copy(t).scale(I),x<s)return S.to(n);const P=i.x,M=i.y,O=i.z,N=$J;N.set(S.x*P*2,S.y*M*2,S.z*O*2);let z=(1-I)*ka.len()/(.5*N.len()),X=0,Z,Q,k,D;do{z-=X,Z=1/(1+z*P),Q=1/(1+z*M),k=1/(1+z*O);const ne=Z*Z,se=Q*Q,oe=k*k,xe=ne*Z,Pe=se*Q,Ue=oe*k;D=_*ne+E*se+b*oe-1;const le=_*xe*P+E*Pe*M+b*Ue*O,ve=-2*le;X=D/ve}while(Math.abs(D)>ZA.EPSILON12);return ka.scale([Z,Q,k]).to(n)}const Yb=1e-14,YJ=new ee,Jb={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Gg={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Vc={east:new ee,north:new ee,up:new ee,west:new ee,south:new ee,down:new ee},JJ=new ee,KJ=new ee,ZJ=new ee;function Kb(t,e,n,r,i,s){const o=Jb[e]&&Jb[e][n];bi(o&&(!r||r===o));let a,l,h;const p=YJ.copy(i);if(Ur(p.x,0,Yb)&&Ur(p.y,0,Yb)){const _=Math.sign(p.z);a=JJ.fromArray(Gg[e]),e!=="east"&&e!=="west"&&a.scale(_),l=KJ.fromArray(Gg[n]),n!=="east"&&n!=="west"&&l.scale(_),h=ZJ.fromArray(Gg[r]),r!=="east"&&r!=="west"&&h.scale(_)}else{const{up:_,east:E,north:b}=Vc;E.set(-p.y,p.x,0).normalize(),t.geodeticSurfaceNormal(p,_),b.copy(_).cross(E);const{down:x,west:I,south:S}=Vc;x.copy(_).scale(-1),I.copy(E).scale(-1),S.copy(b).scale(-1),a=Vc[e],l=Vc[n],h=Vc[r]}return s[0]=a.x,s[1]=a.y,s[2]=a.z,s[3]=0,s[4]=l.x,s[5]=l.y,s[6]=l.z,s[7]=0,s[8]=h.x,s[9]=h.y,s[10]=h.z,s[11]=0,s[12]=p.x,s[13]=p.y,s[14]=p.z,s[15]=1,s}const eh=new ee,Zb=new ee,qJ=new ee,vi=new ee,eK=new ee,th=new ee;class Cn{constructor(e=0,n=0,r=0){T(this,"radii",void 0),T(this,"radiiSquared",void 0),T(this,"radiiToTheFourth",void 0),T(this,"oneOverRadii",void 0),T(this,"oneOverRadiiSquared",void 0),T(this,"minimumRadius",void 0),T(this,"maximumRadius",void 0),T(this,"centerToleranceSquared",ZA.EPSILON1),T(this,"squaredXOverSquaredZ",void 0),bi(e>=0),bi(n>=0),bi(r>=0),this.radii=new ee(e,n,r),this.radiiSquared=new ee(e*e,n*n,r*r),this.radiiToTheFourth=new ee(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new ee(e===0?0:1/e,n===0?0:1/n,r===0?0:1/r),this.oneOverRadiiSquared=new ee(e===0?0:1/(e*e),n===0?0:1/(n*n),r===0?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||Boolean(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,n=[0,0,0]){const r=Zb,i=qJ,[,,s]=e;this.geodeticSurfaceNormalCartographic(e,r),i.copy(this.radiiSquared).scale(r);const o=Math.sqrt(r.dot(i));return i.scale(1/o),r.scale(s),i.add(r),i.to(n)}cartesianToCartographic(e,n=[0,0,0]){th.from(e);const r=this.scaleToGeodeticSurface(th,vi);if(!r)return;const i=this.geodeticSurfaceNormal(r,Zb),s=eK;s.copy(th).subtract(r);const o=Math.atan2(i.y,i.x),a=Math.asin(i.z),l=Math.sign(Pv(s,th))*DP(s);return WJ([o,a,l],n)}eastNorthUpToFixedFrame(e,n=new Ye){return Kb(this,"east","north","up",e,n)}localFrameToFixedFrame(e,n,r,i,s=new Ye){return Kb(this,e,n,r,i,s)}geocentricSurfaceNormal(e,n=[0,0,0]){return eh.from(e).normalize().to(n)}geodeticSurfaceNormalCartographic(e,n=[0,0,0]){const r=HJ(e),i=r[0],s=r[1],o=Math.cos(s);return eh.set(o*Math.cos(i),o*Math.sin(i),Math.sin(s)).normalize(),eh.to(n)}geodeticSurfaceNormal(e,n=[0,0,0]){return eh.from(e).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(e,n){return XJ(e,this,n)}scaleToGeocentricSurface(e,n=[0,0,0]){vi.from(e);const r=vi.x,i=vi.y,s=vi.z,o=this.oneOverRadiiSquared,a=1/Math.sqrt(r*r*o.x+i*i*o.y+s*s*o.z);return vi.multiplyScalar(a).to(n)}transformPositionToScaledSpace(e,n=[0,0,0]){return vi.from(e).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(e,n=[0,0,0]){return vi.from(e).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(e,n=0,r=[0,0,0]){bi(Ur(this.radii.x,this.radii.y,ZA.EPSILON15)),bi(this.radii.z>0),vi.from(e);const i=vi.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-n))return vi.set(0,0,i).to(r)}}T(Cn,"WGS84",new Cn(UJ,GJ,zJ));class tK{constructor(e,n,r){T(this,"item",void 0),T(this,"previous",void 0),T(this,"next",void 0),this.item=e,this.previous=n,this.next=r}}class nK{constructor(){T(this,"head",null),T(this,"tail",null),T(this,"_length",0)}get length(){return this._length}add(e){const n=new tK(e,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}remove(e){!e||(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,n){e!==n&&(this.remove(n),this._insert(e,n))}_insert(e,n){const r=e.next;e.next=n,this.tail===e?this.tail=n:r.previous=n,n.next=r,n.previous=e,++this._length}}function zg(t){return t!=null}class rK{constructor(){T(this,"_list",void 0),T(this,"_sentinel",void 0),T(this,"_trimTiles",void 0),this._list=new nK,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const n=e._cacheNode;zg(n)&&this._list.splice(this._sentinel,n)}add(e,n,r){zg(n._cacheNode)||(n._cacheNode=this._list.add(n),r&&r(e,n))}unloadTile(e,n,r){const i=n._cacheNode;!zg(i)||(this._list.remove(i),n._cacheNode=void 0,r&&r(e,n))}unloadTiles(e,n){const r=this._trimTiles;this._trimTiles=!1;const i=this._list,s=e.maximumMemoryUsage*1024*1024,o=this._sentinel;let a=i.head;for(;a!==o&&(e.gpuMemoryUsageInBytes>s||r);){const l=a.item;a=a.next,this.unloadTile(e,l,n)}}trim(){this._trimTiles=!0}}function iK(t,e){Ct(t),Ct(e);const{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:i,boundingVolume:{center:s}}=t;let o=new Ye(i);switch(n&&o.translate(n),r){case"Z":break;case"Y":const m=new Ye().rotateX(Math.PI/2);o=o.multiplyRight(m);break;case"X":const _=new Ye().rotateY(-Math.PI/2);o=o.multiplyRight(_);break}e.isQuantized&&o.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const a=new ee(s);e.cartesianModelMatrix=o,e.cartesianOrigin=a;const l=Cn.WGS84.cartesianToCartographic(a,new ee),p=Cn.WGS84.eastNorthUpToFixedFrame(a).invert();e.cartographicModelMatrix=p.multiplyRight(o),e.cartographicOrigin=l,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}const qb=new ee,Vg=new ee,J1=new Fr([new ni,new ni,new ni,new ni,new ni,new ni]);function sK(t,e){const{cameraDirection:n,cameraUp:r,height:i}=t,{metersPerUnit:s}=t.distanceScales,o=Vh(t,t.center),a=Cn.WGS84.eastNorthUpToFixedFrame(o),l=t.unprojectPosition(t.cameraPosition),h=Cn.WGS84.cartographicToCartesian(l,new ee),p=new ee(a.transformAsVector(new ee(n).scale(s))).normalize(),m=new ee(a.transformAsVector(new ee(r).scale(s))).normalize();aK(t);const _=t.constructor,{longitude:E,latitude:b,width:x,bearing:I,zoom:S}=t,P=new _({longitude:E,latitude:b,height:i,width:x,bearing:I,zoom:S,pitch:0});return{camera:{position:h,direction:p,up:m},viewport:t,topDownViewport:P,height:i,cullingVolume:J1,frameNumber:e,sseDenominator:1.15}}function oK(t,e,n){if(n===0||t.length<=n)return[t,[]];const r=[],{longitude:i,latitude:s}=e.viewport;for(const[h,p]of t.entries()){const[m,_]=p.header.mbs,E=Math.abs(i-m),b=Math.abs(s-_),x=Math.sqrt(b*b+E*E);r.push([h,x])}const o=r.sort((h,p)=>h[1]-p[1]),a=[];for(let h=0;h<n;h++)a.push(t[o[h][0]]);const l=[];for(let h=n;h<o.length;h++)l.push(t[o[h][0]]);return[a,l]}function aK(t){const e=t.getFrustumPlanes(),n=ex(e.near,t.cameraPosition),r=Vh(t,n),i=Vh(t,t.cameraPosition,Vg);let s=0;J1.planes[s++].fromPointNormal(r,qb.copy(r).subtract(i));for(const o in e){if(o==="near")continue;const a=e[o],l=ex(a,n,Vg),h=Vh(t,l,Vg);J1.planes[s++].fromPointNormal(h,qb.copy(r).subtract(h))}}function ex(t,e,n=new ee){const r=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-r).add(e),n}function Vh(t,e,n=new ee){const r=t.unprojectPosition(e);return Cn.WGS84.cartographicToCartesian(r,n)}const lK=6378137,cK=6378137,K1=6356752314245179e-9,tx=new ee;function AK(t,e){if(t instanceof ku){const{halfAxes:n}=t,r=fK(n);return Math.log2(K1/(r+e[2]))}else if(t instanceof Du){const{radius:n}=t;return Math.log2(K1/(n+e[2]))}else if(t.width&&t.height){const{width:n,height:r}=t,i=Math.log2(lK/n),s=Math.log2(cK/r);return(i+s)/2}return 1}function QI(t,e,n){const r=Cn.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],new ee),i=Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2));return Math.log2(K1/(i+e[2]))}function uK(t,e,n){const[r,i,s,o]=t;return QI({xmin:r,xmax:s,ymin:i,ymax:o,zmin:0,zmax:0},e,n)}function fK(t){t.getColumn(0,tx);const e=t.getColumn(1),n=t.getColumn(2);return tx.add(e).add(n).len()}const Br={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},hs={ADD:1,REPLACE:2},Ll={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},Wi={I3S:"I3S",TILES3D:"TILES3D"},O0={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},hK={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function $I(t){return t!=null}const dK=new ee,pK=new ee,gK=new ee;function Hg(t,e,n){if(Ct(t,"3D Tile: boundingVolume must be defined"),t.box)return mK(t.box,e,n);if(t.region){const[r,i,s,o,a,l]=t.region,h=Cn.WGS84.cartographicToCartesian([rA(r),rA(o),a],pK),p=Cn.WGS84.cartographicToCartesian([rA(s),rA(i),l],gK),m=new ee().addVectors(h,p).multiplyScalar(.5),_=new ee().subVectors(h,p).len()/2;return nx([m[0],m[1],m[2],_],new Ye)}if(t.sphere)return nx(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function mK(t,e,n){const r=new ee(t[0],t[1],t[2]);e.transform(r,r);let i=[];if(t.length===10){const h=t.slice(3,6),p=new KA;p.fromArray(t,6);const m=new ee([1,0,0]),_=new ee([0,1,0]),E=new ee([0,0,1]);m.transformByQuaternion(p),m.scale(h[0]),_.transformByQuaternion(p),_.scale(h[1]),E.transformByQuaternion(p),E.scale(h[2]),i=[...m.toArray(),..._.toArray(),...E.toArray()]}else i=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const s=e.transformAsVector(i.slice(0,3)),o=e.transformAsVector(i.slice(3,6)),a=e.transformAsVector(i.slice(6,9)),l=new xn([s[0],s[1],s[2],o[0],o[1],o[2],a[0],a[1],a[2]]);return $I(n)?(n.center=r,n.halfAxes=l,n):new ku(r,l)}function nx(t,e,n){const r=new ee(t[0],t[1],t[2]);e.transform(r,r);const i=e.getScale(dK),s=Math.max(Math.max(i[0],i[1]),i[2]),o=t[3]*s;return $I(n)?(n.center=r,n.radius=o,n):new Du(r,o)}new ee;new ee;new Ye;new ee;new ee;new ee;function yK(t,e){const n=t*e;return 1-Math.exp(-(n*n))}function vK(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return yK(e,n)*r}return 0}function _K(t,e,n){const r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,s=n?i:t.lodMetricValue;if(s===0)return 0;const o=Math.max(t._distanceToCamera,1e-7),{height:a,sseDenominator:l}=e,{viewDistanceScale:h}=r.options;let p=s*a*(h||1)/(o*l);return p-=vK(r,o),p}const jg=new ee,rx=new ee,zs=new ee,ix=new ee,EK=new ee,Wg=new Ye,sx=new Ye;function wK(t,e){if(t.lodMetricValue===0||isNaN(t.lodMetricValue))return"DIG";const n=2*XI(t,e);return n<2?"OUT":!t.header.children||n<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}function XI(t,e){const{topDownViewport:n}=e,r=t.header.mbs[1],i=t.header.mbs[0],s=t.header.mbs[2],o=t.header.mbs[3],a=[...t.boundingVolume.center],l=n.unprojectPosition(n.cameraPosition);Cn.WGS84.cartographicToCartesian(l,jg),rx.copy(jg).subtract(a).normalize(),Cn.WGS84.eastNorthUpToFixedFrame(a,Wg),sx.copy(Wg).invert(),zs.copy(jg).transform(sx);const h=Math.sqrt(zs[0]*zs[0]+zs[1]*zs[1]),p=h*h/zs[2];ix.copy([zs[0],zs[1],p]);const _=ix.transform(Wg).subtract(a).normalize(),b=rx.cross(_).normalize().scale(o).add(a),x=Cn.WGS84.cartesianToCartographic(b),I=n.project([i,r,s]),S=n.project(x);return EK.copy(I).subtract(S).magnitude()}function TK(t){return{assetGltfUpAxis:t.asset&&t.asset.gltfUpAxis||"Y"}}class ox{constructor(e=0){T(this,"_map",new Map),T(this,"_array",void 0),T(this,"_length",void 0),this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return Ct(e<this._array.length),this._array[e]}set(e,n){Ct(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=n,this._map.set(n,e)}delete(e){const n=this._map.get(e);n>=0&&(this._array.splice(n,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const n=this.length++;this._array[n]=e,this._map.set(e,n)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){Ct(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){Ct(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const bK={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class F0{traversalFinished(e){return!0}constructor(e){T(this,"options",void 0),T(this,"root",void 0),T(this,"requestedTiles",void 0),T(this,"selectedTiles",void 0),T(this,"emptyTiles",void 0),T(this,"lastUpdate",new Date().getTime()),T(this,"updateDebounceTime",1e3),T(this,"_traversalStack",void 0),T(this,"_emptyTraversalStack",void 0),T(this,"_frameNumber",void 0),this.options={...bK,...e},this._traversalStack=new ox,this._emptyTraversalStack=new ox,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}traverse(e,n,r){this.root=e,this.options={...this.options,...r},this.reset(),this.updateTile(e,n),this._frameNumber=n.frameNumber,this.executeTraversal(e,n)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,n){const r=this._traversalStack;for(e._selectionDepth=1,r.push(e);r.length>0;){const s=r.pop();let o=!1;this.canTraverse(s,n)&&(this.updateChildTiles(s,n),o=this.updateAndPushChildren(s,n,r,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const a=s.parent,l=Boolean(!a||a._shouldRefine),h=!o;s.hasRenderContent?s.refine===hs.ADD?(this.loadTile(s,n),this.selectTile(s,n)):s.refine===hs.REPLACE&&(this.loadTile(s,n),h&&this.selectTile(s,n)):(this.emptyTiles[s.id]=s,this.loadTile(s,n),h&&this.selectTile(s,n)),this.touchTile(s,n),s._shouldRefine=o&&l}const i=new Date().getTime();(this.traversalFinished(n)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(n))}updateChildTiles(e,n){const r=e.children;for(const i of r)this.updateTile(i,n);return!0}updateAndPushChildren(e,n,r,i){const{loadSiblings:s,skipLevelOfDetail:o}=this.options,a=e.children;a.sort(this.compareDistanceToCamera.bind(this));const l=e.refine===hs.REPLACE&&e.hasRenderContent&&!o;let h=!1,p=!0;for(const m of a)if(m._selectionDepth=i,m.isVisibleAndInRequestVolume?(r.find(m)&&r.delete(m),r.push(m),h=!0):(l||s)&&(this.loadTile(m,n),this.touchTile(m,n)),l){let _;if(m._inRequestVolume?m.hasRenderContent?_=m.contentAvailable:_=this.executeEmptyTraversal(m,n):_=!1,p=p&&_,!p)return!1}return h||(p=!1),p}updateTile(e,n){this.updateTileVisibility(e,n)}selectTile(e,n){this.shouldSelectTile(e)&&(e._selectedFrame=n.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,n){this.shouldLoadTile(e)&&(e._requestedFrame=n.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,n){e.tileset._cache.touch(e),e._touchedFrame=n.frameNumber}canTraverse(e,n,r=!1,i=!1){return e.hasChildren?e.hasTilesetContent?!e.contentExpired:!i&&!e.isVisibleAndInRequestVolume?!1:this.shouldRefine(e,n,r):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,n,r){let i=e._screenSpaceError;return r&&(i=e.getScreenSpaceError(n,!0)),i>this.options.maximumScreenSpaceError}updateTileVisibility(e,n){const r=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===n.viewport.id&&r.push(i);else r.push(n.viewport.id);e.updateVisibility(n,r)}compareDistanceToCamera(e,n){return e._distanceToCamera-n._distanceToCamera}anyChildrenVisible(e,n){let r=!1;for(const i of e.children)i.updateVisibility(n),r=r||i.isVisibleAndInRequestVolume;return r}executeEmptyTraversal(e,n){let r=!0;const i=this._emptyTraversalStack;for(i.push(e);i.length>0&&r;){const s=i.pop();if(this.updateTile(s,n),s.isVisibleAndInRequestVolume||this.loadTile(s,n),this.touchTile(s,n),!s.hasRenderContent&&this.canTraverse(s,n,!1,!0)){const a=s.children;for(const l of a)i.find(l)&&i.delete(l),i.push(l)}else s.contentAvailable||(r=!1)}return r}}const ax=new ee;function xK(t){return t!=null}class Z1{constructor(e,n,r,i=""){T(this,"tileset",void 0),T(this,"header",void 0),T(this,"id",void 0),T(this,"url",void 0),T(this,"parent",void 0),T(this,"refine",void 0),T(this,"type",void 0),T(this,"contentUrl",void 0),T(this,"lodMetricType",void 0),T(this,"lodMetricValue",void 0),T(this,"boundingVolume",void 0),T(this,"content",void 0),T(this,"contentState",void 0),T(this,"gpuMemoryUsageInBytes",void 0),T(this,"children",void 0),T(this,"depth",void 0),T(this,"viewportIds",void 0),T(this,"transform",void 0),T(this,"extensions",void 0),T(this,"userData",void 0),T(this,"computedTransform",void 0),T(this,"hasEmptyContent",void 0),T(this,"hasTilesetContent",void 0),T(this,"traverser",void 0),T(this,"_cacheNode",void 0),T(this,"_frameNumber",void 0),T(this,"_lodJudge",void 0),T(this,"_expireDate",void 0),T(this,"_expiredContent",void 0),T(this,"_shouldRefine",void 0),T(this,"_distanceToCamera",void 0),T(this,"_centerZDepth",void 0),T(this,"_screenSpaceError",void 0),T(this,"_visibilityPlaneMask",void 0),T(this,"_visible",void 0),T(this,"_inRequestVolume",void 0),T(this,"_stackLength",void 0),T(this,"_selectionDepth",void 0),T(this,"_touchedFrame",void 0),T(this,"_visitedFrame",void 0),T(this,"_selectedFrame",void 0),T(this,"_requestedFrame",void 0),T(this,"_priority",void 0),T(this,"_contentBoundingVolume",void 0),T(this,"_viewerRequestVolume",void 0),T(this,"_initialTransform",void 0),this.header=n,this.tileset=e,this.id=i||n.id,this.url=n.url,this.parent=r,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=Br.UNLOADED,this.gpuMemoryUsageInBytes=0,this.children=[],this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.depth=0,this.viewportIds=[],this.userData={},this.extensions=null,this._priority=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._screenSpaceError=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this.traverser=new F0({}),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._initialTransform=new Ye,this.transform=new Ye,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Br.READY||this.hasEmptyContent}get contentAvailable(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Br.UNLOADED}get contentExpired(){return this.contentState===Br.EXPIRED}get contentFailed(){return this.contentState===Br.FAILED}getScreenSpaceError(e,n){switch(this.tileset.type){case Wi.I3S:return XI(this,e);case Wi.TILES3D:return _K(this,e,n);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:n}=e.options,r=this.refine===hs.ADD||n;if(r&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Br.UNLOADED)return-1;const i=this.parent,o=i&&(!r||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,a=e.root?e.root._screenSpaceError:0;return Math.max(a-o,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Br.LOADING;const n=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!n)return this.contentState=Br.UNLOADED,!1;try{const r=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,s={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await vs(r,i,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Br.READY,this._onContentLoaded(),!0}catch(r){throw this.contentState=Br.FAILED,r}finally{n.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Br.UNLOADED,!0}updateVisibility(e,n){if(this._frameNumber===e.frameNumber)return;const r=this.parent,i=r?r._visibilityPlaneMask:Fr.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=r?r.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==Fr.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=n}visibility(e,n){const{cullingVolume:r}=e,{boundingVolume:i}=this;return r.computeVisibilityWithPlaneMask(i,n)}contentVisibility(){return!0}distanceToTile(e){const n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth({camera:e}){const n=this.boundingVolume;return ax.subVectors(n.center,e.position),e.direction.dot(ax)}insideViewerRequestVolume(e){const n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(xK(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=Br.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new Ye(e.transform):new Ye;const n=this.parent,r=this.tileset,i=n&&n.computedTransform?n.computedTransform.clone():r.modelMatrix.clone();this.computedTransform=new Ye(i).multiplyRight(this.transform);const s=n&&n._initialTransform?n._initialTransform.clone():new Ye;this._initialTransform=new Ye(s).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Br.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Fr.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||hs.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()&&(this.hasTilesetContent=!0)}_updateBoundingVolume(e){this.boundingVolume=Hg(e.boundingVolume,this.computedTransform,this.boundingVolume);const n=e.content;!n||(n.boundingVolume&&(this._contentBoundingVolume=Hg(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=Hg(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(e=new Ye){const n=e.clone().multiplyRight(this.transform);n.equals(this.computedTransform)||(this.computedTransform=n,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case"i3s":return{...this.tileset.options.i3s,tile:this.header,tileset:this.tileset.tileset,isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return TK(this.tileset.tileset)}}}class CK extends F0{compareDistanceToCamera(e,n){return n._distanceToCamera===0&&e._distanceToCamera===0?n._centerZDepth-e._centerZDepth:n._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,n){if(super.updateTileVisibility(e,n),!e.isVisibleAndInRequestVolume)return;const r=e.children.length>0;if(e.hasTilesetContent&&r){const o=e.children[0];this.updateTileVisibility(o,n),e._visible=o._visible;return}if(this.meetsScreenSpaceErrorEarly(e,n)){e._visible=!1;return}const i=e.refine===hs.REPLACE,s=e._optimChildrenWithinParent===hK.USE_OPTIMIZATION;if(i&&s&&r&&!this.anyChildrenVisible(e,n)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,n){const{parent:r}=e;return!r||r.hasTilesetContent||r.refine!==hs.ADD?!1:!this.shouldRefine(e,n,!0)}}class SK{constructor(){T(this,"frameNumberMap",new Map)}register(e,n){const r=this.frameNumberMap.get(e)||new Map,i=r.get(n)||0;r.set(n,i+1),this.frameNumberMap.set(e,r)}deregister(e,n){const r=this.frameNumberMap.get(e);if(!r)return;const i=r.get(n)||1;r.set(n,i-1)}isZero(e,n){var r;return(((r=this.frameNumberMap.get(e))===null||r===void 0?void 0:r.get(n))||0)===0}}const Qg={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class PK{constructor(){T(this,"_statusMap",void 0),T(this,"pendingTilesRegister",new SK),this._statusMap={}}add(e,n,r,i){if(!this._statusMap[n]){const{frameNumber:s,viewport:{id:o}}=i;this._statusMap[n]={request:e,callback:r,key:n,frameState:i,status:Qg.REQUESTED},this.pendingTilesRegister.register(o,s),e().then(a=>{this._statusMap[n].status=Qg.COMPLETED;const{frameNumber:l,viewport:{id:h}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(h,l),this._statusMap[n].callback(a,i)}).catch(a=>{this._statusMap[n].status=Qg.ERROR;const{frameNumber:l,viewport:{id:h}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(h,l),r(a)})}}update(e,n){if(this._statusMap[e]){const{frameNumber:r,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,r);const{frameNumber:s,viewport:{id:o}}=n;this.pendingTilesRegister.register(o,s),this._statusMap[e].frameState=n}}find(e){return this._statusMap[e]}hasPendingTiles(e,n){return!this.pendingTilesRegister.isZero(e,n)}}class MK extends F0{traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}constructor(e){super(e),T(this,"_tileManager",void 0),this._tileManager=new PK}shouldRefine(e,n){return e._lodJudge=wK(e,n),e._lodJudge==="DIG"}updateChildTiles(e,n){const r=e.header.children||[],i=e.children,s=e.tileset;for(const o of r){const a="".concat(o.id,"-").concat(n.viewport.id),l=i&&i.find(h=>h.id===a);if(l)l&&this.updateTile(l,n);else{let h=()=>this._loadTile(o.id,s);this._tileManager.find(a)?this._tileManager.update(a,n):(s.tileset.nodePages&&(h=()=>s.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(h,a,m=>this._onTileLoad(m,e,a),n))}}return!1}async _loadTile(e,n){const{loader:r}=n,i=n.getTileUrl("".concat(n.url,"/nodes/").concat(e)),s={...n.loadOptions,i3s:{...n.loadOptions.i3s,isTileHeader:!0,loadContent:!1}};return await vs(i,r,s)}_onTileLoad(e,n,r){const i=new Z1(n.tileset,e,n,r);n.children.push(i);const s=this._tileManager.find(i.id).frameState;this.updateTile(i,s),this._frameNumber===s.frameNumber&&(this.traversalFinished(s)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,s)}}const IK={description:"",ellipsoid:Cn.WGS84,modelMatrix:new Ye,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},nh="Tiles In Tileset(s)",$g="Tiles In Memory",lx="Tiles In View",cx="Tiles To Render",Ax="Tiles Loaded",Xg="Tiles Loading",ux="Tiles Unloaded",fx="Failed Tile Loads",hx="Points/Vertices",Yg="Tile Memory Use";class BK{constructor(e,n){T(this,"options",void 0),T(this,"loadOptions",void 0),T(this,"type",void 0),T(this,"tileset",void 0),T(this,"loader",void 0),T(this,"url",void 0),T(this,"basePath",void 0),T(this,"modelMatrix",void 0),T(this,"ellipsoid",void 0),T(this,"lodMetricType",void 0),T(this,"lodMetricValue",void 0),T(this,"refine",void 0),T(this,"root",void 0),T(this,"roots",void 0),T(this,"asset",void 0),T(this,"description",void 0),T(this,"properties",void 0),T(this,"extras",void 0),T(this,"attributions",void 0),T(this,"credits",void 0),T(this,"stats",void 0),T(this,"traverseCounter",void 0),T(this,"geometricError",void 0),T(this,"selectedTiles",void 0),T(this,"updatePromise",null),T(this,"tilesetInitializationPromise",void 0),T(this,"cartographicCenter",void 0),T(this,"cartesianCenter",void 0),T(this,"zoom",void 0),T(this,"boundingVolume",void 0),T(this,"gpuMemoryUsageInBytes",void 0),T(this,"dynamicScreenSpaceErrorComputedDensity",void 0),T(this,"_traverser",void 0),T(this,"_cache",void 0),T(this,"_requestScheduler",void 0),T(this,"_frameNumber",void 0),T(this,"_queryParamsString",void 0),T(this,"_queryParams",void 0),T(this,"_extensionsUsed",void 0),T(this,"_tiles",void 0),T(this,"_pendingCount",void 0),T(this,"lastUpdatedVieports",void 0),T(this,"_requestedTiles",void 0),T(this,"_emptyTiles",void 0),T(this,"frameStateData",void 0),T(this,"maximumMemoryUsage",void 0),Ct(e),this.options={...IK,...n},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||F3(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this.root=null,this.roots={},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.traverseCounter=0,this.geometricError=0,this._traverser=this._initializeTraverser(),this._cache=new rK,this._requestScheduler=new O3({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this._frameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this.frameStateData={},this.lastUpdatedVieports=null,this._queryParams={},this._queryParamsString="",this.maximumMemoryUsage=this.options.maximumMemoryUsage||32,this.gpuMemoryUsageInBytes=0,this.stats=new bu({id:this.url}),this._initializeStats(),this._extensionsUsed=void 0,this.dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description||"",this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return this._queryParamsString||(this._queryParamsString=LK(this._queryParams)),this._queryParamsString}setProps(e){this.options={...this.options,...e}}setOptions(e){this.options={...this.options,...e}}getTileUrl(e){return e.startsWith("data:")?e:"".concat(e).concat(this.queryParams)}hasExtension(e){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(e)>-1)}update(e=null){this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(e=null){return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(n=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),n(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const n=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;const r=[];for(const i of n){const s=i.id;this._needTraverse(s)?r.push(s):this.traverseCounter--}for(const i of n){const s=i.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!r.includes(s))continue;const o=sK(i,this._frameNumber);this._traverser.traverse(this.roots[s],o,this.options)}}_needTraverse(e){let n=e;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[e]),n===e}_onTraversalEnd(e){const n=e.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const r=this.frameStateData[n],i=Object.values(this._traverser.selectedTiles),[s,o]=oK(i,e,this.options.maximumTilesSelected);r.selectedTiles=s;for(const a of o)a.unselect();r._requestedTiles=Object.values(this._traverser.requestedTiles),r._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const n=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,n){if(e.length!==n.length)return!0;const r=new Set(e.map(o=>o.id)),i=new Set(n.map(o=>o.id));let s=e.filter(o=>!i.has(o.id)).length>0;return s=s||n.filter(o=>!r.has(o.id)).length>0,s}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,n)=>e._unloadTile(n))}_updateStats(){let e=0,n=0;for(const r of this.selectedTiles)r.contentAvailable&&r.content&&(e++,r.content.pointCount?n+=r.content.pointCount:n+=r.content.vertexCount);this.stats.get(lx).count=this.selectedTiles.length,this.stats.get(cx).count=e,this.stats.get(hx).count=n}async _initializeTileSet(e){this.type===Wi.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===Wi.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===Wi.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var e;const n=this.tileset.fullExtent;if(n){const{xmin:i,xmax:s,ymin:o,ymax:a,zmin:l,zmax:h}=n;this.cartographicCenter=new ee(i+(s-i)/2,o+(a-o)/2,l+(h-l)/2),this.cartesianCenter=Cn.WGS84.cartographicToCartesian(this.cartographicCenter,new ee),this.zoom=QI(n,this.cartographicCenter,this.cartesianCenter);return}const r=(e=this.tileset.store)===null||e===void 0?void 0:e.extent;if(r){const[i,s,o,a]=r;this.cartographicCenter=new ee(i+(o-i)/2,s+(a-s)/2,0),this.cartesianCenter=Cn.WGS84.cartographicToCartesian(this.cartographicCenter,new ee),this.zoom=uK(r,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new ee,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root;Ct(e);const{center:n}=e.boundingVolume;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new ee,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?this.cartographicCenter=Cn.WGS84.cartesianToCartographic(n,new ee):this.cartographicCenter=new ee(0,0,-Cn.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=AK(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(nh),this.stats.get(Xg),this.stats.get($g),this.stats.get(lx),this.stats.get(cx),this.stats.get(Ax),this.stats.get(ux),this.stats.get(fx),this.stats.get(hx,"memory"),this.stats.get(Yg,"memory")}_initializeTileHeaders(e,n){const r=new Z1(this,e.root,n);if(n&&(n.children.push(r),r.depth=n.depth+1),this.type===Wi.TILES3D){const i=[];for(i.push(r);i.length>0;){const s=i.pop();this.stats.get(nh).incrementCount();const o=s.header.children||[];for(const a of o){const l=new Z1(this,a,s);s.children.push(l),l.depth=s.depth+1,i.push(l)}}}return r}_initializeTraverser(){let e;switch(this.type){case Wi.TILES3D:e=CK;break;case Wi.I3S:e=MK;break;default:e=F0}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let n;try{this._onStartTileLoading(),n=await e.loadContent()}catch(r){this._onTileLoadError(e,r)}finally{this._onEndTileLoading(),this._onTileLoad(e,n)}}_onTileLoadError(e,n){this.stats.get(fx).incrementCount();const r=n.message||n.toString(),i=e.url;console.error("A 3D tile failed to load: ".concat(e.url," ").concat(r)),this.options.onTileError(e,r,i)}_onTileLoad(e,n){if(!!n){if(this.type===Wi.I3S){var r,i;const s=((r=this.tileset)===null||r===void 0||(i=r.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(nh).reset(),this.stats.get(nh).addCount(s)}e&&e.content&&iK(e,e.content),this._addTileToCache(e),this.options.onTileLoad(e)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(Xg).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(Xg).decrementCount()}_addTileToCache(e){this._cache.add(this,e,n=>n._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(Ax).incrementCount(),this.stats.get($g).incrementCount(),this.gpuMemoryUsageInBytes+=e.content.byteLength||0,this.stats.get(Yg).count=this.gpuMemoryUsageInBytes}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.content&&e.content.byteLength||0,this.stats.get($g).decrementCount(),this.stats.get(ux).incrementCount(),this.stats.get(Yg).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const n=e.pop();for(const r of n.children)e.push(r);this._destroyTile(n)}this.root=null}_destroySubtree(e){const n=e,r=[];for(r.push(n);r.length>0;){e=r.pop();for(const i of e.children)r.push(i);e!==n&&this._destroyTile(e)}n.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed,this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}function LK(t){const e=[];for(const n of Object.keys(t))e.push("".concat(n,"=").concat(t[n]));switch(e.length){case 0:return"";case 1:return"?".concat(e[0]);default:return"?".concat(e.join("&"))}}const YI="3.2.9",Hc={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function JI(t,e,n){Ct(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}function RK(t,e=0){const n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}const OK={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},dn={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},gt={...OK,...dn},Jg={[dn.DOUBLE]:Float64Array,[dn.FLOAT]:Float32Array,[dn.UNSIGNED_SHORT]:Uint16Array,[dn.UNSIGNED_INT]:Uint32Array,[dn.UNSIGNED_BYTE]:Uint8Array,[dn.BYTE]:Int8Array,[dn.SHORT]:Int16Array,[dn.INT]:Int32Array},FK={DOUBLE:dn.DOUBLE,FLOAT:dn.FLOAT,UNSIGNED_SHORT:dn.UNSIGNED_SHORT,UNSIGNED_INT:dn.UNSIGNED_INT,UNSIGNED_BYTE:dn.UNSIGNED_BYTE,BYTE:dn.BYTE,SHORT:dn.SHORT,INT:dn.INT},Kg="Failed to convert GL type";class Ki{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const n in Jg)if(Jg[n]===e)return n;throw new Error(Kg)}static fromName(e){const n=FK[e];if(!n)throw new Error(Kg);return n}static getArrayType(e){switch(e){case dn.UNSIGNED_SHORT_5_6_5:case dn.UNSIGNED_SHORT_4_4_4_4:case dn.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const n=Jg[e];if(!n)throw new Error(Kg);return n}}static getByteSize(e){return Ki.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return Boolean(Ki.getArrayType(e))}static createTypedArray(e,n,r=0,i){i===void 0&&(i=(n.byteLength-r)/Ki.getByteSize(e));const s=Ki.getArrayType(e);return new s(n,r,i)}}function DK(t,e){if(!t)throw new Error("math.gl assertion failed. ".concat(e))}function kK(t,e=[0,0,0]){const n=t>>11&31,r=t>>5&63,i=t&31;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}new Sv;new ee;new Sv;new Sv;function dx(t,e=255){return On(t,0,e)/e*2-1}function px(t){return t<0?-1:1}function NK(t,e,n,r){if(DK(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(r.x=dx(t,n),r.y=dx(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const i=r.x;r.x=(1-Math.abs(r.y))*px(i),r.y=(1-Math.abs(i))*px(r.y)}return r.normalize()}function UK(t,e,n){return NK(t,e,255,n)}class p_{constructor(e,n){T(this,"json",void 0),T(this,"buffer",void 0),T(this,"featuresLength",0),T(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=n}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return Boolean(this.json[e])}getGlobalProperty(e,n=gt.UNSIGNED_INT,r=1){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(e,n,r,1,i.byteOffset):i}getPropertyArray(e,n,r){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(n=Ki.fromName(i.componentType)),this._getTypedArrayFromBinary(e,n,r,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(e,n,i)}getProperty(e,n,r,i,s){const o=this.json[e];if(!o)return o;const a=this.getPropertyArray(e,n,r);if(r===1)return a[i];for(let l=0;l<r;++l)s[l]=a[r*i+l];return s}_getTypedArrayFromBinary(e,n,r,i,s){const o=this._cachedTypedArrays;let a=o[e];return a||(a=Ki.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+s,i*r),o[e]=a),a}_getTypedArrayFromArray(e,n,r){const i=this._cachedTypedArrays;let s=i[e];return s||(s=Ki.createTypedArray(n,r),i[e]=s),s}}const GK={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},zK={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},VK={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function HK(t,e,n,r){const{componentType:i}=t;Ct(t.componentType);const s=typeof i=="string"?Ki.fromName(i):i,o=GK[t.type],a=zK[t.type],l=VK[t.type];return n+=t.byteOffset,{values:Ki.createTypedArray(s,e,n,o*r),type:s,size:o,unpacker:a,packer:l}}const Ji=t=>t!==void 0;function jK(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?WK(r,n):null}function WK(t,e){let n,r,i;const s=t.instancesLength,o=t.classes;let a=t.classIds,l=t.parentCounts,h=t.parentIds,p=s;Ji(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,i=getBinaryAccessor(a),a=i.createArrayBufferView(e.buffer,e.byteOffset+a.byteOffset,s));let m;if(Ji(l))for(Ji(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,s)),m=new Uint16Array(s),p=0,n=0;n<s;++n)m[n]=p,p+=l[n];Ji(h)&&Ji(h.byteOffset)&&(h.componentType=defaultValue(h.componentType,GL.UNSIGNED_SHORT),h.type=AttributeType.SCALAR,i=getBinaryAccessor(h),h=i.createArrayBufferView(e.buffer,e.byteOffset+h.byteOffset,p));const _=o.length;for(n=0;n<_;++n){const I=o[n].length,S=o[n].instances,P=getBinaryProperties(I,S,e);o[n].instances=combine(P,S)}const E=new Array(_).fill(0),b=new Uint16Array(s);for(n=0;n<s;++n)r=a[n],b[n]=E[r],++E[r];const x={classes:o,classIds:a,classIndexes:b,parentCounts:l,parentIndexes:m,parentIds:h};return XK(x),x}function jc(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?QK(t,e,n):$K(t,e,n)}function QK(t,e,n){const r=t.classIds,i=t.parentCounts,s=t.parentIds,o=t.parentIndexes,a=r.length,l=scratchVisited;l.length=Math.max(l.length,a);const h=++marker,p=scratchStack;for(p.length=0,p.push(e);p.length>0;){if(e=p.pop(),l[e]===h)continue;l[e]=h;const m=n(t,e);if(Ji(m))return m;const _=i[e],E=o[e];for(let b=0;b<_;++b){const x=s[E+b];x!==e&&p.push(x)}}return null}function $K(t,e,n){let r=!0;for(;r;){const i=n(t,e);if(Ji(i))return i;const s=t.parentIds[e];r=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}function XK(t){const n=t.classIds.length;for(let r=0;r<n;++r)KI(t,r,stack)}function KI(t,e,n){const r=t.parentCounts,i=t.parentIds,s=t.parentIndexes,a=t.classIds.length;if(!Ji(i))return;assert(e<a,"Parent index ".concat(e," exceeds the total number of instances: ").concat(a)),assert(n.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),n.push(e);const l=Ji(r)?r[e]:1,h=Ji(r)?s[e]:e;for(let p=0;p<l;++p){const m=i[h+p];m!==e&&KI(t,m,n)}n.pop(e)}function gr(t){return t!=null}const rh=(t,e)=>t,YK={HIERARCHY:!0,extensions:!0,extras:!0};class ZI{constructor(e,n,r,i={}){var s;T(this,"json",void 0),T(this,"binary",void 0),T(this,"featureCount",void 0),T(this,"_extensions",void 0),T(this,"_properties",void 0),T(this,"_binaryProperties",void 0),T(this,"_hierarchy",void 0),Ct(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=((s=this.json)===null||s===void 0?void 0:s.extensions)||{},this._properties={};for(const o in this.json)YK[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=jK(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,n){if(this._checkBatchId(e),Ct(typeof n=="string",n),this._hierarchy){const r=jc(this._hierarchy,e,(i,s)=>{const o=i.classIds[s];return i.classes[o].name===n});return gr(r)}return!1}isExactClass(e,n){return Ct(typeof n=="string",n),this.getExactClassName(e)===n}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const n=this._hierarchy.classIds[e];return this._hierarchy.classes[n].name}}hasProperty(e,n){return this._checkBatchId(e),Ct(typeof n=="string",n),gr(this._properties[n])||this._hasPropertyInHierarchy(e,n)}getPropertyNames(e,n){this._checkBatchId(e),n=gr(n)?n:[],n.length=0;const r=Object.keys(this._properties);return n.push(...r),this._hierarchy&&this._getPropertyNamesInHierarchy(e,n),n}getProperty(e,n){if(this._checkBatchId(e),Ct(typeof n=="string",n),this._binaryProperties){const i=this._binaryProperties[n];if(gr(i))return this._getBinaryProperty(i,e)}const r=this._properties[n];if(gr(r))return rh(r[e]);if(this._hierarchy){const i=this._getHierarchyProperty(e,n);if(gr(i))return i}}setProperty(e,n,r){const i=this.featureCount;if(this._checkBatchId(e),Ct(typeof n=="string",n),this._binaryProperties){const o=this._binaryProperties[n];if(o){this._setBinaryProperty(o,e,r);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,n,r))return;let s=this._properties[n];gr(s)||(this._properties[n]=new Array(i),s=this._properties[n]),s[e]=rh(r)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,n){return e.unpack(e.typedArray,n)}_setBinaryProperty(e,n,r){e.pack(r,e.typedArray,n)}_initializeBinaryProperties(){let e=null;for(const n in this._properties){const r=this._properties[n],i=this._initializeBinaryProperty(n,r);i&&(e=e||{},e[n]=i)}return e}_initializeBinaryProperty(e,n){if("byteOffset"in n){const r=n;Ct(this.binary,"Property ".concat(e," requires a batch table binary.")),Ct(r.type,"Property ".concat(e," requires a type."));const i=HK(r,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(e,n){if(!this._hierarchy)return!1;const r=jc(this._hierarchy,e,(i,s)=>{const o=i.classIds[s],a=i.classes[o].instances;return gr(a[n])});return gr(r)}_getPropertyNamesInHierarchy(e,n){jc(this._hierarchy,e,(r,i)=>{const s=r.classIds[i],o=r.classes[s].instances;for(const a in o)o.hasOwnProperty(a)&&n.indexOf(a)===-1&&n.push(a)})}_getHierarchyProperty(e,n){return jc(this._hierarchy,e,(r,i)=>{const s=r.classIds[i],o=r.classes[s],a=r.classIndexes[i],l=o.instances[n];return gr(l)?gr(l.typedArray)?this._getBinaryProperty(l,a):rh(l[a]):null})}_setHierarchyProperty(e,n,r,i){const s=jc(this._hierarchy,n,(o,a)=>{const l=o.classIds[a],h=o.classes[l],p=o.classIndexes[a],m=h.instances[r];return gr(m)?(Ct(a===n,'Inherited property "'.concat(r,'" is read-only.')),gr(m.typedArray)?this._setBinaryProperty(m,p,i):m[p]=rh(i),!0):!1});return gr(s)}}const Zg=4;function D0(t,e,n=0){const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=Zg,t.version=r.getUint32(n,!0),n+=Zg,t.byteLength=r.getUint32(n,!0),n+=Zg,t.version!==1)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}const Na=4,gx="b3dm tile in legacy format.";function g_(t,e,n){const r=new DataView(e);let i;t.header=t.header||{};let s=r.getUint32(n,!0);n+=Na;let o=r.getUint32(n,!0);n+=Na;let a=r.getUint32(n,!0);n+=Na;let l=r.getUint32(n,!0);return n+=Na,a>=570425344?(n-=Na*2,i=s,a=o,l=0,s=0,o=0,console.warn(gx)):l>=570425344&&(n-=Na,i=a,a=s,l=o,s=0,o=0,console.warn(gx)),t.header.featureTableJsonByteLength=s,t.header.featureTableBinaryByteLength=o,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=l,t.header.batchLength=i,n}function m_(t,e,n,r){return n=JK(t,e,n),n=KK(t,e,n),n}function JK(t,e,n,r){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:o}=t.header;if(t.featureTableJson={BATCH_LENGTH:o||0},i>0){const a=JI(e,n,i);t.featureTableJson=JSON.parse(a)}return n+=i,t.featureTableBinary=new Uint8Array(e,n,s),n+=s,n}function KK(t,e,n,r){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=t.header;if(i>0){const o=JI(e,n,i);t.batchTableJson=JSON.parse(o),n+=i,s>0&&(t.batchTableBinary=new Uint8Array(e,n,s),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=s)}return n}function qI(t,e,n){if(!e&&(!t||!t.batchIds||!n))return null;const{batchIds:r,isRGB565:i,pointCount:s}=t;if(r&&n){const o=new Uint8ClampedArray(s*3);for(let a=0;a<s;a++){const l=r[a],p=n.getProperty(l,"dimensions").map(m=>m*255);o[a*3]=p[0],o[a*3+1]=p[1],o[a*3+2]=p[2]}return{type:gt.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(i){const o=new Uint8ClampedArray(s*3);for(let a=0;a<s;a++){const l=kK(e[a]);o[a*3]=l[0],o[a*3+1]=l[1],o[a*3+2]=l[2]}return{type:gt.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}return e&&e.length===s*3?{type:gt.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:gt.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}const mx=new ee;function ZK(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(t.pointsLength*3);for(let r=0;r<t.pointsLength;r++)UK(e[r*2],e[r*2+1],mx),mx.toArray(n,r*3);return{type:gt.FLOAT,size:2,value:n}}return{type:gt.FLOAT,size:2,value:e}}function qK(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,eZ(t,e)):{type:gt.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function eZ(t,e){const n=new ee,r=new Float32Array(t.pointCount*3);for(let i=0;i<t.pointCount;i++)n.set(e[i*3],e[i*3+1],e[i*3+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,i*3);return r}async function tZ(t,e,n,r,i){n=D0(t,e,n),n=g_(t,e,n),n=m_(t,e,n),nZ(t);const{featureTable:s,batchTable:o}=rZ(t);return await lZ(t,s,o,r,i),iZ(t,s,r),sZ(t,s,o),oZ(t,s),n}function nZ(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function rZ(t){const e=new p_(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",gt.FLOAT,3);const r=aZ(t,e);return{featureTable:e,batchTable:r}}function iZ(t,e,n){if(!t.attributes.positions){if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",gt.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",gt.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=(1<<16)-1,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",gt.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",gt.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=qK(t,r,n)}}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function sZ(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",gt.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",gt.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",gt.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=qI(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",gt.UNSIGNED_BYTE,4))}function oZ(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",gt.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",gt.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=ZK(t,n)}}function aZ(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",gt.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=t;n=new ZI(i,s,r)}return n}async function lZ(t,e,n,r,i){let s,o,a;const l=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];l&&(a=l.properties);const h=e.getExtension("3DTILES_draco_point_compression");if(h){o=h.properties;const m=h.byteOffset,_=h.byteLength;if(!o||!Number.isFinite(m)||!_)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=t.featureTableBinary.slice(m,m+_),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA)}if(!s)return!0;const p={buffer:s,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await cZ(t,p,r,i)}async function cZ(t,e,n,r){const{parse:i}=r,s={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete s["3d-tiles"];const o=await i(e.buffer,GI,s),a=o.attributes.POSITION&&o.attributes.POSITION.value,l=o.attributes.COLOR_0&&o.attributes.COLOR_0.value,h=o.attributes.NORMAL&&o.attributes.NORMAL.value,p=o.attributes.BATCH_ID&&o.attributes.BATCH_ID.value,m=a&&o.attributes.POSITION.value.quantization,_=h&&o.attributes.NORMAL.value.quantization;if(m){const b=o.POSITION.data.quantization,x=b.range;t.quantizedVolumeScale=new ee(x,x,x),t.quantizedVolumeOffset=new ee(b.minValues),t.quantizedRange=(1<<b.quantizationBits)-1,t.isQuantizedDraco=!0}_&&(t.octEncodedRange=(1<<o.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const E={};if(e.batchTableProperties)for(const b of Object.keys(e.batchTableProperties))o.attributes[b]&&o.attributes[b].value&&(E[b.toLowerCase()]=o.attributes[b].value);t.attributes={positions:a,colors:qI(t,l,void 0),normals:h,batchIds:p,...E}}const q1={URI:0,EMBEDDED:1};function eB(t,e,n,r){t.rotateYtoZ=!0;const i=t.byteOffset+t.byteLength-n;if(i===0)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=lv(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4===0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}async function tB(t,e,n,r){const i=n["3d-tiles"]||{};if(AZ(t,e),i.loadGLTF){const{parse:s,fetch:o}=r;t.gltfUrl&&(t.gltfArrayBuffer=await o(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await s(t.gltfArrayBuffer,uu,n,r),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}function AZ(t,e,n){switch(e){case q1.URI:const r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),s=new TextDecoder().decode(r);t.gltfUrl=s.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case q1.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function uZ(t,e,n,r,i){var s;n=fZ(t,e,n,r),await tB(t,q1.EMBEDDED,r,i);const o=t==null||(s=t.gltf)===null||s===void 0?void 0:s.extensions;return o&&o.CESIUM_RTC&&(t.rtcCenter=o.CESIUM_RTC.center),n}function fZ(t,e,n,r,i){n=D0(t,e,n),n=g_(t,e,n),n=m_(t,e,n),n=eB(t,e,n,r);const s=new p_(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=s.getGlobalProperty("RTC_CENTER",gt.FLOAT,3),n}async function hZ(t,e,n,r,i){return n=dZ(t,e,n,r),await tB(t,t.gltfFormat,r,i),n}function dZ(t,e,n,r,i){if(n=D0(t,e,n),t.version!==1)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=g_(t,e,n);const s=new DataView(e);if(t.gltfFormat=s.getUint32(n,!0),n+=4,n=m_(t,e,n),n=eB(t,e,n,r),t.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new p_(t.featureTableJson,t.featureTableBinary),a=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",gt.FLOAT,3);const l=new ZI(t.batchTableJson,t.batchTableBinary,a);return pZ(t,o,l,a),n}function pZ(t,e,n,r){const s={instances:new Array(r),batchTable:t._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,o=new ee;new ee,new ee,new ee;const a=new xn,l=new KA,h=new ee,p={},m=new Ye,_=[],E=[],b=new ee,x=new ee;for(let I=0;I<r;I++){let S;if(e.hasProperty("POSITION"))S=e.getProperty("POSITION",gt.FLOAT,3,I,o);else if(e.hasProperty("POSITION_QUANTIZED")){S=e.getProperty("POSITION_QUANTIZED",gt.UNSIGNED_SHORT,3,I,o);const X=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",gt.FLOAT,3,b);if(!X)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const Z=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",gt.FLOAT,3,x);if(!Z)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const Q=65535;for(let k=0;k<3;k++)S[k]=S[k]/Q*Z[k]+X[k]}if(!S)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(o.copy(S),p.translation=o,t.normalUp=e.getProperty("NORMAL_UP",gt.FLOAT,3,I,_),t.normalRight=e.getProperty("NORMAL_RIGHT",gt.FLOAT,3,I,E),t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",gt.UNSIGNED_SHORT,2,_),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",gt.UNSIGNED_SHORT,2,E),t.octNormalUp)throw t.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");t.eastNorthUp?(Cn.WGS84.eastNorthUpToFixedFrame(o,m),m.getRotationMatrix3(a)):a.identity()}l.fromMatrix3(a),p.rotation=l,h.set(1,1,1);const P=e.getProperty("SCALE",gt.FLOAT,1,I);Number.isFinite(P)&&h.multiplyByScalar(P);const M=e.getProperty("SCALE_NON_UNIFORM",gt.FLOAT,3,I,_);M&&h.scale(M),p.scale=h;let O=e.getProperty("BATCH_ID",gt.UNSIGNED_SHORT,1,I);O===void 0&&(O=I);const N=new Ye().fromQuaternion(p.rotation);m.identity(),m.translate(p.translation),m.multiplyRight(N),m.scale(p.scale);const z=m.clone();s[I]={modelMatrix:z,batchId:O}}t.instances=s}async function gZ(t,e,n,r,i,s){n=D0(t,e,n);const o=new DataView(e);for(t.tilesLength=o.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const a={};t.tiles.push(a),n=await s(e,n,r,i,a)}return n}async function mZ(t,e,n,r){t.rotateYtoZ=!0,t.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=r;t.gltf=await i(e,uu,n,r)}async function nB(t,e=0,n,r,i={}){switch(i.byteOffset=e,i.type=RK(t,e),i.type){case Hc.COMPOSITE:return await gZ(i,t,e,n,r,nB);case Hc.BATCHED_3D_MODEL:return await uZ(i,t,e,n,r);case Hc.GLTF:return await mZ(i,t,n,r);case Hc.INSTANCED_3D_MODEL:return await hZ(i,t,e,n,r);case Hc.POINT_CLOUD:return await tZ(i,t,e,n,r);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}const yZ=1952609651,vZ=1;async function _Z(t){if(new Uint32Array(t.slice(0,4))[0]!==yZ)throw new Error("Wrong subtree file magic number");if(new Uint32Array(t.slice(4,8))[0]!==vZ)throw new Error("Wrong subtree file verson, must be 1");const r=yx(t.slice(8,16)),i=new Uint8Array(t,24,r),o=new TextDecoder("utf8").decode(i),a=JSON.parse(o),l=yx(t.slice(16,24));let h=new ArrayBuffer(0);return l&&(h=t.slice(24+r)),"bufferView"in a.tileAvailability&&(a.tileAvailability.explicitBitstream=await qg(a,"tileAvailability",h)),"bufferView"in a.contentAvailability&&(a.contentAvailability.explicitBitstream=await qg(a,"contentAvailability",h)),"bufferView"in a.childSubtreeAvailability&&(a.childSubtreeAvailability.explicitBitstream=await qg(a,"childSubtreeAvailability",h)),a}async function qg(t,e,n){const r=t[e].bufferView,i=t.bufferViews[r],s=t.buffers[i.buffer];if(s.uri){const a=await(await l1(s.uri)).arrayBuffer();return new Uint8Array(a,i.byteOffset,i.byteLength)}return new Uint8Array(n,i.byteOffset,i.byteLength)}function yx(t){const e=new DataView(t),n=e.getUint32(0,!0),r=e.getUint32(4,!0);return n+2**32*r}const rB={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:YI,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:_Z,options:{}},EZ=4,wZ=8,TZ={QUADTREE:EZ,OCTREE:wZ};async function iB(t){const{options:e,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:r=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0}}=t;let{subtree:s,level:o=0}=t;const{subdivisionScheme:a,subtreeLevels:l,maximumLevel:h,contentUrlTemplate:p,subtreesUriTemplate:m,basePath:_}=e,E={children:[],lodMetricValue:0,contentUrl:""},b=TZ[a],x=r&1,I=r>>1&1,S=r>>2&1,P=(b**o-1)/(b-1);let M=Oo(n.mortonIndex,r),O=P+M,N=Oo(n.x,x),z=Oo(n.y,I),X=Oo(n.z,S),Z=!1;o+1>l&&(Z=em(s.childSubtreeAvailability,M));const Q=Oo(i.x,N),k=Oo(i.y,z),D=Oo(i.z,X),ne=o+i.level;if(Z){const Ue="".concat(_,"/").concat(m),le=ey(Ue,ne,Q,k,D);s=await vs(le,rB),i.mortonIndex=M,i.x=N,i.y=z,i.z=X,i.level=o,M=0,O=0,N=0,z=0,X=0,o=0}if(!em(s.tileAvailability,O)||o>h)return E;em(s.contentAvailability,O)&&(E.contentUrl=ey(p,ne,Q,k,D));const xe=o+1,Pe={mortonIndex:M,x:N,y:z,z:X};for(let Ue=0;Ue<b;Ue++){const le=await iB({subtree:s,options:e,parentData:Pe,childIndex:Ue,level:xe,globalData:i});if(le.contentUrl||le.children.length){const ve=ne+1,Fe=bZ(le,ve,{childTileX:N,childTileY:z,childTileZ:X},e);E.children.push(Fe)}}return E}function em(t,e){return"constant"in t?Boolean(t.constant):t.explicitBitstream?SZ(e,t.explicitBitstream):!1}function bZ(t,e,n,r){const{basePath:i,refine:s,getRefine:o,lodMetricType:a,getTileType:l,rootLodMetricValue:h,rootBoundingVolume:p}=r,m=t.contentUrl&&t.contentUrl.replace("".concat(i,"/"),""),_=h/2**e,E=xZ(e,p,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:m},id:t.contentUrl,refine:o(s),type:l(t),lodMetricType:a,lodMetricValue:_,boundingVolume:E}}function xZ(t,e,n){if(e.region){const{childTileX:r,childTileY:i,childTileZ:s}=n,[o,a,l,h,p,m]=e.region,_=2**t,E=(l-o)/_,b=(h-a)/_,x=(m-p)/_,[I,S]=[o+E*r,o+E*(r+1)],[P,M]=[a+b*i,a+b*(i+1)],[O,N]=[p+x*s,p+x*(s+1)];return{region:[I,P,S,M,O,N]}}return console.warn("Unsupported bounding volume type: ",e),null}function Oo(t,e){return parseInt(t.toString(2)+e.toString(2),2)}function ey(t,e,n,r,i){const s=CZ({level:e,x:n,y:r,z:i});return t.replace(/{level}|{x}|{y}|{z}/gi,o=>s[o])}function CZ(t){const e={};for(const n in t)e["{".concat(n,"}")]=t[n];return e}function SZ(t,e){const n=Math.floor(t/8),r=t%8;return(e[n]>>r&1)===1}function y_(t){if(!t.contentUrl)return Ll.EMPTY;const n=t.contentUrl.split(".").pop();switch(n){case"pnts":return Ll.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Ll.SCENEGRAPH;default:return n}}function v_(t){switch(t){case"REPLACE":case"replace":return hs.REPLACE;case"ADD":case"add":return hs.ADD;default:return t}}function ty(t,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const r=new URL(t,"".concat(e,"/"));return decodeURI(r.toString())}else if(t.startsWith("/"))return t;return"".concat(e,"/").concat(t)}function vx(t,e){if(!t)return null;if(t.content){const n=t.content.uri||t.content.url;t.contentUrl=ty(n,e.basePath)}return t.id=t.contentUrl,t.lodMetricType=O0.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=y_(t),t.refine=v_(t.refine),t}function PZ(t){const e=t.basePath,n=vx(t.root,t),r=[];for(r.push(n);r.length>0;){const s=(r.pop()||{}).children||[];for(const o of s)vx(o,{basePath:e}),r.push(o)}return n}async function MZ(t){if(!t.root)return null;const e=t.basePath,n=t.root.extensions["3DTILES_implicit_tiling"],{subdivisionScheme:r,maximumLevel:i,subtreeLevels:s,subtrees:{uri:o}}=n,a=ey(o,0,0,0,0),l=ty(a,e),h=await vs(l,rB),p=ty(t.root.content.uri,e),m=t.root.refine,_=t.root.geometricError,E=t.root.boundingVolume,b={contentUrlTemplate:p,subtreesUriTemplate:o,subdivisionScheme:r,subtreeLevels:s,maximumLevel:i,refine:m,basePath:e,lodMetricType:O0.GEOMETRIC_ERROR,rootLodMetricValue:_,rootBoundingVolume:E,getTileType:y_,getRefine:v_};return await IZ(t.root,h,b)}async function IZ(t,e,n){if(!t)return null;t.lodMetricType=O0.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform;const{children:r,contentUrl:i}=await iB({subtree:e,options:n});return i&&(t.contentUrl=i,t.content={uri:i.replace("".concat(n.basePath,"/"),"")}),t.refine=v_(t.refine),t.type=y_(t),t.children=r,t.id=t.contentUrl,t}const _x="3DTILES_implicit_tiling",sB={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:YI,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:OZ,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function BZ(t){return F3(t.url)}async function LZ(t,e,n){const r={content:{featureIds:null}};return await nB(t,0,e,n,r.content),r.content}async function RZ(t,e,n){var r;const i=JSON.parse(new TextDecoder().decode(t));return i.loader=e.loader||sB,i.url=n.url,i.basePath=BZ(i),i.root=FZ(i)?await MZ(i):PZ(i),i.type=Wi.TILES3D,i.lodMetricType=O0.GEOMETRIC_ERROR,i.lodMetricValue=((r=i.root)===null||r===void 0?void 0:r.lodMetricValue)||0,i}async function OZ(t,e,n){const r=e["3d-tiles"]||{};let i;return r.isTileset==="auto"?i=n.url&&n.url.indexOf(".json")!==-1:i=r.isTileset,i?t=await RZ(t,e,n):t=await LZ(t,e,n),t}function FZ(t){var e,n;return(t==null||(e=t.extensionsRequired)===null||e===void 0?void 0:e.includes(_x))&&(t==null||(n=t.extensionsUsed)===null||n===void 0?void 0:n.includes(_x))}const Ex=[0],DZ={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:sB,onTilesetLoad:{type:"function",value:t=>{},compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:(t,e,n)=>{},compare:!1},_getMeshColor:{type:"function",value:t=>[255,255,255],compare:!1}};class oB extends Ss{constructor(...e){super(...e),T(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&Ve.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){const{tileset3d:e}=this.state;return e!==null&&e.isLoaded()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,oldProps:n,changeFlags:r}){if(e.data&&e.data!==n.data&&this._loadTileset(e.data),r.viewportChanged){const{activeViewports:i}=this.state;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(r.propsChanged){const{layerMap:i}=this.state;for(const s in i)i[s].needsUpdate=!0}}activateViewport(e){const{activeViewports:n,lastUpdatedViewports:r}=this.state;this.internalState.viewport=e,n[e.id]=e;const i=r==null?void 0:r[e.id];(!i||!e.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:e,sourceLayer:n}){const{layerMap:r}=this.state,i=n&&n.id;if(i){const s=i.substring(this.id.length+1),o=s.substring(s.indexOf("-")+1);e.object=r[o]&&r[o].tile}return e}filterSubLayer({layer:e,viewport:n}){const{tile:r}=e.props,{id:i}=n;return r.selected&&r.viewportIds.includes(i)}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}async _loadTileset(e){const{loadOptions:n={}}=this.props;let r=this.props.loader||this.props.loaders;Array.isArray(r)&&(r=r[0]);const i={loadOptions:{...n}};if(r.preload){const a=await r.preload(e,n);a.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:a.headers}),Object.assign(i,a)}const s=await vs(e,r,i.loadOptions),o=new BK(s,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(e){const{lastUpdatedViewports:n}=this.state;this.props.onTileLoad(e),this._updateTileset(n),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;const{tileset3d:n}=this.state,{timeline:r}=this.context,i=Object.keys(e).length;!r||!i||!n||n.selectTiles(Object.values(e)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(e,n){if(!e.content)return null;switch(e.type){case Ll.POINTCLOUD:return this._makePointCloudLayer(e,n);case Ll.SCENEGRAPH:return this._make3DModelLayer(e);case Ll.MESH:return this._makeSimpleMeshLayer(e,n);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}_makePointCloudLayer(e,n){const{attributes:r,pointCount:i,constantRGBA:s,cartographicOrigin:o,modelMatrix:a}=e.content,{positions:l,normals:h,colors:p}=r;if(!l)return null;const m=n&&n.props.data||{header:{vertexCount:i},attributes:{POSITION:l,NORMAL:h,COLOR_0:p}},{pointSize:_,getPointColor:E}=this.props,b=this.getSubLayerClass("pointcloud",$v);return new b({pointSize:_},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),tile:e,data:m,coordinateSystem:$e.METER_OFFSETS,coordinateOrigin:o,modelMatrix:a,getColor:s||E,_offset:0})}_make3DModelLayer(e){const{gltf:n,instances:r,cartographicOrigin:i,modelMatrix:s}=e.content,o=this.getSubLayerClass("scenegraph",h_);return new o({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),tile:e,data:r||Ex,scenegraph:n,coordinateSystem:$e.METER_OFFSETS,coordinateOrigin:i,modelMatrix:s,getTransformMatrix:a=>a.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,n){const r=e.content,{attributes:i,indices:s,modelMatrix:o,cartographicOrigin:a,coordinateSystem:l=$e.METER_OFFSETS,material:h,featureIds:p}=r,{_getMeshColor:m}=this.props,_=n&&n.props.mesh||new Ar({drawMode:4,attributes:kZ(i),indices:s}),E=this.getSubLayerClass("mesh",d_);return new E(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),tile:e,mesh:_,data:Ex,getColor:m(e),pbrMaterial:h,modelMatrix:o,coordinateOrigin:a,coordinateSystem:l,featureIds:p,_offset:0})}renderLayers(){const{tileset3d:e,layerMap:n}=this.state;return e?e.tiles.map(r=>{const i=n[r.id]=n[r.id]||{tile:r};let{layer:s}=i;return r.selected&&(s?i.needsUpdate&&(s=this._getSubLayer(r,s),i.needsUpdate=!1):s=this._getSubLayer(r)),i.layer=s,s}).filter(Boolean):null}}T(oB,"defaultProps",DZ);T(oB,"layerName","Tile3DLayer");function kZ(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}const NZ=new Map([["centerX",Float64Array.BYTES_PER_ELEMENT],["centerY",Float64Array.BYTES_PER_ELEMENT],["centerZ",Float64Array.BYTES_PER_ELEMENT],["minHeight",Float32Array.BYTES_PER_ELEMENT],["maxHeight",Float32Array.BYTES_PER_ELEMENT],["boundingSphereCenterX",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterY",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterZ",Float64Array.BYTES_PER_ELEMENT],["boundingSphereRadius",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointX",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointY",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointZ",Float64Array.BYTES_PER_ELEMENT]]);function tm(t){return t>>1^-(t&1)}function UZ(t){let e=0;const n={};for(const[r,i]of NZ){const s=i===8?t.getFloat64:t.getFloat32;n[r]=s.call(t,e,!0),e+=i}return{header:n,headerEndPosition:e}}function GZ(t,e){let n=e;const r=3,i=t.getUint32(n,!0),s=new Uint16Array(i*r);n+=Uint32Array.BYTES_PER_ELEMENT;const o=Uint16Array.BYTES_PER_ELEMENT,a=i*o,l=n,h=l+a,p=h+a;let m=0,_=0,E=0;for(let b=0;b<i;b++)m+=tm(t.getUint16(l+o*b,!0)),_+=tm(t.getUint16(h+o*b,!0)),E+=tm(t.getUint16(p+o*b,!0)),s[b]=m,s[b+i]=_,s[b+i*2]=E;return n+=a*3,{vertexData:s,vertexDataEndPosition:n}}function aA(t,e,n,r,i=!0){let s;if(r===2?s=new Uint16Array(t,e,n):s=new Uint32Array(t,e,n),!i)return s;let o=0;for(let a=0;a<s.length;++a){const l=s[a];s[a]=o-l,l===0&&++o}return s}function zZ(t,e,n){let r=n;const i=3,o=e.length/i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;r%o!==0&&(r+=o-r%o);const a=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const l=a*3,h=aA(t.buffer,r,l,o);return r+=l*o,{triangleIndicesEndPosition:r,triangleIndices:h}}function VZ(t,e,n){let r=n;const i=3,o=e.length/i>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,a=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const l=aA(t.buffer,r,a,o,!1);r+=a*o;const h=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const p=aA(t.buffer,r,h,o,!1);r+=h*o;const m=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const _=aA(t.buffer,r,m,o,!1);r+=m*o;const E=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const b=aA(t.buffer,r,E,o,!1);return r+=E*o,{edgeIndicesEndPosition:r,westIndices:l,southIndices:p,eastIndices:_,northIndices:b}}function HZ(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function jZ(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}function WZ(t,e){const n={};if(t.byteLength<=e)return{extensions:n,extensionsEndPosition:e};let r=e;for(;r<t.byteLength;){const i=t.getUint8(r,!0);r+=Uint8Array.BYTES_PER_ELEMENT;const s=t.getUint32(r,!0);r+=Uint32Array.BYTES_PER_ELEMENT;const o=new DataView(t.buffer,r,s);switch(i){case 1:{n.vertexNormals=HZ(o);break}case 2:{n.waterMask=jZ(o);break}}r+=s}return{extensions:n,extensionsEndPosition:r}}const gl={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},QZ={maxDecodingStep:gl.extensions};function $Z(t,e){const n=Object.assign({},QZ,e),r=new DataView(t),{header:i,headerEndPosition:s}=UZ(r);if(n.maxDecodingStep<gl.vertices)return{header:i};const{vertexData:o,vertexDataEndPosition:a}=GZ(r,s);if(n.maxDecodingStep<gl.triangleIndices)return{header:i,vertexData:o};const{triangleIndices:l,triangleIndicesEndPosition:h}=zZ(r,o,a);if(n.maxDecodingStep<gl.edgeIndices)return{header:i,vertexData:o,triangleIndices:l};const{westIndices:p,southIndices:m,eastIndices:_,northIndices:E,edgeIndicesEndPosition:b}=VZ(r,o,h);if(n.maxDecodingStep<gl.extensions)return{header:i,vertexData:o,triangleIndices:l,westIndices:p,northIndices:E,eastIndices:_,southIndices:m};const{extensions:x}=WZ(r,b);return{header:i,vertexData:o,triangleIndices:l,westIndices:p,northIndices:E,eastIndices:_,southIndices:m,extensions:x}}function aB(t,e,n,r){const i=r?YZ(r,t.POSITION.value):XZ(e),s=new t.POSITION.value.constructor(i.length*6),o=new t.TEXCOORD_0.value.constructor(i.length*4),a=new e.constructor(i.length*6);for(let h=0;h<i.length;h++){const p=i[h];JZ({edge:p,edgeIndex:h,attributes:t,skirtHeight:n,newPosition:s,newTexcoord0:o,newTriangles:a})}t.POSITION.value=qp(t.POSITION.value,s),t.TEXCOORD_0.value=qp(t.TEXCOORD_0.value,o);const l=e instanceof Array?e.concat(a):qp(e,a);return{attributes:t,triangles:l}}function XZ(t){const e=[];for(let o=0;o<t.length;o+=3)e.push([t[o],t[o+1]]),e.push([t[o+1],t[o+2]]),e.push([t[o+2],t[o]]);e.sort((o,a)=>Math.min(...o)-Math.min(...a)||Math.max(...o)-Math.max(...a));const n=[];let r=0;for(;r<e.length;){var i,s;e[r][0]===((i=e[r+1])===null||i===void 0?void 0:i[1])&&e[r][1]===((s=e[r+1])===null||s===void 0?void 0:s[0])?r+=2:(n.push(e[r]),r++)}return n}function YZ(t,e){t.westIndices.sort((r,i)=>e[3*r+1]-e[3*i+1]),t.eastIndices.sort((r,i)=>e[3*i+1]-e[3*r+1]),t.southIndices.sort((r,i)=>e[3*i]-e[3*r]),t.northIndices.sort((r,i)=>e[3*r]-e[3*i]);const n=[];for(const r in t){const i=t[r];for(let s=0;s<i.length-1;s++)n.push([i[s],i[s+1]])}return n}function JZ({edge:t,edgeIndex:e,attributes:n,skirtHeight:r,newPosition:i,newTexcoord0:s,newTriangles:o}){const a=n.POSITION.value.length,l=e*2,h=e*2+1;i.set(n.POSITION.value.subarray(t[0]*3,t[0]*3+3),l*3),i[l*3+2]=i[l*3+2]-r,i.set(n.POSITION.value.subarray(t[1]*3,t[1]*3+3),h*3),i[h*3+2]=i[h*3+2]-r,s.set(n.TEXCOORD_0.value.subarray(t[0]*2,t[0]*2+2),l*2),s.set(n.TEXCOORD_0.value.subarray(t[1]*2,t[1]*2+2),h*2);const p=e*2*3;o[p]=t[0],o[p+1]=a/3+h,o[p+2]=t[1],o[p+3]=a/3+h,o[p+4]=t[0],o[p+5]=a/3+l}function KZ(t,e,n){const{minHeight:r,maxHeight:i}=e,[s,o,a,l]=n||[0,0,1,1],h=a-s,p=l-o,m=i-r,_=t.length/3,E=new Float32Array(_*3),b=new Float32Array(_*2);for(let x=0;x<_;x++){const I=t[x]/32767,S=t[x+_]/32767,P=t[x+_*2]/32767;E[3*x+0]=I*h+s,E[3*x+1]=S*p+o,E[3*x+2]=P*m+r,b[2*x+0]=I,b[2*x+1]=S}return{POSITION:{value:E,size:3},TEXCOORD_0:{value:b,size:2}}}function ZZ(t,e){if(!t)return null;const{bounds:n}=e,{header:r,vertexData:i,triangleIndices:s,westIndices:o,northIndices:a,eastIndices:l,southIndices:h}=$Z(t,gl.triangleIndices);let p=s,m=KZ(i,r,n);const _=c_(m);if(e.skirtHeight){const{attributes:E,triangles:b}=aB(m,p,e.skirtHeight,{westIndices:o,northIndices:a,eastIndices:l,southIndices:h});m=E,p=b}return{loaderData:{header:{}},header:{vertexCount:p.length,boundingBox:_},mode:4,indices:{value:p,size:1},attributes:m}}function wx(t,e){return ZZ(t,e["quantized-mesh"])}class qZ{constructor(e=257){this.gridSize=e;const n=e-1;if(n&n-1)throw new Error(`Expected grid size to be 2^n+1, got ${e}.`);this.numTriangles=n*n*2-2,this.numParentTriangles=this.numTriangles-n*n,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let r=0;r<this.numTriangles;r++){let i=r+2,s=0,o=0,a=0,l=0,h=0,p=0;for(i&1?a=l=h=n:s=o=p=n;(i>>=1)>1;){const _=s+a>>1,E=o+l>>1;i&1?(a=s,l=o,s=h,o=p):(s=a,o=l,a=h,l=p),h=_,p=E}const m=r*4;this.coords[m+0]=s,this.coords[m+1]=o,this.coords[m+2]=a,this.coords[m+3]=l}}createTile(e){return new eq(e,this)}}class eq{constructor(e,n){const r=n.gridSize;if(e.length!==r*r)throw new Error(`Expected terrain data of length ${r*r} (${r} x ${r}), got ${e.length}.`);this.terrain=e,this.martini=n,this.errors=new Float32Array(e.length),this.update()}update(){const{numTriangles:e,numParentTriangles:n,coords:r,gridSize:i}=this.martini,{terrain:s,errors:o}=this;for(let a=e-1;a>=0;a--){const l=a*4,h=r[l+0],p=r[l+1],m=r[l+2],_=r[l+3],E=h+m>>1,b=p+_>>1,x=E+b-p,I=b+h-E,S=(s[p*i+h]+s[_*i+m])/2,P=b*i+E,M=Math.abs(S-s[P]);if(o[P]=Math.max(o[P],M),a<n){const O=(p+I>>1)*i+(h+x>>1),N=(_+I>>1)*i+(m+x>>1);o[P]=Math.max(o[P],o[O],o[N])}}}getMesh(e=0){const{gridSize:n,indices:r}=this.martini,{errors:i}=this;let s=0,o=0;const a=n-1;r.fill(0);function l(E,b,x,I,S,P){const M=E+x>>1,O=b+I>>1;Math.abs(E-S)+Math.abs(b-P)>1&&i[O*n+M]>e?(l(S,P,E,b,M,O),l(x,I,S,P,M,O)):(r[b*n+E]=r[b*n+E]||++s,r[I*n+x]=r[I*n+x]||++s,r[P*n+S]=r[P*n+S]||++s,o++)}l(0,0,a,a,a,0),l(a,a,0,0,0,a);const h=new Uint16Array(s*2),p=new Uint32Array(o*3);let m=0;function _(E,b,x,I,S,P){const M=E+x>>1,O=b+I>>1;if(Math.abs(E-S)+Math.abs(b-P)>1&&i[O*n+M]>e)_(S,P,E,b,M,O),_(x,I,S,P,M,O);else{const N=r[b*n+E]-1,z=r[I*n+x]-1,X=r[P*n+S]-1;h[2*N]=E,h[2*N+1]=b,h[2*z]=x,h[2*z+1]=I,h[2*X]=S,h[2*X+1]=P,p[m++]=N,p[m++]=z,p[m++]=X}}return _(0,0,a,a,a,0),_(a,a,0,0,0,a),{vertices:h,triangles:p}}}class tq{constructor(e,n,r=n){this.data=e,this.width=n,this.height=r,this.coords=[],this.triangles=[],this._halfedges=[],this._candidates=[],this._queueIndices=[],this._queue=[],this._errors=[],this._rms=[],this._pending=[],this._pendingLen=0,this._rmsSum=0;const i=n-1,s=r-1,o=this._addPoint(0,0),a=this._addPoint(i,0),l=this._addPoint(0,s),h=this._addPoint(i,s),p=this._addTriangle(h,o,l,-1,-1,-1);this._addTriangle(o,h,a,p,-1,-1),this._flush()}run(e=1){for(;this.getMaxError()>e;)this.refine()}refine(){this._step(),this._flush()}getMaxError(){return this._errors[0]}getRMSD(){return this._rmsSum>0?Math.sqrt(this._rmsSum/(this.width*this.height)):0}heightAt(e,n){return this.data[this.width*n+e]}_flush(){const e=this.coords;for(let n=0;n<this._pendingLen;n++){const r=this._pending[n],i=2*this.triangles[r*3+0],s=2*this.triangles[r*3+1],o=2*this.triangles[r*3+2];this._findCandidate(e[i],e[i+1],e[s],e[s+1],e[o],e[o+1],r)}this._pendingLen=0}_findCandidate(e,n,r,i,s,o,a){const l=Math.min(e,r,s),h=Math.min(n,i,o),p=Math.max(e,r,s),m=Math.max(n,i,o);let _=Fo(r,i,s,o,l,h),E=Fo(s,o,e,n,l,h),b=Fo(e,n,r,i,l,h);const x=i-n,I=e-r,S=o-i,P=r-s,M=n-o,O=s-e,N=Fo(e,n,r,i,s,o),z=this.heightAt(e,n)/N,X=this.heightAt(r,i)/N,Z=this.heightAt(s,o)/N;let Q=0,k=0,D=0,ne=0;for(let se=h;se<=m;se++){let oe=0;_<0&&S!==0&&(oe=Math.max(oe,Math.floor(-_/S))),E<0&&M!==0&&(oe=Math.max(oe,Math.floor(-E/M))),b<0&&x!==0&&(oe=Math.max(oe,Math.floor(-b/x)));let xe=_+S*oe,Pe=E+M*oe,Ue=b+x*oe,le=!1;for(let ve=l+oe;ve<=p;ve++){if(xe>=0&&Pe>=0&&Ue>=0){le=!0;const Ce=z*xe+X*Pe+Z*Ue,Fe=Math.abs(Ce-this.heightAt(ve,se));ne+=Fe*Fe,Fe>Q&&(Q=Fe,k=ve,D=se)}else if(le)break;xe+=S,Pe+=M,Ue+=x}_+=P,E+=O,b+=I}(k===e&&D===n||k===r&&D===i||k===s&&D===o)&&(Q=0),this._candidates[2*a]=k,this._candidates[2*a+1]=D,this._rms[a]=ne,this._queuePush(a,Q,ne)}_step(){const e=this._queuePop(),n=e*3+0,r=e*3+1,i=e*3+2,s=this.triangles[n],o=this.triangles[r],a=this.triangles[i],l=this.coords[2*s],h=this.coords[2*s+1],p=this.coords[2*o],m=this.coords[2*o+1],_=this.coords[2*a],E=this.coords[2*a+1],b=this._candidates[2*e],x=this._candidates[2*e+1],I=this._addPoint(b,x);if(Fo(l,h,p,m,b,x)===0)this._handleCollinear(I,n);else if(Fo(p,m,_,E,b,x)===0)this._handleCollinear(I,r);else if(Fo(_,E,l,h,b,x)===0)this._handleCollinear(I,i);else{const S=this._halfedges[n],P=this._halfedges[r],M=this._halfedges[i],O=this._addTriangle(s,o,I,S,-1,-1,n),N=this._addTriangle(o,a,I,P,-1,O+1),z=this._addTriangle(a,s,I,M,O+2,N+1);this._legalize(O),this._legalize(N),this._legalize(z)}}_addPoint(e,n){const r=this.coords.length>>1;return this.coords.push(e,n),r}_addTriangle(e,n,r,i,s,o,a=this.triangles.length){const l=a/3;return this.triangles[a+0]=e,this.triangles[a+1]=n,this.triangles[a+2]=r,this._halfedges[a+0]=i,this._halfedges[a+1]=s,this._halfedges[a+2]=o,i>=0&&(this._halfedges[i]=a+0),s>=0&&(this._halfedges[s]=a+1),o>=0&&(this._halfedges[o]=a+2),this._candidates[2*l+0]=0,this._candidates[2*l+1]=0,this._queueIndices[l]=-1,this._rms[l]=0,this._pending[this._pendingLen++]=l,a}_legalize(e){const n=this._halfedges[e];if(n<0)return;const r=e-e%3,i=n-n%3,s=r+(e+1)%3,o=r+(e+2)%3,a=i+(n+2)%3,l=i+(n+1)%3,h=this.triangles[o],p=this.triangles[e],m=this.triangles[s],_=this.triangles[a],E=this.coords;if(!nq(E[2*h],E[2*h+1],E[2*p],E[2*p+1],E[2*m],E[2*m+1],E[2*_],E[2*_+1]))return;const b=this._halfedges[s],x=this._halfedges[o],I=this._halfedges[a],S=this._halfedges[l];this._queueRemove(r/3),this._queueRemove(i/3);const P=this._addTriangle(h,_,m,-1,I,b,r),M=this._addTriangle(_,h,p,P,x,S,i);this._legalize(P+1),this._legalize(M+2)}_handleCollinear(e,n){const r=n-n%3,i=r+(n+1)%3,s=r+(n+2)%3,o=this.triangles[s],a=this.triangles[n],l=this.triangles[i],h=this._halfedges[i],p=this._halfedges[s],m=this._halfedges[n];if(m<0){const z=this._addTriangle(e,o,a,-1,p,-1,r),X=this._addTriangle(o,e,l,z,-1,h);this._legalize(z+1),this._legalize(X+2);return}const _=m-m%3,E=_+(m+2)%3,b=_+(m+1)%3,x=this.triangles[E],I=this._halfedges[E],S=this._halfedges[b];this._queueRemove(_/3);const P=this._addTriangle(o,a,e,p,-1,-1,r),M=this._addTriangle(a,x,e,S,-1,P+1,_),O=this._addTriangle(x,l,e,I,-1,M+1),N=this._addTriangle(l,o,e,h,P+2,O+1);this._legalize(P),this._legalize(M),this._legalize(O),this._legalize(N)}_queuePush(e,n,r){const i=this._queue.length;this._queueIndices[e]=i,this._queue.push(e),this._errors.push(n),this._rmsSum+=r,this._queueUp(i)}_queuePop(){const e=this._queue.length-1;return this._queueSwap(0,e),this._queueDown(0,e),this._queuePopBack()}_queuePopBack(){const e=this._queue.pop();return this._errors.pop(),this._rmsSum-=this._rms[e],this._queueIndices[e]=-1,e}_queueRemove(e){const n=this._queueIndices[e];if(n<0){const i=this._pending.indexOf(e);if(i!==-1)this._pending[i]=this._pending[--this._pendingLen];else throw new Error("Broken triangulation (something went wrong).");return}const r=this._queue.length-1;r!==n&&(this._queueSwap(n,r),this._queueDown(n,r)||this._queueUp(n)),this._queuePopBack()}_queueLess(e,n){return this._errors[e]>this._errors[n]}_queueSwap(e,n){const r=this._queue[e],i=this._queue[n];this._queue[e]=i,this._queue[n]=r,this._queueIndices[r]=n,this._queueIndices[i]=e;const s=this._errors[e];this._errors[e]=this._errors[n],this._errors[n]=s}_queueUp(e){let n=e;for(;;){const r=n-1>>1;if(r===n||!this._queueLess(n,r))break;this._queueSwap(r,n),n=r}}_queueDown(e,n){let r=e;for(;;){const i=2*r+1;if(i>=n||i<0)break;const s=i+1;let o=i;if(s<n&&this._queueLess(s,i)&&(o=s),!this._queueLess(o,r))break;this._queueSwap(r,o),r=o}return r>e}}function Fo(t,e,n,r,i,s){return(n-i)*(e-s)-(r-s)*(t-i)}function nq(t,e,n,r,i,s,o,a){const l=t-o,h=e-a,p=n-o,m=r-a,_=i-o,E=s-a,b=l*l+h*h,x=p*p+m*m,I=_*_+E*E;return l*(m*I-x*E)-h*(p*I-x*_)+b*(p*E-m*_)<0}function ih(t,e,n,r,i){const{rScaler:s,bScaler:o,gScaler:a,offset:l}=r,h=new Float32Array((e+1)*(n+1));for(let p=0,m=0;m<n;m++)for(let _=0;_<e;_++,p++){const E=p*4,b=t[E+0],x=t[E+1],I=t[E+2];h[p+m]=b*s+x*a+I*o+l}if(i==="martini"){for(let p=(e+1)*e,m=0;m<e;m++,p++)h[p]=h[p-e-1];for(let p=n,m=0;m<n+1;m++,p+=n+1)h[p]=h[p-1]}return h}function rq(t,e,n,r,i){const s=n+1,o=t.length/2,a=new Float32Array(o*3),l=new Float32Array(o*2),[h,p,m,_]=i||[0,0,n,r],E=(m-h)/n,b=(_-p)/r;for(let x=0;x<o;x++){const I=t[x*2],S=t[x*2+1],P=S*s+I;a[3*x+0]=I*E+h,a[3*x+1]=-S*b+_,a[3*x+2]=e[P],l[2*x+0]=I/n,l[2*x+1]=S/r}return{POSITION:{value:a,size:3},TEXCOORD_0:{value:l,size:2}}}function iq(t,e){if(t===null)return null;const{meshMaxError:n,bounds:r,elevationDecoder:i}=e,{data:s,width:o,height:a}=t;let l,h;switch(e.tesselator){case"martini":l=ih(s,o,a,i,e.tesselator),h=Tx(n,o,l);break;case"delatin":l=ih(s,o,a,i,e.tesselator),h=bx(n,o,a,l);break;default:o===a&&!(a&o-1)?(l=ih(s,o,a,i,"martini"),h=Tx(n,o,l)):(l=ih(s,o,a,i,"delatin"),h=bx(n,o,a,l));break}const{vertices:p}=h;let{triangles:m}=h,_=rq(p,l,o,a,r);const E=c_(_);if(e.skirtHeight){const{attributes:b,triangles:x}=aB(_,m,e.skirtHeight);_=b,m=x}return{loaderData:{header:{}},header:{vertexCount:m.length,boundingBox:E},mode:4,indices:{value:Uint32Array.from(m),size:1},attributes:_}}function Tx(t,e,n){const r=e+1,s=new qZ(r).createTile(n),{vertices:o,triangles:a}=s.getMesh(t);return{vertices:o,triangles:a}}function bx(t,e,n,r){const i=new tq(r,e+1,n+1);i.run(t);const{coords:s,triangles:o}=i;return{vertices:s,triangles:o}}async function sq(t,e,n){const r={...e,mimeType:"application/x.image",image:{...e.image,type:"data"}},i=await n.parse(t,r);return iq(i,e.terrain)}const lB="3.2.9",cB={name:"Terrain",id:"terrain",module:"terrain",version:lB,worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}},oq={name:"Quantized Mesh",id:"quantized-mesh",module:"terrain",version:lB,worker:!0,extensions:["terrain"],mimeTypes:["application/vnd.quantized-mesh"],options:{"quantized-mesh":{bounds:[0,0,1,1],skirtHeight:null}}};({...cB});({...oq});const xx=[1],aq={...Nu.defaultProps,elevationData:Q1,texture:{...Q1,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0,loaders:[cB]};function Cx(t){return Array.isArray(t)?t.join(";"):t||""}class AB extends Ss{constructor(...e){super(...e),T(this,"state",void 0)}updateState({props:e,oldProps:n}){const r=e.elevationData!==n.elevationData;if(r){const{elevationData:s}=e,o=s&&(Array.isArray(s)||s.includes("{x}")&&s.includes("{y}"));this.setState({isTiled:o})}const i=r||e.meshMaxError!==n.meshMaxError||e.elevationDecoder!==n.elevationDecoder||e.bounds!==n.bounds;if(!this.state.isTiled&&i){const s=this.loadTerrain(e);this.setState({terrain:s})}e.workerUrl&&Ve.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:e,bounds:n,elevationDecoder:r,meshMaxError:i,signal:s}){var o;if(!e)return null;let a=this.getLoadOptions();a={...a,terrain:{skirtHeight:this.state.isTiled?i*2:0,...(o=a)===null||o===void 0?void 0:o.terrain,bounds:n,meshMaxError:i,elevationDecoder:r}};const{fetch:l}=this.props;return l(e,{propName:"elevationData",layer:this,loadOptions:a,signal:s})}getTiledTerrainData(e){const{elevationData:n,fetch:r,texture:i,elevationDecoder:s,meshMaxError:o}=this.props,{viewport:a}=this.context,l=Nd(n,e),h=i&&Nd(i,e),{signal:p}=e;let m=[0,0],_=[0,0];if(a.isGeospatial){const I=e.bbox;m=a.projectFlat([I.west,I.south]),_=a.projectFlat([I.east,I.north])}else{const I=e.bbox;m=[I.left,I.bottom],_=[I.right,I.top]}const E=[m[0],m[1],_[0],_[1]],b=this.loadTerrain({elevationData:l,bounds:E,elevationDecoder:s,meshMaxError:o,signal:p}),x=h?r(h,{propName:"texture",layer:this,loaders:[],signal:p}).catch(I=>null):Promise.resolve(null);return Promise.all([b,x])}renderSubLayers(e){const n=this.getSubLayerClass("mesh",cu),{color:r,wireframe:i,material:s}=this.props,{data:o}=e;if(!o)return null;const[a,l]=o;return new n(e,{data:xx,mesh:a,texture:l,_instanced:!1,coordinateSystem:$e.CARTESIAN,getPosition:h=>[0,0,0],getColor:r,wireframe:i,material:s})}onViewportLoad(e){if(!e)return;const{zRange:n}=this.state,r=e.map(o=>o.content).filter(Boolean).map(o=>o[0].header.boundingBox.map(l=>l[2]));if(r.length===0)return;const i=Math.min(...r.map(o=>o[0])),s=Math.max(...r.map(o=>o[1]));(!n||i<n[0]||s>n[1])&&this.setState({zRange:[i,s]})}renderLayers(){const{color:e,material:n,elevationData:r,texture:i,wireframe:s,meshMaxError:o,elevationDecoder:a,tileSize:l,maxZoom:h,minZoom:p,extent:m,maxRequests:_,onTileLoad:E,onTileUnload:b,onTileError:x,maxCacheSize:I,maxCacheByteSize:S,refinementStrategy:P}=this.props;if(this.state.isTiled)return new Nu(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:Cx(r),texture:Cx(i),meshMaxError:o,elevationDecoder:a}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:l,maxZoom:h,minZoom:p,extent:m,maxRequests:_,onTileLoad:E,onTileUnload:b,onTileError:x,maxCacheSize:I,maxCacheByteSize:S,refinementStrategy:P});const M=this.getSubLayerClass("mesh",cu);return new M(this.getSubLayerProps({id:"mesh"}),{data:xx,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:O=>[0,0,0],getColor:e,material:n,wireframe:s})}}T(AB,"defaultProps",aq);T(AB,"layerName","TerrainLayer");function lq(t,e,n){const r=cq(t),i=Object.keys(r).filter(s=>r[s]!==Array);return Aq(t,{propArrayTypes:r,...e},{numericPropKeys:n&&n.numericPropKeys||i,PositionDataType:n?n.PositionDataType:Float32Array})}function cq(t){const e={};for(const n of t)if(n.properties)for(const r in n.properties){const i=n.properties[r];e[r]=gq(i,e[r])}return e}function Aq(t,e,n){const{pointPositionsCount:r,pointFeaturesCount:i,linePositionsCount:s,linePathsCount:o,lineFeaturesCount:a,polygonPositionsCount:l,polygonObjectsCount:h,polygonRingsCount:p,polygonFeaturesCount:m,propArrayTypes:_,coordLength:E}=e,{numericPropKeys:b=[],PositionDataType:x=Float32Array}=n,I=t[0]&&"id"in t[0],S=t.length>65535?Uint32Array:Uint16Array,P={type:"Point",positions:new x(r*E),globalFeatureIds:new S(r),featureIds:i>65535?new Uint32Array(r):new Uint16Array(r),numericProps:{},properties:[],fields:[]},M={type:"LineString",pathIndices:s>65535?new Uint32Array(o+1):new Uint16Array(o+1),positions:new x(s*E),globalFeatureIds:new S(s),featureIds:a>65535?new Uint32Array(s):new Uint16Array(s),numericProps:{},properties:[],fields:[]},O={type:"Polygon",polygonIndices:l>65535?new Uint32Array(h+1):new Uint16Array(h+1),primitivePolygonIndices:l>65535?new Uint32Array(p+1):new Uint16Array(p+1),positions:new x(l*E),triangles:[],globalFeatureIds:new S(l),featureIds:m>65535?new Uint32Array(l):new Uint16Array(l),numericProps:{},properties:[],fields:[]};for(const z of[P,M,O])for(const X of b){const Z=_[X];z.numericProps[X]=new Z(z.positions.length/E)}M.pathIndices[o]=s,O.polygonIndices[h]=l,O.primitivePolygonIndices[p]=l;const N={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const z of t){const X=z.geometry,Z=z.properties||{};switch(X.type){case"Point":uq(X,P,N,E,Z),P.properties.push(rm(Z,b)),I&&P.fields.push({id:z.id}),N.pointFeature++;break;case"LineString":fq(X,M,N,E,Z),M.properties.push(rm(Z,b)),I&&M.fields.push({id:z.id}),N.lineFeature++;break;case"Polygon":hq(X,O,N,E,Z),O.properties.push(rm(Z,b)),I&&O.fields.push({id:z.id}),N.polygonFeature++;break;default:throw new Error("Invalid geometry type")}N.feature++}return pq(P,M,O,E)}function uq(t,e,n,r,i){e.positions.set(t.data,n.pointPosition*r);const s=t.data.length/r;__(e,i,n.pointPosition,s),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+s),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+s),n.pointPosition+=s}function fq(t,e,n,r,i){e.positions.set(t.data,n.linePosition*r);const s=t.data.length/r;__(e,i,n.linePosition,s),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+s),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+s);for(let o=0,a=t.indices.length;o<a;++o){const l=t.indices[o],h=o===a-1?t.data.length:t.indices[o+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(h-l)/r}}function hq(t,e,n,r,i){e.positions.set(t.data,n.polygonPosition*r);const s=t.data.length/r;__(e,i,n.polygonPosition,s),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+s),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+s);for(let o=0,a=t.indices.length;o<a;++o){const l=n.polygonPosition;e.polygonIndices[n.polygonObject++]=l;const h=t.areas[o],p=t.indices[o],m=t.indices[o+1];for(let E=0,b=p.length;E<b;++E){const x=p[E],I=E===b-1?m===void 0?t.data.length:m[0]:p[E+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(I-x)/r}const _=n.polygonPosition;dq(e,h,p,{startPosition:l,endPosition:_,coordLength:r})}}function dq(t,e,n,{startPosition:r,endPosition:i,coordLength:s}){const o=r*s,a=i*s,l=t.positions.subarray(o,a),h=n[0],p=n.slice(1).map(_=>(_-h)/s),m=o7(l,p,s,e);for(let _=0,E=m.length;_<E;++_)t.triangles.push(r+m[_])}function nm(t,e){const n={};for(const r in t)n[r]={value:t[r],size:e};return n}function pq(t,e,n,r){return{points:{...t,positions:{value:t.positions,size:r},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:nm(t.numericProps,1)},lines:{...e,positions:{value:e.positions,size:r},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:nm(e.numericProps,1)},polygons:{...n,positions:{value:n.positions,size:r},polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},triangles:{value:new Uint32Array(n.triangles),size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:nm(n.numericProps,1)}}}function __(t,e,n,r){for(const i in t.numericProps)if(i in e){const s=e[i];t.numericProps[i].fill(s,n,n+r)}}function rm(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}function gq(t,e){return e===Array||!Number.isFinite(t)?Array:e===Float64Array||Math.fround(t)!==t?Float64Array:Float32Array}function Sx(t,e){const n=e==null?void 0:e.globalFeatureId;return n!==void 0?mq(t,n):yq(t,e==null?void 0:e.type)}function mq(t,e){const n=uB(t);for(const r of n){let i=0,s=r.featureIds.value[0];for(let o=0;o<r.featureIds.value.length;o++){const a=r.featureIds.value[o];if(a!==s){if(e===r.globalFeatureIds.value[i])return Hd(r,i,o);i=o,s=a}}if(e===r.globalFeatureIds.value[i])return Hd(r,i,r.featureIds.value.length)}throw new Error("featureId:".concat(e," not found"))}function yq(t,e){const n=uB(t,e);return _q(n)}function vq(t,e,n){switch(t.type){case"Point":return bq(t,e,n);case"LineString":return Tq(t,e,n);case"Polygon":return fB(t,e,n);default:const r=t;throw new Error("Unsupported geometry type: ".concat(r==null?void 0:r.type))}}function uB(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||xq(t),[t];const r=[];return t.points&&(t.points.type="Point",r.push(t.points)),t.lines&&(t.lines.type="LineString",r.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",r.push(t.polygons)),r}function _q(t){const e=[];for(const n of t){if(n.featureIds.value.length===0)continue;let r=0,i=n.featureIds.value[0];for(let s=0;s<n.featureIds.value.length;s++){const o=n.featureIds.value[s];o!==i&&(e.push(Hd(n,r,s)),r=s,i=o)}e.push(Hd(n,r,n.featureIds.value.length))}return e}function Hd(t,e,n){const r=vq(t,e,n),i=wq(t,e),s=Eq(t,e);return{type:"Feature",geometry:r,properties:i,...s}}function Eq(t,e=0,n){return t.fields&&t.fields[t.featureIds.value[e]]}function wq(t,e=0,n){const r=Object.assign({},t.properties[t.featureIds.value[e]]);for(const i in t.numericProps)r[i]=t.numericProps[i].value[e];return r}function fB(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.polygonIndices.value.filter(l=>l>=e&&l<=n),s=t.primitivePolygonIndices.value.filter(l=>l>=e&&l<=n);if(!(i.length>2)){const l=[];for(let h=0;h<s.length-1;h++){const p=s[h],m=s[h+1],_=jd(r,p,m);l.push(_)}return{type:"Polygon",coordinates:l}}const a=[];for(let l=0;l<i.length-1;l++){const h=i[l],p=i[l+1],m=fB(t,h,p).coordinates;a.push(m)}return{type:"MultiPolygon",coordinates:a}}function Tq(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.pathIndices.value.filter(a=>a>=e&&a<=n);if(!(i.length>2)){const a=jd(r,i[0],i[1]);return{type:"LineString",coordinates:a}}const o=[];for(let a=0;a<i.length-1;a++){const l=jd(r,i[a],i[a+1]);o.push(l)}return{type:"MultiLineString",coordinates:o}}function bq(t,e,n){const{positions:r}=t,i=jd(r,e,n);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}function jd(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let i=e;i<n;i++){const s=Array();for(let o=i*t.size;o<(i+1)*t.size;o++)s.push(Number(t.value[o]));r.push(s)}return r}function xq(t){return t.pathIndices?"LineString":t.polygonIndices?"Polygon":"Point"}var E_={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */E_.read=function(t,e,n,r,i){var s,o,a=i*8-r-1,l=(1<<a)-1,h=l>>1,p=-7,m=n?i-1:0,_=n?-1:1,E=t[e+m];for(m+=_,s=E&(1<<-p)-1,E>>=-p,p+=a;p>0;s=s*256+t[e+m],m+=_,p-=8);for(o=s&(1<<-p)-1,s>>=-p,p+=r;p>0;o=o*256+t[e+m],m+=_,p-=8);if(s===0)s=1-h;else{if(s===l)return o?NaN:(E?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-h}return(E?-1:1)*o*Math.pow(2,s-r)};E_.write=function(t,e,n,r,i,s){var o,a,l,h=s*8-i-1,p=(1<<h)-1,m=p>>1,_=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=r?0:s-1,b=r?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=p):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+m>=1?e+=_/l:e+=_*Math.pow(2,1-m),e*l>=2&&(o++,l/=2),o+m>=p?(a=0,o=p):o+m>=1?(a=(e*l-1)*Math.pow(2,i),o=o+m):(a=e*Math.pow(2,m-1)*Math.pow(2,i),o=0));i>=8;t[n+E]=a&255,E+=b,a/=256,i-=8);for(o=o<<i|a,h+=i;h>0;t[n+E]=o&255,E+=b,o/=256,h-=8);t[n+E-b]|=x*128};var hB=Et,sh=E_;function Et(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Et.Varint=0;Et.Fixed64=1;Et.Bytes=2;Et.Fixed32=5;var ny=(1<<16)*(1<<16),Px=1/ny,Cq=12,dB=typeof TextDecoder>"u"?null:new TextDecoder("utf8");Et.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,s=this.pos;this.type=r&7,t(i,e,this),this.pos===s&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=oh(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Ix(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=oh(this.buf,this.pos)+oh(this.buf,this.pos+4)*ny;return this.pos+=8,t},readSFixed64:function(){var t=oh(this.buf,this.pos)+Ix(this.buf,this.pos+4)*ny;return this.pos+=8,t},readFloat:function(){var t=sh.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=sh.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,n,r;return r=e[this.pos++],n=r&127,r<128||(r=e[this.pos++],n|=(r&127)<<7,r<128)||(r=e[this.pos++],n|=(r&127)<<14,r<128)||(r=e[this.pos++],n|=(r&127)<<21,r<128)?n:(r=e[this.pos],n|=(r&15)<<28,Sq(n,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=Cq&&dB?zq(this.buf,e,t):Gq(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Et.Bytes)return t.push(this.readVarint(e));var n=os(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Et.Bytes)return t.push(this.readSVarint());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Et.Bytes)return t.push(this.readBoolean());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Et.Bytes)return t.push(this.readFloat());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Et.Bytes)return t.push(this.readDouble());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Et.Bytes)return t.push(this.readFixed32());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Et.Bytes)return t.push(this.readSFixed32());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Et.Bytes)return t.push(this.readFixed64());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Et.Bytes)return t.push(this.readSFixed64());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===Et.Varint)for(;this.buf[this.pos++]>127;);else if(e===Et.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Et.Fixed32)this.pos+=4;else if(e===Et.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Ga(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Ga(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Ga(this.buf,t&-1,this.pos),Ga(this.buf,Math.floor(t*Px),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Ga(this.buf,t&-1,this.pos),Ga(this.buf,Math.floor(t*Px),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){Pq(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=Vq(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Mx(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),sh.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),sh.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&Mx(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,Et.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Bq,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Lq,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Fq,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Rq,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Oq,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Dq,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,kq,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Nq,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Uq,e)},writeBytesField:function(t,e){this.writeTag(t,Et.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Et.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Et.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Et.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Et.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Et.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Et.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Et.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Et.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Et.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};function Sq(t,e,n){var r=n.buf,i,s;if(s=r[n.pos++],i=(s&112)>>4,s<128||(s=r[n.pos++],i|=(s&127)<<3,s<128)||(s=r[n.pos++],i|=(s&127)<<10,s<128)||(s=r[n.pos++],i|=(s&127)<<17,s<128)||(s=r[n.pos++],i|=(s&127)<<24,s<128)||(s=r[n.pos++],i|=(s&1)<<31,s<128))return Ua(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function os(t){return t.type===Et.Bytes?t.readVarint()+t.pos:t.pos+1}function Ua(t,e,n){return n?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function Pq(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(n=~(-t%4294967296),r=~(-t/4294967296),n^4294967295?n=n+1|0:(n=0,r=r+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),Mq(n,r,e),Iq(r,e)}function Mq(t,e,n){n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos]=t&127}function Iq(t,e){var n=(t&7)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function Mx(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function Bq(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Lq(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Rq(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Oq(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function Fq(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Dq(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function kq(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function Nq(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Uq(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function oh(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function Ga(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Ix(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Gq(t,e,n){for(var r="",i=e;i<n;){var s=t[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a>n)break;var l,h,p;a===1?s<128&&(o=s):a===2?(l=t[i+1],(l&192)===128&&(o=(s&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=t[i+1],h=t[i+2],(l&192)===128&&(h&192)===128&&(o=(s&15)<<12|(l&63)<<6|h&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=t[i+1],h=t[i+2],p=t[i+3],(l&192)===128&&(h&192)===128&&(p&192)===128&&(o=(s&15)<<18|(l&63)<<12|(h&63)<<6|p&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,r+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),r+=String.fromCharCode(o),i+=a}return r}function zq(t,e,n){return dB.decode(t.subarray(e,n))}function Vq(t,e,n){for(var r=0,i,s;r<e.length;r++){if(i=e.charCodeAt(r),i>55295&&i<57344)if(s)if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,s=i;continue}else i=s-55296<<10|i-56320|65536,s=null;else{i>56319||r+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):s=i;continue}else s&&(t[n++]=239,t[n++]=191,t[n++]=189,s=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=i&63|128)}return n}function Hq(t){const e=t.length;if(e<=1)return[t];const n=[];let r,i;for(let s=0;s<e;s++){const o=jq(t[s]);o!==0&&(i===void 0&&(i=o<0),i===o<0?(r&&n.push(r),r=[t[s]]):r&&r.push(t[s]))}return r&&n.push(r),n}function jq(t){let e=0;for(let n=0,r=t.length-1,i,s;n<t.length;r=n++)i=t[n],s=t[r],e+=(s[0]-i[0])*(i[1]+s[1]);return e}function Wq(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?Qq(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function Qq(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}class w_{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(e,n,r,i,s){T(this,"properties",void 0),T(this,"extent",void 0),T(this,"type",void 0),T(this,"id",void 0),T(this,"_pbf",void 0),T(this,"_geometry",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=s,e.readFields(Wq,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let r=1,i=0,s=0,o=0;const a=[];let l;for(;e.pos<n;){if(i<=0){const h=e.readVarint();r=h&7,i=h>>3}if(i--,r===1||r===2)s+=e.readSVarint(),o+=e.readSVarint(),r===1&&(l&&a.push(l),l=[]),l&&l.push([s,o]);else if(r===7)l&&l.push(l[0].slice());else throw new Error("unknown command ".concat(r))}return l&&a.push(l),a}bbox(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let r=1,i=0,s=0,o=0,a=1/0,l=-1/0,h=1/0,p=-1/0;for(;e.pos<n;){if(i<=0){const m=e.readVarint();r=m&7,i=m>>3}if(i--,r===1||r===2)s+=e.readSVarint(),o+=e.readSVarint(),s<a&&(a=s),s>l&&(l=s),o<h&&(h=o),o>p&&(p=o);else if(r!==7)throw new Error("unknown command ".concat(r))}return[a,h,l,p]}_toGeoJSON(e){let n=this.loadGeometry(),r=w_.types[this.type],i,s;switch(this.type){case 1:const a=[];for(i=0;i<n.length;i++)a[i]=n[i][0];n=a,e(n,this);break;case 2:for(i=0;i<n.length;i++)e(n[i],this);break;case 3:for(n=Hq(n),i=0;i<n.length;i++)for(s=0;s<n[i].length;s++)e(n[i][s],this);break}n.length===1?n=n[0]:r="Multi".concat(r);const o={type:"Feature",geometry:{type:r,coordinates:n},properties:this.properties};return this.id!==null&&(o.id=this.id),o}toGeoJSON(e){if(typeof e=="function")return this._toGeoJSON(e);const{x:n,y:r,z:i}=e,s=this.extent*Math.pow(2,i),o=this.extent*n,a=this.extent*r;function l(h){for(let p=0;p<h.length;p++){const m=h[p];m[0]=(m[0]+o)*360/s-180;const _=180-(m[1]+a)*360/s;m[1]=360/Math.PI*Math.atan(Math.exp(_*Math.PI/180))-90}}return this._toGeoJSON(l)}}class $q{constructor(e,n){T(this,"version",void 0),T(this,"name",void 0),T(this,"extent",void 0),T(this,"length",void 0),T(this,"_pbf",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Xq,this,n),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const n=this._pbf.readVarint()+this._pbf.pos;return new w_(this._pbf,n,this.extent,this._keys,this._values)}}function Xq(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(Yq(n)))}function Yq(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=t.readVarint()>>3;e=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null}return e}class Jq{constructor(e,n){T(this,"layers",void 0),this.layers=e.readFields(Kq,{},n)}}function Kq(t,e,n){if(t===3&&n){const r=new $q(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function Zq(t){const e=t.indices.length,n="Polygon";if(e<=1)return{type:n,data:t.data,areas:[[Od(t.data)]],indices:[t.indices]};const r=[],i=[];let s=[],o=[],a,l=0;for(let h,p=0,m;p<e;p++){m=t.indices[p]-l,h=t.indices[p+1]-l||t.data.length;const _=t.data.slice(m,h),E=Od(_);if(E===0){const b=t.data.slice(0,m),x=t.data.slice(h);t.data=b.concat(x),l+=h-m;continue}a===void 0&&(a=E<0),a===E<0?(o.length&&(r.push(s),i.push(o)),o=[m],s=[E]):(s.push(E),o.push(m))}return s&&r.push(s),o.length&&i.push(o),{type:n,areas:r,indices:i,data:t.data}}function qq(t,e,n,r){for(let i=0,s=t.length;i<s;i+=2){t[i]=(t[i]+e)*360/r-180;const o=180-(t[i+1]+n)*360/r;t[i+1]=360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90}}function eee(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?tee(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function tee(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}let Bx,Do,im,ah,sm,om,Wc;class nee{constructor(e,n,r,i,s,o){T(this,"properties",void 0),T(this,"extent",void 0),T(this,"type",void 0),T(this,"id",void 0),T(this,"_pbf",void 0),T(this,"_geometry",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_geometryInfo",void 0),this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=s,this._geometryInfo=o,e.readFields(eee,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry,Bx=e.readVarint()+e.pos,Do=1,ah=0,sm=0,om=0,Wc=0;const n=[],r=[];for(;e.pos<Bx;)if(ah<=0&&(im=e.readVarint(),Do=im&7,ah=im>>3),ah--,Do===1||Do===2)sm+=e.readSVarint(),om+=e.readSVarint(),Do===1&&n.push(Wc),r.push(sm,om),Wc+=2;else if(Do===7){if(Wc>0){const i=n[n.length-1];r.push(r[i],r[i+1]),Wc+=2}}else throw new Error("unknown command ".concat(Do));return{data:r,indices:n}}_toBinaryCoordinates(e){const n=this.loadGeometry();let r;e(n.data,this);const i=2;switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=n.indices.length,r={type:"Point",...n};break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=n.indices.length,this._geometryInfo.linePositionsCount+=n.data.length/i,r={type:"LineString",...n};break;case 3:r=Zq(n),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=r.indices.length;for(const o of r.indices)this._geometryInfo.polygonRingsCount+=o.length;this._geometryInfo.polygonPositionsCount+=r.data.length/i;break;default:throw new Error("Invalid geometry type: ".concat(this.type))}const s={type:"Feature",geometry:r,properties:this.properties};return this.id!==null&&(s.id=this.id),s}toBinaryCoordinates(e){if(typeof e=="function")return this._toBinaryCoordinates(e);const{x:n,y:r,z:i}=e,s=this.extent*Math.pow(2,i),o=this.extent*n,a=this.extent*r;return this._toBinaryCoordinates(l=>qq(l,o,a,s))}}class ree{constructor(e,n){T(this,"version",void 0),T(this,"name",void 0),T(this,"extent",void 0),T(this,"length",void 0),T(this,"_pbf",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(iee,this,n),this.length=this._features.length}feature(e,n){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const r=this._pbf.readVarint()+this._pbf.pos;return new nee(this._pbf,r,this.extent,this._keys,this._values,n)}}function iee(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(see(n)))}function see(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=t.readVarint()>>3;e=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null}return e}class oee{constructor(e,n){T(this,"layers",void 0),this.layers=e.readFields(aee,{},n)}}function aee(t,e,n){if(t===3&&n){const r=new ree(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function Lx(t,e){var n,r;const i=cee(e),s=(e==null||(n=e.gis)===null||n===void 0?void 0:n.format)||(e==null||(r=e.mvt)===null||r===void 0?void 0:r.shape);switch(s){case"columnar-table":return{shape:"columnar-table",data:am(t,i)};case"geojson-row-table":return{shape:"geojson-row-table",data:Rx(t,i)};case"geojson":return Rx(t,i);case"binary-geometry":return am(t,i);case"binary":return am(t,i);default:throw new Error(s)}}function am(t,e){const[n,r]=lee(t,e),i=lq(n,r);return i.byteLength=t.byteLength,i}function lee(t,e){const n=[],r={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength<=0)return[n,r];const i=new oee(new hB(t));return(e&&Array.isArray(e.layers)?e.layers:Object.keys(i.layers)).forEach(o=>{const a=i.layers[o];if(!!a)for(let l=0;l<a.length;l++){const h=a.feature(l,r),p=uee(h,e,o);n.push(p)}}),[n,r]}function Rx(t,e){if(t.byteLength<=0)return[];const n=[],r=new Jq(new hB(t));return(Array.isArray(e.layers)?e.layers:Object.keys(r.layers)).forEach(s=>{const o=r.layers[s];if(!!o)for(let a=0;a<o.length;a++){const l=o.feature(a),h=Aee(l,e,s);n.push(h)}}),n}function cee(t){var e;if(!(t!=null&&t.mvt))throw new Error("mvt options required");const n=((e=t.mvt)===null||e===void 0?void 0:e.coordinates)==="wgs84",{tileIndex:r}=t.mvt,i=r&&Number.isFinite(r.x)&&Number.isFinite(r.y)&&Number.isFinite(r.z);if(n&&!i)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return t.mvt}function Aee(t,e,n){const r=t.toGeoJSON(e.coordinates==="wgs84"?e.tileIndex:fee);return e.layerProperty&&(r.properties[e.layerProperty]=n),r}function uee(t,e,n){const r=t.toBinaryCoordinates(e.coordinates==="wgs84"?e.tileIndex:hee);return e.layerProperty&&r.properties&&(r.properties[e.layerProperty]=n),r}function fee(t,e){const{extent:n}=e;for(let r=0;r<t.length;r++){const i=t[r];i[0]/=n,i[1]/=n}}function hee(t,e){const{extent:n}=e;for(let r=0,i=t.length;r<i;++r)t[r]/=n}const dee="3.2.9",pee={mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}},pB={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:dee,extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:pee};({...pB});const gB={clipBounds:[0,0,1,1]},mB=`
uniform vec4 clip_bounds;

bool clip_isInBounds(vec2 position) {
  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];
}
`,gee={name:"clip-vs",vs:mB},mee={"vs:#decl":`
varying float clip_isVisible;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));
`,"fs:#decl":`
varying float clip_isVisible;
`,"fs:DECKGL_FILTER_COLOR":`
  if (clip_isVisible < 0.5) discard;
`},yee={name:"clip-fs",fs:mB},vee={"vs:#decl":`
varying vec2 clip_commonPosition;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_commonPosition = geometry.position.xy;
`,"fs:#decl":`
varying vec2 clip_commonPosition;
`,"fs:DECKGL_FILTER_COLOR":`
  if (!clip_isInBounds(clip_commonPosition)) discard;
`};class T_ extends RM{getShaders(){let e="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(e=this.props.clipByInstance),this.state.clipByInstance=e,e?{modules:[gee],inject:mee}:{modules:[yee],inject:vee}}draw({uniforms:e}){const{clipBounds:n=gB.clipBounds}=this.props;if(this.state.clipByInstance)e.clip_bounds=n;else{const r=this.projectPosition([n[0],n[1],0]),i=this.projectPosition([n[2],n[3],0]);e.clip_bounds=[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[0],i[0]),Math.max(r[1],i[1])]}}}T(T_,"defaultProps",gB);T(T_,"extensionName","ClipExtension");const _ee={Point:yB,MultiPoint:Eee,LineString:vB,MultiLineString:wee,Polygon:_B,MultiPolygon:Tee};function yB([t,e],[n,r],i){const s=Ii(n[0],r[0],t),o=Ii(n[1],r[1],e);return i.unprojectFlat([s,o])}function b_(t,e,n){return t.map(r=>yB(r,e,n))}function Eee(t,e,n){return b_(t,e,n)}function vB(t,e,n){return b_(t,e,n)}function wee(t,e,n){return t.map(r=>vB(r,e,n))}function _B(t,e,n){return t.map(r=>b_(r,e,n))}function Tee(t,e,n){return t.map(r=>_B(r,e,n))}function bee(t,e,n){const r=n.projectFlat([e.west,e.north]),i=n.projectFlat([e.east,e.south]),s=[r,i];return{...t,coordinates:_ee[t.type](t.coordinates,s,n)}}const xee=["points","lines","polygons"];function Cee(t,e,n,r){for(const i of xee){const s=t[i]&&See(t[i],e,n,r);if(s>=0)return s}return-1}function See(t,e,n,r){const i=t.featureIds.value;if(!i.length)return-1;let s=0,o=i[i.length-1]+1;if(r){const l=Pee(t,r);if(l)s=l[0],o=l[1]+1;else return-1}let a=-1;if(e in t.numericProps){const l=t.numericProps[e].value.findIndex((h,p)=>h===n&&i[p]>=s&&i[p]<o);return l>=0?t.globalFeatureIds.value[l]:-1}else e?a=Ox(t.properties,l=>l[e]===n,s,o):t.fields&&(a=Ox(t.fields,l=>l.id===n,s,o));return a>=0?Mee(t,a):-1}function Pee(t,e){if(!t.__layers){const n={},{properties:r}=t;for(let i=0;i<r.length;i++){const{layerName:s}=r[i];s&&(n[s]?n[s][1]=i:n[s]=[i,i])}t.__layers=n}return t.__layers[e]}function Mee(t,e){if(!t.__ids){const n=[],r=t.featureIds.value,i=t.globalFeatureIds.value;for(let s=0;s<r.length;s++)n[r[s]]=i[s];t.__ids=n}return t.__ids[e]}function Ox(t,e,n,r){for(let i=n;i<r;i++)if(e(t[i],i))return i;return-1}const lm=512,Iee={...Fu.defaultProps,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[pB],binary:!0};class EB extends Nu{initializeState(){super.initializeState();const e=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:e,data:null,tileJSON:null})}get isLoaded(){return this.state&&this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:e,oldProps:n,context:r,changeFlags:i}){var s;i.dataChanged&&this._updateTileData(),(s=this.state)!==null&&s!==void 0&&s.data&&(super.updateState({props:e,oldProps:n,context:r,changeFlags:i}),this._setWGS84PropertyForTiles());const{highlightColor:o}=e;o!==n.highlightColor&&Array.isArray(o)&&this.setState({highlightColor:o})}async _updateTileData(){let e=this.props.data,n=null;if(typeof e=="string"&&!$Q(e)){const{onDataLoad:r,fetch:i}=this.props;this.setState({data:null,tileJSON:null});try{n=await i(e,{propName:"data",layer:this,loaders:[]})}catch(s){this.raiseError(s,"loading TileJSON"),e=null}r&&r(n,{propName:"data",layer:this})}else e.tilejson&&(n=e);n&&(e=n.tiles),this.setState({data:e,tileJSON:n})}_getTilesetOptions(){const e=super._getTilesetOptions(),n=this.state.tileJSON,{minZoom:r,maxZoom:i}=this.props;return n&&(Number.isFinite(n.minzoom)&&n.minzoom>r&&(e.minZoom=n.minzoom),Number.isFinite(n.maxzoom)&&(!Number.isFinite(i)||n.maxzoom<i)&&(e.maxZoom=n.maxzoom)),e}renderLayers(){var e;return(e=this.state)!==null&&e!==void 0&&e.data?super.renderLayers():null}getTileData(e){var n;const{data:r,binary:i}=this.state,{index:s,signal:o}=e,a=Nd(r,e);if(!a)return Promise.reject("Invalid URL");let l=this.getLoadOptions();const{fetch:h}=this.props;return l={...l,mimeType:"application/x-protobuf",mvt:{...(n=l)===null||n===void 0?void 0:n.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:s},gis:i?{format:"binary"}:{}},h(a,{propName:"data",layer:this,loadOptions:l,signal:o})}renderSubLayers(e){const{x:n,y:r,z:i}=e.tile.index,s=Math.pow(2,i),o=lm/s,a=-o,l=lm*n/s,h=lm*(1-r/s),p=new Ye().scale([o,a,1]);e.autoHighlight=!1,this.context.viewport.resolution||(e.modelMatrix=p,e.coordinateOrigin=[l,h,0],e.coordinateSystem=$e.CARTESIAN,e.extensions=[...e.extensions||[],new T_]);const m=super.renderSubLayers(e);return this.state.binary&&!(m instanceof Fu)&&Ve.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),m}_updateAutoHighlight(e){const{uniqueIdProperty:n}=this.props,{hoveredFeatureId:r,hoveredFeatureLayerName:i}=this.state,s=e.object;let o,a;s&&(o=cm(s,n),a=Fx(s));let{highlightColor:l}=this.props;typeof l=="function"&&(l=l(e)),(r!==o||i!==a)&&this.setState({highlightColor:l,hoveredFeatureId:o,hoveredFeatureLayerName:a})}getPickingInfo(e){const n=super.getPickingInfo(e),r=Boolean(this.context.viewport.resolution);if(this.state.binary&&n.index!==-1){const{data:i}=e.sourceLayer.props;n.object=Sx(i,{globalFeatureId:n.index})}return n.object&&!r&&(n.object=kx(n.object,n.tile.bbox,this.context.viewport)),n}getSubLayerPropsByTile(e){return{highlightedObjectIndex:this.getHighlightedObjectIndex(e),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(e){const{hoveredFeatureId:n,hoveredFeatureLayerName:r,binary:i}=this.state,{uniqueIdProperty:s,highlightedFeatureId:o}=this.props,a=e.content,l=Dx(o);if(!(Dx(n)||l))return-1;const p=l?o:n;return Array.isArray(a)?a.findIndex(m=>{const _=cm(m,s)===p,E=l||Fx(m)===r;return _&&E}):a&&i?Cee(a,s,p,l?"":r):-1}_pickObjects(e){const{deck:n,viewport:r}=this.context,i=r.width,s=r.height,o=r.x,a=r.y,l=[this.id];return n.pickObjects({x:o,y:a,width:i,height:s,layerIds:l,maxObjects:e})}getRenderedFeatures(e=null){const n=this._pickObjects(e),r=new Set,i=[];for(const s of n){const o=cm(s.object,this.props.uniqueIdProperty);o===void 0?i.push(s.object):r.has(o)||(r.add(o),i.push(s.object))}return i}_setWGS84PropertyForTiles(){const e="dataInWGS84";this.state.tileset.selectedTiles.forEach(r=>{r.hasOwnProperty(e)||Object.defineProperty(r,e,{get:()=>{if(!r.content)return null;if(this.state.binary&&Array.isArray(r.content)&&!r.content.length)return[];const{bbox:i}=r;if(r._contentWGS84===void 0&&XQ(i)){const s=this.state.binary?Sx(r.content):r.content;r._contentWGS84=s.map(o=>kx(o,i,this.context.viewport))}return r._contentWGS84}})})}}T(EB,"layerName","MVTLayer");T(EB,"defaultProps",Iee);function cm(t,e){if(t.properties&&e)return t.properties[e];if("id"in t)return t.id}function Fx(t){var e;return((e=t.properties)===null||e===void 0?void 0:e.layerName)||null}function Dx(t){return t!=null&&t!==""}function kx(t,e,n){const r={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(r.geometry,"coordinates",{get:()=>bee(t.geometry,e,n).coordinates}),r}const Nx="0123456789bcdefghjkmnpqrstuvwxyz",wB={};for(let t=0;t<Nx.length;t++)wB[Nx.charAt(t)]=t;const Bee=-90,Lee=90,Ree=-180,Oee=180;function Fee(t){let e=!0,n=Lee,r=Bee,i=Oee,s=Ree,o,a=0;for(let l=0,h=t.length;l<h;l++){const p=t[l].toLowerCase();a=wB[p];for(let m=4;m>=0;m--){const _=a>>m&1;e?(o=(i+s)/2,_===1?s=o:i=o):(o=(n+r)/2,_===1?r=o:n=o),e=!e}}return[r,s,n,i]}function Dee(t){const[e,n,r,i]=Fee(t);return[i,r,i,e,n,e,n,r,i,r]}const kee={getGeohash:{type:"accessor",value:t=>t.geohash}};class TB extends ac{indexToBounds(){const{data:e,getGeohash:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(r,i)=>Dee(n(r,i))}}}T(TB,"layerName","GeohashLayer");T(TB,"defaultProps",kee);const Nee="pk.eyJ1IjoibWF5cTA0MjIiLCJhIjoiY2phamMwOHV4MjllajMzbnFyeTMwcmZvYiJ9.aFMw4Aws5zY9Y4NwYqFMlQ",Uee=new aM({color:[255,255,255],intensity:1}),Gee=new b9({color:[255,255,255],intensity:2,position:[-74.05,40.7,8e3]}),zee=new Uv({ambientLight:Uee,pointLight:Gee}),Vee={ambient:.1,diffuse:.6,shininess:32,specularColor:[60,64,70]},Hee={buildingColor:[74,80,87],trailColor0:[253,128,93],trailColor1:[23,184,190],material:Vee,effects:[zee]},jee={longitude:104.392,latitude:36.067,zoom:4,pitch:0,bearing:0},Wee="mapbox://styles/mapbox/dark-v10";function Qee(t,e="CN"){t.setFilter("admin-0-boundary-disputed",["all",["==",["get","disputed"],"true"],["==",["get","admin_level"],0],["==",["get","maritime"],"false"],["match",["get","worldview"],["all",e],!0,!1]]),t.setFilter("admin-0-boundary",["all",["==",["get","admin_level"],0],["==",["get","disputed"],"false"],["==",["get","maritime"],"false"],["match",["get","worldview"],["all",e],!0,!1]]),t.setFilter("admin-0-boundary-bg",["all",["==",["get","admin_level"],0],["==",["get","maritime"],"false"],["match",["get","worldview"],["all",e],!0,!1]])}var bB=60,xB=bB*60,CB=xB*24,$ee=CB*7,Ts=1e3,Rl=bB*Ts,fu=xB*Ts,Jl=CB*Ts,SB=$ee*Ts,x_="millisecond",ml="second",yl="minute",vl="hour",Ws="day",Hh="week",wi="month",PB="quarter",Qs="year",_l="date",Xee="YYYY-MM-DDTHH:mm:ssZ",Ux="Invalid Date",Yee=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,MB=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g;const Jee={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")};var ry=function(e,n,r){var i=String(e);return!i||i.length>=n?e:""+Array(n+1-i.length).join(r)+e},Kee=function(e){var n=-e.utcOffset(),r=Math.abs(n),i=Math.floor(r/60),s=r%60;return(n<=0?"+":"-")+ry(i,2,"0")+":"+ry(s,2,"0")},Zee=function t(e,n){if(e.date()<n.date())return-t(n,e);var r=(n.year()-e.year())*12+(n.month()-e.month()),i=e.clone().add(r,wi),s=n-i<0,o=e.clone().add(r+(s?-1:1),wi);return+(-(r+(n-i)/(s?i-o:o-i))||0)},qee=function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},ete=function(e){var n={M:wi,y:Qs,w:Hh,d:Ws,D:_l,h:vl,m:yl,s:ml,ms:x_,Q:PB};return n[e]||String(e||"").toLowerCase().replace(/s$/,"")},tte=function(e){return e===void 0};const nte={s:ry,z:Kee,m:Zee,a:qee,p:ete,u:tte};var SA="en",qo={};qo[SA]=Jee;var C_=function(e){return e instanceof k0},Wd=function t(e,n,r){var i;if(!e)return SA;if(typeof e=="string"){var s=e.toLowerCase();qo[s]&&(i=s),n&&(qo[s]=n,i=s);var o=e.split("-");if(!i&&o.length>1)return t(o[0])}else{var a=e.name;qo[a]=e,i=a}return!r&&i&&(SA=i),i||!r&&SA},Zt=function(e,n){if(C_(e))return e.clone();var r=typeof n=="object"?n:{};return r.date=e,r.args=arguments,new k0(r)},rte=function(e,n){return Zt(e,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})},Lt=nte;Lt.l=Wd;Lt.i=C_;Lt.w=rte;var ite=function(e){var n=e.date,r=e.utc;if(n===null)return new Date(NaN);if(Lt.u(n))return new Date;if(n instanceof Date)return new Date(n);if(typeof n=="string"&&!/Z$/i.test(n)){var i=n.match(Yee);if(i){var s=i[2]-1||0,o=(i[7]||"0").substring(0,3);return r?new Date(Date.UTC(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)):new Date(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)}}return new Date(n)},k0=function(){function t(n){this.$L=Wd(n.locale,null,!0),this.parse(n)}var e=t.prototype;return e.parse=function(r){this.$d=ite(r),this.$x=r.x||{},this.init()},e.init=function(){var r=this.$d;this.$y=r.getFullYear(),this.$M=r.getMonth(),this.$D=r.getDate(),this.$W=r.getDay(),this.$H=r.getHours(),this.$m=r.getMinutes(),this.$s=r.getSeconds(),this.$ms=r.getMilliseconds()},e.$utils=function(){return Lt},e.isValid=function(){return this.$d.toString()!==Ux},e.isSame=function(r,i){var s=Zt(r);return this.startOf(i)<=s&&s<=this.endOf(i)},e.isAfter=function(r,i){return Zt(r)<this.startOf(i)},e.isBefore=function(r,i){return this.endOf(i)<Zt(r)},e.$g=function(r,i,s){return Lt.u(r)?this[i]:this.set(s,r)},e.unix=function(){return Math.floor(this.valueOf()/1e3)},e.valueOf=function(){return this.$d.getTime()},e.startOf=function(r,i){var s=this,o=Lt.u(i)?!0:i,a=Lt.p(r),l=function(S,P){var M=Lt.w(s.$u?Date.UTC(s.$y,P,S):new Date(s.$y,P,S),s);return o?M:M.endOf(Ws)},h=function(S,P){var M=[0,0,0,0],O=[23,59,59,999];return Lt.w(s.toDate()[S].apply(s.toDate("s"),(o?M:O).slice(P)),s)},p=this.$W,m=this.$M,_=this.$D,E="set"+(this.$u?"UTC":"");switch(a){case Qs:return o?l(1,0):l(31,11);case wi:return o?l(1,m):l(0,m+1);case Hh:{var b=this.$locale().weekStart||0,x=(p<b?p+7:p)-b;return l(o?_-x:_+(6-x),m)}case Ws:case _l:return h(E+"Hours",0);case vl:return h(E+"Minutes",1);case yl:return h(E+"Seconds",2);case ml:return h(E+"Milliseconds",3);default:return this.clone()}},e.endOf=function(r){return this.startOf(r,!1)},e.$set=function(r,i){var s,o=Lt.p(r),a="set"+(this.$u?"UTC":""),l=(s={},s[Ws]=a+"Date",s[_l]=a+"Date",s[wi]=a+"Month",s[Qs]=a+"FullYear",s[vl]=a+"Hours",s[yl]=a+"Minutes",s[ml]=a+"Seconds",s[x_]=a+"Milliseconds",s)[o],h=o===Ws?this.$D+(i-this.$W):i;if(o===wi||o===Qs){var p=this.clone().set(_l,1);p.$d[l](h),p.init(),this.$d=p.set(_l,Math.min(this.$D,p.daysInMonth())).$d}else l&&this.$d[l](h);return this.init(),this},e.set=function(r,i){return this.clone().$set(r,i)},e.get=function(r){return this[Lt.p(r)]()},e.add=function(r,i){var s=this,o;r=Number(r);var a=Lt.p(i),l=function(_){var E=Zt(s);return Lt.w(E.date(E.date()+Math.round(_*r)),s)};if(a===wi)return this.set(wi,this.$M+r);if(a===Qs)return this.set(Qs,this.$y+r);if(a===Ws)return l(1);if(a===Hh)return l(7);var h=(o={},o[yl]=Rl,o[vl]=fu,o[ml]=Ts,o)[a]||1,p=this.$d.getTime()+r*h;return Lt.w(p,this)},e.subtract=function(r,i){return this.add(r*-1,i)},e.format=function(r){var i=this,s=this.$locale();if(!this.isValid())return s.invalidDate||Ux;var o=r||Xee,a=Lt.z(this),l=this.$H,h=this.$m,p=this.$M,m=s.weekdays,_=s.months,E=s.meridiem,b=function(M,O,N,z){return M&&(M[O]||M(i,o))||N[O].slice(0,z)},x=function(M){return Lt.s(l%12||12,M,"0")},I=E||function(P,M,O){var N=P<12?"AM":"PM";return O?N.toLowerCase():N},S={YY:String(this.$y).slice(-2),YYYY:this.$y,M:p+1,MM:Lt.s(p+1,2,"0"),MMM:b(s.monthsShort,p,_,3),MMMM:b(_,p),D:this.$D,DD:Lt.s(this.$D,2,"0"),d:String(this.$W),dd:b(s.weekdaysMin,this.$W,m,2),ddd:b(s.weekdaysShort,this.$W,m,3),dddd:m[this.$W],H:String(l),HH:Lt.s(l,2,"0"),h:x(1),hh:x(2),a:I(l,h,!0),A:I(l,h,!1),m:String(h),mm:Lt.s(h,2,"0"),s:String(this.$s),ss:Lt.s(this.$s,2,"0"),SSS:Lt.s(this.$ms,3,"0"),Z:a};return o.replace(MB,function(P,M){return M||S[P]||a.replace(":","")})},e.utcOffset=function(){return-Math.round(this.$d.getTimezoneOffset()/15)*15},e.diff=function(r,i,s){var o,a=Lt.p(i),l=Zt(r),h=(l.utcOffset()-this.utcOffset())*Rl,p=this-l,m=Lt.m(this,l);return m=(o={},o[Qs]=m/12,o[wi]=m,o[PB]=m/3,o[Hh]=(p-h)/SB,o[Ws]=(p-h)/Jl,o[vl]=p/fu,o[yl]=p/Rl,o[ml]=p/Ts,o)[a]||p,s?m:Lt.a(m)},e.daysInMonth=function(){return this.endOf(wi).$D},e.$locale=function(){return qo[this.$L]},e.locale=function(r,i){if(!r)return this.$L;var s=this.clone(),o=Wd(r,i,!0);return o&&(s.$L=o),s},e.clone=function(){return Lt.w(this.$d,this)},e.toDate=function(){return new Date(this.valueOf())},e.toJSON=function(){return this.isValid()?this.toISOString():null},e.toISOString=function(){return this.$d.toISOString()},e.toString=function(){return this.$d.toUTCString()},t}(),IB=k0.prototype;Zt.prototype=IB;[["$ms",x_],["$s",ml],["$m",yl],["$H",vl],["$W",Ws],["$M",wi],["$y",Qs],["$D",_l]].forEach(function(t){IB[t[1]]=function(e){return this.$g(e,t[0],t[1])}});Zt.extend=function(t,e){return t.$i||(t(e,k0,Zt),t.$i=!0),Zt};Zt.locale=Wd;Zt.isDayjs=C_;Zt.unix=function(t){return Zt(t*1e3)};Zt.en=qo[SA];Zt.Ls=qo;Zt.p={};var iy=Jl*365,sy=Jl*30,ste=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,Qc={years:iy,months:sy,days:Jl,hours:fu,minutes:Rl,seconds:Ts,milliseconds:1,weeks:SB},jh=function(e){return e instanceof RB},BB,ji,lA=function(e,n,r){return new RB(e,r,n.$l)},$c=function(e){return ji.p(e)+"s"},LB=function(e){return e<0},ko=function(e){return LB(e)?Math.ceil(e):Math.floor(e)},ote=function(e){return Math.abs(e)},za=function(e,n){return e?LB(e)?{negative:!0,format:""+ote(e)+n}:{negative:!1,format:""+e+n}:{negative:!1,format:""}},RB=function(){function t(n,r,i){var s=this;if(this.$d={},this.$l=i,n===void 0&&(this.$ms=0,this.parseFromMilliseconds()),r)return lA(n*Qc[$c(r)],this);if(typeof n=="number")return this.$ms=n,this.parseFromMilliseconds(),this;if(typeof n=="object")return Object.keys(n).forEach(function(h){s.$d[$c(h)]=n[h]}),this.calMilliseconds(),this;if(typeof n=="string"){var o=n.match(ste);if(o){var a=o.slice(2),l=a.map(function(h){return h!=null?Number(h):0});return this.$d.years=l[0],this.$d.months=l[1],this.$d.weeks=l[2],this.$d.days=l[3],this.$d.hours=l[4],this.$d.minutes=l[5],this.$d.seconds=l[6],this.calMilliseconds(),this}}return this}var e=t.prototype;return e.calMilliseconds=function(){var r=this;this.$ms=Object.keys(this.$d).reduce(function(i,s){return i+(r.$d[s]||0)*Qc[s]},0)},e.parseFromMilliseconds=function(){var r=this.$ms;this.$d.years=ko(r/iy),r%=iy,this.$d.months=ko(r/sy),r%=sy,this.$d.days=ko(r/Jl),r%=Jl,this.$d.hours=ko(r/fu),r%=fu,this.$d.minutes=ko(r/Rl),r%=Rl,this.$d.seconds=ko(r/Ts),r%=Ts,this.$d.milliseconds=r},e.toISOString=function(){var r=za(this.$d.years,"Y"),i=za(this.$d.months,"M"),s=+this.$d.days||0;this.$d.weeks&&(s+=this.$d.weeks*7);var o=za(s,"D"),a=za(this.$d.hours,"H"),l=za(this.$d.minutes,"M"),h=this.$d.seconds||0;this.$d.milliseconds&&(h+=this.$d.milliseconds/1e3);var p=za(h,"S"),m=r.negative||i.negative||o.negative||a.negative||l.negative||p.negative,_=a.format||l.format||p.format?"T":"",E=m?"-":"",b=E+"P"+r.format+i.format+o.format+_+a.format+l.format+p.format;return b==="P"||b==="-P"?"P0D":b},e.toJSON=function(){return this.toISOString()},e.format=function(r){var i=r||"YYYY-MM-DDTHH:mm:ss",s={Y:this.$d.years,YY:ji.s(this.$d.years,2,"0"),YYYY:ji.s(this.$d.years,4,"0"),M:this.$d.months,MM:ji.s(this.$d.months,2,"0"),D:this.$d.days,DD:ji.s(this.$d.days,2,"0"),H:this.$d.hours,HH:ji.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:ji.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:ji.s(this.$d.seconds,2,"0"),SSS:ji.s(this.$d.milliseconds,3,"0")};return i.replace(MB,function(o,a){return a||String(s[o])})},e.as=function(r){return this.$ms/Qc[$c(r)]},e.get=function(r){var i=this.$ms,s=$c(r);return s==="milliseconds"?i%=1e3:s==="weeks"?i=ko(i/Qc[s]):i=this.$d[s],i===0?0:i},e.add=function(r,i,s){var o;return i?o=r*Qc[$c(i)]:jh(r)?o=r.$ms:o=lA(r,this).$ms,lA(this.$ms+o*(s?-1:1),this)},e.subtract=function(r,i){return this.add(r,i,!0)},e.locale=function(r){var i=this.clone();return i.$l=r,i},e.clone=function(){return lA(this.$ms,this)},e.humanize=function(r){return BB().add(this.$ms,"ms").locale(this.$l).fromNow(!r)},e.milliseconds=function(){return this.get("milliseconds")},e.asMilliseconds=function(){return this.as("milliseconds")},e.seconds=function(){return this.get("seconds")},e.asSeconds=function(){return this.as("seconds")},e.minutes=function(){return this.get("minutes")},e.asMinutes=function(){return this.as("minutes")},e.hours=function(){return this.get("hours")},e.asHours=function(){return this.as("hours")},e.days=function(){return this.get("days")},e.asDays=function(){return this.as("days")},e.weeks=function(){return this.get("weeks")},e.asWeeks=function(){return this.as("weeks")},e.months=function(){return this.get("months")},e.asMonths=function(){return this.as("months")},e.years=function(){return this.get("years")},e.asYears=function(){return this.as("years")},t}();const ate=function(t,e,n){BB=n,ji=n().$utils(),n.duration=function(s,o){var a=n.locale();return lA(s,{$l:a},o)},n.isDuration=jh;var r=e.prototype.add,i=e.prototype.subtract;e.prototype.add=function(s,o){return jh(s)&&(s=s.asMilliseconds()),r.bind(this)(s,o)},e.prototype.subtract=function(s,o){return jh(s)&&(s=s.asMilliseconds()),i.bind(this)(s,o)}};Zt.extend(ate);const lte=Zt("2022-07-31T00:00:00.000+08:00"),OB=[165921696e4,165928242e4],cte=new URLSearchParams(window.location.search),FB={isTimeShifting:!1};FB.isTimeShifting=cte.has("time-shifting");function Ate(t){return`https://en.m.wikipedia.org/wiki/${t}`}function S_(){let t=Zt();return FB.isTimeShifting&&(t=t.subtract(12,"hour")),Zt(lte).hour(t.hour()).minute(t.minute()).second(t.second())}function ute(t,e,n){return n=n.replace(/$/,""),t.filter(i=>{var a;const s=i.waypoints.findIndex(l=>l.station===n);if(s===-1)return!1;let o=i.waypoints[s];return o.station===((a=i.waypoints[s+1])==null?void 0:a.station)&&(o=i.waypoints[s+1]),!(o.timestamp>S_()||i.waypoints.at(-1).timestamp-o.timestamp<e)})}const fte={time:OB[0],playing:!1,startingTime:0,timeLength:0,routeList:[],stationMap:{},stationList:[],selectedStation:{},filteredRouteList:[],selectedRoute:[]};function hte(t,e){switch(e.type!=="setTime"&&console.log(e.type,e.payload),e.type){case"loadData":const{routeList:n,stationMap:r}=e.payload,i=Object.entries(r).map(([o,a])=>(a.stationName=o,{name:o,...a}));return n.forEach(o=>{o.waypoints.forEach(a=>{const l=r[`${a.station}\u7AD9`];l&&(a.coords=l.location)})}),{...t,routeList:n,stationMap:r,stationList:i,playing:!0};case"setTime":return{...t,time:e.payload};case"setTimeLength":return{...t,timeLength:e.payload};case"setSelectedStation":const s=e.payload;return{...t,selectedStation:t.stationMap[s],filteredRouteList:ute(t.routeList,t.timeLength,s)};case"setSelectedRoute":return{...t,startingTime:+S_(),selectedRoute:e.payload};default:throw new Error}}const P_=K.exports.createContext({});function dte({time:t=OB[0],stationList:e,filteredRouteList:n,selectedRoute:r}){const i=K.exports.useContext(P_),s=K.exports.useRef(),o=K.exports.useRef(new Set),a=r.length!==0,l=K.exports.useCallback(()=>{const E=s.current.getMap();Qee(E)},[]),h=E=>{var x;if(!((x=E.object)!=null&&x.name))return;console.log(E.object.name);const b=E.object.name;i({type:"setSelectedStation",payload:b})},p=E=>{!E.object||(console.log(E.object.trainCode),i({type:"setSelectedRoute",payload:[E.object]}),o.current=new Set(E.object.waypoints.map(b=>b.station+"\u7AD9")))},m=[new ca({id:"selectedRoutePathLayer",data:r,pickable:!0,visible:a,autoHighlight:!0,highlightColor:[255,235,59],widthScale:20,widthMinPixels:1,getPath:E=>E.waypoints.map(b=>b.coords),getColor:[255,235,59],opacity:.05}),new s_({id:"selectedRouteTripsLayer",data:r,visible:a,getPath:E=>E.waypoints.map(b=>b.coords),getTimestamps:E=>E.waypoints.map(b=>b.timestamp),getColor:[255,200,100],opacity:1,widthMinPixels:6,capRounded:!0,jointRounded:!0,fadeTrail:!0,trailLength:5e6,currentTime:t,shadowEnabled:!1}),new ca({id:"filteredRouteListLayer",data:n,pickable:!0,visible:!a,autoHighlight:!0,highlightColor:[255,235,59],widthScale:20,widthMinPixels:2,getPath:E=>E.waypoints.map(b=>b.coords),getColor:[0,187,144],opacity:.3,onClick:p}),new C0({id:"stationLayer",data:e,pickable:!0,autoHighlight:!0,highlightColor:[255,200,100],opacity:.5,stroked:!1,filled:!0,radiusScale:6,radiusMinPixels:2,radiusMaxPixels:10,lineWidthMinPixels:1,getPosition:E=>E.location,getRadius:500,getFillColor:E=>a?o.current.has(E.name)?[255,255,0,200]:[255,140,0,50]:[255,140,0,100],onHover:h})],_=E=>{const{layer:b,object:x}=E;if(!x)return null;const I=b==null?void 0:b.id;if(I==="stationLayer")return x.name;if(I==="filteredRouteListLayer"||I==="selectedRoutePathLayer"){const S=x.waypoints.map(P=>P.station).join(" -> ");return`${x.trainCode}
${S}`}return null};return ze(kM,{layers:m,effects:Hee.effects,initialViewState:jee,controller:!0,getTooltip:_,children:ze(ov,{reuseMaps:!0,ref:s,onLoad:l,mapStyle:Wee,mapboxAccessToken:Nee})})}function zn(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function ue(){return ue=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ue.apply(this,arguments)}function DB(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=DB(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function en(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=DB(t))&&(r&&(r+=" "),r+=e);return r}function lh(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function ds(t,e,n={clone:!0}){const r=n.clone?ue({},t):t;return lh(t)&&lh(e)&&Object.keys(e).forEach(i=>{i!=="__proto__"&&(lh(e[i])&&i in t&&lh(t[i])?r[i]=ds(t[i],e[i],n):r[i]=e[i])}),r}function Kl(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function kt(t){if(typeof t!="string")throw new Error(Kl(7));return t.charAt(0).toUpperCase()+t.slice(1)}function Wh(t){return t&&t.ownerDocument||document}function Gx(t,e){typeof t=="function"?t(e):t&&(t.current=e)}const pte=typeof window<"u"?K.exports.useLayoutEffect:K.exports.useEffect,kB=pte;function gte({controlled:t,default:e,name:n,state:r="value"}){const{current:i}=K.exports.useRef(t!==void 0),[s,o]=K.exports.useState(e),a=i?t:s,l=K.exports.useCallback(h=>{i||o(h)},[]);return[a,l]}function Qo(t){const e=K.exports.useRef(t);return kB(()=>{e.current=t}),K.exports.useCallback((...n)=>(0,e.current)(...n),[])}function ea(t,e){return K.exports.useMemo(()=>t==null&&e==null?null:n=>{Gx(t,n),Gx(e,n)},[t,e])}let N0=!0,oy=!1,zx;const mte={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function yte(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&mte[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function vte(t){t.metaKey||t.altKey||t.ctrlKey||(N0=!0)}function Am(){N0=!1}function _te(){this.visibilityState==="hidden"&&oy&&(N0=!0)}function Ete(t){t.addEventListener("keydown",vte,!0),t.addEventListener("mousedown",Am,!0),t.addEventListener("pointerdown",Am,!0),t.addEventListener("touchstart",Am,!0),t.addEventListener("visibilitychange",_te,!0)}function wte(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return N0||yte(e)}function NB(){const t=K.exports.useCallback(i=>{i!=null&&Ete(i.ownerDocument)},[]),e=K.exports.useRef(!1);function n(){return e.current?(oy=!0,window.clearTimeout(zx),zx=window.setTimeout(()=>{oy=!1},100),e.current=!1,!0):!1}function r(i){return wte(i)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}const Tte={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:-1,overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},bte=Tte;function UB(t,e){const n=ue({},e);return Object.keys(t).forEach(r=>{n[r]===void 0&&(n[r]=t[r])}),n}function M_(t,e,n){const r={};return Object.keys(t).forEach(i=>{r[i]=t[i].reduce((s,o)=>(o&&(s.push(e(o)),n&&n[o]&&s.push(n[o])),s),[]).join(" ")}),r}const Vx=t=>t,xte=()=>{let t=Vx;return{configure(e){t=e},generate(e){return t(e)},reset(){t=Vx}}},Cte=xte(),Ste=Cte,Pte={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function U0(t,e,n="Mui"){const r=Pte[e];return r?`${n}-${r}`:`${Ste.generate(t)}-${e}`}function Uu(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=U0(t,i,n)}),r}function PA(t){return typeof t=="string"}function Mte(t,e={},n){return PA(t)?e:ue({},e,{ownerState:ue({},e.ownerState,n)})}function Ite(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function Bte(t,e){return typeof t=="function"?t(e):t}function Hx(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function Lte(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:s}=t;if(!e){const E=en(i==null?void 0:i.className,r==null?void 0:r.className,s,n==null?void 0:n.className),b=ue({},n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),x=ue({},n,i,r);return E.length>0&&(x.className=E),Object.keys(b).length>0&&(x.style=b),{props:x,internalRef:void 0}}const o=Ite(ue({},i,r)),a=Hx(r),l=Hx(i),h=e(o),p=en(h==null?void 0:h.className,n==null?void 0:n.className,s,i==null?void 0:i.className,r==null?void 0:r.className),m=ue({},h==null?void 0:h.style,n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),_=ue({},h,n,l,a);return p.length>0&&(_.className=p),Object.keys(m).length>0&&(_.style=m),{props:_,internalRef:h.ref}}const Rte=["elementType","externalSlotProps","ownerState"];function Vs(t){var e;const{elementType:n,externalSlotProps:r,ownerState:i}=t,s=zn(t,Rte),o=Bte(r,i),{props:a,internalRef:l}=Lte(ue({},s,{externalSlotProps:o})),h=ea(l,ea(o==null?void 0:o.ref,(e=t.additionalProps)==null?void 0:e.ref));return Mte(n,ue({},a,{ref:h}),i)}function cA(t){return U0("MuiSlider",t)}const Ote=Uu("MuiSlider",["root","active","focusVisible","disabled","dragging","marked","vertical","trackInverted","trackFalse","rail","track","mark","markActive","markLabel","markLabelActive","thumb","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel"]),Qh=Ote,Fte=t=>{const{open:e}=t;return{offset:en(e&&Qh.valueLabelOpen),circle:Qh.valueLabelCircle,label:Qh.valueLabelLabel}};function GB(t){const{children:e,className:n,value:r}=t,i=Fte(t);return K.exports.cloneElement(e,{className:en(e.props.className)},ii(K.exports.Fragment,{children:[e.props.children,ze("span",{className:en(i.offset,n),"aria-hidden":!0,children:ze("span",{className:i.circle,children:ze("span",{className:i.label,children:r})})})]}))}const Dte=2;function zB(t,e){return t-e}function Xc(t,e,n){return t==null?e:Math.min(Math.max(e,t),n)}function jx(t,e){var n;const{index:r}=(n=t.reduce((i,s,o)=>{const a=Math.abs(e-s);return i===null||a<i.distance||a===i.distance?{distance:a,index:o}:i},null))!=null?n:{};return r}function ch(t,e){if(e.current!==void 0&&t.changedTouches){const n=t;for(let r=0;r<n.changedTouches.length;r+=1){const i=n.changedTouches[r];if(i.identifier===e.current)return{x:i.clientX,y:i.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function Qd(t,e,n){return(t-e)*100/(n-e)}function kte(t,e,n){return(n-e)*t+e}function Nte(t){if(Math.abs(t)<1){const n=t.toExponential().split("e-"),r=n[0].split(".")[1];return(r?r.length:0)+parseInt(n[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function Ute(t,e,n){const r=Math.round((t-n)/e)*e+n;return Number(r.toFixed(Nte(e)))}function Wx({values:t,newValue:e,index:n}){const r=t.slice();return r[n]=e,r.sort(zB)}function Ah({sliderRef:t,activeIndex:e,setActive:n}){var r,i;const s=Wh(t.current);if(!((r=t.current)!=null&&r.contains(s.activeElement))||Number(s==null||(i=s.activeElement)==null?void 0:i.getAttribute("data-index"))!==e){var o;(o=t.current)==null||o.querySelector(`[type="range"][data-index="${e}"]`).focus()}n&&n(e)}const Gte={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},zte=t=>t;let uh;function um(){return uh===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?uh=CSS.supports("touch-action","none"):uh=!0),uh}function Vte(t){const{"aria-labelledby":e,defaultValue:n,disabled:r=!1,disableSwap:i=!1,isRtl:s=!1,marks:o=!1,max:a=100,min:l=0,name:h,onChange:p,onChangeCommitted:m,orientation:_="horizontal",ref:E,scale:b=zte,step:x=1,tabIndex:I,value:S}=t,P=K.exports.useRef(),[M,O]=K.exports.useState(-1),[N,z]=K.exports.useState(-1),[X,Z]=K.exports.useState(!1),Q=K.exports.useRef(0),[k,D]=gte({controlled:S,default:n!=null?n:l,name:"Slider"}),ne=p&&((pe,Oe,Xe)=>{const et=pe.nativeEvent||pe,We=new et.constructor(et.type,et);Object.defineProperty(We,"target",{writable:!0,value:{value:Oe,name:h}}),p(We,Oe,Xe)}),se=Array.isArray(k);let oe=se?k.slice().sort(zB):[k];oe=oe.map(pe=>Xc(pe,l,a));const xe=o===!0&&x!==null?[...Array(Math.floor((a-l)/x)+1)].map((pe,Oe)=>({value:l+x*Oe})):o||[],Pe=xe.map(pe=>pe.value),{isFocusVisibleRef:Ue,onBlur:le,onFocus:ve,ref:Ce}=NB(),[Fe,ke]=K.exports.useState(-1),it=K.exports.useRef(),Rt=ea(Ce,it),Pn=ea(E,Rt),un=pe=>Oe=>{var Xe;const et=Number(Oe.currentTarget.getAttribute("data-index"));ve(Oe),Ue.current===!0&&ke(et),z(et),pe==null||(Xe=pe.onFocus)==null||Xe.call(pe,Oe)},Tt=pe=>Oe=>{var Xe;le(Oe),Ue.current===!1&&ke(-1),z(-1),pe==null||(Xe=pe.onBlur)==null||Xe.call(pe,Oe)};kB(()=>{if(r&&it.current.contains(document.activeElement)){var pe;(pe=document.activeElement)==null||pe.blur()}},[r]),r&&M!==-1&&O(-1),r&&Fe!==-1&&ke(-1);const Ut=pe=>Oe=>{var Xe;(Xe=pe.onChange)==null||Xe.call(pe,Oe);const et=Number(Oe.currentTarget.getAttribute("data-index")),We=oe[et],lt=Pe.indexOf(We);let Me=Oe.target.valueAsNumber;if(xe&&x==null&&(Me=Me<We?Pe[lt-1]:Pe[lt+1]),Me=Xc(Me,l,a),xe&&x==null){const Vt=Pe.indexOf(oe[et]);Me=Me<oe[et]?Pe[Vt-1]:Pe[Vt+1]}if(se){i&&(Me=Xc(Me,oe[et-1]||-1/0,oe[et+1]||1/0));const Vt=Me;Me=Wx({values:oe,newValue:Me,index:et});let at=et;i||(at=Me.indexOf(Vt)),Ah({sliderRef:it,activeIndex:at})}D(Me),ke(et),ne&&ne(Oe,Me,et),m&&m(Oe,Me)},ot=K.exports.useRef();let Gt=_;s&&_==="horizontal"&&(Gt+="-reverse");const zt=({finger:pe,move:Oe=!1})=>{const{current:Xe}=it,{width:et,height:We,bottom:lt,left:Me}=Xe.getBoundingClientRect();let Vt;Gt.indexOf("vertical")===0?Vt=(lt-pe.y)/We:Vt=(pe.x-Me)/et,Gt.indexOf("-reverse")!==-1&&(Vt=1-Vt);let at;if(at=kte(Vt,l,a),x)at=Ute(at,x,l);else{const Ps=jx(Pe,at);at=Pe[Ps]}at=Xc(at,l,a);let sr=0;if(se){Oe?sr=ot.current:sr=jx(oe,at),i&&(at=Xc(at,oe[sr-1]||-1/0,oe[sr+1]||1/0));const Ps=at;at=Wx({values:oe,newValue:at,index:sr}),i&&Oe||(sr=at.indexOf(Ps),ot.current=sr)}return{newValue:at,activeIndex:sr}},Mn=Qo(pe=>{const Oe=ch(pe,P);if(!Oe)return;if(Q.current+=1,pe.type==="mousemove"&&pe.buttons===0){In(pe);return}const{newValue:Xe,activeIndex:et}=zt({finger:Oe,move:!0});Ah({sliderRef:it,activeIndex:et,setActive:O}),D(Xe),!X&&Q.current>Dte&&Z(!0),ne&&Xe!==k&&ne(pe,Xe,et)}),In=Qo(pe=>{const Oe=ch(pe,P);if(Z(!1),!Oe)return;const{newValue:Xe}=zt({finger:Oe,move:!0});O(-1),pe.type==="touchend"&&z(-1),m&&m(pe,Xe),P.current=void 0,kn()}),jn=Qo(pe=>{if(r)return;um()||pe.preventDefault();const Oe=pe.changedTouches[0];Oe!=null&&(P.current=Oe.identifier);const Xe=ch(pe,P);if(Xe!==!1){const{newValue:We,activeIndex:lt}=zt({finger:Xe});Ah({sliderRef:it,activeIndex:lt,setActive:O}),D(We),ne&&ne(pe,We,lt)}Q.current=0;const et=Wh(it.current);et.addEventListener("touchmove",Mn),et.addEventListener("touchend",In)}),kn=K.exports.useCallback(()=>{const pe=Wh(it.current);pe.removeEventListener("mousemove",Mn),pe.removeEventListener("mouseup",In),pe.removeEventListener("touchmove",Mn),pe.removeEventListener("touchend",In)},[In,Mn]);K.exports.useEffect(()=>{const{current:pe}=it;return pe.addEventListener("touchstart",jn,{passive:um()}),()=>{pe.removeEventListener("touchstart",jn,{passive:um()}),kn()}},[kn,jn]),K.exports.useEffect(()=>{r&&kn()},[r,kn]);const yn=pe=>Oe=>{var Xe;if((Xe=pe.onMouseDown)==null||Xe.call(pe,Oe),r||Oe.defaultPrevented||Oe.button!==0)return;Oe.preventDefault();const et=ch(Oe,P);if(et!==!1){const{newValue:lt,activeIndex:Me}=zt({finger:et});Ah({sliderRef:it,activeIndex:Me,setActive:O}),D(lt),ne&&ne(Oe,lt,Me)}Q.current=0;const We=Wh(it.current);We.addEventListener("mousemove",Mn),We.addEventListener("mouseup",In)},on=Qd(se?oe[0]:l,l,a),rr=Qd(oe[oe.length-1],l,a)-on,$r=(pe={})=>{const Oe={onMouseDown:yn(pe||{})},Xe=ue({},pe,Oe);return ue({ref:Pn},Xe)},ir=pe=>Oe=>{var Xe;(Xe=pe.onMouseOver)==null||Xe.call(pe,Oe);const et=Number(Oe.currentTarget.getAttribute("data-index"));z(et)},vt=pe=>Oe=>{var Xe;(Xe=pe.onMouseLeave)==null||Xe.call(pe,Oe),z(-1)};return{active:M,axis:Gt,axisProps:Gte,dragging:X,focusedThumbIndex:Fe,getHiddenInputProps:(pe={})=>{var Oe;const Xe={onChange:Ut(pe||{}),onFocus:un(pe||{}),onBlur:Tt(pe||{})},et=ue({},pe,Xe);return ue({tabIndex:I,"aria-labelledby":e,"aria-orientation":_,"aria-valuemax":b(a),"aria-valuemin":b(l),name:h,type:"range",min:t.min,max:t.max,step:(Oe=t.step)!=null?Oe:void 0,disabled:r},et,{style:ue({},bte,{direction:s?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:$r,getThumbProps:(pe={})=>{const Oe={onMouseOver:ir(pe||{}),onMouseLeave:vt(pe||{})};return ue({},pe,Oe)},marks:xe,open:N,range:se,trackLeap:rr,trackOffset:on,values:oe}}const Hte=["aria-label","aria-valuetext","className","component","classes","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","scale","step","tabIndex","track","value","valueLabelDisplay","valueLabelFormat","isRtl","components","componentsProps"],Qx=t=>t,jte=t=>{const{disabled:e,dragging:n,marked:r,orientation:i,track:s,classes:o}=t;return M_({root:["root",e&&"disabled",n&&"dragging",r&&"marked",i==="vertical"&&"vertical",s==="inverted"&&"trackInverted",s===!1&&"trackFalse"],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled"],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]},cA,o)},Wte=({children:t})=>t,Qte=K.exports.forwardRef(function(e,n){var r,i,s,o,a,l,h;const{"aria-label":p,"aria-valuetext":m,className:_,component:E,classes:b,disableSwap:x=!1,disabled:I=!1,getAriaLabel:S,getAriaValueText:P,marks:M=!1,max:O=100,min:N=0,orientation:z="horizontal",scale:X=Qx,step:Z=1,track:Q="normal",valueLabelDisplay:k="off",valueLabelFormat:D=Qx,isRtl:ne=!1,components:se={},componentsProps:oe={}}=e,xe=zn(e,Hte),Pe=ue({},e,{marks:M,classes:b,disabled:I,isRtl:ne,max:O,min:N,orientation:z,scale:X,step:Z,track:Q,valueLabelDisplay:k,valueLabelFormat:D}),{axisProps:Ue,getRootProps:le,getHiddenInputProps:ve,getThumbProps:Ce,open:Fe,active:ke,axis:it,range:Rt,focusedThumbIndex:Pn,dragging:un,marks:Tt,values:Ut,trackOffset:ot,trackLeap:Gt}=Vte(ue({},Pe,{ref:n}));Pe.marked=Tt.length>0&&Tt.some(We=>We.label),Pe.dragging=un,Pe.focusedThumbIndex=Pn;const zt=jte(Pe),Mn=(r=E!=null?E:se.Root)!=null?r:"span",In=Vs({elementType:Mn,getSlotProps:le,externalSlotProps:oe.root,externalForwardedProps:xe,ownerState:Pe,className:[zt.root,_]}),jn=(i=se.Rail)!=null?i:"span",kn=Vs({elementType:jn,externalSlotProps:oe.rail,ownerState:Pe,className:zt.rail}),yn=(s=se.Track)!=null?s:"span",on=Vs({elementType:yn,externalSlotProps:oe.track,additionalProps:{style:ue({},Ue[it].offset(ot),Ue[it].leap(Gt))},ownerState:Pe,className:zt.track}),rr=(o=se.Thumb)!=null?o:"span",$r=Vs({elementType:rr,getSlotProps:Ce,externalSlotProps:oe.thumb,ownerState:Pe}),ir=(a=se.ValueLabel)!=null?a:GB,vt=Vs({elementType:ir,externalSlotProps:oe.valueLabel,ownerState:Pe}),Xr=(l=se.Mark)!=null?l:"span",fi=Vs({elementType:Xr,externalSlotProps:oe.mark,ownerState:Pe,className:zt.mark}),pe=(h=se.MarkLabel)!=null?h:"span",Oe=Vs({elementType:pe,externalSlotProps:oe.markLabel,ownerState:Pe}),Xe=se.Input||"input",et=Vs({elementType:Xe,getSlotProps:ve,externalSlotProps:oe.input,ownerState:Pe});return ii(Mn,ue({},In,{children:[ze(jn,ue({},kn)),ze(yn,ue({},on)),Tt.filter(We=>We.value>=N&&We.value<=O).map((We,lt)=>{const Me=Qd(We.value,N,O),Vt=Ue[it].offset(Me);let at;return Q===!1?at=Ut.indexOf(We.value)!==-1:at=Q==="normal"&&(Rt?We.value>=Ut[0]&&We.value<=Ut[Ut.length-1]:We.value<=Ut[0])||Q==="inverted"&&(Rt?We.value<=Ut[0]||We.value>=Ut[Ut.length-1]:We.value>=Ut[0]),ii(K.exports.Fragment,{children:[ze(Xr,ue({"data-index":lt},fi,!PA(Xr)&&{markActive:at},{style:ue({},Vt,fi.style),className:en(fi.className,at&&zt.markActive)})),We.label!=null?ze(pe,ue({"aria-hidden":!0,"data-index":lt},Oe,!PA(pe)&&{markLabelActive:at},{style:ue({},Vt,Oe.style),className:en(zt.markLabel,Oe.className,at&&zt.markLabelActive),children:We.label})):null]},We.value)}),Ut.map((We,lt)=>{const Me=Qd(We,N,O),Vt=Ue[it].offset(Me),at=k==="off"?Wte:ir;return ze(K.exports.Fragment,{children:ze(at,ue({},!PA(at)&&{valueLabelFormat:D,valueLabelDisplay:k,value:typeof D=="function"?D(X(We),lt):D,index:lt,open:Fe===lt||ke===lt||k==="on",disabled:I},vt,{className:en(zt.valueLabel,vt.className),children:ze(rr,ue({"data-index":lt,"data-focusvisible":Pn===lt},$r,{className:en(zt.thumb,$r.className,ke===lt&&zt.active,Pn===lt&&zt.focusVisible),style:ue({},Vt,{pointerEvents:x&&ke!==lt?"none":void 0},$r.style),children:ze(Xe,ue({"data-index":lt,"aria-label":S?S(lt):p,"aria-valuenow":X(We),"aria-valuetext":P?P(X(We),lt):m,value:Ut[lt]},et))}))}))},lt)})]}))}),$te=Qte;function VB(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var Xte=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Yte=VB(function(t){return Xte.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91});function Jte(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Kte(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Zte=function(){function t(n){var r=this;this._insertTag=function(i){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,s),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Kte(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=Jte(i);try{s.insertRule(r,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),Yn="-ms-",$d="-moz-",_t="-webkit-",HB="comm",I_="rule",B_="decl",qte="@import",jB="@keyframes",ene=Math.abs,G0=String.fromCharCode,tne=Object.assign;function nne(t,e){return(((e<<2^mr(t,0))<<2^mr(t,1))<<2^mr(t,2))<<2^mr(t,3)}function WB(t){return t.trim()}function rne(t,e){return(t=e.exec(t))?t[0]:t}function xt(t,e,n){return t.replace(e,n)}function ay(t,e){return t.indexOf(e)}function mr(t,e){return t.charCodeAt(e)|0}function hu(t,e,n){return t.slice(e,n)}function Qi(t){return t.length}function L_(t){return t.length}function fh(t,e){return e.push(t),t}function ine(t,e){return t.map(e).join("")}var z0=1,Zl=1,QB=0,br=0,pn=0,Ac="";function V0(t,e,n,r,i,s,o){return{value:t,root:e,parent:n,type:r,props:i,children:s,line:z0,column:Zl,length:o,return:""}}function Yc(t,e){return tne(V0("",null,null,"",null,null,0),t,{length:-t.length},e)}function sne(){return pn}function one(){return pn=br>0?mr(Ac,--br):0,Zl--,pn===10&&(Zl=1,z0--),pn}function Gr(){return pn=br<QB?mr(Ac,br++):0,Zl++,pn===10&&(Zl=1,z0++),pn}function es(){return mr(Ac,br)}function $h(){return br}function Gu(t,e){return hu(Ac,t,e)}function du(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function $B(t){return z0=Zl=1,QB=Qi(Ac=t),br=0,[]}function XB(t){return Ac="",t}function Xh(t){return WB(Gu(br-1,ly(t===91?t+2:t===40?t+1:t)))}function ane(t){for(;(pn=es())&&pn<33;)Gr();return du(t)>2||du(pn)>3?"":" "}function lne(t,e){for(;--e&&Gr()&&!(pn<48||pn>102||pn>57&&pn<65||pn>70&&pn<97););return Gu(t,$h()+(e<6&&es()==32&&Gr()==32))}function ly(t){for(;Gr();)switch(pn){case t:return br;case 34:case 39:t!==34&&t!==39&&ly(pn);break;case 40:t===41&&ly(t);break;case 92:Gr();break}return br}function cne(t,e){for(;Gr()&&t+pn!==47+10;)if(t+pn===42+42&&es()===47)break;return"/*"+Gu(e,br-1)+"*"+G0(t===47?t:Gr())}function Ane(t){for(;!du(es());)Gr();return Gu(t,br)}function une(t){return XB(Yh("",null,null,null,[""],t=$B(t),0,[0],t))}function Yh(t,e,n,r,i,s,o,a,l){for(var h=0,p=0,m=o,_=0,E=0,b=0,x=1,I=1,S=1,P=0,M="",O=i,N=s,z=r,X=M;I;)switch(b=P,P=Gr()){case 40:if(b!=108&&X.charCodeAt(m-1)==58){ay(X+=xt(Xh(P),"&","&\f"),"&\f")!=-1&&(S=-1);break}case 34:case 39:case 91:X+=Xh(P);break;case 9:case 10:case 13:case 32:X+=ane(b);break;case 92:X+=lne($h()-1,7);continue;case 47:switch(es()){case 42:case 47:fh(fne(cne(Gr(),$h()),e,n),l);break;default:X+="/"}break;case 123*x:a[h++]=Qi(X)*S;case 125*x:case 59:case 0:switch(P){case 0:case 125:I=0;case 59+p:E>0&&Qi(X)-m&&fh(E>32?Xx(X+";",r,n,m-1):Xx(xt(X," ","")+";",r,n,m-2),l);break;case 59:X+=";";default:if(fh(z=$x(X,e,n,h,p,i,a,M,O=[],N=[],m),s),P===123)if(p===0)Yh(X,e,z,z,O,s,m,a,N);else switch(_){case 100:case 109:case 115:Yh(t,z,z,r&&fh($x(t,z,z,0,0,i,a,M,i,O=[],m),N),i,N,m,a,r?O:N);break;default:Yh(X,z,z,z,[""],N,0,a,N)}}h=p=E=0,x=S=1,M=X="",m=o;break;case 58:m=1+Qi(X),E=b;default:if(x<1){if(P==123)--x;else if(P==125&&x++==0&&one()==125)continue}switch(X+=G0(P),P*x){case 38:S=p>0?1:(X+="\f",-1);break;case 44:a[h++]=(Qi(X)-1)*S,S=1;break;case 64:es()===45&&(X+=Xh(Gr())),_=es(),p=m=Qi(M=X+=Ane($h())),P++;break;case 45:b===45&&Qi(X)==2&&(x=0)}}return s}function $x(t,e,n,r,i,s,o,a,l,h,p){for(var m=i-1,_=i===0?s:[""],E=L_(_),b=0,x=0,I=0;b<r;++b)for(var S=0,P=hu(t,m+1,m=ene(x=o[b])),M=t;S<E;++S)(M=WB(x>0?_[S]+" "+P:xt(P,/&\f/g,_[S])))&&(l[I++]=M);return V0(t,e,n,i===0?I_:a,l,h,p)}function fne(t,e,n){return V0(t,e,n,HB,G0(sne()),hu(t,2,-2),0)}function Xx(t,e,n,r){return V0(t,e,n,B_,hu(t,0,r),hu(t,r+1,-1),r)}function YB(t,e){switch(nne(t,e)){case 5103:return _t+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return _t+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return _t+t+$d+t+Yn+t+t;case 6828:case 4268:return _t+t+Yn+t+t;case 6165:return _t+t+Yn+"flex-"+t+t;case 5187:return _t+t+xt(t,/(\w+).+(:[^]+)/,_t+"box-$1$2"+Yn+"flex-$1$2")+t;case 5443:return _t+t+Yn+"flex-item-"+xt(t,/flex-|-self/,"")+t;case 4675:return _t+t+Yn+"flex-line-pack"+xt(t,/align-content|flex-|-self/,"")+t;case 5548:return _t+t+Yn+xt(t,"shrink","negative")+t;case 5292:return _t+t+Yn+xt(t,"basis","preferred-size")+t;case 6060:return _t+"box-"+xt(t,"-grow","")+_t+t+Yn+xt(t,"grow","positive")+t;case 4554:return _t+xt(t,/([^-])(transform)/g,"$1"+_t+"$2")+t;case 6187:return xt(xt(xt(t,/(zoom-|grab)/,_t+"$1"),/(image-set)/,_t+"$1"),t,"")+t;case 5495:case 3959:return xt(t,/(image-set\([^]*)/,_t+"$1$`$1");case 4968:return xt(xt(t,/(.+:)(flex-)?(.*)/,_t+"box-pack:$3"+Yn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+_t+t+t;case 4095:case 3583:case 4068:case 2532:return xt(t,/(.+)-inline(.+)/,_t+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Qi(t)-1-e>6)switch(mr(t,e+1)){case 109:if(mr(t,e+4)!==45)break;case 102:return xt(t,/(.+:)(.+)-([^]+)/,"$1"+_t+"$2-$3$1"+$d+(mr(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~ay(t,"stretch")?YB(xt(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(mr(t,e+1)!==115)break;case 6444:switch(mr(t,Qi(t)-3-(~ay(t,"!important")&&10))){case 107:return xt(t,":",":"+_t)+t;case 101:return xt(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+_t+(mr(t,14)===45?"inline-":"")+"box$3$1"+_t+"$2$3$1"+Yn+"$2box$3")+t}break;case 5936:switch(mr(t,e+11)){case 114:return _t+t+Yn+xt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return _t+t+Yn+xt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return _t+t+Yn+xt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return _t+t+Yn+t+t}return t}function Ol(t,e){for(var n="",r=L_(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function hne(t,e,n,r){switch(t.type){case qte:case B_:return t.return=t.return||t.value;case HB:return"";case jB:return t.return=t.value+"{"+Ol(t.children,r)+"}";case I_:t.value=t.props.join(",")}return Qi(n=Ol(t.children,r))?t.return=t.value+"{"+n+"}":""}function dne(t){var e=L_(t);return function(n,r,i,s){for(var o="",a=0;a<e;a++)o+=t[a](n,r,i,s)||"";return o}}function pne(t){return function(e){e.root||(e=e.return)&&t(e)}}function gne(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case B_:t.return=YB(t.value,t.length);break;case jB:return Ol([Yc(t,{value:xt(t.value,"@","@"+_t)})],r);case I_:if(t.length)return ine(t.props,function(i){switch(rne(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ol([Yc(t,{props:[xt(i,/:(read-\w+)/,":"+$d+"$1")]})],r);case"::placeholder":return Ol([Yc(t,{props:[xt(i,/:(plac\w+)/,":"+_t+"input-$1")]}),Yc(t,{props:[xt(i,/:(plac\w+)/,":"+$d+"$1")]}),Yc(t,{props:[xt(i,/:(plac\w+)/,Yn+"input-$1")]})],r)}return""})}}var mne=function(e,n,r){for(var i=0,s=0;i=s,s=es(),i===38&&s===12&&(n[r]=1),!du(s);)Gr();return Gu(e,br)},yne=function(e,n){var r=-1,i=44;do switch(du(i)){case 0:i===38&&es()===12&&(n[r]=1),e[r]+=mne(br-1,n,r);break;case 2:e[r]+=Xh(i);break;case 4:if(i===44){e[++r]=es()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=G0(i)}while(i=Gr());return e},vne=function(e,n){return XB(yne($B(e),n))},Yx=new WeakMap,_ne=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!Yx.get(r))&&!i){Yx.set(e,!0);for(var s=[],o=vne(n,s),a=r.props,l=0,h=0;l<o.length;l++)for(var p=0;p<a.length;p++,h++)e.props[h]=s[l]?o[l].replace(/&\f/g,a[p]):a[p]+" "+o[l]}}},Ene=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}},wne=[gne],Tne=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(x){var I=x.getAttribute("data-emotion");I.indexOf(" ")!==-1&&(document.head.appendChild(x),x.setAttribute("data-s",""))})}var i=e.stylisPlugins||wne,s={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(x){for(var I=x.getAttribute("data-emotion").split(" "),S=1;S<I.length;S++)s[I[S]]=!0;a.push(x)});var l,h=[_ne,Ene];{var p,m=[hne,pne(function(x){p.insert(x)})],_=dne(h.concat(i,m)),E=function(I){return Ol(une(I),_)};l=function(I,S,P,M){p=P,E(I?I+"{"+S.styles+"}":S.styles),M&&(b.inserted[S.name]=!0)}}var b={key:n,sheet:new Zte({key:n,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:l};return b.sheet.hydrate(a),b},JB={exports:{}},Mt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dn=typeof Symbol=="function"&&Symbol.for,R_=Dn?Symbol.for("react.element"):60103,O_=Dn?Symbol.for("react.portal"):60106,H0=Dn?Symbol.for("react.fragment"):60107,j0=Dn?Symbol.for("react.strict_mode"):60108,W0=Dn?Symbol.for("react.profiler"):60114,Q0=Dn?Symbol.for("react.provider"):60109,$0=Dn?Symbol.for("react.context"):60110,F_=Dn?Symbol.for("react.async_mode"):60111,X0=Dn?Symbol.for("react.concurrent_mode"):60111,Y0=Dn?Symbol.for("react.forward_ref"):60112,J0=Dn?Symbol.for("react.suspense"):60113,bne=Dn?Symbol.for("react.suspense_list"):60120,K0=Dn?Symbol.for("react.memo"):60115,Z0=Dn?Symbol.for("react.lazy"):60116,xne=Dn?Symbol.for("react.block"):60121,Cne=Dn?Symbol.for("react.fundamental"):60117,Sne=Dn?Symbol.for("react.responder"):60118,Pne=Dn?Symbol.for("react.scope"):60119;function Wr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case R_:switch(t=t.type,t){case F_:case X0:case H0:case W0:case j0:case J0:return t;default:switch(t=t&&t.$$typeof,t){case $0:case Y0:case Z0:case K0:case Q0:return t;default:return e}}case O_:return e}}}function KB(t){return Wr(t)===X0}Mt.AsyncMode=F_;Mt.ConcurrentMode=X0;Mt.ContextConsumer=$0;Mt.ContextProvider=Q0;Mt.Element=R_;Mt.ForwardRef=Y0;Mt.Fragment=H0;Mt.Lazy=Z0;Mt.Memo=K0;Mt.Portal=O_;Mt.Profiler=W0;Mt.StrictMode=j0;Mt.Suspense=J0;Mt.isAsyncMode=function(t){return KB(t)||Wr(t)===F_};Mt.isConcurrentMode=KB;Mt.isContextConsumer=function(t){return Wr(t)===$0};Mt.isContextProvider=function(t){return Wr(t)===Q0};Mt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===R_};Mt.isForwardRef=function(t){return Wr(t)===Y0};Mt.isFragment=function(t){return Wr(t)===H0};Mt.isLazy=function(t){return Wr(t)===Z0};Mt.isMemo=function(t){return Wr(t)===K0};Mt.isPortal=function(t){return Wr(t)===O_};Mt.isProfiler=function(t){return Wr(t)===W0};Mt.isStrictMode=function(t){return Wr(t)===j0};Mt.isSuspense=function(t){return Wr(t)===J0};Mt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===H0||t===X0||t===W0||t===j0||t===J0||t===bne||typeof t=="object"&&t!==null&&(t.$$typeof===Z0||t.$$typeof===K0||t.$$typeof===Q0||t.$$typeof===$0||t.$$typeof===Y0||t.$$typeof===Cne||t.$$typeof===Sne||t.$$typeof===Pne||t.$$typeof===xne)};Mt.typeOf=Wr;(function(t){t.exports=Mt})(JB);var ZB=JB.exports,Mne={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ine={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},qB={};qB[ZB.ForwardRef]=Mne;qB[ZB.Memo]=Ine;var Bne=!0;function Lne(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):r+=i+" "}),r}var eL=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||Bne===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},Rne=function(e,n,r){eL(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var s=n;do e.insert(n===s?"."+i:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function One(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var Fne={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Dne=/[A-Z]|^ms/g,kne=/_EMO_([^_]+?)_([^]*?)_EMO_/g,tL=function(e){return e.charCodeAt(1)===45},Jx=function(e){return e!=null&&typeof e!="boolean"},fm=VB(function(t){return tL(t)?t:t.replace(Dne,"-$&").toLowerCase()}),Kx=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(kne,function(r,i,s){return $i={name:i,styles:s,next:$i},i})}return Fne[e]!==1&&!tL(e)&&typeof n=="number"&&n!==0?n+"px":n};function pu(t,e,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return $i={name:n.name,styles:n.styles,next:$i},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)$i={name:r.name,styles:r.styles,next:$i},r=r.next;var i=n.styles+";";return i}return Nne(t,e,n)}case"function":{if(t!==void 0){var s=$i,o=n(t);return $i=s,pu(t,e,o)}break}}if(e==null)return n;var a=e[n];return a!==void 0?a:n}function Nne(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=pu(t,e,n[i])+";";else for(var s in n){var o=n[s];if(typeof o!="object")e!=null&&e[o]!==void 0?r+=s+"{"+e[o]+"}":Jx(o)&&(r+=fm(s)+":"+Kx(s,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var a=0;a<o.length;a++)Jx(o[a])&&(r+=fm(s)+":"+Kx(s,o[a])+";");else{var l=pu(t,e,o);switch(s){case"animation":case"animationName":{r+=fm(s)+":"+l+";";break}default:r+=s+"{"+l+"}"}}}return r}var Zx=/label:\s*([^\s;\n{]+)\s*(;|$)/g,$i,nL=function(e,n,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,s="";$i=void 0;var o=e[0];o==null||o.raw===void 0?(i=!1,s+=pu(r,n,o)):s+=o[0];for(var a=1;a<e.length;a++)s+=pu(r,n,e[a]),i&&(s+=o[a]);Zx.lastIndex=0;for(var l="",h;(h=Zx.exec(s))!==null;)l+="-"+h[1];var p=One(s)+l;return{name:p,styles:s,next:$i}},Une=function(e){return e()},Gne=M2["useInsertionEffect"]?M2["useInsertionEffect"]:!1,zne=Gne||Une,rL=K.exports.createContext(typeof HTMLElement<"u"?Tne({key:"css"}):null);rL.Provider;var Vne=function(e){return K.exports.forwardRef(function(n,r){var i=K.exports.useContext(rL);return e(n,i,r)})},Hne=K.exports.createContext({});function jne(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return nL(e)}var D_=function(){var e=jne.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Wne=Yte,Qne=function(e){return e!=="theme"},qx=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Wne:Qne},eC=function(e,n,r){var i;if(n){var s=n.shouldForwardProp;i=e.__emotion_forwardProp&&s?function(o){return e.__emotion_forwardProp(o)&&s(o)}:s}return typeof i!="function"&&r&&(i=e.__emotion_forwardProp),i},$ne=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return eL(n,r,i),zne(function(){return Rne(n,r,i)}),null},Xne=function t(e,n){var r=e.__emotion_real===e,i=r&&e.__emotion_base||e,s,o;n!==void 0&&(s=n.label,o=n.target);var a=eC(e,n,r),l=a||qx(i),h=!l("as");return function(){var p=arguments,m=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&m.push("label:"+s+";"),p[0]==null||p[0].raw===void 0)m.push.apply(m,p);else{m.push(p[0][0]);for(var _=p.length,E=1;E<_;E++)m.push(p[E],p[0][E])}var b=Vne(function(x,I,S){var P=h&&x.as||i,M="",O=[],N=x;if(x.theme==null){N={};for(var z in x)N[z]=x[z];N.theme=K.exports.useContext(Hne)}typeof x.className=="string"?M=Lne(I.registered,O,x.className):x.className!=null&&(M=x.className+" ");var X=nL(m.concat(O),I.registered,N);M+=I.key+"-"+X.name,o!==void 0&&(M+=" "+o);var Z=h&&a===void 0?qx(P):l,Q={};for(var k in x)h&&k==="as"||Z(k)&&(Q[k]=x[k]);return Q.className=M,Q.ref=S,K.exports.createElement(K.exports.Fragment,null,K.exports.createElement($ne,{cache:I,serialized:X,isStringTag:typeof P=="string"}),K.exports.createElement(P,Q))});return b.displayName=s!==void 0?s:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",b.defaultProps=e.defaultProps,b.__emotion_real=b,b.__emotion_base=i,b.__emotion_styles=m,b.__emotion_forwardProp=a,Object.defineProperty(b,"toString",{value:function(){return"."+o}}),b.withComponent=function(x,I){return t(x,ue({},n,I,{shouldForwardProp:eC(b,I,!0)})).apply(void 0,m)},b}},Yne=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],cy=Xne.bind();Yne.forEach(function(t){cy[t]=cy(t)});const Jne=cy;/** @license MUI v5.10.7
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Kne(t,e){return Jne(t,e)}const Zne=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))};function MA(t,e){return e?ds(t,e,{clone:!1}):t}const k_={xs:0,sm:600,md:900,lg:1200,xl:1536},tC={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${k_[t]}px)`};function wo(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const s=r.breakpoints||tC;return e.reduce((o,a,l)=>(o[s.up(s.keys[l])]=n(e[l]),o),{})}if(typeof e=="object"){const s=r.breakpoints||tC;return Object.keys(e).reduce((o,a)=>{if(Object.keys(s.values||k_).indexOf(a)!==-1){const l=s.up(a);o[l]=n(e[a],a)}else{const l=a;o[l]=e[l]}return o},{})}return n(e)}function qne(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,i)=>{const s=t.up(i);return r[s]={},r},{}))||{}}function ere(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function N_(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,s)=>i&&i[s]?i[s]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function nC(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=N_(t,n)||r,e&&(i=e(i)),i}function Re(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,s=o=>{if(o[e]==null)return null;const a=o[e],l=o.theme,h=N_(l,r)||{};return wo(o,a,m=>{let _=nC(h,i,m);return m===_&&typeof m=="string"&&(_=nC(h,i,`${e}${m==="default"?"":kt(m)}`,m)),n===!1?_:{[n]:_}})};return s.propTypes={},s.filterProps=[e],s}function To(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(s=>{r[s]=i}),r),{}),n=r=>Object.keys(r).reduce((i,s)=>e[s]?MA(i,e[s](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function tre(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const nre={m:"margin",p:"padding"},rre={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},rC={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},ire=tre(t=>{if(t.length>2)if(rC[t])t=rC[t];else return[t];const[e,n]=t.split(""),r=nre[e],i=rre[n]||"";return Array.isArray(i)?i.map(s=>r+s):[r+i]}),sre=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],ore=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],iL=[...sre,...ore];function zu(t,e,n,r){var i;const s=(i=N_(t,e,!1))!=null?i:n;return typeof s=="number"?o=>typeof o=="string"?o:s*o:Array.isArray(s)?o=>typeof o=="string"?o:s[o]:typeof s=="function"?s:()=>{}}function sL(t){return zu(t,"spacing",8)}function Vu(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function are(t,e){return n=>t.reduce((r,i)=>(r[i]=Vu(e,n),r),{})}function lre(t,e,n,r){if(e.indexOf(n)===-1)return null;const i=ire(n),s=are(i,r),o=t[n];return wo(t,o,s)}function cre(t,e){const n=sL(t.theme);return Object.keys(t).map(r=>lre(t,e,r,n)).reduce(MA,{})}function q0(t){return cre(t,iL)}q0.propTypes={};q0.filterProps=iL;function Hu(t){return typeof t!="number"?t:`${t}px solid`}const Are=Re({prop:"border",themeKey:"borders",transform:Hu}),ure=Re({prop:"borderTop",themeKey:"borders",transform:Hu}),fre=Re({prop:"borderRight",themeKey:"borders",transform:Hu}),hre=Re({prop:"borderBottom",themeKey:"borders",transform:Hu}),dre=Re({prop:"borderLeft",themeKey:"borders",transform:Hu}),pre=Re({prop:"borderColor",themeKey:"palette"}),gre=Re({prop:"borderTopColor",themeKey:"palette"}),mre=Re({prop:"borderRightColor",themeKey:"palette"}),yre=Re({prop:"borderBottomColor",themeKey:"palette"}),vre=Re({prop:"borderLeftColor",themeKey:"palette"}),U_=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=zu(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Vu(e,r)});return wo(t,t.borderRadius,n)}return null};U_.propTypes={};U_.filterProps=["borderRadius"];const _re=To(Are,ure,fre,hre,dre,pre,gre,mre,yre,vre,U_),oL=_re,Ere=Re({prop:"displayPrint",cssProperty:!1,transform:t=>({"@media print":{display:t}})}),wre=Re({prop:"display"}),Tre=Re({prop:"overflow"}),bre=Re({prop:"textOverflow"}),xre=Re({prop:"visibility"}),Cre=Re({prop:"whiteSpace"}),aL=To(Ere,wre,Tre,bre,xre,Cre),Sre=Re({prop:"flexBasis"}),Pre=Re({prop:"flexDirection"}),Mre=Re({prop:"flexWrap"}),Ire=Re({prop:"justifyContent"}),Bre=Re({prop:"alignItems"}),Lre=Re({prop:"alignContent"}),Rre=Re({prop:"order"}),Ore=Re({prop:"flex"}),Fre=Re({prop:"flexGrow"}),Dre=Re({prop:"flexShrink"}),kre=Re({prop:"alignSelf"}),Nre=Re({prop:"justifyItems"}),Ure=Re({prop:"justifySelf"}),Gre=To(Sre,Pre,Mre,Ire,Bre,Lre,Rre,Ore,Fre,Dre,kre,Nre,Ure),lL=Gre,G_=t=>{if(t.gap!==void 0&&t.gap!==null){const e=zu(t.theme,"spacing",8),n=r=>({gap:Vu(e,r)});return wo(t,t.gap,n)}return null};G_.propTypes={};G_.filterProps=["gap"];const z_=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=zu(t.theme,"spacing",8),n=r=>({columnGap:Vu(e,r)});return wo(t,t.columnGap,n)}return null};z_.propTypes={};z_.filterProps=["columnGap"];const V_=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=zu(t.theme,"spacing",8),n=r=>({rowGap:Vu(e,r)});return wo(t,t.rowGap,n)}return null};V_.propTypes={};V_.filterProps=["rowGap"];const zre=Re({prop:"gridColumn"}),Vre=Re({prop:"gridRow"}),Hre=Re({prop:"gridAutoFlow"}),jre=Re({prop:"gridAutoColumns"}),Wre=Re({prop:"gridAutoRows"}),Qre=Re({prop:"gridTemplateColumns"}),$re=Re({prop:"gridTemplateRows"}),Xre=Re({prop:"gridTemplateAreas"}),Yre=Re({prop:"gridArea"}),Jre=To(G_,z_,V_,zre,Vre,Hre,jre,Wre,Qre,$re,Xre,Yre),cL=Jre,Kre=Re({prop:"color",themeKey:"palette"}),Zre=Re({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"}),qre=Re({prop:"backgroundColor",themeKey:"palette"}),eie=To(Kre,Zre,qre),AL=eie,tie=Re({prop:"position"}),nie=Re({prop:"zIndex",themeKey:"zIndex"}),rie=Re({prop:"top"}),iie=Re({prop:"right"}),sie=Re({prop:"bottom"}),oie=Re({prop:"left"}),uL=To(tie,nie,rie,iie,sie,oie),aie=Re({prop:"boxShadow",themeKey:"shadows"}),fL=aie;function bo(t){return t<=1&&t!==0?`${t*100}%`:t}const lie=Re({prop:"width",transform:bo}),hL=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,i,s;return{maxWidth:((r=t.theme)==null||(i=r.breakpoints)==null||(s=i.values)==null?void 0:s[n])||k_[n]||bo(n)}};return wo(t,t.maxWidth,e)}return null};hL.filterProps=["maxWidth"];const cie=Re({prop:"minWidth",transform:bo}),Aie=Re({prop:"height",transform:bo}),uie=Re({prop:"maxHeight",transform:bo}),fie=Re({prop:"minHeight",transform:bo});Re({prop:"size",cssProperty:"width",transform:bo});Re({prop:"size",cssProperty:"height",transform:bo});const hie=Re({prop:"boxSizing"}),die=To(lie,hL,cie,Aie,uie,fie,hie),dL=die,pie=Re({prop:"fontFamily",themeKey:"typography"}),gie=Re({prop:"fontSize",themeKey:"typography"}),mie=Re({prop:"fontStyle",themeKey:"typography"}),yie=Re({prop:"fontWeight",themeKey:"typography"}),vie=Re({prop:"letterSpacing"}),_ie=Re({prop:"textTransform"}),Eie=Re({prop:"lineHeight"}),wie=Re({prop:"textAlign"}),Tie=Re({prop:"typography",cssProperty:!1,themeKey:"typography"}),bie=To(Tie,pie,gie,mie,yie,vie,Eie,wie,_ie),pL=bie,iC={borders:oL.filterProps,display:aL.filterProps,flexbox:lL.filterProps,grid:cL.filterProps,positions:uL.filterProps,palette:AL.filterProps,shadows:fL.filterProps,sizing:dL.filterProps,spacing:q0.filterProps,typography:pL.filterProps},gL={borders:oL,display:aL,flexbox:lL,grid:cL,positions:uL,palette:AL,shadows:fL,sizing:dL,spacing:q0,typography:pL};Object.keys(iC).reduce((t,e)=>(iC[e].forEach(n=>{t[n]=gL[e]}),t),{});function xie(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function Cie(t,e){return typeof t=="function"?t(e):t}function Sie(t=gL){const e=Object.keys(t).reduce((i,s)=>(t[s].filterProps.forEach(o=>{i[o]=t[s]}),i),{});function n(i,s,o){const a={[i]:s,theme:o},l=e[i];return l?l(a):{[i]:s}}function r(i){const{sx:s,theme:o={}}=i||{};if(!s)return null;function a(l){let h=l;if(typeof l=="function")h=l(o);else if(typeof l!="object")return l;if(!h)return null;const p=qne(o.breakpoints),m=Object.keys(p);let _=p;return Object.keys(h).forEach(E=>{const b=Cie(h[E],o);if(b!=null)if(typeof b=="object")if(e[E])_=MA(_,n(E,b,o));else{const x=wo({theme:o},b,I=>({[E]:I}));xie(x,b)?_[E]=r({sx:b,theme:o}):_=MA(_,x)}else _=MA(_,n(E,b,o))}),ere(m,_)}return Array.isArray(s)?s.map(a):a(s)}return r}const mL=Sie();mL.filterProps=["sx"];const Pie=mL,Mie=["values","unit","step"],Iie=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>ue({},n,{[r.key]:r.val}),{})};function Bie(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=zn(t,Mie),s=Iie(e),o=Object.keys(s);function a(_){return`@media (min-width:${typeof e[_]=="number"?e[_]:_}${n})`}function l(_){return`@media (max-width:${(typeof e[_]=="number"?e[_]:_)-r/100}${n})`}function h(_,E){const b=o.indexOf(E);return`@media (min-width:${typeof e[_]=="number"?e[_]:_}${n}) and (max-width:${(b!==-1&&typeof e[o[b]]=="number"?e[o[b]]:E)-r/100}${n})`}function p(_){return o.indexOf(_)+1<o.length?h(_,o[o.indexOf(_)+1]):a(_)}function m(_){const E=o.indexOf(_);return E===0?a(o[1]):E===o.length-1?l(o[E]):h(_,o[o.indexOf(_)+1]).replace("@media","@media not all and")}return ue({keys:o,values:s,up:a,down:l,between:h,only:p,not:m,unit:n},i)}const Lie={borderRadius:4},Rie=Lie;function Oie(t=8){if(t.mui)return t;const e=sL({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(s=>{const o=e(s);return typeof o=="number"?`${o}px`:o}).join(" ");return n.mui=!0,n}const Fie=["breakpoints","palette","spacing","shape"];function H_(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:s={}}=t,o=zn(t,Fie),a=Bie(n),l=Oie(i);let h=ds({breakpoints:a,direction:"ltr",components:{},palette:ue({mode:"light"},r),spacing:l,shape:ue({},Rie,s)},o);return h=e.reduce((p,m)=>ds(p,m),h),h}const Die=K.exports.createContext(null),kie=Die;function Nie(){return K.exports.useContext(kie)}function Uie(t){return Object.keys(t).length===0}function Gie(t=null){const e=Nie();return!e||Uie(e)?t:e}const zie=H_();function yL(t=zie){return Gie(t)}const Vie=["variant"];function sC(t){return t.length===0}function vL(t){const{variant:e}=t,n=zn(t,Vie);let r=e||"";return Object.keys(n).sort().forEach(i=>{i==="color"?r+=sC(r)?t[i]:kt(t[i]):r+=`${sC(r)?i:kt(i)}${kt(t[i].toString())}`}),r}const Hie=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],jie=["theme"],Wie=["theme"];function Jc(t){return Object.keys(t).length===0}function Qie(t){return typeof t=="string"&&t.charCodeAt(0)>96}const $ie=(t,e)=>e.components&&e.components[t]&&e.components[t].styleOverrides?e.components[t].styleOverrides:null,Xie=(t,e)=>{let n=[];e&&e.components&&e.components[t]&&e.components[t].variants&&(n=e.components[t].variants);const r={};return n.forEach(i=>{const s=vL(i.props);r[s]=i.style}),r},Yie=(t,e,n,r)=>{var i,s;const{ownerState:o={}}=t,a=[],l=n==null||(i=n.components)==null||(s=i[r])==null?void 0:s.variants;return l&&l.forEach(h=>{let p=!0;Object.keys(h.props).forEach(m=>{o[m]!==h.props[m]&&t[m]!==h.props[m]&&(p=!1)}),p&&a.push(e[vL(h.props)])}),a};function IA(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Jie=H_();function Kie(t={}){const{defaultTheme:e=Jie,rootShouldForwardProp:n=IA,slotShouldForwardProp:r=IA,styleFunctionSx:i=Pie}=t,s=o=>{const a=Jc(o.theme)?e:o.theme;return i(ue({},o,{theme:a}))};return s.__mui_systemSx=!0,(o,a={})=>{Zne(o,O=>O.filter(N=>!(N!=null&&N.__mui_systemSx)));const{name:l,slot:h,skipVariantsResolver:p,skipSx:m,overridesResolver:_}=a,E=zn(a,Hie),b=p!==void 0?p:h&&h!=="Root"||!1,x=m||!1;let I,S=IA;h==="Root"?S=n:h?S=r:Qie(o)&&(S=void 0);const P=Kne(o,ue({shouldForwardProp:S,label:I},E)),M=(O,...N)=>{const z=N?N.map(k=>typeof k=="function"&&k.__emotion_real!==k?D=>{let{theme:ne}=D,se=zn(D,jie);return k(ue({theme:Jc(ne)?e:ne},se))}:k):[];let X=O;l&&_&&z.push(k=>{const D=Jc(k.theme)?e:k.theme,ne=$ie(l,D);if(ne){const se={};return Object.entries(ne).forEach(([oe,xe])=>{se[oe]=typeof xe=="function"?xe(ue({},k,{theme:D})):xe}),_(k,se)}return null}),l&&!b&&z.push(k=>{const D=Jc(k.theme)?e:k.theme;return Yie(k,Xie(l,D),D,l)}),x||z.push(s);const Z=z.length-N.length;if(Array.isArray(O)&&Z>0){const k=new Array(Z).fill("");X=[...O,...k],X.raw=[...O.raw,...k]}else typeof O=="function"&&O.__emotion_real!==O&&(X=k=>{let{theme:D}=k,ne=zn(k,Wie);return O(ue({theme:Jc(D)?e:D},ne))});return P(X,...z)};return P.withConfig&&(M.withConfig=P.withConfig),M}}function Zie(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:UB(e.components[n].defaultProps,r)}function qie({props:t,name:e,defaultTheme:n}){const r=yL(n);return Zie({theme:r,name:e,props:t})}function j_(t,e=0,n=1){return Math.min(Math.max(e,t),n)}function ese(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function ha(t){if(t.type)return t;if(t.charAt(0)==="#")return ha(ese(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(Kl(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(Kl(10,i))}else r=r.split(",");return r=r.map(s=>parseFloat(s)),{type:n,values:r,colorSpace:i}}function ep(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.indexOf("rgb")!==-1?r=r.map((i,s)=>s<3?parseInt(i,10):i):e.indexOf("hsl")!==-1&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.indexOf("color")!==-1?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function tse(t){t=ha(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,s=r*Math.min(i,1-i),o=(h,p=(h+n/30)%12)=>i-s*Math.max(Math.min(p-3,9-p,1),-1);let a="rgb";const l=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return t.type==="hsla"&&(a+="a",l.push(e[3])),ep({type:a,values:l})}function oC(t){t=ha(t);let e=t.type==="hsl"||t.type==="hsla"?ha(tse(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function nse(t,e){const n=oC(t),r=oC(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function El(t,e){return t=ha(t),e=j_(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,ep(t)}function _L(t,e){if(t=ha(t),e=j_(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return ep(t)}function EL(t,e){if(t=ha(t),e=j_(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return ep(t)}function rse(t,e){return ue({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}const ise={black:"#000",white:"#fff"},gu=ise,sse={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},ose=sse,ase={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Va=ase,lse={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Ha=lse,cse={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Kc=cse,Ase={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},ja=Ase,use={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Wa=use,fse={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Qa=fse,hse=["mode","contrastThreshold","tonalOffset"],aC={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:gu.white,default:gu.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},hm={text:{primary:gu.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:gu.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function lC(t,e,n,r){const i=r.light||r,s=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=EL(t.main,i):e==="dark"&&(t.dark=_L(t.main,s)))}function dse(t="light"){return t==="dark"?{main:ja[200],light:ja[50],dark:ja[400]}:{main:ja[700],light:ja[400],dark:ja[800]}}function pse(t="light"){return t==="dark"?{main:Va[200],light:Va[50],dark:Va[400]}:{main:Va[500],light:Va[300],dark:Va[700]}}function gse(t="light"){return t==="dark"?{main:Ha[500],light:Ha[300],dark:Ha[700]}:{main:Ha[700],light:Ha[400],dark:Ha[800]}}function mse(t="light"){return t==="dark"?{main:Wa[400],light:Wa[300],dark:Wa[700]}:{main:Wa[700],light:Wa[500],dark:Wa[900]}}function yse(t="light"){return t==="dark"?{main:Qa[400],light:Qa[300],dark:Qa[700]}:{main:Qa[800],light:Qa[500],dark:Qa[900]}}function vse(t="light"){return t==="dark"?{main:Kc[400],light:Kc[300],dark:Kc[700]}:{main:"#ed6c02",light:Kc[500],dark:Kc[900]}}function _se(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2}=t,i=zn(t,hse),s=t.primary||dse(e),o=t.secondary||pse(e),a=t.error||gse(e),l=t.info||mse(e),h=t.success||yse(e),p=t.warning||vse(e);function m(x){return nse(x,hm.text.primary)>=n?hm.text.primary:aC.text.primary}const _=({color:x,name:I,mainShade:S=500,lightShade:P=300,darkShade:M=700})=>{if(x=ue({},x),!x.main&&x[S]&&(x.main=x[S]),!x.hasOwnProperty("main"))throw new Error(Kl(11,I?` (${I})`:"",S));if(typeof x.main!="string")throw new Error(Kl(12,I?` (${I})`:"",JSON.stringify(x.main)));return lC(x,"light",P,r),lC(x,"dark",M,r),x.contrastText||(x.contrastText=m(x.main)),x},E={dark:hm,light:aC};return ds(ue({common:ue({},gu),mode:e,primary:_({color:s,name:"primary"}),secondary:_({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:_({color:a,name:"error"}),warning:_({color:p,name:"warning"}),info:_({color:l,name:"info"}),success:_({color:h,name:"success"}),grey:ose,contrastThreshold:n,getContrastText:m,augmentColor:_,tonalOffset:r},E[e]),i)}const Ese=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function wse(t){return Math.round(t*1e5)/1e5}const cC={textTransform:"uppercase"},AC='"Roboto", "Helvetica", "Arial", sans-serif';function Tse(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:r=AC,fontSize:i=14,fontWeightLight:s=300,fontWeightRegular:o=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:h=16,allVariants:p,pxToRem:m}=n,_=zn(n,Ese),E=i/14,b=m||(S=>`${S/h*E}rem`),x=(S,P,M,O,N)=>ue({fontFamily:r,fontWeight:S,fontSize:b(P),lineHeight:M},r===AC?{letterSpacing:`${wse(O/P)}em`}:{},N,p),I={h1:x(s,96,1.167,-1.5),h2:x(s,60,1.2,-.5),h3:x(o,48,1.167,0),h4:x(o,34,1.235,.25),h5:x(o,24,1.334,0),h6:x(a,20,1.6,.15),subtitle1:x(o,16,1.75,.15),subtitle2:x(a,14,1.57,.1),body1:x(o,16,1.5,.15),body2:x(o,14,1.43,.15),button:x(a,14,1.75,.4,cC),caption:x(o,12,1.66,.4),overline:x(o,12,2.66,1,cC)};return ds(ue({htmlFontSize:h,pxToRem:b,fontFamily:r,fontSize:i,fontWeightLight:s,fontWeightRegular:o,fontWeightMedium:a,fontWeightBold:l},I),_,{clone:!1})}const bse=.2,xse=.14,Cse=.12;function Xt(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${bse})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${xse})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Cse})`].join(",")}const Sse=["none",Xt(0,2,1,-1,0,1,1,0,0,1,3,0),Xt(0,3,1,-2,0,2,2,0,0,1,5,0),Xt(0,3,3,-2,0,3,4,0,0,1,8,0),Xt(0,2,4,-1,0,4,5,0,0,1,10,0),Xt(0,3,5,-1,0,5,8,0,0,1,14,0),Xt(0,3,5,-1,0,6,10,0,0,1,18,0),Xt(0,4,5,-2,0,7,10,1,0,2,16,1),Xt(0,5,5,-3,0,8,10,1,0,3,14,2),Xt(0,5,6,-3,0,9,12,1,0,3,16,2),Xt(0,6,6,-3,0,10,14,1,0,4,18,3),Xt(0,6,7,-4,0,11,15,1,0,4,20,3),Xt(0,7,8,-4,0,12,17,2,0,5,22,4),Xt(0,7,8,-4,0,13,19,2,0,5,24,4),Xt(0,7,9,-4,0,14,21,2,0,5,26,4),Xt(0,8,9,-5,0,15,22,2,0,6,28,5),Xt(0,8,10,-5,0,16,24,2,0,6,30,5),Xt(0,8,11,-5,0,17,26,2,0,6,32,5),Xt(0,9,11,-5,0,18,28,2,0,7,34,6),Xt(0,9,12,-6,0,19,29,2,0,7,36,6),Xt(0,10,13,-6,0,20,31,3,0,8,38,7),Xt(0,10,13,-6,0,21,33,3,0,8,40,7),Xt(0,10,14,-6,0,22,35,3,0,8,42,7),Xt(0,11,14,-7,0,23,36,3,0,9,44,8),Xt(0,11,15,-7,0,24,38,3,0,9,46,8)],Pse=Sse,Mse=["duration","easing","delay"],Ise={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Bse={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function uC(t){return`${Math.round(t)}ms`}function Lse(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function Rse(t){const e=ue({},Ise,t.easing),n=ue({},Bse,t.duration);return ue({getAutoHeightDuration:Lse,create:(i=["all"],s={})=>{const{duration:o=n.standard,easing:a=e.easeInOut,delay:l=0}=s;return zn(s,Mse),(Array.isArray(i)?i:[i]).map(h=>`${h} ${typeof o=="string"?o:uC(o)} ${a} ${typeof l=="string"?l:uC(l)}`).join(",")}},t,{easing:e,duration:n})}const Ose={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Fse=Ose,Dse=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function kse(t={},...e){const{mixins:n={},palette:r={},transitions:i={},typography:s={}}=t,o=zn(t,Dse);if(t.vars)throw new Error(Kl(18));const a=_se(r),l=H_(t);let h=ds(l,{mixins:rse(l.breakpoints,n),palette:a,shadows:Pse.slice(),typography:Tse(a,s),transitions:Rse(i),zIndex:ue({},Fse)});return h=ds(h,o),h=e.reduce((p,m)=>ds(p,m),h),h}const Nse=kse(),W_=Nse;function tp({props:t,name:e}){return qie({props:t,name:e,defaultTheme:W_})}const wL=t=>IA(t)&&t!=="classes",TL=IA,Use=Kie({defaultTheme:W_,rootShouldForwardProp:wL}),Qr=Use;function Gse(){return yL(W_)}const zse=t=>!t||!PA(t),hh=zse,Vse=["component","components","componentsProps","color","size"],eo=ue({},Qh,Uu("MuiSlider",["colorPrimary","colorSecondary","thumbColorPrimary","thumbColorSecondary","sizeSmall","thumbSizeSmall"])),Hse=Qr("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${kt(n.color)}`],n.size!=="medium"&&e[`size${kt(n.size)}`],n.marked&&e.marked,n.orientation==="vertical"&&e.vertical,n.track==="inverted"&&e.trackInverted,n.track===!1&&e.trackFalse]}})(({theme:t,ownerState:e})=>ue({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:(t.vars||t).palette[e.color].main,WebkitTapHighlightColor:"transparent"},e.orientation==="horizontal"&&ue({height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}},e.size==="small"&&{height:2},e.marked&&{marginBottom:20}),e.orientation==="vertical"&&ue({height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}},e.size==="small"&&{width:2},e.marked&&{marginRight:44}),{"@media print":{colorAdjust:"exact"},[`&.${eo.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${eo.dragging}`]:{[`& .${eo.thumb}, & .${eo.track}`]:{transition:"none"}}})),jse=Qr("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(t,e)=>e.rail})(({ownerState:t})=>ue({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38},t.orientation==="horizontal"&&{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"},t.orientation==="vertical"&&{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"},t.track==="inverted"&&{opacity:1})),Wse=Qr("span",{name:"MuiSlider",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?EL(t.palette[e.color].main,.62):_L(t.palette[e.color].main,.5);return ue({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest})},e.size==="small"&&{border:"none"},e.orientation==="horizontal"&&{height:"inherit",top:"50%",transform:"translateY(-50%)"},e.orientation==="vertical"&&{width:"inherit",left:"50%",transform:"translateX(-50%)"},e.track===!1&&{display:"none"},e.track==="inverted"&&{backgroundColor:t.vars?t.vars.palette.Slider[`${e.color}Track`]:n,borderColor:t.vars?t.vars.palette.Slider[`${e.color}Track`]:n})}),Qse=Qr("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e[`thumbColor${kt(n.color)}`],n.size!=="medium"&&e[`thumbSize${kt(n.size)}`]]}})(({theme:t,ownerState:e})=>ue({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest})},e.size==="small"&&{width:12,height:12},e.orientation==="horizontal"&&{top:"50%",transform:"translate(-50%, -50%)"},e.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 50%)"},{"&:before":ue({position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},e.size==="small"&&{boxShadow:"none"}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&:hover, &.${eo.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.16)`:El(t.palette[e.color].main,.16)}`,"@media (hover: none)":{boxShadow:"none"}},[`&.${eo.active}`]:{boxShadow:`0px 0px 0px 14px ${t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / 0.16)`:El(t.palette[e.color].main,.16)}`},[`&.${eo.disabled}`]:{"&:hover":{boxShadow:"none"}}})),$se=Qr(GB,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(t,e)=>e.valueLabel})(({theme:t,ownerState:e})=>ue({[`&.${eo.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"},zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),transform:"translateY(-100%) scale(0)",position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem"},e.orientation==="horizontal"&&{top:"-10px",transformOrigin:"bottom center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"}},e.orientation==="vertical"&&{right:"30px",top:"24px",transformOrigin:"right center","&:before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",right:"-20%",top:"25%"}},e.size==="small"&&{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"})),Xse=Qr("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>TL(t)&&t!=="markActive",overridesResolver:(t,e)=>e.mark})(({theme:t,ownerState:e,markActive:n})=>ue({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},e.orientation==="horizontal"&&{top:"50%",transform:"translate(-1px, -50%)"},e.orientation==="vertical"&&{left:"50%",transform:"translate(-50%, 1px)"},n&&{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8})),Yse=Qr("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>TL(t)&&t!=="markLabelActive",overridesResolver:(t,e)=>e.markLabel})(({theme:t,ownerState:e,markLabelActive:n})=>ue({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap"},e.orientation==="horizontal"&&{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}},e.orientation==="vertical"&&{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}},n&&{color:(t.vars||t).palette.text.primary})),Jse=t=>{const{color:e,size:n,classes:r={}}=t;return ue({},r,{root:en(r.root,cA(`color${kt(e)}`),r[`color${kt(e)}`],n&&[cA(`size${kt(n)}`),r[`size${kt(n)}`]]),thumb:en(r.thumb,cA(`thumbColor${kt(e)}`),r[`thumbColor${kt(e)}`],n&&[cA(`thumbSize${kt(n)}`),r[`thumbSize${kt(n)}`]])})},Kse=K.exports.forwardRef(function(e,n){var r,i,s,o;const a=tp({props:e,name:"MuiSlider"}),h=Gse().direction==="rtl",{component:p="span",components:m={},componentsProps:_={},color:E="primary",size:b="medium"}=a,x=zn(a,Vse),I=ue({},a,{color:E,size:b}),S=Jse(I);return ze($te,ue({},x,{isRtl:h,components:ue({Root:Hse,Rail:jse,Track:Wse,Thumb:Qse,ValueLabel:$se,Mark:Xse,MarkLabel:Yse},m),componentsProps:ue({},_,{root:ue({},_.root,hh(m.Root)&&{as:p,ownerState:ue({},(r=_.root)==null?void 0:r.ownerState,{color:E,size:b})}),thumb:ue({},_.thumb,hh(m.Thumb)&&{ownerState:ue({},(i=_.thumb)==null?void 0:i.ownerState,{color:E,size:b})}),track:ue({},_.track,hh(m.Track)&&{ownerState:ue({},(s=_.track)==null?void 0:s.ownerState,{color:E,size:b})}),valueLabel:ue({},_.valueLabel,hh(m.ValueLabel)&&{ownerState:ue({},(o=_.valueLabel)==null?void 0:o.ownerState,{color:E,size:b})})}),classes:S,ref:n}))}),Zse=Kse;function Ay(t,e){return Ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Ay(t,e)}function qse(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Ay(t,e)}const fC=Xd.createContext(null);function eoe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Q_(t,e){var n=function(s){return e&&K.exports.isValidElement(s)?e(s):s},r=Object.create(null);return t&&K.exports.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function toe(t,e){t=t||{},e=e||{};function n(p){return p in e?e[p]:t[p]}var r=Object.create(null),i=[];for(var s in t)s in e?i.length&&(r[s]=i,i=[]):i.push(s);var o,a={};for(var l in e){if(r[l])for(o=0;o<r[l].length;o++){var h=r[l][o];a[r[l][o]]=n(h)}a[l]=n(l)}for(o=0;o<i.length;o++)a[i[o]]=n(i[o]);return a}function $o(t,e,n){return n[e]!=null?n[e]:t.props[e]}function noe(t,e){return Q_(t.children,function(n){return K.exports.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:$o(n,"appear",t),enter:$o(n,"enter",t),exit:$o(n,"exit",t)})})}function roe(t,e,n){var r=Q_(t.children),i=toe(e,r);return Object.keys(i).forEach(function(s){var o=i[s];if(!!K.exports.isValidElement(o)){var a=s in e,l=s in r,h=e[s],p=K.exports.isValidElement(h)&&!h.props.in;l&&(!a||p)?i[s]=K.exports.cloneElement(o,{onExited:n.bind(null,o),in:!0,exit:$o(o,"exit",t),enter:$o(o,"enter",t)}):!l&&a&&!p?i[s]=K.exports.cloneElement(o,{in:!1}):l&&a&&K.exports.isValidElement(h)&&(i[s]=K.exports.cloneElement(o,{onExited:n.bind(null,o),in:h.props.in,exit:$o(o,"exit",t),enter:$o(o,"enter",t)}))}}),i}var ioe=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},soe={component:"div",childFactory:function(e){return e}},$_=function(t){qse(e,t);function e(r,i){var s;s=t.call(this,r,i)||this;var o=s.handleExited.bind(eoe(s));return s.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},s}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,s){var o=s.children,a=s.handleExited,l=s.firstRender;return{children:l?noe(i,a):roe(i,o,a),firstRender:!1}},n.handleExited=function(i,s){var o=Q_(this.props.children);i.key in o||(i.props.onExited&&i.props.onExited(s),this.mounted&&this.setState(function(a){var l=ue({},a.children);return delete l[i.key],{children:l}}))},n.render=function(){var i=this.props,s=i.component,o=i.childFactory,a=zn(i,["component","childFactory"]),l=this.state.contextValue,h=ioe(this.state.children).map(o);return delete a.appear,delete a.enter,delete a.exit,s===null?ze(fC.Provider,{value:l,children:h}):ze(fC.Provider,{value:l,children:ze(s,{...a,children:h})})},e}(Xd.Component);$_.propTypes={};$_.defaultProps=soe;const ooe=$_;function aoe(t){const{className:e,classes:n,pulsate:r=!1,rippleX:i,rippleY:s,rippleSize:o,in:a,onExited:l,timeout:h}=t,[p,m]=K.exports.useState(!1),_=en(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),E={width:o,height:o,top:-(o/2)+s,left:-(o/2)+i},b=en(n.child,p&&n.childLeaving,r&&n.childPulsate);return!a&&!p&&m(!0),K.exports.useEffect(()=>{if(!a&&l!=null){const x=setTimeout(l,h);return()=>{clearTimeout(x)}}},[l,a,h]),ze("span",{className:_,style:E,children:ze("span",{className:b})})}const loe=Uu("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),qr=loe,coe=["center","classes","className"];let np=t=>t,hC,dC,pC,gC;const uy=550,Aoe=80,uoe=D_(hC||(hC=np`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),foe=D_(dC||(dC=np`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),hoe=D_(pC||(pC=np`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),doe=Qr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),poe=Qr(aoe,{name:"MuiTouchRipple",slot:"Ripple"})(gC||(gC=np`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),qr.rippleVisible,uoe,uy,({theme:t})=>t.transitions.easing.easeInOut,qr.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,qr.child,qr.childLeaving,foe,uy,({theme:t})=>t.transitions.easing.easeInOut,qr.childPulsate,hoe,({theme:t})=>t.transitions.easing.easeInOut),goe=K.exports.forwardRef(function(e,n){const r=tp({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:s={},className:o}=r,a=zn(r,coe),[l,h]=K.exports.useState([]),p=K.exports.useRef(0),m=K.exports.useRef(null);K.exports.useEffect(()=>{m.current&&(m.current(),m.current=null)},[l]);const _=K.exports.useRef(!1),E=K.exports.useRef(null),b=K.exports.useRef(null),x=K.exports.useRef(null);K.exports.useEffect(()=>()=>{clearTimeout(E.current)},[]);const I=K.exports.useCallback(O=>{const{pulsate:N,rippleX:z,rippleY:X,rippleSize:Z,cb:Q}=O;h(k=>[...k,ze(poe,{classes:{ripple:en(s.ripple,qr.ripple),rippleVisible:en(s.rippleVisible,qr.rippleVisible),ripplePulsate:en(s.ripplePulsate,qr.ripplePulsate),child:en(s.child,qr.child),childLeaving:en(s.childLeaving,qr.childLeaving),childPulsate:en(s.childPulsate,qr.childPulsate)},timeout:uy,pulsate:N,rippleX:z,rippleY:X,rippleSize:Z},p.current)]),p.current+=1,m.current=Q},[s]),S=K.exports.useCallback((O={},N={},z)=>{const{pulsate:X=!1,center:Z=i||N.pulsate,fakeElement:Q=!1}=N;if((O==null?void 0:O.type)==="mousedown"&&_.current){_.current=!1;return}(O==null?void 0:O.type)==="touchstart"&&(_.current=!0);const k=Q?null:x.current,D=k?k.getBoundingClientRect():{width:0,height:0,left:0,top:0};let ne,se,oe;if(Z||O===void 0||O.clientX===0&&O.clientY===0||!O.clientX&&!O.touches)ne=Math.round(D.width/2),se=Math.round(D.height/2);else{const{clientX:xe,clientY:Pe}=O.touches&&O.touches.length>0?O.touches[0]:O;ne=Math.round(xe-D.left),se=Math.round(Pe-D.top)}if(Z)oe=Math.sqrt((2*D.width**2+D.height**2)/3),oe%2===0&&(oe+=1);else{const xe=Math.max(Math.abs((k?k.clientWidth:0)-ne),ne)*2+2,Pe=Math.max(Math.abs((k?k.clientHeight:0)-se),se)*2+2;oe=Math.sqrt(xe**2+Pe**2)}O!=null&&O.touches?b.current===null&&(b.current=()=>{I({pulsate:X,rippleX:ne,rippleY:se,rippleSize:oe,cb:z})},E.current=setTimeout(()=>{b.current&&(b.current(),b.current=null)},Aoe)):I({pulsate:X,rippleX:ne,rippleY:se,rippleSize:oe,cb:z})},[i,I]),P=K.exports.useCallback(()=>{S({},{pulsate:!0})},[S]),M=K.exports.useCallback((O,N)=>{if(clearTimeout(E.current),(O==null?void 0:O.type)==="touchend"&&b.current){b.current(),b.current=null,E.current=setTimeout(()=>{M(O,N)});return}b.current=null,h(z=>z.length>0?z.slice(1):z),m.current=N},[]);return K.exports.useImperativeHandle(n,()=>({pulsate:P,start:S,stop:M}),[P,S,M]),ze(doe,ue({className:en(qr.root,s.root,o),ref:x},a,{children:ze(ooe,{component:null,exit:!0,children:l})}))}),moe=goe;function yoe(t){return U0("MuiButtonBase",t)}const voe=Uu("MuiButtonBase",["root","disabled","focusVisible"]),_oe=voe,Eoe=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],woe=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:i}=t,o=M_({root:["root",e&&"disabled",n&&"focusVisible"]},yoe,i);return n&&r&&(o.root+=` ${r}`),o},Toe=Qr("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${_oe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),boe=K.exports.forwardRef(function(e,n){const r=tp({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:s=!1,children:o,className:a,component:l="button",disabled:h=!1,disableRipple:p=!1,disableTouchRipple:m=!1,focusRipple:_=!1,LinkComponent:E="a",onBlur:b,onClick:x,onContextMenu:I,onDragLeave:S,onFocus:P,onFocusVisible:M,onKeyDown:O,onKeyUp:N,onMouseDown:z,onMouseLeave:X,onMouseUp:Z,onTouchEnd:Q,onTouchMove:k,onTouchStart:D,tabIndex:ne=0,TouchRippleProps:se,touchRippleRef:oe,type:xe}=r,Pe=zn(r,Eoe),Ue=K.exports.useRef(null),le=K.exports.useRef(null),ve=ea(le,oe),{isFocusVisibleRef:Ce,onFocus:Fe,onBlur:ke,ref:it}=NB(),[Rt,Pn]=K.exports.useState(!1);h&&Rt&&Pn(!1),K.exports.useImperativeHandle(i,()=>({focusVisible:()=>{Pn(!0),Ue.current.focus()}}),[]);const[un,Tt]=K.exports.useState(!1);K.exports.useEffect(()=>{Tt(!0)},[]);const Ut=un&&!p&&!h;K.exports.useEffect(()=>{Rt&&_&&!p&&un&&le.current.pulsate()},[p,_,Rt,un]);function ot(Me,Vt,at=m){return Qo(sr=>(Vt&&Vt(sr),!at&&le.current&&le.current[Me](sr),!0))}const Gt=ot("start",z),zt=ot("stop",I),Mn=ot("stop",S),In=ot("stop",Z),jn=ot("stop",Me=>{Rt&&Me.preventDefault(),X&&X(Me)}),kn=ot("start",D),yn=ot("stop",Q),on=ot("stop",k),rr=ot("stop",Me=>{ke(Me),Ce.current===!1&&Pn(!1),b&&b(Me)},!1),$r=Qo(Me=>{Ue.current||(Ue.current=Me.currentTarget),Fe(Me),Ce.current===!0&&(Pn(!0),M&&M(Me)),P&&P(Me)}),ir=()=>{const Me=Ue.current;return l&&l!=="button"&&!(Me.tagName==="A"&&Me.href)},vt=K.exports.useRef(!1),Xr=Qo(Me=>{_&&!vt.current&&Rt&&le.current&&Me.key===" "&&(vt.current=!0,le.current.stop(Me,()=>{le.current.start(Me)})),Me.target===Me.currentTarget&&ir()&&Me.key===" "&&Me.preventDefault(),O&&O(Me),Me.target===Me.currentTarget&&ir()&&Me.key==="Enter"&&!h&&(Me.preventDefault(),x&&x(Me))}),fi=Qo(Me=>{_&&Me.key===" "&&le.current&&Rt&&!Me.defaultPrevented&&(vt.current=!1,le.current.stop(Me,()=>{le.current.pulsate(Me)})),N&&N(Me),x&&Me.target===Me.currentTarget&&ir()&&Me.key===" "&&!Me.defaultPrevented&&x(Me)});let pe=l;pe==="button"&&(Pe.href||Pe.to)&&(pe=E);const Oe={};pe==="button"?(Oe.type=xe===void 0?"button":xe,Oe.disabled=h):(!Pe.href&&!Pe.to&&(Oe.role="button"),h&&(Oe["aria-disabled"]=h));const Xe=ea(it,Ue),et=ea(n,Xe),We=ue({},r,{centerRipple:s,component:l,disabled:h,disableRipple:p,disableTouchRipple:m,focusRipple:_,tabIndex:ne,focusVisible:Rt}),lt=woe(We);return ii(Toe,ue({as:pe,className:en(lt.root,a),ownerState:We,onBlur:rr,onClick:x,onContextMenu:zt,onFocus:$r,onKeyDown:Xr,onKeyUp:fi,onMouseDown:Gt,onMouseLeave:jn,onMouseUp:In,onDragLeave:Mn,onTouchEnd:yn,onTouchMove:on,onTouchStart:kn,ref:et,tabIndex:h?-1:ne,type:xe},Oe,Pe,{children:[o,Ut?ze(moe,ue({ref:ve,center:s},se)):null]}))}),xoe=boe;function Coe(t){return U0("MuiButton",t)}const Soe=Uu("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),dh=Soe,Poe=K.exports.createContext({}),Moe=Poe,Ioe=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Boe=t=>{const{color:e,disableElevation:n,fullWidth:r,size:i,variant:s,classes:o}=t,a={root:["root",s,`${s}${kt(e)}`,`size${kt(i)}`,`${s}Size${kt(i)}`,e==="inherit"&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${kt(i)}`],endIcon:["endIcon",`iconSize${kt(i)}`]},l=M_(a,Coe,o);return ue({},o,l)},bL=t=>ue({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Loe=Qr(xoe,{shouldForwardProp:t=>wL(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${kt(n.color)}`],e[`size${kt(n.size)}`],e[`${n.variant}Size${kt(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,r;return ue({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":ue({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:El(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:El(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:El(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:(t.vars||t).palette.grey.A100,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":ue({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${dh.focusVisible}`]:ue({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${dh.disabled}`]:ue({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="outlined"&&e.color==="secondary"&&{border:`1px solid ${(t.vars||t).palette.action.disabled}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${El(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(r=t.palette).getContrastText)==null?void 0:n.call(r,t.palette.grey[300]),backgroundColor:(t.vars||t).palette.grey[300],boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${dh.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${dh.disabled}`]:{boxShadow:"none"}}),Roe=Qr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${kt(n.size)}`]]}})(({ownerState:t})=>ue({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},bL(t))),Ooe=Qr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${kt(n.size)}`]]}})(({ownerState:t})=>ue({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},bL(t))),Foe=K.exports.forwardRef(function(e,n){const r=K.exports.useContext(Moe),i=UB(r,e),s=tp({props:i,name:"MuiButton"}),{children:o,color:a="primary",component:l="button",className:h,disabled:p=!1,disableElevation:m=!1,disableFocusRipple:_=!1,endIcon:E,focusVisibleClassName:b,fullWidth:x=!1,size:I="medium",startIcon:S,type:P,variant:M="text"}=s,O=zn(s,Ioe),N=ue({},s,{color:a,component:l,disabled:p,disableElevation:m,disableFocusRipple:_,fullWidth:x,size:I,type:P,variant:M}),z=Boe(N),X=S&&ze(Roe,{className:z.startIcon,ownerState:N,children:S}),Z=E&&ze(Ooe,{className:z.endIcon,ownerState:N,children:E});return ii(Loe,ue({ownerState:N,className:en(r.className,z.root,h),component:l,disabled:p,focusRipple:!_,focusVisibleClassName:en(z.focusVisible,b),ref:n,type:P},O,{classes:z,children:[X,o,Z]}))}),Doe=Foe;const koe=()=>{const t=K.exports.useContext(P_),[e,n]=K.exports.useState(1.5);return ze("div",{className:"start-dialog",children:ii("div",{className:"start-dialog-box",children:[ze("div",{className:"project-title",children:"\u795E\u6E38"}),ze("div",{className:"description1",children:"Start a imagined wandering on ...train..."}),ze("div",{className:"description2",children:"How long would you like the journey to last?"}),ii("div",{className:"time-length",children:[e,ze("span",{style:{color:"#aaa",fontSize:"1rem"},children:" Hours"})]}),ze(Zse,{min:.5,max:6,step:.1,value:e,onChange:(s,o)=>{n(o)}}),ze(Doe,{variant:"outlined",size:"large",style:{marginTop:"3rem"},onClick:()=>{t({type:"setTimeLength",payload:e*3600*1e3})},children:"Select A City"})]})})};const Noe=({time:t=0,startingTime:e=0,timeLength:n=0,selectedStation:r={},filteredRouteList:i=[],selectedRoute:s=[]})=>{var b;const o=Zt.duration(Zt(e+n).diff(Zt(t))),a=i.length!==0,l=s.length!==0,{city:h}=r,p=(b=s[0])==null?void 0:b.trainCode,m=!a&&!l,_=a&&!l,E=l;return ii("div",{className:"info-pane",children:[m&&ze("div",{style:{padding:"1rem"},children:"pick a city"}),_&&ii("div",{className:"text-info",children:[ze("div",{className:"text-secondary",children:"Departure City:"}),ze("div",{className:"text-primary",children:h})]}),E&&ii("div",{className:"text-info",children:[ze("div",{className:"text-secondary",children:"Train:"}),ze("div",{className:"text-primary",children:p}),ze("div",{className:"countdown",children:o.format("HH:mm:ss")})]}),ii("div",{style:{height:"100%"},children:[_&&ze("iframe",{style:{height:"100%",border:0},src:Ate(h)}),E&&ze("div",{style:{height:"100%",border:0},children:"Route"})]})]})};function Uoe(){const[t,e]=K.exports.useReducer(hte,fte),n=K.exports.useRef(!1),r=K.exports.useRef(0);K.exports.useEffect(()=>{(async()=>{if(n.current)return;n.current=!0;const _=fetch("routes.json").then(I=>I.json()),E=fetch("stations.json").then(I=>I.json()),[b,x]=await Promise.all([_,E]);e({type:"loadData",payload:{routeList:b,stationMap:x}}),n.current=!1})()},[]);const i=()=>{t.playing&&e({type:"setTime",payload:Number(S_())}),r.current=window.requestAnimationFrame(i)};K.exports.useEffect(()=>(r.current=window.requestAnimationFrame(i),()=>{window.cancelAnimationFrame(r.current),r.current=0}),[t.playing]);const{time:s,startingTime:o,timeLength:a,stationList:l,selectedStation:h,filteredRouteList:p,selectedRoute:m}=t;return ze(P_.Provider,{value:e,children:t.timeLength===0?ze(koe,{}):ii(ED,{children:[ze(Noe,{time:s,startingTime:o,timeLength:a,selectedStation:h,filteredRouteList:p,selectedRoute:m}),ze("div",{className:"map-container",children:ze(dte,{time:s,stationList:l,filteredRouteList:p,selectedRoute:m})})]})})}dm.createRoot(document.getElementById("root")).render(ze(Xd.StrictMode,{children:ze(Uoe,{})}));export{$R as c};
